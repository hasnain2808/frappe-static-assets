var Rollup=function(exports){"use strict";window.frappe||(window.frappe={}),frappe.provide=function(e){for(var t=e.split("."),n=window,r=0;r<t.length;r++){var i=t[r];n[i]||(n[i]={}),n=n[i]}return n},frappe.provide("locals"),frappe.provide("frappe.flags"),frappe.provide("frappe.settings"),frappe.provide("frappe.utils"),frappe.provide("frappe.ui.form"),frappe.provide("frappe.modules"),frappe.provide("frappe.templates"),frappe.provide("frappe.test_data"),frappe.provide("frappe.utils"),frappe.provide("frappe.model"),frappe.provide("frappe.user"),frappe.provide("frappe.session"),frappe.provide("frappe._messages"),frappe.provide("locals.DocType"),frappe.provide("frappe.listview_settings"),frappe.provide("frappe.tour"),frappe.provide("frappe.listview_parent_route"),window.NEWLINE="\n",window.TAB=9,window.UP_ARROW=38,window.DOWN_ARROW=40,window.cur_frm=null,frappe._=function(e,t,n){if(void 0===n&&(n=null),!e)return e;if("string"!=typeof e)return e;var r="",i=e;return n&&(r=frappe._messages[i+":"+n]),r||(r=frappe._messages[i]||e),t&&"object"==typeof t&&(r=$.format(r,t)),r},window.__=frappe._,frappe.get_languages=function(){return frappe.languages||(frappe.languages=[],$.each(frappe.boot.lang_dict,function(e,t){frappe.languages.push({label:e,value:t})}),frappe.languages=frappe.languages.sort(function(e,t){return e.value<t.value?-1:1})),frappe.languages};var commonjsGlobal="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function unwrapExports(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}!function(e){var t=/xyz/.test(function(){})?/\b_super\b/:/.*/;function n(){}n.extend=function(e){var r=this.prototype,i=Object.create(r);for(var a in e)i[a]="function"==typeof e[a]&&"function"==typeof r[a]&&t.test(e[a])?function(e,t){return function(){var n=this._super;this._super=r[e];var i=t.apply(this,arguments);return this._super=n,i}}(a,e[a]):e[a];var o="function"==typeof i.init?i.hasOwnProperty("init")?i.init:function(){r.init.apply(this,arguments)}:function(){};return o.prototype=i,i.constructor=o,o.extend=n.extend,o},e.Class=n}(commonjsGlobal);var _class={};function format(e,t){return null==e?e:(this.unkeyed_index=0,e.replace(/\{(\w*)\}/g,function(e,n){if(""===n&&(n=this.unkeyed_index,this.unkeyed_index++),n==+n)return void 0!==t[n]?t[n]:e}.bind(this)))}String.prototype.includes||(String.prototype.includes=function(e,t){return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),r=n.length>>>0;if(0===r)return!1;for(var i=0|t,a=Math.max(i>=0?i:r-Math.abs(i),0);a<r;){if(n[a]===e)return!0;a++}return!1}}),"function"!=typeof String.prototype.trimLeft&&(String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")}),"function"!=typeof String.prototype.trimRight&&(String.prototype.trimRight=function(){return this.replace(/\s+$/,"")}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e){var t=arguments;if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),r=1;r<arguments.length;r++){var i=t[r];if(null!=i)for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])}return n},writable:!0,configurable:!0}),frappe.require=function(e,t){return"string"==typeof e&&(e=[e]),new Promise(function(n){frappe.assets.execute(e,function(){n(),t&&t()})})},frappe.assets={check:function(){if(window._version_number!=localStorage.getItem("_version_number")&&(frappe.assets.clear_local_storage(),console.log("Cleared App Cache.")),localStorage._last_load){var e=new Date-new Date(localStorage._last_load);(e<1e4||e>864e5)&&frappe.assets.clear_local_storage()}else frappe.assets.clear_local_storage();frappe.assets.init_local_storage()},init_local_storage:function(){localStorage._last_load=new Date,localStorage._version_number=window._version_number,frappe.boot&&(localStorage.metadata_version=frappe.boot.metadata_version)},clear_local_storage:function(){for(var e in $.each(["_last_load","_version_number","metadata_version","page_info","last_visited"],function(e,t){localStorage.removeItem(t)}),localStorage)0!==e.indexOf("desk_assets:")&&0!==e.indexOf("_page:")&&0!==e.indexOf("_doctype:")&&0!==e.indexOf("preferred_breadcrumbs:")||localStorage.removeItem(e);console.log("localStorage cleared")},executed_:[],execute:function(e,t){for(var n=[],r=0,i=e.length;r<i;r++)frappe.assets.exists(e[r])||n.push(e[r]);n.length?frappe.assets.fetch(n,function(){frappe.assets.eval_assets(e,t)}):frappe.assets.eval_assets(e,t)},eval_assets:function(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n];-1===frappe.assets.executed_.indexOf(i)&&(frappe.assets.handler[frappe.assets.extn(i)](frappe.assets.get(i),i),frappe.assets.executed_.push(i))}t&&t()},exists:function(e){return-1!==frappe.assets.executed_.indexOf(e)||!frappe.boot.developer_mode&&!!frappe.assets.get(e)},fetch:function(e,t){frappe.call({type:"GET",method:"frappe.client.get_js",args:{items:e},callback:function(n){$.each(e,function(e,t){frappe.assets.add(t,n.message[e])}),t()},freeze:!0})},add:function(e,t){if("localStorage"in window)try{frappe.assets.set(e,t)}catch(n){frappe.assets.clear_local_storage(),frappe.assets.set(e,t)}},get:function(e){return localStorage.getItem("desk_assets:"+e)},set:function(e,t){localStorage.setItem("desk_assets:"+e,t)},extn:function(e){return-1!=e.indexOf("?")&&(e=e.split("?").slice(-1)[0]),e.split(".").slice(-1)[0]},handler:{js:function(e,t){frappe.dom.eval(e)},css:function(e,t){frappe.dom.set_style(e)}},include_style:function(e,t,n){void 0===n&&(n=null);var r=t+"/assets/css/"+e;return n&&(r=t+"/assets/css-rtl/"+e),'<link href="'+r+'" rel="stylesheet">'}},jQuery&&(jQuery.format=format),frappe.provide("frappe.form.formatters"),frappe.form.link_formatters={},frappe.form.formatters={_right:function(e,t){return t&&(t.inline||t.only_value)?e:"<div style='text-align: right'>"+e+"</div>"},Data:function(e,t){return t&&"URL"==t.options?'<a href="'+e+'" title="Open Link" target="_blank">'+e+"</a>":null==e?"":e},Select:function(e){return __(frappe.form.formatters.Data(e))},Float:function(e,t,n,r){var i=t.precision||cint(frappe.boot.sysdefaults&&frappe.boot.sysdefaults.float_precision)||null;if(t.options&&t.options.trim())return t.precision=i,frappe.form.formatters.Currency(e,t,n,r);if(!(n||{}).always_show_decimals&&!is_null(e)){var a=cstr(e).split(".");null!=a[1]&&0!==cint(a[1])||(i=0)}return frappe.form.formatters._right(null==e||""===e?"":format_number(e,null,i),n)},Int:function(e,t,n){return frappe.form.formatters._right(null==e?"":cint(e),n)},Percent:function(e,t,n){var r=t.precision||cint(frappe.boot.sysdefaults&&frappe.boot.sysdefaults.float_precision)||2;return frappe.form.formatters._right(flt(e,r)+"%",n)},Rating:function(e){return'<div class="rating">\n\t\t\t'+(""+[1,2,3,4,5].map(function(t){return'<svg class="icon icon-md '+(t<=(e||0)?"star-click":"")+'" data-idx="'+t+'">\n\t\t\t\t<use href="#icon-star"></use>\n\t\t\t</svg>'}).join(""))+"\n\t\t</div>"},Currency:function(e,t,n,r){var i=frappe.meta.get_field_currency(t,r),a=t.precision||cint(frappe.boot.sysdefaults.currency_precision)||2;if(a>2){var o=cstr(e).split("."),s=o.length>1?o[1]:"";if(s.length<3||s.length<a){var l=frappe.model.get_value(":Currency",i,"fraction_units")||100;s.length<cstr(l).length&&(a=cstr(l).length-1)}}return e=null==e||""===e?"":format_currency(e,i,a),n&&n.only_value?e:frappe.form.formatters._right(e,n)},Check:function(e){return'<input type="checkbox" disabled\n\t\t\tclass="disabled-'+(e?"selected":"deselected")+'">'},Link:function(e,t,n,r){var i=t._options||t.options,a=e;return e&&e.match&&e.match(/^['"].*['"]$/)&&e.replace(/^.(.*).$/,"$1"),n&&(n.for_print||n.only_value)?e:(frappe.form.link_formatters[i]&&r&&i!==r.doctype&&(e=frappe.form.link_formatters[i](e,r,t)),e?"'"==e[0]&&"'"==e[e.length-1]?e.substring(1,e.length-1):t&&t.link_onclick?repl('<a onclick="%(onclick)s">%(value)s</a>',{onclick:t.link_onclick.replace(/"/g,"&quot;"),value:e}):t&&i&&frappe.model.can_read(i)?'<a\n\t\t\t\t\thref="/app/'+encodeURIComponent(frappe.router.slug(i))+"/"+encodeURIComponent(a)+'"\n\t\t\t\t\tdata-doctype="'+i+'"\n\t\t\t\t\tdata-name="'+a+'">\n\t\t\t\t\t'+__(n&&n.label||e)+"</a>":e:"")},Date:function(e){return frappe.datetime.str_to_user?(e&&"Invalid date"===(e=frappe.datetime.str_to_user(e))&&(e=null),e||""):e},DateRange:function(e){return Array.isArray(e)?__("{0} to {1}",[frappe.datetime.str_to_user(e[0]),frappe.datetime.str_to_user(e[1])]):e||""},Datetime:function(e){if(e){var t=moment(frappe.datetime.convert_to_user_tz(e));return frappe.boot.sysdefaults.time_zone&&(t=t.tz(frappe.boot.sysdefaults.time_zone)),t.format(frappe.boot.sysdefaults.date_format.toUpperCase()+" "+(frappe.boot.sysdefaults.time_format||"HH:mm:ss"))}return""},Text:function(e){if(e){for(var t=["<p","<div","<br","<table"],n=!1,r=0;r<t.length;r++)if(e.match(t[r])){n=!0;break}n||(e=frappe.utils.replace_newlines(e))}return frappe.form.formatters.Data(e)},Time:function(e){return e&&(e=frappe.datetime.str_to_user(e,!0)),e||""},Duration:function(e,t){if(e){var n=frappe.utils.get_duration_options(t);e=frappe.utils.get_formatted_duration(e,n)}return e||""},LikedBy:function(e){var t="";return $.each(JSON.parse(e||"[]"),function(e,n){n&&(t+=frappe.avatar(n))}),t},Tag:function(e){var t="";return $.each((e||"").split(","),function(e,n){n&&(t+='\n\t\t\t\t<span\n\t\t\t\t\tclass="data-pill btn-xs align-center ellipsis"\n\t\t\t\t\tstyle="background-color: var(--control-bg); box-shadow: none; margin-right: 4px;"\n\t\t\t\t\tdata-field="_user_tags" data-label="'+n+"'\">\n\t\t\t\t\t"+n+"\n\t\t\t\t</span>")}),t},Comment:function(e){return e},Assign:function(e){var t="";return $.each(JSON.parse(e||"[]"),function(e,n){n&&(t+='<span class="label label-warning" \t\t\t\tstyle="margin-right: 7px;"\t\t\t\tdata-field="_assign">'+n+"</span>")}),t},SmallText:function(e){return frappe.form.formatters.Text(e)},TextEditor:function(e){var t=frappe.form.formatters.Text(e);try{$(t).find(".ql-editor").length||(t='<div class="ql-editor read-mode">'+t+"</div>")}catch(e){t='<div class="ql-editor read-mode">'+t+"</div>"}return t},Code:function(e){return"<pre>"+(null==e?"":$("<div>").text(e).html())+"</pre>"},WorkflowState:function(e){var t=frappe.get_doc("Workflow State",e);return t?repl("<span class='label label-%(style)s' \t\t\t\tdata-workflow-state='%(value)s'\t\t\t\tstyle='padding-bottom: 4px; cursor: pointer;'>\t\t\t\t<i class='fa fa-small fa-white fa-%(icon)s'></i> %(value)s</span>",{value:e,style:t.style.toLowerCase(),icon:t.icon}):"<span class='label'>"+e+"</span>"},Email:function(e){return $("<div></div>").text(e).html()},FileSize:function(e){return e>1048576?e=flt(flt(e)/1048576,1)+"M":e>1024&&(e=flt(flt(e)/1024,1)+"K"),e},TableMultiSelect:function(e,t,n){e=e||[];var r=frappe.get_meta(t.options).fields.find(function(e){return"Link"===e.fieldtype});return e.map(function(e){var t=e[r.fieldname];return frappe.format(t,r,n,e)}).join(", ")},Color:function(e){return e?'<div>\n\t\t\t<div class="selected-color" style="background-color: '+e+'"></div>\n\t\t\t<span class="color-value">'+e+"</span>\n\t\t</div>":""},Icon:function(e){return e?'<div>\n\t\t\t<div class="selected-icon">'+frappe.utils.icon(e,"md")+'</div>\n\t\t\t<span class="icon-value">'+e+"</span>\n\t\t</div>":""}},frappe.form.get_formatter=function(e){return e||(e="Data"),frappe.form.formatters[e.replace(/ /g,"")]||frappe.form.formatters.Data},frappe.format=function(e,t,n,r){t||(t={fieldtype:"Data"}),"_user_tags"==t.fieldname&&(t.fieldtype="Tag");var i=t.fieldtype||"Data";"Dynamic Link"===i&&(i="Link",t._options=r?r[t.options]:null);var a=(t.formatter||frappe.form.get_formatter(i))(e,t,n,r);return"string"==typeof a&&(a=frappe.dom.remove_script_and_style(a)),a},frappe.get_format_helper=function(e){var t={get_formatted:function(t){var n=frappe.meta.get_docfield(e.doctype,t);return n||console.log("fieldname not found: "+t),frappe.format(e[t],n,{inline:1},e)}};return $.extend(t,e),t},frappe.form.link_formatters.User=function(e,t,n){return t&&(t.full_name||n&&t[n.fieldname+"_full_name"])||e},frappe.provide("frappe.dom"),frappe.dom={id_count:0,freeze_count:0,by_id:function(e){return document.getElementById(e)},get_unique_id:function(){var e="unique-"+frappe.dom.id_count;return frappe.dom.id_count++,e},set_unique_id:function(e){var t=$(e);if(t.attr("id"))return t.attr("id");var n="unique-"+frappe.dom.id_count;return t.attr("id",n),frappe.dom.id_count++,n},eval:function(e){if(e){var t=document.createElement("script");t.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(t)}},remove_script_and_style:function(e){var t=["script","style","noscript","title","meta","base","head"];if(!new RegExp(t.map(function(e){return"<"+e+">.*<\\/"+e+">"}).join("|"),"s").test(e))return e;var n=document.createElement("div");n.innerHTML=e;var r=!1;t.forEach(function(e){var t=n.getElementsByTagName(e);for(a=t.length;a--;)r=!0,t[a].parentNode.removeChild(t[a])});for(var i=n.getElementsByTagName("link"),a=i.length;a--;)"stylesheet"==i[a].getAttribute("rel")&&(r=!0,i[a].parentNode.removeChild(i[a]));return r?n.innerHTML:e},is_element_in_viewport:function(e,t){void 0===t&&(t=0),"function"==typeof jQuery&&e instanceof jQuery&&(e=e[0]);var n=e.getBoundingClientRect();return n.top+t>=0&&n.left+t>=0&&n.bottom-t<=$(window).height()&&n.right-t<=$(window).width()},is_element_in_modal:function(e){return Boolean($(e).parents(".modal").length)},set_style:function(e,t){if(e){var n=document.createElement("style");if(n.type="text/css",t){var r=document.getElementById(t);r&&r.parentNode.removeChild(r),n.id=t}return n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(n),n}},add:function(e,t,n,r,i,a){e&&e.substr&&(e=frappe.dom.by_id(e));var o=document.createElement(t);return e&&e.appendChild(o),n&&("img"==t.toLowerCase()?o.src=n:o.className=n),r&&frappe.dom.css(o,r),i&&(o.innerHTML=i),a&&(o.onclick=a),o},css:function(e,t){return e&&t&&$.extend(e.style,t),e},activate:function(e,t,n,r){void 0===r&&(r="active"),e.find("."+n+"."+r).removeClass(r),t.addClass(r)},freeze:function(e,t){if($("#freeze").length)$("#freeze").addClass("in");else{var n=$('<div id="freeze" class="modal-backdrop fade"></div>').on("click",function(){if(cur_frm&&cur_frm.cur_grid)return cur_frm.cur_grid.toggle_view(),!1}).appendTo("#body");n.html(repl('<div class="freeze-message-container"><div class="freeze-message"><p class="lead">%(msg)s</p></div></div>',{msg:e||""})),setTimeout(function(){n.addClass("in")},1)}t&&$("#freeze").addClass(t),frappe.dom.freeze_count++},unfreeze:function(){if(frappe.dom.freeze_count&&(frappe.dom.freeze_count--,!frappe.dom.freeze_count))$("#freeze").removeClass("in").remove()},save_selection:function(){if(window.getSelection){var e=window.getSelection();if(e.getRangeAt&&e.rangeCount){for(var t=[],n=0,r=e.rangeCount;n<r;++n)t.push(e.getRangeAt(n));return t}}else if(document.selection&&document.selection.createRange)return document.selection.createRange();return null},restore_selection:function(e){if(e)if(window.getSelection){var t=window.getSelection();t.removeAllRanges();for(var n=0,r=e.length;n<r;++n)t.addRange(e[n])}else document.selection&&e.select&&e.select()},is_touchscreen:function(){return"ontouchstart"in window},handle_broken_images:function(e){$(e).find("img").on("error",function(e){$(e.currentTarget).addClass("no-image")})},scroll_to_bottom:function(e){var t=$(e);t.scrollTop(t[0].scrollHeight)},file_to_base64:function(e){return new Promise(function(t){var n=new FileReader;n.onload=function(){t(n.result)},n.readAsDataURL(e)})},scroll_to_section:function(e){setTimeout(function(){var t=$('a:contains("'+e+'")');t.length&&(t.parent().hasClass("collapsed")&&t.click(),frappe.ui.scroll(t.parent().parent()))},200)},pixel_to_inches:function(e){var t=$('<div id="dpi" style="height: 1in; width: 1in; left: 100%; position: fixed; top: 100%;"></div>');t.appendTo(document.body);var n=e/document.getElementById("dpi").offsetWidth;return t.remove(),n}},frappe.ellipsis=function(e,t){return t||(t=20),(e=cstr(e)).length>t&&(e=e.substr(0,t)+"..."),e},frappe.run_serially=function(e){var t=Promise.resolve();return e.forEach(function(e){e&&(t=t.then?t.then(e):Promise.resolve())}),t},frappe.load_image=function(e,t,n,r){void 0===r&&(r=function(){});var i=new Image;i.onload=function(){t(this)},i.onerror=n,r(i),i.src=e},frappe.timeout=function(e){return new Promise(function(t){setTimeout(function(){return t()},1e3*e)})},frappe.scrub=function(e,t){return void 0===t&&(t="_"),e.replace(/ /g,t).toLowerCase()},frappe.unscrub=function(e){return frappe.model.unscrub(e)},frappe.get_data_pill=function(e,t,n,r){void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=null);var i=$('\n\t\t<button class="data-pill btn">\n\t\t\t<div class="flex align-center ellipsis">\n\t\t\t\t'+(r||"")+'\n\t\t\t\t<span class="pill-label '+(r?"ml-2":"")+'">'+e+"</span>\n\t\t\t</div>\n\t\t</button>\n\t");if(n){var a=$('\n\t\t\t<span class="remove-btn cursor-pointer">\n\t\t\t\t'+frappe.utils.icon("close","sm")+"\n\t\t\t</span>\n\t\t").click(function(){n(t||e,i)});i.append(a)}return i},frappe.get_modal=function(e,t){return $('<div class="modal fade" style="overflow: auto;" tabindex="-1">\n\t\t<div class="modal-dialog">\n\t\t\t<div class="modal-content">\n\t\t\t\t<div class="modal-header">\n\t\t\t\t\t<div class="fill-width flex title-section">\n\t\t\t\t\t\t<span class="indicator hidden"></span>\n\t\t\t\t\t\t<h4 class="modal-title">'+e+'</h4>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="modal-actions">\n\t\t\t\t\t\t<button class="btn btn-modal-minimize btn-link hide">\n\t\t\t\t\t\t\t'+frappe.utils.icon("collapse")+'\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button class="btn btn-modal-close btn-link" data-dismiss="modal">\n\t\t\t\t\t\t\t'+frappe.utils.icon("close-alt","sm","close-alt")+'\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="modal-body ui-front">'+t+'</div>\n\t\t\t\t<div class="modal-footer hide">\n\t\t\t\t\t<div class="custom-actions"></div>\n\t\t\t\t\t<div class="standard-actions">\n\t\t\t\t\t\t<button type="button" class="btn btn-secondary btn-sm hide btn-modal-secondary">\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button type="button" class="btn btn-primary btn-sm hide btn-modal-primary">\n\t\t\t\t\t\t\t'+__("Confirm")+"\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>")},frappe.is_online=function(){return 1==frappe.boot.developer_mode||(!("onLine"in navigator)||navigator.onLine)},$(window).on("online",function(){frappe.show_alert({indicator:"green",message:__("You are connected to internet.")})}),$(window).on("offline",function(){frappe.show_alert({indicator:"orange",message:__("Connection lost. Some features might not work.")})}),frappe.ui.form.Layout=Class.extend({init:function(e){this.views={},this.pages=[],this.sections=[],this.fields_list=[],this.fields_dict={},$.extend(this,e)},make:function(){!this.parent&&this.body&&(this.parent=this.body),this.wrapper=$('<div class="form-layout">').appendTo(this.parent),this.message=$('<div class="form-message hidden"></div>').appendTo(this.wrapper),this.fields||(this.fields=this.get_doctype_fields()),this.setup_tabbing(),this.render()},show_empty_form_message:function(){this.wrapper.find(".frappe-control:visible").length||this.wrapper.find(".section-head.collapsed").length||this.show_message(__("This form does not have any input"))},get_doctype_fields:function(){var e=[this.get_new_name_field()];return e=this.doctype_layout?e.concat(this.get_fields_from_layout()):e.concat(frappe.meta.sort_docfields(frappe.meta.docfield_map[this.doctype]))},get_new_name_field:function(){return{parent:this.frm.doctype,fieldtype:"Data",fieldname:"__newname",reqd:1,hidden:1,label:__("Name"),get_status:function(e){return e.frm&&e.frm.is_new()&&e.frm.meta.autoname&&["prompt","name"].includes(e.frm.meta.autoname.toLowerCase())?"Write":"None"}}},get_fields_from_layout:function(){for(var e=[],t=0,n=this.doctype_layout.fields;t<n.length;t+=1){var r=n[t],i=copy_dict(frappe.meta.docfield_map[this.doctype][r.fieldname]);i.label=r.label,e.push(i)}return e},show_message:function(e,t){this.message_color&&this.message.removeClass(this.message_color),this.message_color=t&&["yellow","blue"].includes(t)?t:"blue",e?("<"!==e.substr(0,1)&&(e="<div>"+e+"</div>"),this.message.removeClass("hidden").addClass(this.message_color),$(e).appendTo(this.message)):this.message.empty().addClass("hidden")},render:function(e){var t=this,n=e||this.fields;this.section=null,this.column=null,this.with_dashboard&&this.setup_dashboard_section(),this.no_opening_section()&&this.make_section(),$.each(n,function(e,n){switch(n.fieldtype){case"Fold":t.make_page(n);break;case"Section Break":t.make_section(n);break;case"Column Break":t.make_column(n);break;default:t.make_field(n)}})},no_opening_section:function(){return this.fields[0]&&"Section Break"!=this.fields[0].fieldtype||!this.fields.length},setup_dashboard_section:function(){this.no_opening_section()&&this.fields.unshift({fieldtype:"Section Break"})},replace_field:function(e,t,n){if(t.fieldname=e,this.fields_dict[e]&&this.fields_dict[e].df){var r=this.init_field(t,n);this.fields_dict[e].$wrapper.remove(),this.fields_list.splice(this.fields_dict[e],1,r),this.fields_dict[e]=r,this.frm&&(r.perm=this.frm.perm),this.section.fields_list.splice(this.section.fields_dict[e],1,r),this.section.fields_dict[e]=r,this.refresh_fields([t])}},make_field:function(e,t,n){!this.section&&this.make_section(),!this.column&&this.make_column();var r=this.init_field(e,n);this.fields_list.push(r),this.fields_dict[e.fieldname]=r,this.frm&&(r.perm=this.frm.perm),this.section.fields_list.push(r),this.section.fields_dict[e.fieldname]=r,r.section=this.section},init_field:function(e,t){void 0===t&&(t=!1);var n=frappe.ui.form.make_control({df:e,doctype:this.doctype,parent:this.column.wrapper.get(0),frm:this.frm,render_input:t,doc:this.doc,layout:this});return n.layout=this,n},make_page:function(e){var t=this,n=$('<div class="form-clickable-section text-center">\t\t\t\t<a class="btn-fold h6 text-muted">'+__("Show more details")+"</a>\t\t\t</div>").appendTo(this.wrapper);this.page=$('<div class="form-page second-page hide"></div>').appendTo(this.wrapper),this.fold_btn=n.find(".btn-fold").on("click",function(){var e=$(this).parent().next();e.hasClass("hide")?($(this).removeClass("btn-fold").html(__("Hide details")),e.removeClass("hide"),frappe.utils.scroll_to($(this),!0,30),t.folded=!1):($(this).addClass("btn-fold").html(__("Show more details")),e.addClass("hide"),t.folded=!0)}),this.section=null,this.folded=!0},unfold:function(){this.fold_btn.trigger("click")},make_section:function(e){this.section=new frappe.ui.form.Section(this,e),e&&(this.fields_dict[e.fieldname]=this.section,this.fields_list.push(this.section)),this.column=null},make_column:function(e){this.column=new frappe.ui.form.Column(this.section,e),e&&e.fieldname&&this.fields_list.push(this.column)},refresh:function(e){e&&(this.doc=e),this.frm&&this.wrapper.find(".empty-form-alert").remove(),this.attach_doc_and_docfields(!0),this.frm&&this.frm.wrapper&&$(this.frm.wrapper).trigger("refresh-fields"),this.refresh_dependency(),this.refresh_sections(),this.frm&&this.refresh_section_collapse(),document.activeElement&&"INPUT"==document.activeElement.tagName&&this.is_numeric_field_active()&&document.activeElement.select()},is_numeric_field_active:function(){var e=($(document.activeElement).closest(".frappe-control").data()||{}).fieldtype;return frappe.model.numeric_fieldtypes.includes(e)},refresh_sections:function(){this.wrapper.find(".form-section:not(.hide-control)").each(function(){var e=$(this).removeClass("empty-section visible-section");e.find(".frappe-control:not(.hide-control)").length?e.addClass("visible-section"):e.addClass("empty-section")})},refresh_fields:function(e){var t=e.map(function(e){if(e.fieldname)return e.fieldname});this.fields_list.map(function(e){t.includes(e.df.fieldname)&&(e.refresh(),e.df.default&&e.set_input(e.df.default))})},add_fields:function(e){this.render(e),this.refresh_fields(e)},refresh_section_collapse:function(){if(this.sections&&this.sections.length)for(var e=0;e<this.sections.length;e++){var t=this.sections[e],n=t.df;if(n&&n.collapsible){var r=!0;n.collapsible_depends_on&&(r=!this.evaluate_depends_on_value(n.collapsible_depends_on)),r&&t.has_missing_mandatory()&&(r=!1),t.collapse(r)}}},attach_doc_and_docfields:function(e){for(var t=this,n=0,r=this.fields_list.length;n<r;n++){var i=this.fields_list[n];t.doc&&(i.doc=t.doc,i.doctype=t.doc.doctype,i.docname=t.doc.name,i.df=frappe.meta.get_docfield(t.doc.doctype,i.df.fieldname,t.doc.name)||i.df,t.frm&&(i.perm=t.frm.perm)),e&&i.df&&i.refresh&&i.refresh()}},refresh_section_count:function(){this.wrapper.find(".section-count-label:visible").each(function(e){$(this).html(e+1)})},setup_tabbing:function(){var e=this;this.wrapper.on("keydown",function(t){if(9==t.which){var n=$(t.target),r=n.attr("data-doctype"),i=n.attr("data-fieldname");if(r)return e.handle_tab(r,i,t.shiftKey)}})},handle_tab:function(e,t,n){var r=null,i=null,a=this.fields_list,o=!1;if(e!=this.doctype){if(!(r=this.get_open_grid_row())||!r.layout)return;a=r.layout.fields_list}for(var s=0,l=a.length;s<l;s++){if(a[s].df.fieldname==t){if(n){i?this.set_focus(i):$(this.primary_button).focus();break}if(s<l-1&&(o=this.focus_on_next_field(s,a)),o)break}this.is_visible(a[s])&&(i=a[s])}return o||(r?r.doc.idx==r.grid.grid_rows.length?r.toggle_view(!1,function(){r.grid.frm.layout.handle_tab(r.grid.df.parent,r.grid.df.fieldname)}):r.grid.grid_rows[r.doc.idx].toggle_view(!0):n||$(this.primary_button).focus()),!1},focus_on_next_field:function(e,t){for(var n=e+1,r=t.length;n<r;n++){var i=t[n];if(this.is_visible(i)){if("Table"===i.df.fieldtype)return i.grid.grid_rows&&i.grid.grid_rows.length||i.grid.add_new_row(),i.grid.grid_rows[0].show_form(),!0;if(!in_list(frappe.model.no_value_type,i.df.fieldtype))return this.set_focus(i),!0}}},is_visible:function(e){return"Write"===e.disp_status&&e.$wrapper&&e.$wrapper.is(":visible")},set_focus:function(e){"Table"==e.df.fieldtype?e.grid.grid_rows.length?e.grid.grid_rows[0].toggle_view(!0):e.grid.add_new_row(1):e.editor?e.editor.set_focus():e.$input&&e.$input.focus()},get_open_grid_row:function(){return $(".grid-row-open").data("grid_row")},refresh_dependency:function(){var e=!1;for(var t in this.fields_list){(r=this.fields_list[t]).dependencies_clear=!0,(r.df.depends_on||r.df.mandatory_depends_on||r.df.read_only_depends_on)&&(e=!0)}if(e){for(var n=this.fields_list.length-1;n>=0;n--){var r;(r=this.fields_list[n]).guardian_has_value=!0,r.df.depends_on&&(r.guardian_has_value=this.evaluate_depends_on_value(r.df.depends_on),r.guardian_has_value?r.df.hidden_due_to_dependency&&(r.df.hidden_due_to_dependency=!1,r.refresh()):r.df.hidden_due_to_dependency||(r.df.hidden_due_to_dependency=!0,r.refresh())),r.df.mandatory_depends_on&&this.set_dependant_property(r.df.mandatory_depends_on,r.df.fieldname,"reqd"),r.df.read_only_depends_on&&this.set_dependant_property(r.df.read_only_depends_on,r.df.fieldname,"read_only")}this.refresh_section_count()}},set_dependant_property:function(e,t,n){var r,i=this.evaluate_depends_on_value(e)?1:0;this.frm?r=this.frm:(this.is_dialog||"Web Form"===this.doctype)&&(r=this),r&&(this.doc&&this.doc.parent&&this.doc.parentfield?(r.setting_dependency=!0,r.set_df_property(this.doc.parentfield,n,i,this.doc.parent,t,this.doc.name),r.setting_dependency=!1,this.fields_dict[t]&&this.fields_dict[t].refresh()):r.set_df_property(t,n,i))},evaluate_depends_on_value:function(e){var t=null;if(!(n=this.doc)&&this.get_values)var n=this.get_values(!0);if(n){var r=this.frm?this.frm.doc:this.doc||null;if("boolean"==typeof e)t=e;else if("function"==typeof e)t=e(n);else if("eval:"==e.substr(0,5))try{t=frappe.utils.eval(e.substr(5),{doc:n,parent:r}),r&&r.istable&&e.includes("is_submittable")&&(t=!0)}catch(e){frappe.throw(__('Invalid "depends_on" expression'))}else if("fn:"==e.substr(0,3)&&this.frm)t=this.frm.script_manager.trigger(e.substr(3),this.doctype,this.docname);else{var i=n[e];t=$.isArray(i)?!!i.length:!!i}return t}}}),frappe.ui.form.Section=Class.extend({init:function(e,t){this.layout=e,this.df=t||{},this.fields_list=[],this.fields_dict={},this.make(),this.row={wrapper:this.wrapper},this.refresh()},make:function(){this.layout.page||(this.layout.page=$('<div class="form-page"></div>').appendTo(this.layout.wrapper));var e=this.layout.card_layout;this.wrapper=$('<div class="row form-section '+(e?"card-section":"")+'">').appendTo(this.layout.page),this.layout.sections.push(this),this.df&&(this.df.label&&this.make_head(),this.df.description&&$('<div class="col-sm-12 small text-muted form-section-description">'+__(this.df.description)+"</div>").appendTo(this.wrapper),this.df.cssClass&&this.wrapper.addClass(this.df.cssClass),this.df.hide_border&&this.wrapper.toggleClass("hide-border",!0)),this.body=$('<div class="section-body">').appendTo(this.wrapper)},make_head:function(){var e=this;this.head=$('<div class="section-head">\n\t\t\t'+__(this.df.label)+'\n\t\t\t<span class="ml-2 collapse-indicator mb-1">\n\t\t\t</span>\n\t\t</div>'),this.head.appendTo(this.wrapper),this.indicator=this.head.find(".collapse-indicator"),this.indicator.hide(),this.df.collapsible&&(this.collapse_link=this.head.on("click",function(){e.collapse()}),this.indicator.show())},refresh:function(){if(this.df){var e=this.df.hidden||this.df.hidden_due_to_dependency;!e&&this.layout&&this.layout.frm&&!this.layout.frm.get_perm(this.df.permlevel||0,"read")&&(e=!0),this.wrapper.toggleClass("hide-control",!!e)}},collapse:function(e){if(this.head&&this.body){void 0===e&&(e=!this.body.hasClass("hide")),this.body.toggleClass("hide",e),this.head.toggleClass("collapsed",e);var t=e?"down":"up-line";this.indicator,this.indicator.html(frappe.utils.icon(t,"sm","mb-1")),this.fields_list.forEach(function(e){"Signature"==e.df.fieldtype&&e.refresh()})}},is_collapsed:function(){return this.body.hasClass("hide")},has_missing_mandatory:function(){for(var e=!1,t=0,n=this.fields_list.length;t<n;t++){var r=this.fields_list[t].df;if(r.reqd&&null==this.layout.doc[r.fieldname]){e=!0;break}}return e}}),frappe.ui.form.Column=Class.extend({init:function(e,t){t||(t={}),this.df=t,this.section=e,this.make(),this.resize_all_columns()},make:function(){this.wrapper=$('<div class="form-column">\t\t\t<form>\t\t\t</form>\t\t</div>').appendTo(this.section.body).find("form").on("submit",function(){return!1}),this.df.label&&$('<label class="control-label">'+__(this.df.label)+"</label>").appendTo(this.wrapper)},resize_all_columns:function(){var e=cint(12/this.section.wrapper.find(".form-column").length);this.section.wrapper.find(".form-column").removeClass().addClass("form-column").addClass("col-sm-"+e)},refresh:function(){this.section.refresh()}}),frappe.provide("frappe.ui"),frappe.ui.FieldGroup=frappe.ui.form.Layout.extend({init:function(e){$.extend(this,e),this.dirty=!1,this._super(),$.each(this.fields||[],function(e,t){!t.fieldname&&t.label&&(t.fieldname=t.label.replace(/ /g,"_").toLowerCase())}),this.values&&this.set_values(this.values)},make:function(){var e=this,t=this;this.fields&&(this._super(),this.refresh(),$.each(this.fields_list,function(e,n){if(n.df.default){var r=n.df.default;"Today"==r&&"Date"==n.df.fieldtype&&(r=frappe.datetime.get_today()),n.set_input(r),t.refresh_dependency()}}),this.no_submit_on_enter||this.catch_enter_as_submit(),$(this.wrapper).find("input, select").on("change awesomplete-selectcomplete",function(){e.dirty=!0,frappe.run_serially([function(){return frappe.timeout(.1)},function(){return t.refresh_dependency()}])}))},first_button:!1,focus_on_first_input:function(){this.no_focus||$.each(this.fields_list,function(e,t){if(!in_list(["Date","Datetime","Time","Check"],t.df.fieldtype)&&t.set_focus)return t.set_focus(),!1})},catch_enter_as_submit:function(){var e=this;$(this.body).find('input[type="text"], input[type="password"], select').keypress(function(t){13==t.which&&e.has_primary_action&&(t.preventDefault(),e.get_primary_btn().trigger("click"))})},get_input:function(e){var t=this.fields_dict[e];return $(t.txt?t.txt:t.input)},get_field:function(e){return this.fields_dict[e]},get_values:function(e){var t={},n=[];for(var r in this.fields_dict){var i=this.fields_dict[r];if(i.get_value){var a=i.get_value();i.df.reqd&&is_null("string"==typeof a?strip_html(a):a)&&n.push(__(i.df.label)),i.df.reqd&&"Text Editor"===i.df.fieldtype&&is_null(strip_html(cstr(a)))&&n.push(__(i.df.label)),is_null(a)||(t[i.df.fieldname]=a)}}return n.length&&!e?(frappe.msgprint({title:__("Missing Values Required"),message:__("Following fields have missing values:")+"<br><br><ul><li>"+n.join("<li>")+"</ul>",indicator:"orange"}),null):t},get_value:function(e){var t=this.fields_dict[e];return t&&(t.get_value?t.get_value():null)},set_value:function(e,t){var n=this;return new Promise(function(r){var i=n.fields_dict[e];i?i.set_value(t).then(function(){i.set_input(t),n.refresh_dependency(),r()}):r()})},set_input:function(e,t){return this.set_value(e,t)},set_values:function(e){var t=[];for(var n in e)this.fields_dict[n]&&t.push(this.set_value(n,e[n]));return Promise.all(t)},clear:function(){for(var e in this.fields_dict){var t=this.fields_dict[e];t&&t.set_input&&t.set_input(t.df.default||"")}},set_df_property:function(e,t,n){var r=this.get_field(e);r.df[t]=n,r.refresh()}}),frappe.provide("frappe.ui"),window.cur_dialog=null,frappe.ui.open_dialogs=[],frappe.ui.Dialog=class extends frappe.ui.FieldGroup{constructor(e){super(),this.display=!1,this.is_dialog=!0,$.extend(this,{animate:!0,size:null},e),this.make()}make(){var e=this;this.$wrapper=frappe.get_modal("",""),this.static&&(this.$wrapper.modal({backdrop:"static",keyboard:!1}),this.get_close_btn().hide()),this.wrapper=this.$wrapper.find(".modal-dialog").get(0),"small"==this.size?$(this.wrapper).addClass("modal-sm"):"large"==this.size?$(this.wrapper).addClass("modal-lg"):"extra-large"==this.size&&$(this.wrapper).addClass("modal-xl"),this.make_head(),this.modal_body=this.$wrapper.find(".modal-body"),this.$body=$("<div></div>").appendTo(this.modal_body),this.body=this.$body.get(0),this.$message=$('<div class="hide modal-message"></div>').appendTo(this.modal_body),this.header=this.$wrapper.find(".modal-header"),this.footer=this.$wrapper.find(".modal-footer"),this.standard_actions=this.footer.find(".standard-actions"),this.custom_actions=this.footer.find(".custom-actions"),this.set_indicator(),super.make(),this.refresh_section_collapse(),this.action=this.action||{primary:{},secondary:{}},(this.primary_action||this.action.primary&&this.action.primary.onsubmit)&&this.set_primary_action(this.primary_action_label||this.action.primary.label||__("Submit"),this.primary_action||this.action.primary.onsubmit),this.secondary_action&&this.set_secondary_action(this.secondary_action),(this.secondary_action_label||this.action.secondary&&this.action.secondary.label)&&this.set_secondary_action_label(this.secondary_action_label||this.action.secondary.label),this.minimizable&&(this.header.find(".title-section").click(function(){return e.is_minimized&&e.toggle_minimize()}),this.get_minimize_btn().removeClass("hide").on("click",function(){return e.toggle_minimize()}));var t=this;this.$wrapper.on("hide.bs.modal",function(){t.display=!1,t.is_minimized=!1,t.hide_scrollbar(!1),frappe.ui.open_dialogs[frappe.ui.open_dialogs.length-1]===t&&(frappe.ui.open_dialogs.pop(),frappe.ui.open_dialogs.length?window.cur_dialog=frappe.ui.open_dialogs[frappe.ui.open_dialogs.length-1]:window.cur_dialog=null),t.onhide&&t.onhide(),t.on_hide&&t.on_hide()}).on("shown.bs.modal",function(){t.display=!0,window.cur_dialog=t,frappe.ui.open_dialogs.push(t),t.focus_on_first_input(),t.hide_scrollbar(!0),t.on_page_show&&t.on_page_show(),$(document).trigger("frappe.ui.Dialog:shown"),$(document).off("focusin.modal")}).on("scroll",function(){var e=$("input:focus");e.length&&["Date","Datetime","Time"].includes(e.attr("data-fieldtype"))&&e.blur()})}get_primary_btn(){return this.standard_actions.find(".btn-primary")}get_minimize_btn(){return this.$wrapper.find(".modal-header .btn-modal-minimize")}set_message(e){this.$message.removeClass("hide"),this.$body.addClass("hide"),this.$message.text(e)}clear_message(){this.$message.addClass("hide"),this.$body.removeClass("hide")}clear(){super.clear(),this.clear_message()}set_primary_action(e,t){this.footer.removeClass("hide"),this.has_primary_action=!0;var n=this;return this.get_primary_btn().removeClass("hide").html(e).click(function(){n.primary_action_fulfilled=!0;var e=n.get_values();e&&t&&t.apply(n,[e])})}set_secondary_action(e){this.footer.removeClass("hide"),this.get_secondary_btn().removeClass("hide").off("click").on("click",e)}set_secondary_action_label(e){this.get_secondary_btn().removeClass("hide").html(e)}disable_primary_action(){this.get_primary_btn().addClass("disabled")}enable_primary_action(){this.get_primary_btn().removeClass("disabled")}make_head(){this.set_title(this.title)}set_title(e){this.$wrapper.find(".modal-title").html(e)}set_indicator(){this.indicator&&this.header.find(".indicator").removeClass().addClass("indicator "+this.indicator)}show(){return this.animate?this.$wrapper.addClass("fade"):this.$wrapper.removeClass("fade"),this.$wrapper.modal("show"),this.$wrapper.removeClass("modal-minimize"),this.minimizable&&this.is_minimized&&($(".modal-backdrop").toggle(),this.is_minimized=!1),this.clear_message(),this.primary_action_fulfilled=!1,this.is_visible=!0,this}hide(){this.$wrapper.modal("hide"),this.is_visible=!1}get_close_btn(){return this.$wrapper.find(".btn-modal-close")}get_secondary_btn(){return this.standard_actions.find(".btn-modal-secondary")}no_cancel(){this.get_close_btn().toggle(!1)}cancel(){this.get_close_btn().trigger("click")}toggle_minimize(){$(".modal-backdrop").toggle();var e=this.$wrapper.closest(".modal").toggleClass("modal-minimize");e.attr("tabindex")?e.removeAttr("tabindex"):e.attr("tabindex",-1),this.is_minimized=!this.is_minimized;var t=this.is_minimized?"expand":"collapse";this.get_minimize_btn().html(frappe.utils.icon(t)),this.on_minimize_toggle&&this.on_minimize_toggle(this.is_minimized),this.header.find(".modal-title").toggleClass("cursor-pointer"),this.hide_scrollbar(!this.is_minimized)}hide_scrollbar(e){$("body").css("overflow",e?"hidden":"auto")}add_custom_action(e,t,n){void 0===n&&(n=null),this.footer.removeClass("hide");var r=$('\n\t\t\t<button class="btn btn-secondary btn-sm '+(n||"")+'">\n\t\t\t\t'+e+"\n\t\t\t</button>\n\t\t");this.custom_actions.append(r),t&&r.click(t)}},frappe.ui.hide_open_dialog=function(){window.cur_dialog&&(cur_dialog.minimizable?cur_dialog.is_minimized||cur_dialog.toggle_minimize():cur_dialog.hide())},frappe.provide("frappe.messages"),frappe.messages.waiting=function(e,t){return $(frappe.messages.get_waiting_message(t)).appendTo(e)},frappe.messages.get_waiting_message=function(e){return repl('<div class="msg-box" style="width: 63%; margin: 30px auto;">\t\t<p class="text-center">%(msg)s</p></div>',{msg:e})},frappe.throw=function(e){throw"string"==typeof e&&(e={message:e,title:__("Error")}),e.indicator||(e.indicator="red"),frappe.msgprint(e),new Error(e.message)},frappe.confirm=function(e,t,n){var r=new frappe.ui.Dialog({title:__("Confirm"),primary_action_label:__("Yes"),primary_action:function(){t&&t(),r.hide()},secondary_action_label:__("No"),secondary_action:function(){return r.hide()}});return r.$body.append('<p class="frappe-confirm-message">'+e+"</p>"),r.show(),r.confirm_dialog=!0,n&&(r.onhide=function(){r.primary_action_fulfilled||n()}),r},frappe.warn=function(e,t,n,r,i){var a=new frappe.ui.Dialog({title:e,indicator:"red",primary_action_label:r,primary_action:function(){n&&n(),a.hide()},secondary_action_label:__("Cancel"),secondary_action:function(){return a.hide()},minimizable:i});return a.$body.append('<div class="frappe-confirm-message">'+t+"</div>"),a.standard_actions.find(".btn-primary").removeClass("btn-primary").addClass("btn-danger"),a.standard_actions.find(".btn-primary").removeClass("btn-primary").addClass("btn-danger"),a.show(),a},frappe.prompt=function(e,t,n,r){"string"==typeof e&&(e=[{label:e,fieldname:"value",fieldtype:"Data",reqd:1}]),$.isArray(e)||(e=[e]);var i=new frappe.ui.Dialog({fields:e,title:n||__("Enter Value")});return i.set_primary_action(r||__("Submit"),function(){var e=i.get_values();e&&(i.hide(),t(e))}),i.show(),i},frappe.msgprint=function(e,t,n){if(e){if($.isPlainObject(e))var r=e;else if("string"==typeof e&&"{"===e.substr(0,1))r=JSON.parse(e);else r={message:e,title:t};if(r.indicator||(r.indicator="blue"),r.as_list){var i=r.message.map(function(e){return"<li>"+e+"</li>"}).join("");r.message='<ul style="padding-left: 20px">'+i+"</ul>"}if(r.as_table){var a=r.message.map(function(e){return"<tr>"+e.map(function(e){return"<td>"+e+"</td>"}).join("")+"</tr>"}).join("");r.message='<table class="table table-bordered" style="margin: 0;">'+a+"</table>"}if(r.message instanceof Array)r.message.forEach(function(e){frappe.msgprint(e)});else{if(!r.alert){if(frappe.msg_dialog||(frappe.msg_dialog=new frappe.ui.Dialog({title:__("Message"),onhide:function(){frappe.msg_dialog.custom_onhide&&frappe.msg_dialog.custom_onhide(),frappe.msg_dialog.msg_area.empty()},minimizable:r.is_minimizable||n}),frappe.msg_dialog.msg_area=$('<div class="msgprint">').appendTo(frappe.msg_dialog.body),frappe.msg_dialog.clear=function(){frappe.msg_dialog.msg_area.empty()},frappe.msg_dialog.indicator=frappe.msg_dialog.header.find(".indicator")),r.primary_action){if(r.primary_action.server_action&&"string"==typeof r.primary_action.server_action&&(r.primary_action.action=function(){frappe.call({method:r.primary_action.server_action,args:{args:r.primary_action.args},callback:function(){r.primary_action.hide_on_success&&frappe.hide_msgprint()}})}),r.primary_action.client_action&&"string"==typeof r.primary_action.client_action){for(var o=r.primary_action.client_action.split("."),s=window,l=0,c=o;l<c.length;l+=1){var d=c[l];s=s[d]}r.primary_action.action=function(){"function"==typeof s&&s(r.primary_action.args)}}frappe.msg_dialog.set_primary_action(__(r.primary_action.label||r.primary_action_label||"Done"),r.primary_action.action)}else frappe.msg_dialog.has_primary_action&&(frappe.msg_dialog.get_primary_btn().addClass("hide"),frappe.msg_dialog.has_primary_action=!1);r.secondary_action&&(frappe.msg_dialog.set_secondary_action(r.secondary_action.action),frappe.msg_dialog.set_secondary_action_label(__(r.secondary_action.label||"Close"))),null==r.message&&(r.message=""),-1==r.message.search(/<br>|<p>|<li>/)&&(e=frappe.utils.replace_newlines(r.message));var u=!1;return r.clear?frappe.msg_dialog.msg_area.empty():u=frappe.msg_dialog.msg_area.html(),!r.title&&u||frappe.msg_dialog.set_title(r.title||__("Message")),r.indicator?frappe.msg_dialog.indicator.removeClass().addClass("indicator "+r.indicator):frappe.msg_dialog.indicator.removeClass().addClass("hidden"),r.wide?frappe.msg_dialog.wrapper.classList.contains("msgprint-dialog")&&frappe.msg_dialog.wrapper.classList.remove("msgprint-dialog"):frappe.msg_dialog.wrapper.classList.add("msgprint-dialog"),u&&frappe.msg_dialog.msg_area.append("<hr>"),frappe.msg_dialog.msg_area.append(r.message),frappe.msg_dialog.$wrapper.css("z-index",2e3),frappe.msg_dialog.show(),frappe.msg_dialog}frappe.show_alert(r)}}},window.msgprint=frappe.msgprint,frappe.hide_msgprint=function(e){frappe.msg_dialog&&frappe.msg_dialog.msg_area&&frappe.msg_dialog.msg_area.empty(),frappe.msg_dialog&&frappe.msg_dialog.$wrapper.is(":visible")&&(e&&frappe.msg_dialog.$wrapper.removeClass("fade"),frappe.msg_dialog.hide(),e&&frappe.msg_dialog.$wrapper.addClass("fade"))},frappe.update_msgprint=function(e){!frappe.msg_dialog||frappe.msg_dialog&&!frappe.msg_dialog.$wrapper.is(":visible")?frappe.msgprint(e):frappe.msg_dialog.msg_area.html(e)},frappe.verify_password=function(e){frappe.prompt({fieldname:"password",label:__("Enter your password"),fieldtype:"Password",reqd:1},function(t){frappe.call({method:"frappe.core.doctype.user.user.verify_password",args:{password:t.password},callback:function(t){t.exc||e()}})},__("Verify Password"),__("Verify"))},frappe.show_progress=function(e,t,n,r,i){var a;return void 0===n&&(n=100),void 0===i&&(i=!1),frappe.cur_progress&&frappe.cur_progress.title===e&&frappe.cur_progress.is_visible?a=frappe.cur_progress:((a=new frappe.ui.Dialog({title:e})).progress=$('<div>\n\t\t\t<div class="progress">\n\t\t\t\t<div class="progress-bar"></div>\n\t\t\t</div>\n\t\t\t<p class="description text-muted small"></p>\n\t\t</div').appendTo(a.body),a.progress_bar=a.progress.css({"margin-top":"10px"}).find(".progress-bar"),a.$wrapper.removeClass("fade"),a.show(),frappe.cur_progress=a),r&&a.progress.find(".description").text(r),a.percent=cint(100*flt(t)/n),a.progress_bar.css({width:a.percent+"%"}),i&&100===a.percent&&setTimeout(frappe.hide_progress,500),a},frappe.hide_progress=function(){frappe.cur_progress&&(frappe.cur_progress.hide(),frappe.cur_progress=null)},frappe.show_alert=function(e,t,n){void 0===t&&(t=7),void 0===n&&(n={});var r;"string"==typeof e&&(e={message:e}),$("#dialog-container").length||$('<div id="dialog-container"><div id="alert-container"></div></div>').appendTo("body"),r=e.indicator?{orange:"solid-warning",yellow:"solid-warning",blue:"solid-success",green:"solid-success",red:"solid-error"}[e.indicator.toLowerCase()]||"solid-"+e.indicator:"solid-info";var i=$('\n\t\t<div class="alert desk-alert">\n\t\t\t<div class="alert-message-container">\n\t\t\t\t<div class="alert-title-container">\n\t\t\t\t\t<div>'+frappe.utils.icon(r,"lg")+'</div>\n\t\t\t\t\t<div class="alert-message">'+e.message+'</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="alert-subtitle">'+(e.subtitle||"")+'</div>\n\t\t\t</div>\n\t\t\t<div class="alert-body" style="display: none"></div>\n\t\t\t<a class="close">'+frappe.utils.icon("close-alt")+"</a>\n\t\t</div>");return i.hide().appendTo("#alert-container").show(),e.body&&i.find(".alert-body").show().html(e.body),i.find(".close, button").click(function(){return i.addClass("out"),setTimeout(function(){return i.remove()},800),!1}),Object.keys(n).map(function(e){i.find("[data-action="+e+"]").on("click",n[e])}),t>2&&(t-=.8),setTimeout(function(){return i.addClass("out"),setTimeout(function(){return i.remove()},800),!1},1e3*t),i},Object.defineProperty(window,"show_alert",{get:function(){return console.warn("Please use `frappe.show_alert` instead of `show_alert`. It will be deprecated soon."),frappe.show_alert}}),frappe.provide("frappe.ui.keys");var shortcut_groups=new WeakMap,shortcut_group_list=[];frappe.ui.keys.shortcut_groups=shortcut_groups,frappe.ui.keys.get_shortcut_group=function(e){return shortcut_groups.has(e)||shortcut_groups.set(e,new frappe.ui.keys.AltShortcutGroup),shortcut_groups.get(e)};var listener_added=!1,$current_dropdown=null,$body=$(document.body);function get_shortcut_for_key(e){var t=shortcut_group_list.filter(function(t){return e in t.shortcuts_dict}).map(function(t){return t.shortcuts_dict[e]}).filter(function(e){return e.$target.is(":visible")}),n=null;return $current_dropdown&&$current_dropdown.is(".open")&&(n=t.find(function(e){return $.contains($current_dropdown[0],e.$target[0])})),n||(n=t.find(function(e){return $.contains(window.cur_page.page.page.wrapper[0],e.$target[0])}))}frappe.ui.keys.bind_shortcut_group_event=function(){function e(){$current_dropdown?($current_dropdown.addClass("alt-pressed"),$body.removeClass("alt-pressed")):($body.addClass("alt-pressed"),$current_dropdown&&$current_dropdown.removeClass("alt-pressed"))}function t(){$current_dropdown&&$current_dropdown.removeClass("alt-pressed"),$body.removeClass("alt-pressed")}listener_added||(listener_added=!0,$(document).on("keydown",function(t){var n=(frappe.ui.keys.key_map[t.which]||"").toLowerCase();if("alt"===n&&e(),!(t.shiftKey||t.ctrlKey||t.metaKey)&&n&&t.altKey){var r=get_shortcut_for_key(n);r&&(t.preventDefault(),r.$target[0].click()),e()}}),$(document).on("keyup",function(e){"Alt"===e.key&&t()}),$(document).on("mousemove",function(){t()}))},frappe.ui.keys.AltShortcutGroup=class{constructor(){this.shortcuts_dict={},$current_dropdown=null,this.bind_events(),frappe.ui.keys.bind_shortcut_group_event(),shortcut_group_list.push(this)}bind_events(){$(document).on("show.bs.dropdown",function(e){$current_dropdown&&$current_dropdown.removeClass("alt-pressed");var t=$(e.target);t.is(".dropdown, .btn-group")&&($current_dropdown=t)}),$(document).on("hide.bs.dropdown",function(){$current_dropdown&&$current_dropdown.removeClass("alt-pressed"),$current_dropdown=null})}add(e,t){var n=this;t||(t=e);var r=t.text().trim(),i=r.split("").find(function(e){var t=(e=e.toLowerCase())>="a"&&e<="z";return!n.is_taken(e)&&t});if(i){for(var a in this.shortcuts_dict){var o=this.shortcuts_dict[a];if(o.text===r)return o.$target=e,o.$text_el=t,void this.underline_text(o)}var s={$target:e,$text_el:t,letter:i,text:r};this.shortcuts_dict[i.toLowerCase()]=s,this.underline_text(s)}else t.attr("data-label",r)}underline_text(e){e.$text_el.attr("data-label",e.text);var t=!1,n=e.text.split("").map(function(n){return n!==e.letter||t||(n='<span class="alt-underline">'+n+"</span>",t=!0),n}).join("");n=e.$text_el.html().replace(e.text.trim(),n.trim()),e.$text_el.html(n)}is_taken(e){var t=frappe.ui.keys.standard_shortcuts.filter(function(e){return!e.page}).some(function(t){return t.shortcut==="alt+"+e});return e in this.shortcuts_dict||t}},frappe.provide("frappe.ui.keys.handlers"),frappe.ui.keys.setup=function(){$(window).on("keydown",function(e){var t=frappe.ui.keys.get_key(e);if(frappe.ui.keys.handlers[t]){for(var n=null,r=0,i=frappe.ui.keys.handlers[t].length;r<i;r++){var a=frappe.ui.keys.handlers[t][r].apply(this,[e]);!1===a&&(n=a)}return n}})};var standard_shortcuts=[];function close_grid_and_dialog(){var e=$(".grid-row-open");return e.length?(e.data("grid_row").toggle_view(!1),!1):cur_dialog&&!cur_dialog.no_cancel_flag?(cur_dialog.cancel(),!1):void 0}frappe.ui.keys.standard_shortcuts=standard_shortcuts,frappe.ui.keys.add_shortcut=function(e){void 0===e&&(e={});var t=e.shortcut,n=e.action,r=e.description,i=e.page,a=e.target,o=e.condition,s=e.ignore_inputs;if(void 0===s&&(s=!1),a instanceof jQuery){var l=a;n=function(){l[0].click()}}o||(o=function(){return!0});var c=function(e){if((!$(document.activeElement).is("input, select, textarea, [contenteditable=true]")||s)&&o()&&(!i||i.wrapper.is(":visible"))){var t=n(e);(t||void 0===t)&&e.preventDefault()}};c.page=i,frappe.ui.keys.off(t,i),frappe.ui.keys.on(t,c);var d=standard_shortcuts.findIndex(function(e){return e.shortcut===t}),u={shortcut:t,action:n,description:r,page:i,condition:o};-1===d?standard_shortcuts.push(u):standard_shortcuts[d]=u},frappe.ui.keys.show_keyboard_shortcut_dialog=function(){if(!frappe.ui.keys.is_dialog_shown){var e=standard_shortcuts.filter(function(e){return!e.page}),t=standard_shortcuts.filter(function(e){return e.page&&e.page===window.cur_page.page.page}),n=standard_shortcuts.filter(function(e){return e.page&&e.page===window.cur_page.page.frm}),r=s(e,__("Global Shortcuts")),i=s(t,__("Page Shortcuts")),a=s(n,__("Grid Shortcuts")),o=new frappe.ui.Dialog({title:__("Keyboard Shortcuts"),on_hide:function(){frappe.ui.keys.is_dialog_shown=!1}});o.$body.append(r),o.$body.append(i),o.$body.append(a),o.$body.append('\n\t\t<div class="text-muted">\n\t\t\t'+__("Press Alt Key to trigger additional shortcuts in Menu and Sidebar")+"\n\t\t</div>\n\t"),o.show(),frappe.ui.keys.is_dialog_shown=!0}function s(e,t){if(!e.length)return"";var n=e.filter(function(e){return!e.condition||e.condition()}).map(function(e){var t=e.shortcut.split("+").map(frappe.utils.to_title_case).join("+");return frappe.utils.is_mac()&&(t=t.replace("Ctrl","⌘")),'<tr>\n\t\t\t\t\t<td width="40%"><kbd>'+t+'</kbd></td>\n\t\t\t\t\t<td width="60%">'+(e.description||"")+"</td>\n\t\t\t\t</tr>"}).join("");return n='<h5 style="margin: 0;">'+t+'</h5>\n\t\t\t<table style="margin-top: 10px;" class="table table-bordered">\n\t\t\t\t'+n+"\n\t\t\t</table>"}},frappe.ui.keys.get_key=function(e){var t=e.keyCode||e.which,n=frappe.ui.keys.key_map[t]||String.fromCharCode(t);return(e.ctrlKey||e.metaKey)&&(n="ctrl+"+n),e.shiftKey&&(n="shift+"+n),e.altKey&&(n="alt+"+n),e.altKey&&e.ctrlKey,n.toLowerCase()},frappe.ui.keys.on=function(e,t){frappe.ui.keys.handlers[e]||(frappe.ui.keys.handlers[e]=[]),frappe.ui.keys.handlers[e].push(t)},frappe.ui.keys.off=function(e,t){var n=frappe.ui.keys.handlers[e];n&&0!==n.length&&(frappe.ui.keys.handlers[e]=n.filter(function(e){return!!t&&e.page!==t}))},frappe.ui.keys.add_shortcut({shortcut:"ctrl+s",action:function(e){return frappe.app.trigger_primary_action(),e.preventDefault(),!1},description:__("Trigger Primary Action"),ignore_inputs:!0}),frappe.ui.keys.add_shortcut({shortcut:"ctrl+g",action:function(e){return $("#navbar-search").focus(),e.preventDefault(),!1},description:__("Open Awesomebar")}),frappe.ui.keys.add_shortcut({shortcut:"ctrl+h",action:function(e){e.preventDefault(),$(".navbar-home img").click()},description:__("Navigate Home")}),frappe.ui.keys.add_shortcut({shortcut:"alt+s",action:function(e){e.preventDefault(),$(".dropdown-navbar-user a").eq(0).click()},description:__("Open Settings")}),frappe.ui.keys.add_shortcut({shortcut:"shift+/",action:function(){frappe.ui.keys.show_keyboard_shortcut_dialog()},description:__("Show Keyboard Shortcuts")}),frappe.ui.keys.add_shortcut({shortcut:"alt+h",action:function(e){e.preventDefault(),$(".dropdown-help a").eq(0).click()},description:__("Open Help")}),frappe.ui.keys.on("escape",function(e){close_grid_and_dialog()}),frappe.ui.keys.on("esc",function(e){close_grid_and_dialog()}),frappe.ui.keys.on("enter",function(e){window.cur_dialog&&cur_dialog.confirm_dialog&&cur_dialog.get_primary_btn().trigger("click")}),frappe.ui.keys.on("ctrl+down",function(e){var t=frappe.ui.form.get_open_grid_form();t&&t.toggle_view(!1,function(){t.open_next()})}),frappe.ui.keys.on("ctrl+up",function(e){var t=frappe.ui.form.get_open_grid_form();t&&t.toggle_view(!1,function(){t.open_prev()})}),frappe.ui.keys.add_shortcut({shortcut:"shift+ctrl+r",action:function(){frappe.ui.toolbar.clear_cache()},description:__("Clear Cache and Reload")}),frappe.ui.keys.key_map={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",91:"meta",18:"alt",27:"escape",37:"left",39:"right",38:"up",40:"down",32:"space",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",191:"/",188:"<",190:">"},"abcdefghijklmnopqrstuvwxyz".split("").forEach(function(e,t){frappe.ui.keys.key_map[65+t]=e}),frappe.ui.keyCode={ESCAPE:27,LEFT:37,RIGHT:39,UP:38,DOWN:40,ENTER:13,TAB:9,SPACE:32,BACKSPACE:8},$(document).on("keydown",".dropdown-toggle",function(e){e.which===frappe.ui.keyCode.ESCAPE&&$(e.currentTarget).blur()}),frappe.provide("frappe.ui"),frappe.ui.color={get:function(e,t){return e&&t?this.get_color_shade(e,t):e?this.get_color_shade(e,"default"):frappe.ui.color_map},get_color:function(e){var t=Object.keys(frappe.ui.color_map);if(t.includes(e))return frappe.ui.color_map[e];console.warn("'color_name' can be one of "+t+" and not "+e)},get_color_map:function(){var e=["100","300","500","700"],t=getComputedStyle(document.body),n={};return["red","green","blue","dark-green","yellow","gray","purple","pink","orange"].forEach(function(r){n[r]=e.map(function(e){return t.getPropertyValue("--"+r+"-"+e).trim()})}),n},get_color_shade:function(e,t){var n={default:2,light:1,"extra-light":0,dark:3};if(Object.keys(n).includes(t)){var r=this.get_color(e);return r?r[n[t]]:e}console.warn("'shade' can be one of "+Object.keys(n)+" and not "+t)},all:function(){return Object.values(frappe.ui.color_map).reduce(function(e,t){return e.concat(t)},[])},names:function(){return Object.keys(frappe.ui.color_map)},is_standard:function(e){return!!e&&(e.startsWith("#")?this.all().includes(e):this.names().includes(e))},get_color_name:function(e){for(var t in frappe.ui.color_map){if(frappe.ui.color_map[t].includes(e))return t}},get_contrast_color:function(e){if(this.validate_hex(e)){if(!this.is_standard(e))return this.brightness(e)<128?this.lighten(e,.5):this.lighten(e,-.5);var t=this.get_color_name(e);return this.get_color(t).indexOf(e)<=1?this.get(t,"dark"):this.get(t,"extra-light")}},validate_hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},lighten:function(e,t){var n=parseInt(e.slice(1),16),r=t<0?0:255,i=t<0?-1*t:t,a=n>>16,o=n>>8&255,s=255&n;return"#"+(16777216+65536*(Math.round((r-a)*i)+a)+256*(Math.round((r-o)*i)+o)+(Math.round((r-s)*i)+s)).toString(16).slice(1)},hex_to_rgb:function(e){return e.startsWith("#")&&(e=e.substring(1)),{r:parseInt(e.substring(0,2),16),g:parseInt(e.substring(2,4),16),b:parseInt(e.substring(4,6),16)}},brightness:function(e){var t=this.hex_to_rgb(e);return(299*t.r+587*t.g+114*t.b)/1e3}},frappe.ui.color_map=frappe.ui.color.get_color_map(),frappe.provide("frappe.ui"),frappe.ui.Sidebar=class{constructor(e){var t=e.wrapper,n=e.css_class;this.wrapper=t,this.css_class=n,this.items={},this.make_dom()}make_dom(){this.wrapper.html('\n\t\t\t<div class="'+this.css_class+' overlay-sidebar hidden-xs hidden-sm">\n\t\t\t</div>\n\t\t'),this.$sidebar=this.wrapper.find("."+this.css_class)}add_item(e,t,n){var r,i;if(void 0===n&&(n=!1),r=t||0!==this.wrapper.find(".sidebar-menu").length?this.get_section(t):this.get_section(),e instanceof jQuery)i=$("<li>"),e.appendTo(i);else{var a="<li class="+(n?"h6":"")+">\n\t\t\t\t<a "+(e.href?'href="'+e.href+'"':"")+">"+e.label+"</a>\n\t\t\t</li>";i=$(a).click(function(){return e.on_click&&e.on_click()})}r.append(i),e.name&&(this.items[e.name]=i)}remove_item(e){this.items[e]&&this.items[e].remove()}get_section(e){void 0===e&&(e="");var t=$(this.wrapper.find('[data-section-heading="'+e+'"]'));return t.length?t:(t=$('\n\t\t\t<ul class="list-unstyled sidebar-menu" data-section-heading="'+(e||"default")+'">\n\t\t\t\t'+(e?'<li class="h6">'+e+"</li>":"")+"\n\t\t\t</ul>\n\t\t"),this.$sidebar.append(t),t)}},frappe.ui.LinkPreview=class{constructor(){this.popovers_list=[],this.LINK_CLASSES='a[data-doctype], input[data-fieldtype="Link"], .popover',this.popover_timeout=null,this.setup_events()}setup_events(){var e=this;$(document.body).on("mouseover",this.LINK_CLASSES,function(t){e.link_hovered=!0,e.element=$(t.currentTarget),e.is_link="a"===e.element.get(0).tagName.toLowerCase(),e.element.parents().find(".popover").length||(e.identify_doc(),e.popover=e.element.data("bs.popover"),e.name&&e.doctype&&e.setup_popover_control(t))}),this.handle_popover_hide()}identify_doc(){this.is_link?(this.doctype=this.element.attr("data-doctype"),this.name=this.element.attr("data-name"),this.href=this.element.attr("href")):(this.href=this.element.parents(".control-input-wrapper").find(".control-value a").attr("href"),this.doctype=this.element.attr("data-target"),this.name=this.element.val())}setup_popover_control(e){var t=this;(frappe.boot.link_preview_doctypes||[]).includes(this.doctype)&&(this.element.on("change",function(){t.new_popover=!0}),!this.popover||this.new_popover?this.data_timeout=setTimeout(function(){t.create_popover(e)},100):this.popover_timeout=setTimeout(function(){t.element.is(":focus")||t.show_popover(e)},1e3))}create_popover(e){var t=this;this.new_popover=!1,this.element.is(":focus")||this.get_preview_data().then(function(n){n&&(t.popover_timeout&&clearTimeout(t.popover_timeout),t.popover_timeout=setTimeout(function(){if(t.popover){var r=t.get_popover_html(n);t.popover.options.content=r}else t.init_preview_popover(n);t.show_popover(e)},1e3))})}show_popover(e){var t=this;if(this.default_timeout=setTimeout(function(){t.clear_all_popovers()},1e4),this.is_link)this.element.popover("show");else{var n=e.pageX;this.element.popover("show");var r=$(".popover").width();$(".control-field-popover").css("left",n-r/2+"px")}}handle_popover_hide(){var e=this;$(document).on("mouseout",this.LINK_CLASSES,function(){$(".popover:hover").length||(e.link_hovered=!1),e.link_hovered||(e.data_timeout&&clearTimeout(e.data_timeout),e.popover_timeout&&clearTimeout(e.popover_timeout),e.default_timeout&&clearTimeout(e.default_timeout),e.clear_all_popovers())}),frappe.router.on("change",function(){e.clear_all_popovers()})}clear_all_popovers(){this.popovers_list.forEach(function(e){return e.hide()})}get_preview_data(){return frappe.xcall("frappe.desk.link_preview.get_preview_data",{doctype:this.doctype,docname:this.name})}init_preview_popover(e){var t=this.get_popover_html(e);this.element.popover({container:"body",template:'\n\t\t\t\t<div class="link-preview-popover popover">\n\t\t\t\t\t<div class="arrow"></div>\n\t\t\t\t\t<div class="popover-body popover-content">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t',html:!0,sanitizeFn:function(e){return e},content:t,trigger:"manual",placement:"top"}),$(this.element.data("bs.popover").tip).toggleClass("control-field-popover",this.is_link),this.popovers_list.push(this.element.data("bs.popover"))}get_popover_html(e){return this.href||(this.href=window.location.href),this.href&&this.href.includes(" ")&&(this.href=this.href.replace(new RegExp(" ","g"),"%20")),'\n\t\t\t<div class="preview-popover-header">\n\t\t\t\t<div class="preview-header">\n\t\t\t\t\t'+this.get_image_html(e)+'\n\t\t\t\t\t<div class="preview-name">\n\t\t\t\t\t\t<a href='+this.href+">"+__(e.preview_title)+'</a>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="text-muted preview-title">'+this.get_id_html(e)+'</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<hr>\n\t\t\t<div class="popover-body">\n\t\t\t\t'+this.get_content_html(e)+"\n\t\t\t</div>\n\t\t"}get_id_html(e){var t="";return e.preview_title!==e.name&&(t='<a class="text-muted" href='+this.href+">"+e.name+"</a>"),t}get_image_html(e){return'<div class="preview-image">\n\t\t\t'+frappe.get_avatar("avatar-medium",e.preview_title,e.preview_image)+"\n\t\t</div>"}get_content_html(e){var t="";return Object.keys(e).forEach(function(n){if(!["preview_image","preview_title","name"].includes(n)){var r=frappe.ellipsis(e[n],280);t+='\n\t\t\t\t\t<div class="preview-field">\n\t\t\t\t\t\t<div class="preview-label text-muted">'+__(n)+'</div>\n\t\t\t\t\t\t<div class="preview-value">'+r+"</div>\n\t\t\t\t\t</div>\n\t\t\t\t"}}),'<div class="preview-table">'+t+"</div>"}},frappe.provide("frappe.request"),frappe.provide("frappe.request.error_handlers"),frappe.request.url="/",frappe.request.ajax_count=0,frappe.request.waiting_for_ajax=[],frappe.request.logs={},frappe.xcall=function(e,t){return new Promise(function(n,r){frappe.call({method:e,args:t,callback:function(e){n(e.message)},error:function(e){r(e.message)}})})},frappe.call=function(e){if(!frappe.is_online())return frappe.show_alert({indicator:"orange",message:__("Connection Lost"),subtitle:__("You are not connected to Internet. Retry after sometime.")},3),e.always&&e.always(),$.ajax();"string"==typeof arguments[0]&&(e={method:arguments[0],args:arguments[1],callback:arguments[2],headers:arguments[3]}),e.quiet&&(e.no_spinner=!0);var t=$.extend({},e.args);e.module&&e.page?t.cmd=e.module+".page."+e.page+"."+e.page+"."+e.method:e.doc?$.extend(t,{cmd:"run_doc_method",docs:frappe.get_doc(e.doc.doctype,e.doc.name),method:e.method,args:e.args}):e.method&&(t.cmd=e.method);var n=e.url;if(!n){if(n="/api/method/"+t.cmd,window.cordova){var r=frappe.request.url;n=(r=r.slice(0,r.length-1))+n}delete t.cmd}return e.debounce&&frappe.request.is_fresh(t,e.debounce)?Promise.resolve():frappe.request.call({type:e.type||"POST",args:t,success:function(t,n){if(t.task_id)frappe.socketio.subscribe(t.task_id,e),e.queued&&e.queued(t);else if(e.callback)return e.callback(t,n)},error:e.error,always:e.always,btn:e.btn,freeze:e.freeze,freeze_message:e.freeze_message,headers:e.headers||{},error_handlers:e.error_handlers||{},async:e.async,silent:e.silent,url:n})},frappe.request.call=function(e){frappe.request.prepare(e);var t={200:function(t,n){e.success_callback&&e.success_callback(t,n.responseText)},401:function(e){frappe.app.session_expired_dialog&&frappe.app.session_expired_dialog.display?frappe.app.redirect_to_login():frappe.app.handle_session_expired()},404:function(e){frappe.flags.setting_original_route?frappe.app.redirect_to_login():frappe.msgprint({title:__("Not found"),indicator:"red",message:__("The resource you are looking for is not available")})},403:function(e){if("Guest"===frappe.session.user&&"Guest"!==frappe.session.logged_in_user)frappe.app.handle_session_expired();else if(e.responseJSON&&e.responseJSON._error_message)frappe.msgprint({title:__("Not permitted"),indicator:"red",message:e.responseJSON._error_message}),e.responseJSON._server_messages=null;else if(e.responseJSON&&e.responseJSON._server_messages){if(-1!==JSON.parse(e.responseJSON._server_messages).indexOf(__("Not permitted")))return}else frappe.msgprint({title:__("Not permitted"),indicator:"red",message:__("You do not have enough permissions to access this resource. Please contact your manager to get access.")})},508:function(e){frappe.utils.play_sound("error"),frappe.msgprint({title:__("Please try again"),indicator:"red",message:__("Another transaction is blocking this one. Please try again in a few seconds.")})},413:function(e,t){frappe.msgprint({indicator:"red",title:__("File too big"),message:__("File size exceeded the maximum allowed size of {0} MB",[(frappe.boot.max_file_size||5242880)/1048576])})},417:function(t){var n=t.responseJSON;if(!n)try{n=JSON.parse(t.responseText)}catch(e){n=t.responseText}e.error_callback&&e.error_callback(n)},501:function(t,n){"string"==typeof t&&(t=JSON.parse(t)),e.error_callback&&e.error_callback(t,n.responseText)},500:function(t){frappe.utils.play_sound("error");try{e.error_callback&&e.error_callback(),frappe.request.report_error(t,e)}catch(n){frappe.request.report_error(t,e)}},504:function(t){frappe.msgprint(__("Request Timed Out")),e.error_callback&&e.error_callback()},502:function(e){frappe.msgprint(__("Internal Server Error"))}},n={QueryTimeoutError:function(){frappe.utils.play_sound("error"),frappe.msgprint({title:__("Request Timeout"),indicator:"red",message:__("Server was too busy to process this request. Please try again.")})},QueryDeadlockError:function(){frappe.utils.play_sound("error"),frappe.msgprint({title:__("Deadlock Occurred"),indicator:"red",message:__("Server was too busy to process this request. Please try again.")})}},r={url:e.url||frappe.request.url,data:e.args,type:e.type,dataType:e.dataType||"json",async:e.async,headers:Object.assign({"X-Frappe-CSRF-Token":frappe.csrf_token,Accept:"application/json","X-Frappe-CMD":e.args&&e.args.cmd||""},e.headers),cache:!1};return e.args&&e.args.doctype&&(r.headers["X-Frappe-Doctype"]=encodeURIComponent(e.args.doctype)),frappe.last_request=r.data,$.ajax(r).done(function(e,n,r){try{"string"==typeof e&&(e=JSON.parse(e)),(e.docs||e.docinfo)&&frappe.model.sync(e),e.__messages&&$.extend(frappe._messages,e.__messages);var i=t[r.statusCode().status];i&&i(e,r)}catch(t){console.log("Unable to handle success response",e),console.trace(t)}}).always(function(t,n,r){try{if("string"==typeof t&&(t=JSON.parse(t)),t.responseText){t=JSON.parse(t.responseText)}}catch(e){t=null}frappe.request.cleanup(e,t),e.always&&e.always(t)}).fail(function(r,i){try{if(r.responseText){var a=JSON.parse(r.responseText);if(a.exception){var o=a.exception.split(".").at(-1),s=n[o];if(s)return void s(a)}}var l=t[r.statusCode().status];if(l)return void l(r);e.error_callback&&e.error_callback(r)}catch(e){console.log("Unable to handle failed response"),console.trace(e)}})},frappe.request.is_fresh=function(e,t){frappe.request.logs[e.cmd]||(frappe.request.logs[e.cmd]=[]);for(var n=0,r=frappe.request.logs[e.cmd];n<r.length;n+=1){var i=r[n];if(new Date-i.timestamp<t&&frappe.utils.deep_equal(e,i.args))return console.log("throttled"),!0}return frappe.request.logs[e.cmd].push({args:e,timestamp:new Date}),!1},frappe.request.prepare=function(e){for(var t in $("body").attr("data-ajax-state","triggered"),e.btn&&$(e.btn).prop("disabled",!0),e.freeze&&frappe.dom.freeze(e.freeze_message),e.args)e.args[t]&&($.isPlainObject(e.args[t])||$.isArray(e.args[t]))&&(e.args[t]=JSON.stringify(e.args[t]));if(!e.args.cmd&&!e.url)throw console.log(e),"Incomplete Request";e.success_callback=e.success,e.error_callback=e.error,delete e.success,delete e.error},frappe.request.cleanup=function(e,t){if(e.btn&&$(e.btn).prop("disabled",!1),$("body").attr("data-ajax-state","complete"),e.freeze&&frappe.dom.unfreeze(),t){if(t.session_expired||"Guest"===frappe.session.user&&"Guest"!==frappe.session.logged_in_user)return void frappe.app.handle_session_expired();var n=frappe.request.error_handlers[t.exc_type]||[],r=e.error_handlers?e.error_handlers[t.exc_type]:null,i=[].concat(n,r).filter(Boolean);t.exc_type&&i.forEach(function(e){e(t)}),t._server_messages&&!e.silent&&0===i.length&&(t._server_messages=JSON.parse(t._server_messages),frappe.hide_msgprint(),frappe.msgprint(t._server_messages)),t.exc&&(t.exc=JSON.parse(t.exc),t.exc instanceof Array?$.each(t.exc,function(e,t){t&&console.log(t)}):console.log(t.exc)),t._debug_messages&&(e.args&&(console.log("======== arguments ========"),console.log(e.args),console.log("========")),$.each(JSON.parse(t._debug_messages),function(e,t){console.log(t)}),console.log("======== response ========"),delete t._debug_messages,console.log(t),console.log("========"))}frappe.last_response=t},frappe.after_server_call=function(){return frappe.request.ajax_count?new Promise(function(e){frappe.request.waiting_for_ajax.push(function(){e()})}):null},frappe.after_ajax=function(e){return new Promise(function(t){if(frappe.request.ajax_count)frappe.request.waiting_for_ajax.push(function(){if(e)return t(e());t()});else{if(e)return t(e());t()}})},frappe.request.report_error=function(e,t){var n,r=JSON.parse(e.responseText);if(r.exc){try{n=(JSON.parse(r.exc)||[]).join("\n")}catch(e){n=r.exc}delete r.exc}else n="";if(n){var i=frappe.boot.error_report_email;t=frappe.request.cleanup_request_opts(t),frappe.error_dialog||(frappe.error_dialog=new frappe.ui.Dialog({title:__("Server Error"),primary_action_label:__("Report"),primary_action:function(){var e;i?(e=["<h5>Please type some additional information that could help us reproduce this issue:</h5>",'<div style="min-height: 100px; border: 1px solid #bbb; \t\t\t\tborder-radius: 5px; padding: 15px; margin-bottom: 15px;"></div>',"<hr>","<h5>App Versions</h5>","<pre>"+JSON.stringify(frappe.boot.versions,null,"\t")+"</pre>","<h5>Route</h5>","<pre>"+frappe.get_route_str()+"</pre>","<hr>","<h5>Error Report</h5>","<pre>"+n+"</pre>","<hr>","<h5>Request Data</h5>","<pre>"+JSON.stringify(t,null,"\t")+"</pre>","<hr>","<h5>Response JSON</h5>","<pre>"+JSON.stringify(r,null,"\t")+"</pre>"].join("\n"),new frappe.views.CommunicationComposer({subject:"Error Report ["+frappe.datetime.nowdate()+"]",recipients:i,message:e,doc:{doctype:"User",name:frappe.session.user}}).dialog.$wrapper.css("z-index",cint(frappe.msg_dialog.$wrapper.css("z-index"))+1)):frappe.msgprint(__("Support Email Address Not Specified")),frappe.error_dialog.hide()},secondary_action_label:__("Copy error to clipboard"),secondary_action:function(){var e,i;i=["### App Versions",(e=function(e){return"```\n"+e+"\n```"})(JSON.stringify(frappe.boot.versions,null,"\t")),"### Route",e(frappe.get_route_str()),"### Trackeback",e(n),"### Request Data",e(JSON.stringify(t,null,"\t")),"### Response Data",e(JSON.stringify(r,null,"\t"))].join("\n"),frappe.utils.copy_to_clipboard(i),frappe.error_dialog.hide()}}),frappe.error_dialog.wrapper.classList.add("msgprint-dialog"));var a=strip(n).split("\n");frappe.error_dialog.$body.html(a[a.length-1]),frappe.error_dialog.show()}},frappe.request.cleanup_request_opts=function(e){var t=(e.args||{}).doc;return t&&(t=JSON.parse(t),$.each(Object.keys(t),function(e,n){-1!==n.indexOf("password")&&t[n]&&(t[n]="*****")}),e.args.doc=JSON.stringify(t)),e},frappe.request.on_error=function(e,t){frappe.request.error_handlers[e]=frappe.request.error_handlers[e]||[],frappe.request.error_handlers[e].push(t)},$(document).ajaxSend(function(){frappe.request.ajax_count++}),$(document).ajaxComplete(function(){frappe.request.ajax_count--,frappe.request.ajax_count||($.each(frappe.request.waiting_for_ajax||[],function(e,t){t()}),frappe.request.waiting_for_ajax=[])}),frappe.socketio={open_tasks:{},open_docs:[],emit_queue:[],init:function(port){void 0===port&&(port=3e3),window.io&&(frappe.boot.disable_async||frappe.socketio.socket||("https:"==window.location.protocol?frappe.socketio.socket=io.connect(frappe.socketio.get_host(port),{secure:!0}):"http:"==window.location.protocol?frappe.socketio.socket=io.connect(frappe.socketio.get_host(port)):"file:"==window.location.protocol&&(frappe.socketio.socket=io.connect(window.localStorage.server)),frappe.socketio.socket?(frappe.socketio.socket.on("msgprint",function(e){frappe.msgprint(e)}),frappe.socketio.socket.on("eval_js",function(message){eval(message)}),frappe.socketio.socket.on("progress",function(e){e.progress&&(e.percent=flt(e.progress[0])/e.progress[1]*100),e.percent&&(100==e.percent?frappe.hide_progress():frappe.show_progress(e.title||__("Progress"),e.percent,100,e.description))}),frappe.socketio.setup_listeners(),frappe.socketio.setup_reconnect(),$(document).on("form-load form-rename",function(e,t){if(!t.is_new()){for(var n=0,r=frappe.socketio.open_docs.length;n<r;n++){var i=frappe.socketio.open_docs[n];if(t.doctype==i.doctype&&t.docname==i.name)return!1}frappe.socketio.doc_subscribe(t.doctype,t.docname)}}),$(document).on("form-refresh",function(e,t){t.is_new()||frappe.socketio.doc_open(t.doctype,t.docname)}),$(document).on("form-unload",function(e,t){t.is_new()||frappe.socketio.doc_close(t.doctype,t.docname)}),$(document).on("form-typing",function(e,t){frappe.socketio.form_typing(t.doctype,t.docname)}),$(document).on("form-stopped-typing",function(e,t){frappe.socketio.form_stopped_typing(t.doctype,t.docname)}),window.addEventListener("beforeunload",function(){cur_frm&&!cur_frm.is_new()&&cur_frm.doc&&frappe.socketio.doc_close(cur_frm.doctype,cur_frm.docname)})):console.log("Unable to connect to "+frappe.socketio.get_host(port))))},get_host:function(e){void 0===e&&(e=3e3);var t=window.location.origin;if(window.dev_server){var n=t.split(":");e=frappe.boot.socketio_port||e.toString()||"3000",n.length>2&&(t=n[0]+":"+n[1]),t=t+":"+e}return t},subscribe:function(e,t){frappe.socketio.socket.emit("task_subscribe",e),frappe.socketio.socket.emit("progress_subscribe",e),frappe.socketio.open_tasks[e]=t},task_subscribe:function(e){frappe.socketio.socket.emit("task_subscribe",e)},task_unsubscribe:function(e){frappe.socketio.socket.emit("task_unsubscribe",e)},doc_subscribe:function(e,t){frappe.flags.doc_subscribe?console.log("throttled"):(frappe.flags.doc_subscribe=!0,setTimeout(function(){frappe.flags.doc_subscribe=!1},1e3),frappe.socketio.socket.emit("doc_subscribe",e,t),frappe.socketio.open_docs.push({doctype:e,docname:t}))},doc_unsubscribe:function(e,t){frappe.socketio.socket.emit("doc_unsubscribe",e,t),frappe.socketio.open_docs=$.filter(frappe.socketio.open_docs,function(n){return n.doctype===e&&n.name===t?null:n})},doc_open:function(e,t){frappe.socketio.last_doc&&frappe.socketio.last_doc[0]==e&&frappe.socketio.last_doc[1]==t||(frappe.socketio.socket.emit("doc_open",e,t),frappe.socketio.last_doc&&frappe.socketio.doc_close(frappe.socketio.last_doc[0],frappe.socketio.last_doc[1])),frappe.socketio.last_doc=[e,t]},doc_close:function(e,t){frappe.socketio.socket.emit("doc_close",e,t),frappe.socketio.socket.emit("doc_typing_stopped",e,t)},form_typing:function(e,t){frappe.socketio.socket.emit("doc_typing",e,t)},form_stopped_typing:function(e,t){frappe.socketio.socket.emit("doc_typing_stopped",e,t)},setup_listeners:function(){frappe.socketio.socket.on("task_status_change",function(e){frappe.socketio.process_response(e,e.status.toLowerCase())}),frappe.socketio.socket.on("task_progress",function(e){frappe.socketio.process_response(e,"progress")})},setup_reconnect:function(){frappe.socketio.socket.on("connect",function(){setTimeout(function(){$.each(frappe.socketio.open_tasks,function(e,t){frappe.socketio.subscribe(e,t)}),$.each(frappe.socketio.open_docs,function(e){locals[e.doctype]&&locals[e.doctype][e.name]&&frappe.socketio.doc_subscribe(e.doctype,e.name)}),cur_frm&&cur_frm.doc&&frappe.socketio.doc_open(cur_frm.doc.doctype,cur_frm.doc.name)},5e3)})},process_response:function(e,t){if(e){var n=frappe.socketio.open_tasks[e.task_id];n[t]&&n[t](e),"success"===t&&n.callback&&n.callback(e),frappe.request.cleanup(n,e),n.always&&n.always(e),e.status_code&&e.status_code>400&&n.error&&n.error(e)}}},frappe.provide("frappe.realtime"),frappe.realtime.on=function(e,t){frappe.socketio.socket&&frappe.socketio.socket.on(e,t)},frappe.realtime.off=function(e,t){frappe.socketio.socket&&frappe.socketio.socket.off(e,t)},frappe.realtime.publish=function(e,t){frappe.socketio.socket&&frappe.socketio.socket.emit(e,t)};var isArray=Array.isArray,keyList=Object.keys,hasProp=Object.prototype.hasOwnProperty,fastDeepEqual=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){var r,i,a,o=isArray(t),s=isArray(n);if(o&&s){if((i=t.length)!=n.length)return!1;for(r=i;0!=r--;)if(!e(t[r],n[r]))return!1;return!0}if(o!=s)return!1;var l=t instanceof Date,c=n instanceof Date;if(l!=c)return!1;if(l&&c)return t.getTime()==n.getTime();var d=t instanceof RegExp,u=n instanceof RegExp;if(d!=u)return!1;if(d&&u)return t.toString()==n.toString();var p=keyList(t);if((i=p.length)!==keyList(n).length)return!1;for(r=i;0!=r--;)if(!hasProp.call(n,p[r]))return!1;for(r=i;0!=r--;)if(!e(t[a=p[r]],n[a]))return!1;return!0}return t!=t&&n!=n};frappe.provide("frappe.utils"),Array.prototype.uniqBy||(Object.defineProperty(Array.prototype,"uniqBy",{value:function(e){var t={};return this.filter(function(n){var r=e(n);return!(r in t)&&(t[r]=!0)})}}),Object.defineProperty(Array.prototype,"move",{value:function(e,t){this.splice(t,0,this.splice(e,1)[0])}})),Object.defineProperty(Object.prototype,"setDefault",{value:function(e,t){return e in this||(this[e]=t),this[e]},writable:!0}),String.prototype.plural=function(e){var t,n,r,i,a,o={move:"moves",foot:"feet",goose:"geese",sex:"sexes",child:"children",man:"men",tooth:"teeth",person:"people"};if(["sheep","fish","deer","moose","series","species","money","rice","information","equipment"].indexOf(this.toLowerCase())>=0)return this;for(t in o)if(e?(n=new RegExp(o[t]+"$","i"),r=t):(n=new RegExp(t+"$","i"),r=o[t]),n.test(this))return this.replace(n,r);for(a in i=e?{"(quiz)zes$":"$1","(matr)ices$":"$1ix","(vert|ind)ices$":"$1ex","^(ox)en$":"$1","(alias)es$":"$1","(octop|vir)i$":"$1us","(cris|ax|test)es$":"$1is","(shoe)s$":"$1","(o)es$":"$1","(bus)es$":"$1","([m|l])ice$":"$1ouse","(x|ch|ss|sh)es$":"$1","(m)ovies$":"$1ovie","(s)eries$":"$1eries","([^aeiouy]|qu)ies$":"$1y","([lr])ves$":"$1f","(tive)s$":"$1","(hive)s$":"$1","(li|wi|kni)ves$":"$1fe","(shea|loa|lea|thie)ves$":"$1f","(^analy)ses$":"$1sis","((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$":"$1$2sis","([ti])a$":"$1um","(n)ews$":"$1ews","(h|bl)ouses$":"$1ouse","(corpse)s$":"$1","(us)es$":"$1",s$:""}:{"(quiz)$":"$1zes","^(ox)$":"$1en","([m|l])ouse$":"$1ice","(matr|vert|ind)ix|ex$":"$1ices","(x|ch|ss|sh)$":"$1es","([^aeiouy]|qu)y$":"$1ies","(hive)$":"$1s","(?:([^f])fe|([lr])f)$":"$1$2ves","(shea|lea|loa|thie)f$":"$1ves",sis$:"ses","([ti])um$":"$1a","(tomat|potat|ech|her|vet)o$":"$1oes","(bu)s$":"$1ses","(alias)$":"$1es","(octop)us$":"$1i","(ax|test)is$":"$1es","(us)$":"$1es","([^s]+)$":"$1s"})if((n=new RegExp(a,"i")).test(this))return this.replace(n,i[a]);return this},Object.assign(frappe.utils,{get_random:function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",r=0;r<e;r++)t+=n.charAt(Math.floor(Math.random()*n.length));return t},get_file_link:function(e){return e=cstr(e),frappe.utils.is_url(e)?e:-1===e.indexOf("/")?"files/"+e:e},replace_newlines:function(e){return e?e.replace(/\n/g,"<br>"):""},is_html:function(e){return!!e&&!(-1==e.indexOf("<br>")&&-1==e.indexOf("<p")&&-1==e.indexOf("<img")&&-1==e.indexOf("<div")&&!e.includes("<span"))},is_mac:function(){return"MacIntel"===window.navigator.platform},is_xs:function(){return $(document).width()<768},is_sm:function(){return $(document).width()<991&&$(document).width()>=768},is_md:function(){return $(document).width()<1199&&$(document).width()>=991},is_json:function(e){try{JSON.parse(e)}catch(e){return!1}return!0},strip_whitespace:function(e){return(e||"").replace(/<p>\s*<\/p>/g,"").replace(/<br>(\s*<br>\s*)+/g,"<br><br>")},encode_tags:function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;"};return e.replace(/[&<>]/g,function(e){return t[e]||e})},strip_original_content:function(e){var t=[],n=[],r=-1===e.indexOf("<br>")?"\n":"<br>";return $.each(e.split(r),function(e,r){var i=strip(r);!i||">"!==i.substr(0,1)&&"&gt;"!==i.substr(0,4)?(t.push(r),n=[]):n.push(r)}),t.join(r)},escape_html:function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(e).replace(/[&<>"'`=\/]/g,function(e){return t[e]})},html2text:function(e){var t=document.createElement("div");return t.innerHTML=e,t.textContent},is_url:function(e){return"http://"==e.toLowerCase().substr(0,7)||"https://"==e.toLowerCase().substr(0,8)},to_title_case:function(e,t){void 0===t&&(t=!1);var n=t?" ":"";return e.toLowerCase().replace(/(?:^|[\s-\/])\w/g,function(e){return e.toUpperCase()}).replace(/-|_/g,n)},toggle_blockquote:function(e){if(!e)return e;var t=$("<div></div>").html(e);return t.find("blockquote").parent("blockquote").addClass("hidden").before('<p><a class="text-muted btn btn-default toggle-blockquote" style="padding: 2px 7px 0px; line-height: 1;"> \t\t\t\t\t• • • \t\t\t\t</a></p>'),t.html()},scroll_to:function(e,t,n,r){void 0===t&&(t=!0),r=r||$("html, body");var i=0;e&&(i="number"==typeof e?e-cint(n):this.get_scroll_position(e,n)),i<0&&(i=0),i!=r.scrollTop()&&(t?r.animate({scrollTop:i}):r.scrollTop(i))},get_scroll_position:function(e,t){var n=$(".navbar").height()+$(".page-head:visible").height();return $(e).offset().top-n-cint(t)},filter_dict:function(e,t){var n=[];return"string"==typeof t?[e[t]]:($.each(e,function(e,r){for(var i in t)if($.isArray(t[i])){if("in"==t[i][0]){if(-1==t[i][1].indexOf(r[i]))return}else if("not in"==t[i][0]){if(-1!=t[i][1].indexOf(r[i]))return}else if("<"==t[i][0]){if(!(r[i]<t[i]))return}else if("<="==t[i][0]){if(!(r[i]<=t[i]))return}else if(">"==t[i][0]){if(!(r[i]>t[i]))return}else if(">="==t[i][0]&&!(r[i]>=t[i]))return}else if(r[i]!=t[i])return;n.push(r)}),n)},comma_or:function(e){return frappe.utils.comma_sep(e," "+__("or")+" ")},comma_and:function(e){return frappe.utils.comma_sep(e," "+__("and")+" ")},comma_sep:function(e,t){return e instanceof Array?0==e.length?"":1==e.length?e[0]:e.slice(0,e.length-1).join(", ")+t+e.slice(-1)[0]:e},set_footnote:function(e,t,n){return e||(e=$('<div class="text-muted footnote-area level">').appendTo(t)),n?e.html(n):(e.remove(),e=null),e},get_args_dict_from_url:function(e){var t={};return $.each(decodeURIComponent(e).split("&"),function(e,n){n=n.split("="),t[n[0]]=n[1]}),t},get_url_from_dict:function(e){return $.map(e,function(e,t){return null!==e?encodeURIComponent(t)+"="+encodeURIComponent(e):null}).join("&")||""},validate_type:function(e,t){var n;switch(t){case"phone":n=/^([0-9 +_\-,.*#()]){1,20}$/;break;case"name":n=/^[\w][\w'-]*([ \w][\w'-]+)*$/;break;case"number":n=/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/;break;case"digits":n=/^\d+$/;break;case"alphanum":n=/^\w+$/;break;case"email":n=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;break;case"url":n=/^((([A-Za-z0-9.+-]+:(?:\/\/)?)(?:[-;:&=\+\,\w]@)?[A-Za-z0-9.-]+(:[0-9]+)?|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)$/i;break;case"dateIso":n=/^(\d{4})\D?(0[1-9]|1[0-2])\D?([12]\d|0[1-9]|3[01])$/;break;default:return!1}return""!==e&&n.test(e)},guess_style:function(e,t,n){var r=t||"default",i="gray";return e&&(has_words(["Pending","Review","Medium","Not Approved"],e)?(r="warning",i="orange"):has_words(["Open","Urgent","High","Failed","Rejected","Error"],e)?(r="danger",i="red"):has_words(["Closed","Finished","Converted","Completed","Complete","Confirmed","Approved","Yes","Active","Available","Paid","Success"],e)?(r="success",i="green"):has_words(["Submitted"],e)&&(r="info",i="blue")),n?i:r},guess_colour:function(e){return frappe.utils.guess_style(e,null,!0)},get_indicator_color:function(e){return frappe.db.get_list("Workflow State",{filters:{name:e},fields:["name","style"]}).then(function(e){var t=e[0];if(!t.style)return frappe.utils.guess_colour(t.name);return{Success:"green",Warning:"orange",Danger:"red",Primary:"blue"}[t.style]})},sort:function(e,t,n,r){if(!e||e.length<2)return e||[];var i={string:function(e,n){return cstr(e[t]).localeCompare(cstr(n[t]))},number:function(e,n){return flt(e[t])-flt(n[t])}};return n||(n="string"==typeof e[0][t]?"string":"number"),e.sort(i[n]),r&&e.reverse(),e},unique:function(e){for(var t={},n=[],r=0,i=e.length;r<i;r++)e[r]in t||(t[e[r]]=null,n.push(e[r]));return n},remove_nulls:function(e){for(var t=[],n=0,r=e.length;n<r;n++)is_null(e[n])||t.push(e[n]);return t},all:function(e){for(var t=0,n=e.length;t<n;t++)if(!e[t])return!1;return!0},dict:function(e,t){var n=[];return $.each(t,function(t,r){var i={};$.each(e,function(e,t){i[t]=r[e]}),n.push(i)}),n},sum:function(e){return e.reduce(function(e,t){return flt(e)+flt(t)},0)},arrays_equal:function(e,t){if(!e||!t)return!1;if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if($.isArray(e[n])){if(!frappe.utils.arrays_equal(e[n],t[n]))return!1}else if(e[n]!==t[n])return!1;return!0},intersection:function(e,t){var n=0,r=0,i=new Array;for(e=[].concat(e).sort(),t=[].concat(t).sort();n<e.length&&r<t.length;)e[n]<t[r]?n++:e[n]>t[r]?r++:(i.push(e[n]),n++,r++);return i},resize_image:function(e,t,n,r){var i=new Image;n||(n=600),r||(r=400),i.src=e.result,i.onload=function(){var e=i.width,a=i.height;e>a?e>n&&(a*=n/e,e=n):a>r&&(e*=r/a,a=r);var o=document.createElement("canvas");o.width=e,o.height=a,o.getContext("2d").drawImage(this,0,0,e,a);var s=o.toDataURL("image/jpeg");setTimeout(function(){t(s)},10)}},csv_to_array:function(e,t){t=t||",";for(var n=new RegExp("(\\"+t+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+t+"\\r\\n]*))","gi"),r=[[]],i=null;i=n.exec(e);){var a,o=i[1];o.length&&o!==t&&r.push([]),a=i[2]?i[2].replace(new RegExp('""',"g"),'"'):i[3],r[r.length-1].push(a)}return r},warn_page_name_change:function(){frappe.msgprint(__("Note: Changing the Page Name will break previous URL to this page."))},notify:function(e,t,n,r){console.log("push notifications are evil and deprecated")},set_title:function(e){frappe._original_title=e,frappe._title_prefix&&(e=frappe._title_prefix+" "+e.replace(/<[^>]*>/g,"")),document.title=e;var t=frappe.router.get_sub_path();frappe.route_titles[t]=e},set_title_prefix:function(e){frappe._title_prefix=e,frappe.utils.set_title(frappe._original_title)},is_image_file:function(e){return!!e&&(e=e.split("?")[0],/\.(gif|jpg|jpeg|tiff|png|svg)$/i.test(e))},play_sound:function(e){try{if(frappe.boot.user.mute_sounds)return;var t=$("#sound-"+e)[0];t.volume=t.getAttribute("volume"),t.play()}catch(t){console.log("Cannot play sound",e,t)}},split_emails:function(e){var t=[];return e?(e.split(/[,\n](?=(?:[^"]|"[^"]*")*$)/g).forEach(function(e){(e=e.trim())&&t.push(e)}),t):t},supportsES6:function(){try{return new Function("(a = 0) => a"),!0}catch(e){return!1}}(),throttle:function(e,t,n){var r,i,a,o=null,s=0;n||(n={});var l=function(){s=!1===n.leading?0:Date.now(),o=null,a=e.apply(r,i),o||(r=i=null)};return function(){var c=Date.now();s||!1!==n.leading||(s=c);var d=t-(c-s);return r=this,i=arguments,d<=0||d>t?(o&&(clearTimeout(o),o=null),s=c,a=e.apply(r,i),o||(r=i=null)):o||!1===n.trailing||(o=setTimeout(l,d)),a}},debounce:function(e,t,n){var r;return function(){var i=this,a=arguments,o=n&&!r;clearTimeout(r),r=setTimeout(function(){r=null,n||e.apply(i,a)},t),o&&e.apply(i,a)}},get_form_link:function(e,t,n,r,i){void 0===n&&(n=!1),void 0===r&&(r=null),void 0===i&&(i=null),r=r||t,t=encodeURIComponent(t);var a="/app/"+encodeURIComponent(e.toLowerCase().replace(/ /g,"-"))+"/"+t;return i&&(a+=frappe.utils.make_query_string(i)),n?'<a href="'+a+'">'+r+"</a>":a},get_route_label:function(e){var t=e.split("/");return"Report"===t[2]||"query-report"===t[0]?__("{0} Report",[t[3]||t[1]]):"List"===t[0]?__("{0} List",[t[1]]):"modules"===t[0]?__("{0} Modules",[t[1]]):"dashboard"===t[0]?__("{0} Dashboard",[t[1]]):__(frappe.utils.to_title_case(t[0],!0))},report_column_total:function(e,t,n){return t.column.disable_total?"":e.length>0?"Percent"==t.column.fieldtype||"mean"===n?e.reduce(function(e,t){return e+flt(t)})/e.length:"Int"==t.column.fieldtype?e.reduce(function(e,t){return e+cint(t)}):frappe.model.is_numeric_field(t.column.fieldtype)?e.reduce(function(e,t){return e+flt(t)}):null:null},setup_search:function(e,t,n,r){var i=e.find('[data-element="search"]').show();i.focus().val("");var a=e.find(t).show();i.off("keyup").on("keyup",function(){var e=i.val().toLowerCase();e=e.replace(/^\s+|\s+$/g,"");for(var t=0;t<a.length;t++){var o=a.eq(t).find(n),s=o.text().toLowerCase(),l="";r&&o.attr(r)&&(l=o.attr(r).toLowerCase()),s.includes(e)||l.includes(e)?a.eq(t).css("display",""):a.eq(t).css("display","none")}})},deep_equal:function(e,t){return fastDeepEqual(e,t)},file_name_ellipsis:function(e,t){var n=2*t/3,r=t-n,i=e.split("."),a=i.pop(),o=i.join(""),s=o.slice(0,n),l=o.slice(-r);return o.length>t?s+"..."+l+"."+a:e},get_decoded_string:function(e){var t=e.split(",")[1],n=atob(t);try{var r=escape(n);n=decodeURIComponent(r)}catch(e){}return n},copy_to_clipboard:function(e){var t=function(){frappe.show_alert({indicator:"green",message:__("Copied to clipboard.")})};if(navigator.clipboard&&window.isSecureContext)navigator.clipboard.writeText(e).then(t);else{var n=$("<textarea>");$("body").append(n),n.val(e).select(),document.execCommand("copy"),t(),n.remove()}},is_rtl:function(e){return void 0===e&&(e=null),["ar","he","fa","ps"].includes(e||frappe.boot.lang)},bind_actions_with_object:function(e,t){return $(e).off("click.class_actions"),$(e).on("click.class_actions","[data-action]",function(e){var n=$(e.currentTarget),r=n.data("action");t[r]&&t[r](e,n)}),e},eval:function(e,t){void 0===t&&(t={});var n=Object.keys(t),r=Object.values(t);e="let out = "+e+"; return out";try{return(new(Function.prototype.bind.apply(Function,[null].concat(n,[e])))).apply(void 0,r)}catch(t){throw console.log("Error evaluating the following expression:"),console.error(e),t}},get_browser:function(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?{name:"IE",version:(e=/\brv[ :]+(\d+)/g.exec(t)||[])[1]||""}:"Chrome"===n[1]&&null!=(e=t.match(/\bOPR|Edge\/(\d+)/))?{name:"Opera",version:e[1]}:(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]),{name:n[0],version:n[1]})},get_formatted_duration:function(e,t){void 0===t&&(t=null);var n="";if(t||(t={hide_days:0,hide_seconds:0}),e){var r=frappe.utils.seconds_to_duration(e,t);r.days&&(n+=r.days+__("d",null,"Days (Field: Duration)")),r.hours&&(n+=n.length?" ":"",n+=r.hours+__("h",null,"Hours (Field: Duration)")),r.minutes&&(n+=n.length?" ":"",n+=r.minutes+__("m",null,"Minutes (Field: Duration)")),r.seconds&&(n+=n.length?" ":"",n+=r.seconds+__("s",null,"Seconds (Field: Duration)"))}return n},seconds_to_duration:function(e,t){var n=e>0?Math.floor:Math.ceil,r={days:n(e/86400),hours:n(e%86400/3600),minutes:n(e%3600/60),seconds:n(e%60)};return t.hide_days&&(r.hours=n(e/3600),r.days=0),r},duration_to_seconds:function(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0);var i=0;return e&&(i+=24*e*60*60),t&&(i+=60*t*60),n&&(i+=60*n),r&&(i+=r),i},get_duration_options:function(e){return{hide_days:e.hide_days,hide_seconds:e.hide_seconds}},get_number_system:function(e){var t={India:[{divisor:1e7,symbol:"Cr"},{divisor:1e5,symbol:"Lakh"}],"":[{divisor:1e12,symbol:"T"},{divisor:1e9,symbol:"B"},{divisor:1e6,symbol:"M"},{divisor:1e3,symbol:"K"}]};return Object.keys(t).includes(e)||(e=""),t[e]},map_defaults:{center:[19.08,72.8961],zoom:13,tiles:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",options:{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}},icon:function(e,t,n,r,i){void 0===t&&(t="sm"),void 0===n&&(n=""),void 0===r&&(r=""),void 0===i&&(i="");var a="";return"object"==typeof t?r+=" width: "+t.width+"; height: "+t.height:a="icon-"+t,'<svg class="icon '+i+" "+a+'" style="'+r+'">\n\t\t\t<use class="'+n+'" href="#icon-'+e+'"></use>\n\t\t</svg>'},make_chart:function(e,t){void 0===t&&(t={});var n={type:"bar",colors:["light-blue"],axisOptions:{xIsSeries:1,shortenYAxisNumbers:1,xAxisMode:"tick"}};for(var r in t)"object"==typeof n[r]&&"object"==typeof t[r]?n[r]=Object.assign(n[r],t[r]):n[r]=t[r];return new frappe.Chart(e,n)},generate_route:function(e){var t=e.type.toLowerCase();"doctype"===t&&(e.doctype=e.name);var n="";if(e.route)n=e.route;else if(e.link)n=strip(e.link,"#");else if("doctype"===t){var r=frappe.router.slug(e.doctype);if(frappe.model.is_single(e.doctype))n=r;else switch(e.doc_view||(frappe.model.is_tree(e.doctype)?e.doc_view="Tree":e.doc_view="List"),e.doc_view){case"List":e.filters&&(frappe.route_options=e.filters),n=r;break;case"Tree":n=r+"/view/tree";break;case"Report Builder":n=r+"/view/report";break;case"Dashboard":n=r+"/view/dashboard";break;case"New":n=r+"/new";break;case"Calendar":n=r+"/view/calendar/default";break;default:frappe.throw({message:__("Not a valid view:")+e.doc_view,title:__("Unknown View")}),n=""}}else"report"===t?n=e.is_query_report?"query-report/"+e.name:e.doctype?frappe.router.slug(e.doctype)+"/view/report/"+e.name:"/report/"+e.name:"page"===t?n=e.name:"dashboard"===t&&(n="dashboard-view/"+e.name);return e.route_options&&(n+="?"+$.map(e.route_options,function(e,t){return encodeURIComponent(t)+"="+encodeURIComponent(e)}).join("&")),"/app/"+n},shorten_number:function(e,t,n,r){if(void 0===n&&(n=4),void 0===r&&(r=2),String(e).match(/\d/g).length<n)return e.toString();for(var i=this.get_number_system(t),a=Math.abs(Math.round(e)),o=0,s=i;o<s.length;o+=1){var l=s[o];if(a>=l.divisor){var c=e/l.divisor;return(c=this.get_number_of_decimals(c)>r?c.toFixed(r):c)+" "+l.symbol}}return e.toFixed(r)},get_number_of_decimals:function(e){return Math.floor(e)===e?0:e.toString().split(".")[1].length||0},build_summary_item:function(e){if("separator"==e.type)return $('<div class="summary-separator">\n\t\t\t\t<div class="summary-value '+(e.color?e.color.toLowerCase():"text-muted")+'">'+e.value+"</div>\n\t\t\t</div>");var t={fieldtype:e.datatype},n=null;"Currency"==e.datatype&&(t.options="currency",n={currency:e.currency});var r=frappe.format(e.value,t,{only_value:!0},n),i=e.indicator?e.indicator.toLowerCase():e.color?e.color.toLowerCase():"";return $('<div class="summary-item">\n\t\t\t<span class="summary-label">'+e.label+'</span>\n\t\t\t<div class="summary-value '+i+'">'+r+"</div>\n\t\t</div>")},print:function(e,t,n,r,i){window.open(frappe.urllib.get_full_url("/printview?doctype="+encodeURIComponent(e)+"&name="+encodeURIComponent(t)+"&trigger_print=1&format="+encodeURIComponent(n)+"&no_letterhead="+(r?"0":"1")+"&letterhead="+encodeURIComponent(r)+(i?"&_lang="+i:"")))||frappe.msgprint(__("Please enable pop-ups"))},get_clipboard_data:function(e){var t=e;return(t.clipboardData||window.clipboardData||t.originalEvent.clipboardData).getData("Text")},parse_array:function(e){if(e&&0!==e.length)return e}}),frappe.provide("frappe.utils");var EventEmitterMixin={init:function(){this.jq=jQuery({})},trigger:function(e,t){!this.jq&&this.init(),this.jq.trigger(e,t)},once:function(e,t){!this.jq&&this.init(),this.jq.one(e,function(e,n){return t(n)})},on:function(e,t){!this.jq&&this.init(),this.jq.bind(e,function(e,n){return t(n)})},off:function(e,t){!this.jq&&this.init(),this.jq.unbind(e,function(e,n){return t(n)})}};frappe.utils.make_event_emitter=function(e){return Object.assign(e,EventEmitterMixin),e},frappe.provide("frappe.views"),frappe.re_route={"#login":""},frappe.route_titles={},frappe.route_flags={},frappe.route_history=[],frappe.view_factory={},frappe.view_factories=[],frappe.route_options=null,frappe.route_hooks={},$(window).on("hashchange",function(e){if(window.location.hash&&!frappe.router.is_app_route(e.currentTarget.pathname)){var t=frappe.router.get_sub_path(window.location.hash);return frappe.router.push_state(t),!1}}),window.addEventListener("popstate",function(e){return frappe.router.route(),e.preventDefault(),!1}),$("body").on("click","a",function(e){var t=function(t){return e.preventDefault(),frappe.set_route(t),!1},n=e.currentTarget.getAttribute("href");if(!(e.currentTarget.getAttribute("onclick")||e.ctrlKey||e.metaKey||"#"===n))return""===n?t("/app"):n&&n.startsWith("#")?t(e.currentTarget.hash):frappe.router.is_app_route(e.currentTarget.pathname)?t(e.currentTarget.pathname+e.currentTarget.hash):void 0}),frappe.router={current_route:null,routes:{},factory_views:["form","list","report","tree","print","dashboard"],list_views:["list","kanban","report","calendar","tree","gantt","dashboard","image","inbox"],layout_mapped:{},is_app_route:function(e){if("/"===e.substr(0,1)&&(e=e.substr(1)),(e=e.split("/"))[0])return"app"===e[0]},setup:function(){for(var e=0,t=frappe.boot.user.can_read;e<t.length;e+=1){var n=t[e];this.routes[this.slug(n)]={doctype:n}}if(frappe.boot.doctype_layouts)for(var r=0,i=frappe.boot.doctype_layouts;r<i.length;r+=1){var a=i[r];this.routes[this.slug(a.name)]={doctype:a.document_type,doctype_layout:a.name}}},route:function(){if(frappe.app){var e=this.get_sub_path();this.re_route(e)||(this.current_sub_path=e,this.current_route=this.parse(),this.set_history(e),this.render(),this.set_title(e),this.trigger("change"))}},parse:function(e){return(e=this.get_sub_path_string(e).split("/"))?(e=$.map(e,this.decode_component),this.set_route_options_from_url(e),this.convert_to_standard_route(e)):[]},convert_to_standard_route:function(e){return frappe.workspaces[e[0]]?e=["Workspaces",frappe.workspaces[e[0]].name]:this.routes[e[0]]&&(e=this.set_doctype_route(e)),e},set_doctype_route:function(e){var t=this.routes[e[0]];if(e[1])if(e[2]&&"view"===e[1])e=this.get_standard_route_for_list(e,t);else{var n=e[1];e.length>2&&(n=e.slice(1).join("/")),e=["Form",t.doctype,n]}else e=frappe.model.is_single(t.doctype)?["Form",t.doctype,t.doctype]:["List",t.doctype,"List"];return t.doctype_layout&&(this.doctype_layout=t.doctype_layout),e},get_standard_route_for_list:function(e,t){var n;return"tree"===e[2].toLowerCase()?n=["Tree",t.doctype]:(n=["List",t.doctype,frappe.utils.to_title_case(e[2])],e[3]&&n.push.apply(n,e.slice(3,e.length))),n},set_history:function(){frappe.route_history.push(this.current_route),frappe.ui.hide_open_dialog()},render:function(){this.current_route[0]?this.render_page():frappe.views.pageview.show("")},render_page:function(){var e=this.current_route,t=frappe.utils.to_title_case(e[0]);if(e[1]&&frappe.views[t+"Factory"])e[0]=t,frappe.view_factory[t]||(frappe.view_factory[t]=new frappe.views[t+"Factory"]),frappe.view_factory[t].show();else{var n=frappe.utils.xss_sanitise(e[0]);frappe.views.pageview&&frappe.views.pageview.show(n)}},re_route:function(e){if(void 0!==frappe.re_route[e]){var t=this.get_sub_path(frappe.re_route[e]);return t===this.current_sub_path?window.history.back():frappe.set_route(t),!0}},clear_re_route:function(e,t){delete frappe.re_route[encodeURIComponent(frappe.router.slug(e))+"/"+encodeURIComponent(t)]},set_title:function(e){frappe.route_titles[e]&&frappe.utils.set_title(frappe.route_titles[e])},set_route:function(){var e=this,t=Array.from(arguments);return new Promise(function(n){t=e.get_route_from_arguments(t),t=e.convert_from_standard_route(t);var r=e.make_url(t);e.push_state(r),setTimeout(function(){frappe.after_ajax&&frappe.after_ajax(function(){n()})},100)})},get_route_from_arguments:function(e){return 1===e.length&&$.isArray(e[0])&&(e=e[0]),1===e.length&&e[0]&&e[0].includes("/")&&(e=$.map(e[0].split("/"),this.decode_component)),e&&""==e[0]&&e.shift(),e&&["desk","app"].includes(e[0])&&e.shift(),e},convert_from_standard_route:function(e){var t=e[0]?e[0].toLowerCase():"",n=e;return"list"===t?e[2]&&"list"!==e[2]&&!$.isPlainObject(e[2])?(n=[this.slug(e[1]),"view",e[2].toLowerCase()],e[3]&&n.push.apply(n,e.slice(3,e.length))):($.isPlainObject(e[2])&&(frappe.route_options=e[2]),n=[this.slug(e[1])]):"form"===t?(n=[this.slug(e[1])],e[2]&&n.push(e[2])):"tree"===t&&(n=[this.slug(e[1]),"view","tree"]),n},slug_parts:function(e){return e[0]&&this.factory_views.includes(e[0].toLowerCase())&&(e[0]=e[0].toLowerCase(),e[1]=this.slug(e[1])),e},make_url:function(e){return"/app/"+($.map(e,function(e){return $.isPlainObject(e)?(frappe.route_options=e,null):((e=String(e))&&e.match(/[%'"\s\t]/)&&(e=encodeURIComponent(e)),e)}).join("/")||"home")},push_state:function(e){window.location.pathname!==e&&(history.pushState(null,null,e),this.route())},get_sub_path_string:function(e){return e||(e=window.location.pathname+window.location.hash+window.location.search).includes("app#")&&(e=window.location.hash),this.strip_prefix(e)},strip_prefix:function(e){return"/"==e.substr(0,1)&&(e=e.substr(1)),e.startsWith("app/")&&(e=e.substr(4)),"app"==e&&(e=e.substr(4)),"/"==e.substr(0,1)&&(e=e.substr(1)),"#"==e.substr(0,1)&&(e=e.substr(1)),"!"==e.substr(0,1)&&(e=e.substr(1)),e},get_sub_path:function(e){var t=this.get_sub_path_string(e);return e=$.map(t.split("/"),this.decode_component).join("/")},set_route_options_from_url:function(e){var t=e[e.length-1];if(t.indexOf("?")<t.indexOf("=")){var n=t.split("?");e[e.length-1]=n[0];var r=frappe.utils.get_query_params(n[1]);frappe.route_options=$.extend(frappe.route_options||{},r)}},decode_component:function(e){try{return decodeURIComponent(e)}catch(t){if(t instanceof URIError)return e;throw t}},slug:function(e){return e.toLowerCase().replace(/ /g,"-")}},frappe.get_route=function(){return frappe.router.current_route},frappe.get_route_str=function(){return frappe.router.current_route.join("/")},frappe.set_route=function(){return frappe.router.set_route.apply(frappe.router,arguments)},frappe.get_prev_route=function(){return frappe.route_history&&frappe.route_history.length>1?frappe.route_history[frappe.route_history.length-2]:[]},frappe.set_re_route=function(){var e=frappe.router.get_sub_path();frappe.set_route.apply(null,arguments),frappe.re_route[e]=frappe.router.get_sub_path()},frappe.has_route_options=function(){return Boolean(Object.keys(frappe.route_options||{}).length)},frappe.utils.make_event_emitter(frappe.router),frappe.route_history_queue=[];var routes_to_skip=["Form","social","setup-wizard","recorder"],save_routes=frappe.utils.debounce(function(){if("Guest"!==frappe.session.user){var e=frappe.route_history_queue;e.length&&(frappe.route_history_queue=[],frappe.xcall("frappe.desk.doctype.route_history.route_history.deferred_insert",{routes:e}).catch(function(){frappe.route_history_queue.concat(e)}))}},1e4);function is_route_useful(e){return!!e[1]&&!("List"===e[0]&&!e[2]||routes_to_skip.includes(e[0]))}function prettyDate(e,t){if(!e)return"";"string"==typeof e&&(e=frappe.datetime.convert_to_user_tz(e),e=new Date((e||"").replace(/-/g,"/").replace(/[TZ]/g," ").replace(/\.[0-9]*/,"")));var n=((new Date).getTime()-e.getTime())/1e3,r=Math.floor(n/86400);if(isNaN(r)||r<0)return"";if(t){if(0!=r)return r<7?__("{0} d",[r]):r<31?__("{0} w",[Math.floor(r/7)]):r<365?__("{0} M",[Math.floor(r/30)]):__("{0} y",[Math.floor(r/365)]);if(n<60)return __("now");if(n<3600)return __("{0} m",[Math.floor(n/60)]);if(n<86400)return __("{0} h",[Math.floor(n/3600)])}else{if(0!=r)return 1==r?__("yesterday"):r<7?__("{0} days ago",[r]):r<14?__("1 week ago"):r<31?__("{0} weeks ago",[Math.floor(r/7)]):r<62?__("1 month ago"):r<365?__("{0} months ago",[Math.floor(r/30)]):r<730?__("1 year ago"):__("{0} years ago",[Math.floor(r/365)]);if(n<60)return __("just now");if(n<120)return __("1 minute ago");if(n<3600)return __("{0} minutes ago",[Math.floor(n/60)]);if(n<7200)return __("1 hour ago");if(n<86400)return __("{0} hours ago",[Math.floor(n/3600)])}}frappe.router.on("change",function(){is_route_useful(frappe.get_route())&&(frappe.route_history_queue.push({creation:frappe.datetime.now_datetime(),route:frappe.get_route_str()}),save_routes())}),frappe.defaults={get_user_default:function(e){var t=frappe.boot.user.defaults,n=t[e];if(!n&&frappe.defaults.is_a_user_permission_key(e)&&(n=t[frappe.model.scrub(e)]),$.isArray(n)&&(n=n[0]),frappe.defaults.in_user_permission(e,n))return n},get_user_defaults:function(e){var t=frappe.boot.user.defaults,n=t[e];return frappe.defaults.is_a_user_permission_key(e)&&(n=n&&$.isArray(n)&&1===n.length?n[0]:t[e]||t[frappe.model.scrub(e)]),$.isArray(n)||(n=[n]),n.filter(function(t){if(frappe.defaults.in_user_permission(e,t))return t}),n},get_global_default:function(e){var t=frappe.sys_defaults[e];return $.isArray(t)&&(t=t[0]),t},get_global_defaults:function(e){var t=frappe.sys_defaults[e];return $.isArray(t)||(t=[t]),t},set_default:function(e,t,n){return"string"!=typeof t&&(t=JSON.stringify(t)),frappe.boot.user.defaults[e]=t,frappe.call({method:"frappe.client.set_default",args:{key:e,value:t},callback:n||function(e){}})},set_user_default_local:function(e,t){frappe.boot.user.defaults[e]=t},get_default:function(e){var t=frappe.boot.user.defaults,n=t[e];if(frappe.defaults.is_a_user_permission_key(e)&&(n=n&&$.isArray(n)&&1===n.length?n[0]:t[frappe.model.scrub(e)]),frappe.defaults.in_user_permission(e,n)&&n)try{return JSON.parse(n)}catch(e){return n}},is_a_user_permission_key:function(e){return-1===e.indexOf(":")&&e!==frappe.model.scrub(e)},in_user_permission:function(e,t){var n=this.get_user_permissions()[frappe.model.unscrub(e)];return!n||!n.length||n.some(function(e){return e.doc===t})},get_user_permissions:function(){return this._user_permissions||{}},update_user_permissions:function(){var e=this;frappe.call("frappe.core.doctype.user_permission.user_permission.get_user_permissions").then(function(t){t.message&&(e._user_permissions=Object.assign({},t.message))})}},frappe.RoleEditor=class{constructor(e,t,n){var r=this;this.frm=t,this.wrapper=e,this.disable=n;var i=this.frm.doc.roles.map(function(e){return e.role});this.multicheck=frappe.ui.form.make_control({parent:e,df:{fieldname:"roles",fieldtype:"MultiCheck",select_all:!0,columns:3,get_data:function(){return frappe.xcall("frappe.core.doctype.user.user.get_all_roles").then(function(e){return e.map(function(e){return{label:__(e),value:e,checked:i.includes(e)}})})},on_change:function(){r.set_roles_in_table(),r.frm.dirty()}},render_input:!0});var a=this.multicheck.make_checkboxes;this.multicheck.make_checkboxes=function(){a.call(r.multicheck),r.multicheck.$wrapper.find(".label-area").click(function(e){var t=$(e.target).data("unit");t&&r.show_permissions(t),e.preventDefault()})}}set_enable_disable(){$(this.wrapper).find('input[type="checkbox"]').attr("disabled",!!this.disable)}show_permissions(e){var t=this;return this.perm_dialog||this.make_perm_dialog(),$(this.perm_dialog.body).empty(),frappe.xcall("frappe.core.doctype.user.user.get_perm_info",{role:e}).then(function(n){var r=$(t.perm_dialog.body);n.length?(r.append('\n\t\t\t\t\t\t<table class="user-perm">\n\t\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<th> '+__("Document Type")+" </th>\n\t\t\t\t\t\t\t\t\t<th> "+__("Level")+" </th>\n\t\t\t\t\t\t\t\t\t"+frappe.perm.rights.map(function(e){return"<th> "+frappe.unscrub(e)+"</th>"}).join("")+"\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t\t<tbody></tbody>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t"),n.forEach(function(e){r.find("tbody").append("\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td>"+e.parent+"</td>\n\t\t\t\t\t\t\t\t<td>"+e.permlevel+"</td>\n\t\t\t\t\t\t\t\t"+frappe.perm.rights.map(function(t){return'<td class="text-muted bold">'+(e[t]?frappe.utils.icon("check","xs"):"-")+"</td>"}).join("")+"\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t")})):r.append('<div class="text-muted text-center padding">\n\t\t\t\t\t\t'+__("{0} role does not have permission on any doctype",[e])+"\n\t\t\t\t\t</div>"),t.perm_dialog.set_title(e),t.perm_dialog.show()})}make_perm_dialog(){this.perm_dialog=new frappe.ui.Dialog({title:__("Role Permissions")}),this.perm_dialog.$wrapper.find(".modal-dialog").css("width","1200px").css("max-width","80vw")}show(){var e=this.frm.doc.roles.map(function(e){return e.role});this.multicheck.selected_options=e,this.multicheck.refresh_input(),this.set_enable_disable()}set_roles_in_table(){var e=this,t=this.frm.doc.roles||[],n=this.multicheck.get_checked_options();t.map(function(e){n.includes(e.role)||frappe.model.clear_doc(e.doctype,e.name)}),n.map(function(n){t.find(function(e){return e.role===n})||(frappe.model.add_child(e.frm.doc,"Has Role","roles").role=n)})}get_roles(){return{checked_roles:this.multicheck.get_checked_options(),unchecked_roles:this.multicheck.get_unchecked_options()}}},frappe.ModuleEditor=Class.extend({init:function(e,t){this.wrapper=$('<div class="row module-block-list"></div>').appendTo(t),this.frm=e,this.make()},make:function(){var e=this;this.frm.doc.__onload.all_modules.forEach(function(t){$(repl('<div class="col-sm-6"><div class="checkbox">\t\t\t\t<label><input type="checkbox" class="block-module-check" data-module="%(module)s">\t\t\t\t%(module)s</label></div></div>',{module:t})).appendTo(e.wrapper)}),this.bind()},refresh:function(){var e=this;this.wrapper.find(".block-module-check").prop("checked",!0),$.each(this.frm.doc.block_modules,function(t,n){e.wrapper.find(".block-module-check[data-module='"+n.module+"']").prop("checked",!1)})},bind:function(){var e=this;this.wrapper.on("change",".block-module-check",function(){var t=$(this).attr("data-module");$(this).prop("checked")?e.frm.doc.block_modules=$.map(e.frm.doc.block_modules||[],function(e){if(e.module!=t)return e}):e.frm.add_child("block_modules",{module:t})})}}),frappe.template={compiled:{},debug:{}},frappe.template.compile=function(e,t){var n=t||e;if(!frappe.template.compiled[n]){-1!==e.indexOf("'")&&e.replace(/'/g,"\\'");var r="var _p=[],print=function(){_p.push.apply(_p,arguments)};with(obj){\n_p.push('"+(e=(e=(e=(e=(e=(e=(e=e.replace(/{{/g,"{%=").replace(/}}/g,"%}")).replace(/{%\s?if\s?\s?not\s?([^\(][^%{]+)\s?%}/g,"{% if (! $1) { %}")).replace(/{%\s?if\s?([^\(][^%{]+)\s?%}/g,"{% if ($1) { %}")).replace(/{%\s?for\s([a-z._]+)\sin\s([a-z._]+)\s?%}/g,function(e,t,n,r,i){var a=frappe.utils.get_random(3),o=frappe.utils.get_random(3);return"{% for (var "+a+"=0, "+o+"="+n+".length; "+a+"<"+o+"; "+a+"++) { var "+t+" = "+n+"["+a+"]; "+t+"._index = "+a+"; %}"})).replace(/{%\s?endif\s?%}/g,"{% }; %}")).replace(/{%\s?else\s?%}/g,"{% } else { %}")).replace(/{%\s?endfor\s?%}/g,"{% }; %}")).replace(/[\r\t\n]/g," ").split("{%").join("\t").replace(/((^|%})[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%}/g,"',$1,'").split("\t").join("');\n").split("%}").join("\n_p.push('").split("\r").join("\\'")+"');}return _p.join('');";frappe.template.debug[t]=r;try{frappe.template.compiled[n]=new Function("obj",r)}catch(e){console.log("Error in Template:"),console.log(r),e.lineNumber&&(console.log("Error in Line "+e.lineNumber+", Col "+e.columnNumber+":"),console.log(r.split("\n")[e.lineNumber-1]))}}return frappe.template.compiled[n]},frappe.render=function(e,t,n){return frappe.template.compile(e,n)(t)},frappe.render_template=function(e,t){if(-1!==e.indexOf(" "))var n=e;else n=frappe.templates[e];return void 0===t&&(t={}),n||frappe.throw("Template <b>"+e+"</b> not found."),frappe.render(n,t,e)},frappe.render_grid=function(e){e.grid&&(e.columns=e.grid.getColumns(),e.data=e.grid.getData().getItems()),e.print_settings&&e.print_settings.orientation&&"landscape"===e.print_settings.orientation.toLowerCase()&&(e.landscape=!0),null==e.landscape&&(e.columns&&e.columns.length>10?e.landscape=!0:e.landscape=!1),e.content||(e.content=frappe.render_template(e.template||"print_grid",e)),e.base_url=frappe.urllib.get_base_url(),e.print_css=frappe.boot.print_css,e.lang=e.lang||frappe.boot.lang,e.layout_direction=e.layout_direction||frappe.utils.is_rtl()?"rtl":"ltr";var t=frappe.render_template("print_template",e),n=window.open();n||frappe.msgprint(__("Please enable pop-ups in your browser")),n.document.write(t),n.document.close()},frappe.render_tree=function(e){e.base_url=frappe.urllib.get_base_url(),e.landscape=!1,e.print_css=frappe.boot.print_css;var t=frappe.render_template("print_tree",e),n=window.open();n||frappe.msgprint(__("Please enable pop-ups in your browser")),n.document.write(t),n.document.close()},frappe.render_pdf=function(e,t){void 0===t&&(t={});var n=new FormData;n.append("html",e),t.orientation&&n.append("orientation",t.orientation);var r=new Blob([],{type:"text/xml"});n.append("blob",r);var i=new XMLHttpRequest;i.open("POST","/api/method/frappe.utils.print_format.report_to_pdf"),i.setRequestHeader("X-Frappe-CSRF-Token",frappe.csrf_token),i.responseType="arraybuffer",i.onload=function(e){if(200===this.status){var t=new Blob([e.currentTarget.response],{type:"application/pdf"}),n=URL.createObjectURL(t);window.open(n)}},i.send(n)},frappe.templates.page='<div class="page-head flex">  <div class="container">   <div class="row flex align-center page-head-content justify-between">    <div class="col-md-4 col-sm-6 col-xs-8 page-title">               <span class="sidebar-toggle-btn">      <svg class="icon icon-md sidebar-toggle-placeholder">       <use xlink:href="#icon-menu"></use>      </svg>      <span class="sidebar-toggle-icon">       <svg class="icon icon-md">        <use xlink:href="#icon-sidebar-collapse">        </use>       </svg>      </span>     </span>     <div class="flex fill-width title-area">      <div>       <div class="flex">        <h3 class="ellipsis title-text"></h3>        <span class="indicator-pill whitespace-nowrap"></span>       </div>       <div class="ellipsis sub-heading hide text-muted"></div>      </div>      <button class="btn btn-default more-button hide">       <svg class="icon icon-sm">        <use xlink:href="#icon-dot-horizontal">        </use>       </svg>      </button>     </div>    </div>    <div class="flex col page-actions justify-content-end">          <div class="custom-actions hide hidden-xs hidden-md"></div>     <div class="standard-actions flex">      <span class="page-icon-group hide hidden-xs hidden-sm"></span>      <div class="menu-btn-group hide">       <button type="button" class="btn btn-default icon-btn" data-toggle="dropdown" aria-expanded="false">        <span>         <span class="menu-btn-group-label">          <svg class="icon icon-sm">           <use xlink:href="#icon-dot-horizontal">           </use>          </svg>         </span>        </span>       </button>       <ul class="dropdown-menu dropdown-menu-right" role="menu"></ul>      </div>      <button class="btn btn-secondary btn-default btn-sm hide"></button>      <div class="actions-btn-group hide">       <button type="button" class="btn btn-primary btn-sm" data-toggle="dropdown" aria-expanded="false">        <span class="hidden-xs">         <span class="actions-btn-group-label">{%= __("Actions") %}</span>         <svg class="icon icon-xs">          <use xlink:href="#icon-select">          </use>         </svg>        </span>       </button>       <ul class="dropdown-menu dropdown-menu-right" role="menu">       </ul>      </div>      <button class="btn btn-primary btn-sm hide primary-action"></button>     </div>    </div>   </div>  </div> </div> <div class="container page-body">  <div class="page-toolbar hide">   <div class="container">   </div>  </div>  <div class="page-wrapper">   <div class="page-content">    <div class="workflow-button-area btn-group pull-right hide"></div>    <div class="clearfix"></div>   </div>  </div> </div>',frappe.ui.make_app_page=function(e){return e.parent.page=new frappe.ui.Page(e),e.parent.page},frappe.ui.pages={},frappe.ui.Page=Class.extend({init:function(e){$.extend(this,e),this.set_document_title=!0,this.buttons={},this.fields_dict={},this.views={},this.make(),frappe.ui.pages[frappe.get_route_str()]=this},make:function(){this.wrapper=$(this.parent),this.add_main_section(),this.setup_scroll_handler(),this.setup_sidebar_toggle()},setup_scroll_handler:function(){window.addEventListener("scroll",function(){document.documentElement.scrollTop?$(".page-head").toggleClass("drop-shadow",!0):$(".page-head").removeClass("drop-shadow")})},get_empty_state:function(e,t,n){return $('<div class="page-card-container">\n\t\t\t<div class="page-card">\n\t\t\t\t<div class="page-card-head">\n\t\t\t\t\t<span class="indicator blue">\n\t\t\t\t\t\t'+e+"</span>\n\t\t\t\t</div>\n\t\t\t\t<p>"+t+'</p>\n\t\t\t\t<div>\n\t\t\t\t\t<button class="btn btn-primary btn-sm">'+n+"</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>")},load_lib:function(e){frappe.require(this.required_libs,e)},add_main_section:function(){$(frappe.render_template("page",{})).appendTo(this.wrapper),this.single_column?this.add_view("main",'<div class="row layout-main">\t\t\t\t\t<div class="col-md-12 layout-main-section-wrapper">\t\t\t\t\t\t<div class="layout-main-section"></div>\t\t\t\t\t\t<div class="layout-footer hide"></div>\t\t\t\t\t</div>\t\t\t\t</div>'):this.add_view("main",'\n\t\t\t\t<div class="row layout-main">\n\t\t\t\t\t<div class="col-lg-2 layout-side-section"></div>\n\t\t\t\t\t<div class="col layout-main-section-wrapper">\n\t\t\t\t\t\t<div class="layout-main-section"></div>\n\t\t\t\t\t\t<div class="layout-footer hide"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t'),this.setup_page()},setup_page:function(){this.$title_area=this.wrapper.find(".title-area"),this.$sub_title_area=this.wrapper.find("h6"),this.title&&this.set_title(this.title),this.icon&&this.get_main_icon(this.icon),this.body=this.main=this.wrapper.find(".layout-main-section"),this.container=this.wrapper.find(".page-body"),this.sidebar=this.wrapper.find(".layout-side-section"),this.footer=this.wrapper.find(".layout-footer"),this.indicator=this.wrapper.find(".indicator-pill"),this.page_actions=this.wrapper.find(".page-actions"),this.btn_primary=this.page_actions.find(".primary-action"),this.btn_secondary=this.page_actions.find(".btn-secondary"),this.menu=this.page_actions.find(".menu-btn-group .dropdown-menu"),this.menu_btn_group=this.page_actions.find(".menu-btn-group"),this.actions=this.page_actions.find(".actions-btn-group .dropdown-menu"),this.actions_btn_group=this.page_actions.find(".actions-btn-group"),this.standard_actions=this.page_actions.find(".standard-actions"),this.custom_actions=this.page_actions.find(".custom-actions"),this.page_form=$('<div class="page-form row hide"></div>').prependTo(this.main),this.inner_toolbar=this.custom_actions,this.icon_group=this.page_actions.find(".page-icon-group"),this.make_page&&this.make_page(),this.card_layout&&this.main.addClass("frappe-card");var e=this.menu_btn_group.find("button");e.attr("title",__("Menu")).tooltip({delay:{show:600,hide:100}}),frappe.ui.keys.get_shortcut_group(this.page_actions[0]).add(e,e.find(".menu-btn-group-label"));var t=this.actions_btn_group.find("button");frappe.ui.keys.get_shortcut_group(this.page_actions[0]).add(t,t.find(".actions-btn-group-label"))},setup_sidebar_toggle:function(){var e=this,t=$(".page-head").find(".sidebar-toggle-btn"),n=this.wrapper.find(".layout-side-section");this.disable_sidebar_toggle||!n.length?t.remove():(t.attr("title",__("Toggle Sidebar")).tooltip({delay:{show:600,hide:100},trigger:"hover"}),t.click(function(){frappe.utils.is_xs()||frappe.utils.is_sm()?e.setup_overlay_sidebar():n.toggle(),$(document.body).trigger("toggleSidebar"),e.update_sidebar_icon()}))},setup_overlay_sidebar:function(){var e=this,t=this.sidebar.find(".overlay-sidebar").addClass("opened");$('<div class="close-sidebar">').hide().appendTo(this.sidebar).fadeIn();var n=$("html").css("overflow-y","hidden");this.sidebar.find(".close-sidebar").on("click",function(e){return r(e)}),this.sidebar.on("click","button:not(.dropdown-toggle)",function(e){return r(e)});var r=function(){n.css("overflow-y",""),e.sidebar.find("div.close-sidebar").fadeOut(function(){t.removeClass("opened").find(".dropdown-toggle").removeClass("text-muted")})}},update_sidebar_icon:function(){var e=$(".page-head").find(".sidebar-toggle-btn").find(".sidebar-toggle-icon"),t=this.wrapper.find(".layout-side-section"),n=$(t).is(":visible");e.html(frappe.utils.icon(n?"sidebar-collapse":"sidebar-expand","md"))},set_indicator:function(e,t){this.clear_indicator().removeClass("hide").html("<span>"+e+"</span>").addClass(t)},add_action_icon:function(e,t,n,r){void 0===n&&(n="");var i=$('\n\t\t\t<button class="text-muted btn btn-default '+n+' icon-btn">\n\t\t\t\t'+frappe.utils.icon(e)+"\n\t\t\t</button>\n\t\t");return i.appendTo(this.icon_group.removeClass("hide")),i.click(t),i.attr("title",__(r||frappe.unscrub(e))).tooltip({delay:{show:600,hide:100},trigger:"hover"}),i},clear_indicator:function(){return this.indicator.removeClass().addClass("indicator-pill whitespace-nowrap hide")},get_icon_label:function(e,t){var n=e,r="xs";return"object"==typeof e&&(n=e.icon,r=e.size||"xs"),(e?frappe.utils.icon(n,r):"")+' <span class="hidden-xs"> '+__(t)+" </span>"},set_action:function(e,t){var n=this;t.icon&&(t.label=this.get_icon_label(t.icon,t.label)),this.clear_action_of(e),e.removeClass("hide").prop("disabled",!1).html(t.label).on("click",function(){var r=t.click.apply(this);n.btn_disable_enable(e,r)}),t.working_label&&e.attr("data-working-label",t.working_label);var r=e.find("span");frappe.ui.keys.get_shortcut_group(this).add(e,r.length?r:e)},set_primary_action:function(e,t,n,r){return this.set_action(this.btn_primary,{label:e,click:t,icon:n,working_label:r}),this.btn_primary},set_secondary_action:function(e,t,n,r){return this.set_action(this.btn_secondary,{label:e,click:t,icon:n,working_label:r}),this.btn_secondary},clear_action_of:function(e){e.addClass("hide").unbind("click").removeAttr("data-working-label")},clear_primary_action:function(){this.clear_action_of(this.btn_primary)},clear_secondary_action:function(){this.clear_action_of(this.btn_secondary)},clear_actions:function(){this.clear_primary_action(),this.clear_secondary_action()},clear_custom_actions:function(){this.custom_actions.addClass("hide").empty()},clear_icons:function(){this.icon_group.addClass("hide").empty()},add_menu_item:function(e,t,n,r){return this.add_dropdown_item({label:e,click:t,standard:n,parent:this.menu,shortcut:r})},add_custom_menu_item:function(e,t,n,r,i,a){return void 0===a&&(a=null),this.add_dropdown_item({label:t,click:n,standard:r,parent:e,shortcut:i,icon:a})},clear_menu:function(){this.clear_btn_group(this.menu)},show_menu:function(){this.menu_btn_group.removeClass("hide")},hide_menu:function(){this.menu_btn_group.addClass("hide")},show_icon_group:function(){this.icon_group.removeClass("hide")},hide_icon_group:function(){this.icon_group.addClass("hide")},show_actions_menu:function(){this.actions_btn_group.removeClass("hide")},hide_actions_menu:function(){this.actions_btn_group.addClass("hide")},add_action_item:function(e,t,n){return this.add_dropdown_item({label:e,click:t,standard:n,parent:this.actions})},add_actions_menu_item:function(e,t,n){return this.add_dropdown_item({label:e,click:t,standard:n,parent:this.actions,show_parent:!1})},clear_actions_menu:function(){this.clear_btn_group(this.actions)},add_dropdown_item:function(e){var t=e.label,n=e.click,r=e.standard,i=e.parent,a=e.shortcut,o=e.show_parent;void 0===o&&(o=!0);var s=e.icon;void 0===s&&(s=null),o&&i.parent().removeClass("hide");var l,c=this.is_in_group_button_dropdown(i,"li > a.grey-link",t);if(c)return c;var d="";if(s&&(d='<span class="menu-item-icon">'+frappe.utils.icon(s)+"</span>"),a){var u=this.prepare_shortcut_obj(a,n,t);l=$('\n\t\t\t\t<li>\n\t\t\t\t\t<a class="grey-link dropdown-item" href="#" onClick="return false;">\n\t\t\t\t\t\t'+d+'\n\t\t\t\t\t\t<span class="menu-item-label">'+t+'</span>\n\t\t\t\t\t\t<kbd class="pull-right">\n\t\t\t\t\t\t\t<span>'+u.shortcut_label+"</span>\n\t\t\t\t\t\t</kbd>\n\t\t\t\t\t</a>\n\t\t\t\t</li>\n\t\t\t"),frappe.ui.keys.add_shortcut(u)}else l=$('\n\t\t\t\t<li>\n\t\t\t\t\t<a class="grey-link dropdown-item" href="#" onClick="return false;">\n\t\t\t\t\t\t'+d+'\n\t\t\t\t\t\t<span class="menu-item-label">'+t+"</span>\n\t\t\t\t\t</a>\n\t\t\t\t</li>\n\t\t\t");return c=l.find("a").on("click",n),r?l.appendTo(i):(this.divider=i.find(".dropdown-divider"),this.divider.length||(this.divider=$('<li class="dropdown-divider user-action"></li>').prependTo(i)),l.addClass("user-action").insertBefore(this.divider)),frappe.ui.keys.get_shortcut_group(i.get(0)).add(c,c.find(".menu-item-label")),c},prepare_shortcut_obj:function(e,t,n){var r;return r="string"==typeof e?{shortcut:e}:e,frappe.utils.is_mac()?r.shortcut_label=r.shortcut.replace("Ctrl","⌘"):r.shortcut_label=r.shortcut,r.shortcut=r.shortcut.toLowerCase(),r.action||(r.action=t),r.description||(r.description=n),r.page=this,r},is_in_group_button_dropdown:function(e,t,n){if(t||(t="li"),!n||!e)return!1;var r=$(e).find(t+":contains('"+n+"')").filter(function(){var e=$(this).html();return $(e).attr("data-label")===n});return r.length>0&&r},clear_btn_group:function(e){e.empty(),e.parent().addClass("hide")},add_divider:function(){return $('<li class="dropdown-divider"></li>').appendTo(this.menu)},get_or_add_inner_group_button:function(e){var t=this.inner_toolbar.find('.inner-group-button[data-label="'+encodeURIComponent(e)+'"]');return t.length||(t=$('<div class="inner-group-button" data-label="'+encodeURIComponent(e)+'">\n\t\t\t\t\t<button type="button" class="btn btn-default ellipsis" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n\t\t\t\t\t\t'+e+"\n\t\t\t\t\t\t"+frappe.utils.icon("select","xs")+'\n\t\t\t\t\t</button>\n\t\t\t\t\t<div role="menu" class="dropdown-menu"></div>\n\t\t\t\t</div>').appendTo(this.inner_toolbar)),t},get_inner_group_button:function(e){return this.inner_toolbar.find('.inner-group-button[data-label="'+encodeURIComponent(e)+'"]')},set_inner_btn_group_as_primary:function(e){this.get_or_add_inner_group_button(e).find("button").removeClass("btn-default").addClass("btn-primary")},btn_disable_enable:function(e,t){t&&t.then?(e.prop("disabled",!0),t.then(function(){e.prop("disabled",!1)})):t&&t.always&&(e.prop("disabled",!0),t.always(function(){e.prop("disabled",!1)}))},add_inner_button:function(e,t,n,r){void 0===r&&(r="default");var i=this,a=function(){var e=$(this),n=t();i.btn_disable_enable(e,n)};if(!n){var o=this.inner_toolbar.find('button[data-label="'+encodeURIComponent(e)+'"]');return 0==o.length&&((o=$('<button data-label="'+encodeURIComponent(e)+'" class="btn btn-'+r+' ellipsis">\n\t\t\t\t\t'+__(e)+"\n\t\t\t\t</button>")).on("click",a),o.appendTo(this.inner_toolbar.removeClass("hide"))),o}var s=this.get_or_add_inner_group_button(n);if($(this.inner_toolbar).removeClass("hide"),!this.is_in_group_button_dropdown(s.find(".dropdown-menu"),"a",e))return $('<a class="dropdown-item" href="#" onclick="return false;" data-label="'+encodeURIComponent(e)+'">'+e+"</a>").on("click",a).appendTo(s.find(".dropdown-menu"))},remove_inner_button:function(e,t){if("string"==typeof e&&(e=[e]),e=e.map(function(e){return __(e)}),t){var n=this.get_inner_group_button(__(t));n.length&&n.find('.dropdown-item[data-label="'+encodeURIComponent(e)+'"]').remove(),0===n.find(".dropdown-item").length&&n.remove()}else this.inner_toolbar.find('button[data-label="'+encodeURIComponent(e)+'"]').remove()},change_inner_button_type:function(e,t,n){var r;if(t){var i=this.get_inner_group_button(__(t));i.length&&(r=i.find('.dropdown-item[data-label="'+encodeURIComponent(e)+'"]'))}else r=this.inner_toolbar.find('button[data-label="'+encodeURIComponent(e)+'"]');r&&r.removeClass().addClass("btn btn-"+n+" ellipsis")},add_inner_message:function(e){var t=$("<span class='inner-page-message text-muted small'>"+e+"</div>");return this.inner_toolbar.find(".inner-page-message").remove(),this.inner_toolbar.removeClass("hide").prepend(t),t},clear_inner_toolbar:function(){this.inner_toolbar.empty().addClass("hide")},add_sidebar_item:function(e,t,n,r){var i=this.sidebar.find(".sidebar-menu.standard-actions"),a=$("<li>"),o=$("<a>").html(e).on("click",t).appendTo(a);return n?a.insertAfter(i.find(n)):r?a.prependTo(i):a.appendTo(i),o},clear_user_actions:function(){this.menu.find(".user-action").remove()},get_title_area:function(){return this.$title_area},set_title:function(e,t,n,r){void 0===t&&(t=null),void 0===n&&(n=!0),void 0===r&&(r=""),e||(e=""),n&&(e=strip_html(e)),this.title=e,frappe.utils.set_title(r||e),t&&(e=frappe.utils.icon(t)+" "+e);var i=this.$title_area.find(".title-text");i.html(e),i.attr("title",this.title)},set_title_sub:function(e){this.$sub_title_area.html(e).toggleClass("hide",!e)},get_main_icon:function(e){return this.$title_area.find(".title-icon").html('<i class="'+e+' fa-fw"></i> ').toggle(!0)},add_help_button:function(e){},add_button:function(e,t,n){n||(n={});var r=$('<button\n\t\t\tclass="btn '+(n.btn_class||"btn-default")+" "+(n.btn_size||"btn-sm")+' ellipsis">\n\t\t\t\t'+(n.icon?frappe.utils.icon(n.icon):"")+"\n\t\t\t\t"+e+"\n\t\t</button>");return this.add_menu_item(e,t,!1).parent().addClass("hidden-xl"),r.appendTo(this.custom_actions),r.on("click",t),this.custom_actions.removeClass("hide"),r},add_custom_button_group:function(e,t,n){var r='<span class="hidden-xs">\n\t\t\t<span class="custom-btn-group-label">'+__(e)+"</span>\n\t\t\t"+frappe.utils.icon("select","xs")+"\n\t\t</span>";t&&(r='<span class="hidden-xs">\n\t\t\t\t'+frappe.utils.icon(t)+'\n\t\t\t\t<span class="custom-btn-group-label">'+__(e)+"</span>\n\t\t\t\t"+frappe.utils.icon("select","xs")+'\n\t\t\t</span>\n\t\t\t<span class="visible-xs">\n\t\t\t\t'+frappe.utils.icon(t)+"\n\t\t\t</span>");var i=$('\n\t\t\t<div class="custom-btn-group">\n\t\t\t\t<button type="button" class="btn btn-default btn-sm ellipsis" data-toggle="dropdown" aria-expanded="false">\n\t\t\t\t\t'+r+'\n\t\t\t\t</button>\n\t\t\t\t<ul class="dropdown-menu" role="menu"></ul>\n\t\t\t</div>\n\t\t');return n||(n=this.custom_actions),n.removeClass("hide").append(i),i.find(".dropdown-menu")},add_dropdown_button:function(e,t,n,r){frappe.ui.toolbar.add_dropdown_button(e,t,n,r)},add_label:function(e){return this.show_form(),$("<label class='col-md-1 page-only-label'>"+e+" </label>").appendTo(this.page_form)},add_select:function(e,t){return this.add_field({label:e,fieldtype:"Select"}).$wrapper.find("select").empty().add_options(t)},add_data:function(e){return this.add_field({label:e,fieldtype:"Data"}).$wrapper.find("input").attr("placeholder",e)},add_date:function(e,t){return this.add_field({label:e,fieldtype:"Date",default:t}).$wrapper.find("input").attr("placeholder",e)},add_check:function(e){return $("<div class='checkbox'><label><input type='checkbox'>"+e+"</label></div>").appendTo(this.page_form).find("input")},add_break:function(){this.page_form.append('<div class="clearfix invisible-xs"></div>')},add_field:function(e,t){this.show_form(),e.placeholder||(e.placeholder=e.label),e.input_class="input-xs";var n=frappe.ui.form.make_control({df:e,parent:t||this.page_form,only_input:"Check"!=e.fieldtype});if(n.refresh(),$(n.wrapper).addClass("col-md-2").attr("title",__(e.label)).tooltip({delay:{show:600,hide:100},trigger:"hover"}),"HTML"!=e.fieldtype)return n.$input||n.make_input(),n.$input.attr("placeholder",__(e.label)),"Check"===e.fieldtype&&$(n.wrapper).find(":first-child").removeClass("col-md-offset-4 col-md-8"),"Button"==e.fieldtype&&($(n.wrapper).find(".page-control-label").html("&nbsp;"),n.$input.addClass("btn-xs").css({width:"100%","margin-top":"-1px"})),e.default&&n.set_input(e.default),this.fields_dict[e.fieldname||e.label]=n,n},clear_fields:function(){this.page_form.empty()},show_form:function(){this.page_form.removeClass("hide")},hide_form:function(){this.page_form.addClass("hide")},get_form_values:function(){var e={};return this.page_form.fields_dict.forEach(function(t,n){e[n]=t.get_value()}),e},add_view:function(e,t){var n=t;return"string"==typeof t&&(n=$(t)),this.views[e]=n.appendTo($(this.wrapper).find(".page-content")),this.current_view?this.views[e].toggle(!1):this.current_view=this.views[e],this.views[e]},set_view:function(e){this.current_view_name!==e&&(this.current_view&&this.current_view.toggle(!1),this.current_view=this.views[e],this.previous_view_name=this.current_view_name,this.current_view_name=e,this.views[e].toggle(!0),this.wrapper.trigger("view-change"))}}),frappe.provide("frappe.ui"),frappe.ui.Slide=class{constructor(e){void 0===e&&(e=null),$.extend(this,e),this.setup()}setup(){this.$wrapper=$('<div class="slide-wrapper hidden"></div>').attr({"data-slide-id":this.id,"data-slide-name":this.name}).appendTo(this.parent)}make(){this.before_load&&this.before_load(this),this.$body=$('<div class="slide-body">\n\t\t\t<div class="content text-center">\n\t\t\t\t<h1 class="title slide-title">'+this.title+'</h1>\n\t\t\t</div>\n\t\t\t<div class="form-wrapper">\n\t\t\t\t<div class="form"></div>\n\t\t\t\t<div class="add-more text-center" style="margin-top: 5px;">\n\t\t\t\t\t<button class="form-more-btn hide btn btn-default btn-xs">\n\t\t\t\t\t\t<span>Add More</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>').appendTo(this.$wrapper),this.$content=this.$body.find(".content"),this.$form=this.$body.find(".form"),this.$primary_btn=this.slides_footer.find(".primary"),this.$form_wrapper=this.$body.find(".form-wrapper"),this.image_src&&this.$content.append($('<img src="'+this.image_src+'" style="margin: 20px;">')),this.help&&this.$content.append($('<p class="slide-help">'+this.help+"</p>")),this.reqd_fields=[],this.refresh(),this.made=!0}refresh(){this.render_parent_dots(),this.done?this.setup_done_state():this.setup_form()}setup_form(){this.form=new frappe.ui.FieldGroup({fields:this.get_atomic_fields(),body:this.$form[0],no_submit_on_enter:!0}),this.form.make(),this.add_more&&this.bind_more_button(),this.set_reqd_fields(),this.onload&&this.onload(this),this.set_reqd_fields()}setup_done_state(){}get_atomic_fields(){var e=this,t=JSON.parse(JSON.stringify(this.fields));return this.add_more&&(this.count=1,t=t.map(function(t,n){return t.fieldname&&(t.fieldname+="_1"),1===n&&e.mandatory_entry&&(t.reqd=1),t.static||t.label&&t.label,t})),t}set_reqd_fields(){var e=this,t=this.form.fields_dict;this.reqd_fields=[],Object.keys(t).map(function(n){t[n].df.reqd&&e.reqd_fields.push(t[n])})}set_values(){return this.values=this.form.get_values(),null!==this.values&&!(this.validate&&!this.validate())}bind_more_button(){var e=this;this.$more=this.$body.find(".form-more-btn"),this.$more.removeClass("hide").on("click",function(){e.count++;var t=JSON.parse(JSON.stringify(e.fields));e.form.add_fields(t.map(function(t){return t.fieldname&&(t.fieldname+="_"+e.count),t.static||t.label&&t.label,t.reqd=0,t})),e.count===e.max_count&&e.$more.addClass("hide")})}resetup_primary_button(){this.unbind_primary_action(),this.bind_fields_to_action_btn(),this.reset_action_button_state(),this.bind_primary_action()}bind_fields_to_action_btn(){var e=this;this.reqd_fields.map(function(t){t.$wrapper.on("change input click",function(){e.reset_action_button_state()}),t.$wrapper.on("keydown","input",function(t){"Enter"==t.key&&e.reset_action_button_state()})})}reset_action_button_state(){this.reqd_fields.filter(function(e){return!e.get_value()}).length?this.slides_footer.find(".action").addClass("disabled"):this.slides_footer.find(".action").removeClass("disabled")}unbind_primary_action(){this.slides_footer.find(".primary").off()}bind_primary_action(){var e=this;this.slides_footer.find(".primary").on("click.primary_action",function(){e.primary_action()})}is_last_slide(){return this.id===this.parent[0].children.length-1}before_show(){}show_slide(){this.$wrapper.removeClass("hidden"),this.before_show(),this.resetup_primary_button(),this.done?this.$primary_btn.hide():(this.$body.find(".form-control").first().focus(),this.$primary_btn.show())}hide_slide(){this.$wrapper.addClass("hidden")}get_input(e){return this.form.get_input(e)}get_field(e){return this.form.get_field(e)}get_value(e){return this.form.get_value(e)}destroy(){this.$body.remove()}primary_action(){}},frappe.ui.Slides=class{constructor(e){var t=e.parent;void 0===t&&(t=null);var n=e.slides;void 0===n&&(n=[]);var r=e.slide_class;void 0===r&&(r=null);var i=e.unidirectional;void 0===i&&(i=0);var a=e.done_state;void 0===a&&(a=0);var o=e.before_load;void 0===o&&(o=null);var s=e.on_update;void 0===s&&(s=null),this.parent=t,this.slides=n,this.slide_class=r,this.unidirectional=i,this.done_state=a,this.before_load=o,this.on_update=s,this.page_name="setup-wizard",this.slide_dict={},this.made_slide_ids=[],this.values={},this.make()}make(){this.$slide_progress=$("<div>").addClass("slides-progress text-center text-extra-muted").appendTo(this.parent),this.container=$("<div>").addClass("slides-wrapper").attr({tabindex:-1}).appendTo(this.parent),this.$body=$("<div>").addClass("slide-container").appendTo(this.container),this.$footer=$("<div>").addClass("slide-footer").appendTo(this.container),this.render_progress_dots(),this.make_prev_next_buttons(),this.before_load&&this.before_load(this.$footer),this.setup(),this.show_slide(0)}setup(){var e=this;this.slides.map(function(t,n){e.slide_dict[n]?e.made_slide_ids.includes(n+"")&&(e.slide_dict[n].destroy(),e.slide_dict[n].make()):(e.slide_dict[n]=new e.slide_class($.extend(e.slides[n],{parent:e.$body,slides_footer:e.$footer,render_parent_dots:e.render_progress_dots.bind(e),id:n})),e.unidirectional||e.slide_dict[n].make())})}refresh(e){this.render_progress_dots(),this.show_hide_prev_next(e),this.$body.find(".form-control").first().focus()}render_progress_dots(){var e=this;this.$slide_progress.empty(),this.slides.map(function(t,n){var r=$('<div class="slide-step">\n\t\t\t\t<div class="slide-step-indicator"></div>\n\t\t\t\t<div class="slide-step-complete">'+frappe.utils.icon("tick","xs")+"</div>\n\t\t\t</div>").attr({"data-step-id":n});e.done_state&&(e.slide_dict[n]&&e.slide_dict[n].done||t.done)&&r.addClass("step-success"),e.unidirectional&&n===e.current_id&&r.addClass("active"),e.$slide_progress.append(r)}),this.completed=0,this.slides.map(function(t,n){e.slide_dict[n]?e.slide_dict[n].done&&e.completed++:t.done&&e.completed++}),this.on_update&&this.on_update(this.completed,this.slides.length),this.unidirectional||this.bind_progress_dots()}make_prev_next_buttons(){var e=this;$('<div class="row">\n\t\t\t<div class="col-sm-4 text-left prev-div">\n\t\t\t\t<button class="prev-btn btn btn-secondary btn-sm" tabindex="0">'+__("Previous")+'</button>\n\t\t\t</div>\n\t\t\t<div class="col-sm-8 text-right next-div">\n\t\t\t\t<button class="next-btn btn btn-default btn-sm" tabindex="0">'+__("Next")+"</button>\n\t\t\t</div>\n\t\t</div>").appendTo(this.$footer),this.$prev_btn=this.$footer.find(".prev-btn").attr("tabIndex",0).on("click",function(){return e.show_slide(e.current_id-1)}),this.$next_btn=this.$footer.find(".next-btn").attr("tabIndex",0).on("click",function(){e.done_state&&(e.slide&&(e.slide.done=!0),e.current_slide&&(e.current_slide.done=!0)),(!e.unidirectional||e.unidirectional&&e.current_slide.set_values())&&e.show_slide(e.current_id+1)})}bind_progress_dots(){var e=this;this.$slide_progress.find(".fa-circle").addClass("link").on("click",function(){var t=$(this).attr("data-step-id");e.show_slide(t)})}before_show_slide(){return!0}show_slide(e){e=cint(e),!this.before_show_slide()||this.current_slide&&this.current_id===e||(this.update_values(),this.current_slide&&this.current_slide.hide_slide(),this.unidirectional&&!this.slide_dict[e].made&&this.slide_dict[e].make(),this.current_id=e,this.current_slide=this.slide_dict[e],this.current_slide.show_slide(),this.refresh(e))}destroy_slide(e){this.slide_dict[e]&&this.slide_dict[e].destroy(),this.slide_dict[e]=null}on_update(e,t){}show_hide_prev_next(e){0===e?this.$prev_btn.hide():this.$prev_btn.show(),e+1===this.slides.length?this.$next_btn.hide():this.$next_btn.show()}get_values(){var e={};return $.each(this.slide_dict,function(t,n){n.values&&$.extend(e,n.values)}),e}update_values(){this.values=$.extend(this.values,this.get_values())}},frappe.find={page_primary_action:function(){return $(".page-actions:visible .btn-primary")},field:function(e,t){return new Promise(function(n){var r=$('[data-fieldname="'+e+'"] :input');t?(r.val(t).trigger("change"),frappe.after_ajax(function(){n(r)})):n(r)})}},frappe.ui.IconBar=Class.extend({init:function(e,t){this.parent=e,this.buttons={},this.make(t)},make:function(e){this.$wrapper=$('<div class="iconbar-wrapper hide"></div>').appendTo(this.parent);for(var t=0;t<e;t++)this.get_group(t+1)},get_group:function(e){var t=this.$wrapper.find(".iconbar-"+e+" ul");return t.length||(t=$('<div class="iconbar iconbar-'+e+' hide"><ul></ul></div>').appendTo(this.$wrapper).find("ul")),t},add_btn:function(e,t,n,r){var i=this.get_group(e),a=$('<li><i class="'+t+'"></i></li>').appendTo(i).on("click",function(){return r.apply(this),!1});return a.find("i").attr("title",n).tooltip({delay:{show:600,hide:100},trigger:"hover"}),this.$wrapper.find(".iconbar-"+e).removeClass("hide"),this.show(),a},hide:function(e){e?(this.$wrapper.find(".iconbar-"+e).addClass("hide"),this.check_if_all_hidden()):this.$wrapper.addClass("hide").trigger("hidden")},show:function(e){e?(this.$wrapper.find(".iconbar-"+e).removeClass("hide"),this.show()):this.$wrapper.hasClass("hide")&&this.$wrapper.removeClass("hide").trigger("shown")},clear:function(e){this.$wrapper.find(".iconbar-"+e).addClass("hide").find("ul").empty(),this.check_if_all_hidden()},check_if_all_hidden:function(){this.$wrapper.find(".iconbar:visible").length||this.hide()}}),frappe.ui.form.LinkSelector=Class.extend({init:function(e){$.extend(this,e);var t=this;"[Select]"!=this.doctype?frappe.model.with_doctype(this.doctype,function(e){t.make()}):this.make()},make:function(){var e=this;this.start=0,this.dialog=new frappe.ui.Dialog({title:__("Select {0}",["[Select]"==this.doctype?__("value"):__(this.doctype)]),fields:[{fieldtype:"Data",fieldname:"txt",label:__("Beginning with"),description:__("You can use wildcard %")},{fieldtype:"HTML",fieldname:"results"},{fieldtype:"Button",fieldname:"more",label:__("More"),click:function(){e.start+=20,e.search()}}],primary_action_label:__("Search"),primary_action:function(){e.start=0,e.search()}}),this.txt&&this.dialog.fields_dict.txt.set_input(this.txt),this.dialog.get_input("txt").on("keypress",function(t){13===t.which&&(e.start=0,e.search())}),this.dialog.show(),this.search()},search:function(){var e={txt:this.dialog.fields_dict.txt.get_value(),searchfield:"name",start:this.start},t=this;this.target.set_custom_query&&this.target.set_custom_query(e),this.target.is_grid&&this.target.fieldinfo[this.fieldname]&&this.target.fieldinfo[this.fieldname].get_query&&$.extend(e,this.target.fieldinfo[this.fieldname].get_query(cur_frm.doc)),frappe.link_search(this.doctype,e,function(n){var r=t.dialog.fields_dict.results.$wrapper;(0===e.start&&r.empty(),n.values.length?$.each(n.values,function(e,n){$(repl('<div class="row link-select-row">\t\t\t\t\t\t<div class="col-xs-4">\t\t\t\t\t\t\t<b><a href="#">%(name)s</a></b></div>\t\t\t\t\t\t<div class="col-xs-8">\t\t\t\t\t\t\t<span class="text-muted">%(values)s</span></div>\t\t\t\t\t\t</div>',{name:n[0],values:n.splice(1).join(", ")})).appendTo(r).find("a").attr("data-value",n[0]).click(function(){var e=$(this).attr("data-value");return t.target.is_grid?t.set_in_grid(e):(t.target.doctype?t.target.parse_validate_and_set_in_model(e):(t.target.set_input(e),t.target.$input.trigger("change")),t.dialog.hide()),!1})}):$('<p><br><span class="text-muted">'+__("No Results")+"</span>"+(frappe.model.can_create(t.doctype)?'<br><br><a class="new-doc btn btn-default btn-sm">'+__("Create a new {0}",[__(t.doctype)])+"</a>":"")+"</p>").appendTo(r).find(".new-doc").click(function(){frappe.new_doc(t.doctype)}),n.values.length<20)&&t.dialog.fields_dict.more.$wrapper.hide()},this.dialog.get_primary_btn())},set_in_grid:function(e){var t=this,n=!1,r=null;if(this.qty_fieldname)frappe.prompt({fieldname:"qty",fieldtype:"Float",label:"Qty",default:1,reqd:1},function(i){$.each(t.target.frm.doc[t.target.df.fieldname]||[],function(r,a){if(a[t.fieldname]===e)return frappe.model.set_value(a.doctype,a.name,t.qty_fieldname,i.qty),frappe.show_alert(__("Added {0} ({1})",[e,a[t.qty_fieldname]])),n=!0,!1}),n||frappe.run_serially([function(){r=t.target.add_new_row()},function(){return frappe.timeout(.1)},function(){var n={};return n[t.fieldname]=e,n[t.qty_fieldname]=i.qty,frappe.model.set_value(r.doctype,r.name,n)},function(){return frappe.show_alert(__("Added {0} ({1})",[e,i.qty]))}])},__("Set Quantity"),__("Set"));else if(t.dynamic_link_field){r=t.target.add_new_row();frappe.model.set_value(r.doctype,r.name,t.dynamic_link_field,t.dynamic_link_reference),frappe.model.set_value(r.doctype,r.name,t.fieldname,e),frappe.show_alert(__("{0} {1} added",[t.dynamic_link_reference,e]))}else{r=t.target.add_new_row();frappe.model.set_value(r.doctype,r.name,t.fieldname,e),frappe.show_alert(__("{0} added",[e]))}}}),frappe.link_search=function(e,t,n,r){t||(t={txt:""}),t.doctype=e,t.searchfield||(t.searchfield="name"),frappe.call({method:"frappe.desk.search.search_widget",type:"GET",args:t,callback:function(e){n&&n(e)},btn:r})},frappe.ui.form.MultiSelectDialog=class{constructor(e){var t=this;Object.assign(this,e),this.for_select="[Select]"==this.doctype,this.for_select?this.init():frappe.model.with_doctype(this.doctype,function(){return t.init()})}init(){this.page_length=20,this.child_page_length=20,this.fields=this.get_fields(),this.make()}get_fields(){var e=this.get_primary_filters(),t=this.get_result_fields(),n=this.get_data_fields(),r=this.get_child_selection_fields();return e.concat(t,n,r)}get_result_fields(){var e=this;return[{fieldtype:"HTML",fieldname:"results_area"},{fieldtype:"Button",fieldname:"more_btn",label:__("More"),click:function(){e.page_length+=20,e.get_results()}.bind(this)}]}get_data_fields(){return this.data_fields&&this.data_fields.length?[{fieldtype:"Section Break"}].concat(this.data_fields):[]}get_child_selection_fields(){var e=this,t=[];if(this.allow_child_item_selection&&this.child_fieldname){t.push({fieldtype:"HTML",fieldname:"child_selection_area"}),t.push({fieldtype:"Button",fieldname:"more_child_btn",hidden:1,label:__("More"),click:function(){e.child_page_length+=20,e.show_child_results()}.bind(this)})}return t}make(){var e=this,t=this.doctype.plural(),n=__("Select {0}",[this.for_select?__("value"):__(t)]);this.dialog=new frappe.ui.Dialog({title:n,fields:this.fields,size:this.size,primary_action_label:this.primary_action_label||__("Get Items"),secondary_action_label:__("Make {0}",[__(this.doctype)]),primary_action:function(){var t=e.get_custom_filters(),n=cur_dialog.get_values(),r=e.get_selected_child_names(),i=e.get_checked_values().concat(e.get_parent_name_of_selected_children());e.action(i,Object.assign({},e.args,n,t,{filtered_children:r}))},secondary_action:this.make_new_document.bind(this)}),this.add_filters_group&&this.make_filter_area(),this.args={},this.setup_results(),this.bind_events(),this.get_results(),this.dialog.show()}make_new_document(e){e&&(this.set_route_options(),frappe.new_doc(this.doctype,!0))}set_route_options(){var e=this;if(frappe.route_options={},Array.isArray(this.setters))for(var t=0,n=this.setters;t<n.length;t+=1){var r=n[t];frappe.route_options[r.fieldname]=this.dialog.fields_dict[r.fieldname].get_value()||void 0}else Object.keys(this.setters).forEach(function(t){frappe.route_options[t]=e.dialog.fields_dict[t].get_value()||void 0})}setup_results(){this.$parent=$(this.dialog.body),this.$wrapper=this.dialog.fields_dict.results_area.$wrapper.append('<div class="results my-3"\n\t\t\tstyle="border: 1px solid #d1d8dd; border-radius: 3px; height: 300px; overflow: auto;"></div>'),this.$results=this.$wrapper.find(".results"),this.$results.append(this.make_list_row())}show_child_results(){var e=this;this.get_child_result().then(function(t){e.child_results=t.message||[],e.render_child_datatable(),e.$wrapper.addClass("hidden"),e.$child_wrapper.removeClass("hidden"),e.dialog.fields_dict.more_btn.$wrapper.hide()})}toggle_child_selection(){this.dialog.fields_dict.allow_child_item_selection.get_value()?this.show_child_results():(this.child_results=[],this.get_results(),this.$wrapper.removeClass("hidden"),this.$child_wrapper.addClass("hidden"))}render_child_datatable(){var e=this;this.child_datatable?setTimeout(function(){e.child_datatable.rowmanager.checkMap=[],e.child_datatable.refresh(e.get_child_datatable_rows()),e.$child_wrapper.find(".dt-scrollable").css("height","300px"),e.$child_wrapper.find(".dt-scrollable").css("overflow-y","scroll")},500):this.setup_child_datatable()}get_child_datatable_columns(){return[this.doctype].concat(this.child_columns).map(function(e){return{name:frappe.unscrub(e),editable:!1}})}get_child_datatable_rows(){return this.child_results.length>this.child_page_length?this.dialog.fields_dict.more_child_btn.toggle(!0):this.dialog.fields_dict.more_child_btn.toggle(!1),this.child_results.slice(0,this.child_page_length).map(function(e){return Object.values(e).slice(1)})}setup_child_datatable(){var e=this.get_child_datatable_columns(),t=this.get_child_datatable_rows();this.$child_wrapper=this.dialog.fields_dict.child_selection_area.$wrapper,this.$child_wrapper.addClass("my-3"),this.child_datatable=new frappe.DataTable(this.$child_wrapper.get(0),{columns:e,data:t,layout:"fluid",inlineFilters:!0,serialNoColumn:!1,checkboxColumn:!0,cellHeight:35,noDataMessage:__("No Data"),disableReorderColumn:!0}),this.$child_wrapper.find(".dt-scrollable").css("height","300px")}get_primary_filters(){var e=this,t=[],n=new Array(3);return n[0]=[{fieldtype:"Data",label:__("Name"),fieldname:"search_term"}],n[1]=[],n[2]=[],$.isArray(this.setters)?this.setters.forEach(function(e,t){n[(t+1)%3].push(e)}):Object.keys(this.setters).forEach(function(t,r){var i=frappe.meta.docfield_map[e.doctype][t];n[(r+1)%3].push({fieldtype:i.fieldtype,label:i.label,fieldname:t,options:i.options,default:e.setters[t]})}),Object.seal&&Object.seal(n),this.allow_child_item_selection&&(this.child_doctype=frappe.meta.get_docfield(this.doctype,this.child_fieldname).options,n[0].push({fieldtype:"Check",label:__("Select {0}",[this.child_doctype]),fieldname:"allow_child_item_selection",onchange:this.toggle_child_selection.bind(this)})),t=n[0].concat([{fieldtype:"Column Break"}],n[1],[{fieldtype:"Column Break"}],n[2],[{fieldtype:"Section Break",fieldname:"primary_filters_sb"}]),this.add_filters_group&&t.push({fieldtype:"HTML",fieldname:"filter_area"}),t}make_filter_area(){var e=this;this.filter_group=new frappe.ui.FilterGroup({parent:this.dialog.get_field("filter_area").$wrapper,doctype:this.doctype,on_change:function(){e.get_results()}}),this.filter_group.wrapper.find(".apply-filters").hide()}get_custom_filters(){return this.add_filters_group&&this.filter_group?this.filter_group.get_filters().reduce(function(e,t){var n;return Object.assign(e,((n={})[t[1]]=[t[2],t[3]],n))},{}):{}}bind_events(){var e=this,t=this;this.$results.on("click",".list-item-container",function(e){$(e.target).is(":checkbox")||$(e.target).is("a")||$(this).find(":checkbox").trigger("click")}),this.$results.on("click",".list-item--head :checkbox",function(t){e.$results.find(".list-item-container .list-row-check").prop("checked",$(t.target).is(":checked"))}),this.$parent.find(".input-with-feedback").on("change",function(){frappe.flags.auto_scroll=!1,e.get_results()}),this.$parent.find('[data-fieldtype="Data"]').on("input",function(){var n=$(e);clearTimeout(n.data("timeout")),n.data("timeout",setTimeout(function(){frappe.flags.auto_scroll=!1,t.empty_list(),t.get_results()},300))})}get_parent_name_of_selected_children(){var e=this;return this.child_datatable&&this.child_datatable.datamanager.rows.length?this.child_datatable.rowmanager.checkMap.reduce(function(t,n,r){if(1==n){var i=e.child_results[r].parent;t.includes(i)||t.push(i)}return t},[]):[]}get_selected_child_names(){var e=this;return this.child_datatable&&this.child_datatable.datamanager.rows.length?this.child_datatable.rowmanager.checkMap.reduce(function(t,n,r){if(1==n){var i=e.child_results[r].name;t.push(i)}return t},[]):[]}get_checked_values(){return this.$results.find(".list-item-container").map(function(){if($(this).find(".list-row-check:checkbox:checked").length>0)return $(this).attr("data-item-name")}).get()}get_checked_items(){var e=this.get_checked_values();return this.results.filter(function(t){return e.includes(t.name)})}make_list_row(e){void 0===e&&(e={});var t=this,n=0===Object.keys(e).length,r="",i=["name"];if($.isArray(this.setters))for(var a=0,o=this.setters;a<o.length;a+=1){var s=o[a];i.push(s.fieldname)}else i=i.concat(Object.keys(this.setters));i.forEach(function(i){r+='<div class="list-item__content ellipsis">\n\t\t\t\t'+(n?'<span class="ellipsis text-muted" title="'+__(frappe.model.unscrub(i))+'">'+__(frappe.model.unscrub(i))+"</span>":"name"!==i?'<span class="ellipsis result-row" title="'+__(e[i]||"")+'">'+__(e[i]||"")+"</span>":'<a href="'+("/app/"+frappe.router.slug(t.doctype)+"/"+e[i]||"")+'" class="list-id ellipsis" title="'+__(e[i]||"")+'">\n\t\t\t\t\t\t\t'+__(e[i]||"")+"</a>")+"\n\t\t\t</div>"});var l=$('<div class="list-item">\n\t\t\t<div class="list-item__content" style="flex: 0 0 10px;">\n\t\t\t\t<input type="checkbox" class="list-row-check" data-item-name="'+e.name+'" '+(e.checked?"checked":"")+">\n\t\t\t</div>\n\t\t\t"+r+"\n\t\t</div>");return n?l.addClass("list-item--head"):l=$('<div class="list-item-container" data-item-name="'+e.name+'"></div>').append(l),l}render_result_list(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!0);var r=this,i=r.dialog.fields_dict.more_btn.$wrapper;if(!frappe.flags.auto_scroll&&n&&this.empty_list(),i.hide(),$(".modal-dialog .list-item--head").css("z-index",1),0!==e.length){t&&i.show();var a=this.get_checked_values();e.filter(function(e){return!a.includes(e.name)}).forEach(function(e){r.$results.append(r.make_list_row(e))}),this.$results.find(".list-item--head").css("z-index",1),frappe.flags.auto_scroll&&this.$results.animate({scrollTop:r.$results.prop("scrollHeight")},500)}}empty_list(){var e=this.get_checked_items().map(function(e){return Object.assign({},e,{checked:!0})});this.$results.find(".list-item-container").remove(),this.render_result_list(e,0,!1)}get_filters_from_setters(){var e=this,t=this.get_query?this.get_query().filters:{}||{},n=[];if($.isArray(this.setters))for(var r=0,i=this.setters;r<i.length;r+=1){var a=i[r];t[a.fieldname]=e.dialog.fields_dict[a.fieldname].get_value()||void 0,e.args[a.fieldname]=t[a.fieldname],n.push(a.fieldname)}else Object.keys(this.setters).forEach(function(r){var i=e.dialog.fields_dict[r].get_value();"Data"==e.dialog.fields_dict[r].df.fieldtype&&i?t[r]=["like","%"+i+"%"]:(t[r]=i||void 0,e.args[r]=t[r],n.push(r))});return[t,n]}get_args_for_search(){var e=this.get_filters_from_setters(),t=e[0],n=e[1],r=this.get_custom_filters();return Object.assign(t,r),{doctype:this.doctype,txt:this.dialog.fields_dict.search_term.get_value(),filters:t,filter_fields:n,page_length:this.page_length+5,query:this.get_query?this.get_query().query:"",as_dict:1}}async perform_search(e){var t=await frappe.call({type:"GET",method:"frappe.desk.search.search_widget",no_spinner:!0,args:e});return[t,t.values.length&&t.values.length>this.page_length?1:0]}async get_results(){var e=this,t=this.get_args_for_search(),n=await this.perform_search(t),r=n[0],i=n[1];i&&(r.values=r.values.splice(0,this.page_length)),this.results=[],r.values.length&&r.values.forEach(function(t){t.checked=0,e.results.push(t)}),this.render_result_list(this.results,i)}async get_filtered_parents_for_child_search(){var e=this.get_args_for_search();e.filter_fields=["name"];var t=await this.perform_search(e),n=t[0],r=(t[1],[]);return n.values.length&&(r=n.values.map(function(e){return e.name})),r}async add_parent_filters(e){var t=await this.get_filtered_parents_for_child_search();t.length&&e.push(["parent","in",t])}add_custom_child_filters(e){var t=this;this.add_filters_group&&this.filter_group&&this.filter_group.get_filters().forEach(function(n){n[0]==t.child_doctype&&e.push([n[1],n[2],n[3]])})}async get_child_result(){var e=[["parentfield","=",this.child_fieldname]];return await this.add_parent_filters(e),this.add_custom_child_filters(e),frappe.call({method:"frappe.client.get_list",args:{doctype:this.child_doctype,filters:e,fields:["name","parent"].concat(this.child_columns),parent:this.doctype,limit_page_length:this.child_page_length+5,order_by:"parent"}})}},frappe._.get_data_uri=function(e){var t=e.videoWidth,n=e.videoHeight,r=$("<canvas/>");return r[0].width=t,r[0].height=n,r[0].getContext("2d").drawImage(e,0,0,t,n),r[0].toDataURL("image/png")},frappe.ui.Capture=class{constructor(e){void 0===e&&(e={}),this.options=frappe.ui.Capture.OPTIONS,this.set_options(e)}set_options(e){return this.options=Object.assign({},frappe.ui.Capture.OPTIONS,e),this}render(){var e=this;return navigator.mediaDevices.getUserMedia({video:!0}).then(function(t){e.stream=t,e.dialog=new frappe.ui.Dialog({title:e.options.title,animate:e.options.animate,on_hide:function(){return e.stop_media_stream()}}),e.dialog.get_close_btn().on("click",function(){e.hide()});var n=function(){e.dialog.set_primary_action(__("Take Photo"),function(){var t=frappe._.get_data_uri(i);r.find(".fc-p").attr("src",t),r.find(".fc-s").hide(),r.find(".fc-p").show(),e.dialog.set_secondary_action_label(__("Retake")),e.dialog.get_secondary_btn().show(),e.dialog.set_primary_action(__("Submit"),function(){e.hide(),e.callback&&e.callback(t)})})};n(),e.dialog.set_secondary_action(function(){r.find(".fc-p").hide(),r.find(".fc-s").show(),e.dialog.get_secondary_btn().hide(),e.dialog.get_primary_btn().off("click"),n()}),e.dialog.get_secondary_btn().hide();var r=$(frappe.ui.Capture.TEMPLATE),i=r.find("video")[0];i.srcObject=e.stream,i.play(),$(e.dialog.body).html(r)})}show(){var e=this;this.render().then(function(){e.dialog.show()}).catch(function(t){throw e.options.error&&frappe.show_alert(frappe.ui.Capture.ERR_MESSAGE,3),t})}hide(){this.dialog&&this.dialog.hide(),this.stop_media_stream()}stop_media_stream(){this.stream&&this.stream.getTracks().forEach(function(e){e.stop()})}submit(e){this.callback=e}},frappe.ui.Capture.OPTIONS={title:__("Camera"),animate:!1,error:!1},frappe.ui.Capture.ERR_MESSAGE=__("Unable to load camera."),frappe.ui.Capture.TEMPLATE='\n<div class="frappe-capture">\n\t<div class="panel panel-default">\n\t\t<div class="embed-responsive embed-responsive-16by9">\n\t\t\t<img class="fc-p embed-responsive-item" style="object-fit: contain; display: none;"/>\n\t\t\t<video class="fc-s embed-responsive-item">'+frappe.ui.Capture.ERR_MESSAGE+"</video>\n\t\t</div>\n\t</div>\n</div>\n",frappe.provide("frappe.ui"),frappe.ui.app_icon={get_html:function(e,t){var n=e.icon,r=e.color;n&&n.match(/([\uE000-\uF8FF]|\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDDFF])/g)&&(e.emoji=e.icon);var i="";return e.reverse&&(i="color: #36414C;"),r||(r="#4aa3df"),!n||e.emoji?n='<span class="inner" '+(e.reverse?'style="'+i+'"':"")+">"+(e.emoji||e._label[0].toUpperCase())+"</span>":"svg"===n.split(".").slice(-1)[0]?($.ajax({url:frappe.urllib.get_full_url(n),dataType:"text",async:!1,success:function(e){n=e}}),n='<object class="app-icon-svg">'+n+"</object>"):n='<i class="'+n+'" title="'+e._label+'" style="'+i+'"></i>','<div class="app-icon'+(t?" app-icon-small":"")+'" style="background-color: '+r+'" title="'+e._label+'">'+n+"</div>"}},frappe.provide("frappe.ui"),frappe.ui.ThemeSwitcher=class{constructor(){this.setup_dialog(),this.refresh()}setup_dialog(){this.dialog=new frappe.ui.Dialog({title:__("Switch Theme")}),this.body=$('<div class="theme-grid"></div>').appendTo(this.dialog.$body),this.bind_events()}bind_events(){var e=this;this.dialog.$wrapper.on("keydown",function(t){if(e.themes){var n,r=frappe.ui.keys.get_key(t);if("right"===r)n=1;else{if("left"!==r)return;n=-1}var i=e.themes.findIndex(function(t){return t.name===e.current_theme}),a=e.themes[i+n];if(a)return a.$html.click(),!1}})}refresh(){var e=this;this.current_theme=document.documentElement.getAttribute("data-theme")||"light",this.fetch_themes().then(function(){e.render()})}fetch_themes(){var e=this;return new Promise(function(t){e.themes=[{name:"light",label:__("Frappe Light")},{name:"dark",label:__("Timeless Night")}],t(e.themes)})}render(){var e=this;this.themes.forEach(function(t){var n=e.get_preview_html(t);n.appendTo(e.body),t.$html=n})}get_preview_html(e){var t=this,n=$('<div class="'+(this.current_theme==e.name?"selected":"")+'">\n\t\t\t<div data-theme='+e.name+'>\n\t\t\t\t<div class="background">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div class="preview-check">'+frappe.utils.icon("tick","xs")+'</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="navbar"></div>\n\t\t\t\t\t<div class="p-2">\n\t\t\t\t\t\t<div class="toolbar">\n\t\t\t\t\t\t\t<span class="text"></span>\n\t\t\t\t\t\t\t<span class="primary"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="foreground"></div>\n\t\t\t\t\t\t<div class="foreground"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="mt-3 text-center">\n\t\t\t\t<h5 class="theme-title">'+e.label+"</h5>\n\t\t\t</div>\n\t\t</div>");return n.on("click",function(){t.current_theme!==e.name&&(t.themes.forEach(function(e){e.$html.removeClass("selected")}),n.addClass("selected"),t.toggle_theme(e.name))}),n}toggle_theme(e){this.current_theme=e.toLowerCase(),document.documentElement.setAttribute("data-theme",this.current_theme),frappe.show_alert("Theme Changed",3),frappe.xcall("frappe.core.doctype.user.user.switch_theme",{theme:toTitle(e)})}show(){this.dialog.show()}hide(){this.dialog.hide()}},frappe.provide("frappe.model"),$.extend(frappe.model,{no_value_type:["Section Break","Column Break","HTML","Table","Table MultiSelect","Button","Image","Fold","Heading"],layout_fields:["Section Break","Column Break","Fold"],std_fields_list:["name","owner","creation","modified","modified_by","_user_tags","_comments","_assign","_liked_by","docstatus","parent","parenttype","parentfield","idx"],core_doctypes_list:["DocType","DocField","DocPerm","User","Role","Has Role","Page","Module Def","Print Format","Report","Customize Form","Customize Form Field","Property Setter","Custom Field","Client Script"],std_fields:[{fieldname:"name",fieldtype:"Link",label:__("ID")},{fieldname:"owner",fieldtype:"Link",label:__("Created By"),options:"User"},{fieldname:"idx",fieldtype:"Int",label:__("Index")},{fieldname:"creation",fieldtype:"Date",label:__("Created On")},{fieldname:"modified",fieldtype:"Date",label:__("Last Updated On")},{fieldname:"modified_by",fieldtype:"Data",label:__("Last Updated By")},{fieldname:"_user_tags",fieldtype:"Data",label:__("Tags")},{fieldname:"_liked_by",fieldtype:"Data",label:__("Liked By")},{fieldname:"_comments",fieldtype:"Text",label:__("Comments")},{fieldname:"_assign",fieldtype:"Text",label:__("Assigned To")},{fieldname:"docstatus",fieldtype:"Int",label:__("Document Status")}],numeric_fieldtypes:["Int","Float","Currency","Percent","Duration"],std_fields_table:[{fieldname:"parent",fieldtype:"Data",label:__("Parent")}],table_fields:["Table","Table MultiSelect"],new_names:{},events:{},user_settings:{},init:function(){frappe.realtime.on("doc_update",function(e){frappe.views.ListView.trigger_list_update(e);var t=locals[e.doctype]&&locals[e.doctype][e.name];t&&("Form"===frappe.get_route()[0]&&cur_frm.doc.doctype===t.doctype&&cur_frm.doc.name===t.name?frappe.ui.form.is_saving||e.modified==cur_frm.doc.modified||(t.__needs_refresh=!0,cur_frm.check_doctype_conflict()):t.__unsaved?t.__needs_refresh=!0:frappe.model.remove_from_locals(t.doctype,t.name))}),frappe.realtime.on("list_update",function(e){frappe.views.ListView.trigger_list_update(e)})},is_value_type:function(e){return"object"==typeof e&&(e=e.fieldtype),-1===frappe.model.no_value_type.indexOf(e)},is_non_std_field:function(e){return!frappe.model.std_fields_list.includes(e)},get_std_field:function(e,t){void 0===t&&(t=!1);var n=$.map([].concat(frappe.model.std_fields).concat(frappe.model.std_fields_table),function(t){if(t.fieldname==e)return t});if(!n.length){if(t)return{fieldname:e};frappe.msgprint(__("Unknown Column: {0}",[e]))}return n[0]},get_from_localstorage:function(e){if(localStorage["_doctype:"+e])return JSON.parse(localStorage["_doctype:"+e])},set_in_localstorage:function(e,t){try{localStorage["_doctype:"+e]=JSON.stringify(t)}catch(n){console.warn("localStorage quota exceeded, clearing doctype cache"),frappe.model.clear_local_storage(),localStorage["_doctype:"+e]=JSON.stringify(t)}},clear_local_storage:function(){for(var e in localStorage)e.startsWith("_doctype:")&&localStorage.removeItem(e)},with_doctype:function(e,t,n){if(!locals.DocType[e]){var r=null,i=null,a=frappe.model.get_from_localstorage(e);return a&&(i=a.filter(function(t){return t.name===e})[0])&&(r=i.modified),frappe.call({method:"frappe.desk.form.load.getdoctype",type:"GET",args:{doctype:e,with_parent:1,cached_timestamp:r},async:n,callback:function(n){if(n.exc)throw frappe.msgprint(__("Unable to load: {0}",[__(e)])),"No doctype";"use_cache"==n.message?frappe.model.sync(i):frappe.model.set_in_localstorage(e,n.docs),frappe.model.init_doctype(e),n.user_settings&&(frappe.model.user_settings[e]=JSON.parse(n.user_settings),frappe.model.user_settings[e].updated_on=moment().toString()),t&&t(n)}})}t&&t()},init_doctype:function(doctype){var meta=locals.DocType[doctype];meta.__list_js&&eval(meta.__list_js),meta.__custom_list_js&&eval(meta.__custom_list_js),meta.__calendar_js&&eval(meta.__calendar_js),meta.__map_js&&eval(meta.__map_js),meta.__tree_js&&eval(meta.__tree_js),meta.__templates&&$.extend(frappe.templates,meta.__templates)},with_doc:function(e,t,n){return new Promise(function(r){if(t||(t=e),!(locals[e]&&locals[e][t]&&frappe.model.get_docinfo(e,t)))return frappe.call({method:"frappe.desk.form.load.getdoc",type:"GET",args:{doctype:e,name:t},callback:function(i){n&&n(t,i),r(frappe.get_doc(e,t))}});n&&n(t),r(frappe.get_doc(e,t))})},get_docinfo:function(e,t){return frappe.model.docinfo[e]&&frappe.model.docinfo[e][t]||null},set_docinfo:function(e,t,n,r){frappe.model.docinfo[e]&&frappe.model.docinfo[e][t]&&(frappe.model.docinfo[e][t][n]=r)},get_shared:function(e,t){return frappe.model.get_docinfo(e,t).shared},get_server_module_name:function(e){var t=frappe.model.scrub(e),n=frappe.model.scrub(locals.DocType[e].module);return frappe.boot.module_app[n]+"."+n+".doctype."+t+"."+t},scrub:function(e){return e.replace(/ /g,"_").toLowerCase()},unscrub:function(e){return __(e||"").replace(/-|_/g," ").replace(/\w*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},can_create:function(e){return-1!==frappe.boot.user.can_create.indexOf(e)},can_select:function(e){if(frappe.boot.user)return-1!==frappe.boot.user.can_select.indexOf(e)},can_read:function(e){if(frappe.boot.user)return-1!==frappe.boot.user.can_read.indexOf(e)},can_write:function(e){return-1!==frappe.boot.user.can_write.indexOf(e)},can_get_report:function(e){return-1!==frappe.boot.user.can_get_report.indexOf(e)},can_delete:function(e){return!!e&&-1!==frappe.boot.user.can_delete.indexOf(e)},can_cancel:function(e){return!!e&&-1!==frappe.boot.user.can_cancel.indexOf(e)},has_workflow:function(e){return frappe.get_list("Workflow",{document_type:e,is_active:1}).length},is_submittable:function(e){return!!e&&(locals.DocType[e]&&locals.DocType[e].is_submittable)},is_table:function(e){return!!e&&(locals.DocType[e]&&locals.DocType[e].istable)},is_single:function(e){return!!e&&-1!=frappe.boot.single_types.indexOf(e)},is_tree:function(e){return!!e&&-1!=frappe.boot.treeviews.indexOf(e)},is_fresh:function(e){return e&&e.__last_sync_on&&new Date-e.__last_sync_on<5e3},can_import:function(e,t){return!!frappe.user_roles.includes("System Manager")||(t?1===t.perm[0].import:-1!==frappe.boot.user.can_import.indexOf(e))},can_export:function(e,t){return!!frappe.user_roles.includes("System Manager")||(t?1===t.perm[0].export:-1!==frappe.boot.user.can_export.indexOf(e))},can_print:function(e,t){return t?1===t.perm[0].print:-1!==frappe.boot.user.can_print.indexOf(e)},can_email:function(e,t){return t?1===t.perm[0].email:-1!==frappe.boot.user.can_email.indexOf(e)},can_share:function(e,t){return t?1===t.perm[0].share:-1!==frappe.boot.user.can_share.indexOf(e)},can_set_user_permissions:function(e,t){return!!frappe.user_roles.includes("System Manager")||(t?1===t.perm[0].set_user_permissions:-1!==frappe.boot.user.can_set_user_permissions.indexOf(e))},has_value:function(e,t,n){var r=locals[e]&&locals[e][t]&&locals[e][t][n],i=frappe.meta.get_docfield(e,n,t);if(frappe.model.table_fields.includes(i.fieldtype)){var a=!1;$.each(locals[i.options]||{},function(n,r){if(r.parent==t&&r.parenttype==e&&r.parentfield==i.fieldname)return a=!0,!1})}else a=!is_null(r);return!!a},get_list:function(e,t){var n=locals[e]||locals[":"+e]||{};return $.isEmptyObject(n)?[]:frappe.utils.filter_dict(n,t)},get_value:function(e,t,n,r){if(!r){if("string"==typeof t&&locals[e]&&locals[e][t])return locals[e][t][n];var i=frappe.get_list(e,t);return i.length&&i[0]?i[0][n]:null}frappe.call({method:"frappe.client.get_value",args:{doctype:e,fieldname:n,filters:t},callback:function(e){e.exc||r(e.message)}})},set_value:function(e,t,n,r,i){var a;$.isPlainObject(e)?(a=e,r=n=t):a=locals[e]&&locals[e][t];var o=n,s=[];return $.isPlainObject(o)||((o={})[n]=r),$.each(o,function(e,t){a&&a[e]!==t?(a.__unedited&&(a[e]||t)&&(a.__unedited=!1),a[e]=t,s.push(function(){return frappe.model.trigger(e,t,a)})):in_list(["Link","Dynamic Link"],i)&&a&&s.push(function(){return frappe.model.trigger(e,t,a)})}),frappe.run_serially(s)},on:function(e,t,n){frappe.provide("frappe.model.events."+e),frappe.model.events[e][t]||(frappe.model.events[e][t]=[]),frappe.model.events[e][t].push(n)},trigger:function(e,t,n){var r=[];function i(i){if(i)for(var a=function(){var i=s[o];i&&r.push(function(){var r=i(e,t,n);return r&&r.then?r:frappe.after_server_call()})},o=0,s=i;o<s.length;o+=1)a()}return frappe.model.events[n.doctype]&&(i(frappe.model.events[n.doctype][e]),i(frappe.model.events[n.doctype]["*"])),frappe.run_serially(r)},get_doc:function(e,t){if(t||(t=e),$.isPlainObject(t)){var n=frappe.get_list(e,t);return n&&n.length?n[0]:null}return locals[e]?locals[e][t]:null},get_children:function(e,t,n,r){if($.isPlainObject(e)){var i=e;r=n,n=t}else i=frappe.get_doc(e,t);var a=i[n]||[];return r?frappe.utils.filter_dict(a,r):a},clear_table:function(e,t){for(var n=0,r=(e[t]||[]).length;n<r;n++){var i=e[t][n];delete locals[i.doctype][i.name]}e[t]=[]},remove_from_locals:function(e,t){this.clear_doc(e,t),frappe.views.formview[e]&&delete frappe.views.formview[e].frm.opendocs[t]},clear_doc:function(e,t){var n=locals[e]&&locals[e][t];if(n){var r=null;if(n.parenttype){r=n.parent;var i=n.parenttype,a=n.parentfield}if(delete locals[e][t],r){var o=locals[i][r],s=[],l=1;$.each(o[a],function(e,n){n.name!=t&&(s.push(n),n.idx=l,l++),o[a]=s})}}},get_no_copy_list:function(e){for(var t=["name","amended_from","amendment_date","cancel_reason"],n=frappe.get_doc("DocType",e).fields||[],r=0,i=n.length;r<i;r++){var a=n[r];cint(a.no_copy)&&t.push(a.fieldname)}return t},delete_doc:function(e,t,n){var r=t,i=frappe.get_meta(e).title_field;if("hash"==frappe.get_meta(e).autoname&&i){r=frappe.model.get_value(e,t,i);r+=" ("+t+")"}frappe.confirm(__("Permanently delete {0}?",[r]),function(){return frappe.call({method:"frappe.client.delete",args:{doctype:e,name:t},callback:function(r,i){r.exc||(frappe.utils.play_sound("delete"),frappe.model.clear_doc(e,t),n&&n(r,i))}})})},rename_doc:function(e,t,n){var r=__("Merge with existing")+" <b>("+__("This cannot be undone")+")</b>",i=new frappe.ui.Dialog({title:__("Rename {0}",[__(t)]),fields:[{label:__("New Name"),fieldname:"new_name",fieldtype:"Data",reqd:1,default:t},{label:r,fieldtype:"Check",fieldname:"merge"}]});i.set_primary_action(__("Rename"),function(){var r=i.get_values();if(r)return frappe.call({method:"frappe.rename_doc",args:{doctype:e,old:t,new:r.new_name,merge:r.merge},btn:i.get_primary_btn(),callback:function(a,o){a.exc||($(document).trigger("rename",[e,t,a.message||r.new_name]),locals[e]&&locals[e][t]&&delete locals[e][t],i.hide(),n&&n(a.message))}})}),i.show()},round_floats_in:function(e,t){t||(t=frappe.meta.get_fieldnames(e.doctype,e.parent,{fieldtype:["in",["Currency","Float"]]}));for(var n=0,r=t.length;n<r;n++){var i=t[n];e[i]=flt(e[i],precision(i,e))}},validate_missing:function(e,t){e[t]||frappe.throw(__("Please specify")+": "+__(frappe.meta.get_label(e.doctype,t,e.parent||e.name)))},get_all_docs:function(e){var t=[e];for(var n in e)if($.isArray(e[n]))for(var r=e[n],i=0,a=r.length;i<a;i++)t.push(r[i]);return t},get_full_column_name:function(e,t){return e.includes("`tab")?e:"`tab"+t+"`.`"+e+"`"},is_numeric_field:function(e){if(e)return"object"==typeof e&&(e=e.fieldtype),frappe.model.numeric_fieldtypes.includes(e)}}),frappe.get_doc=frappe.model.get_doc,frappe.get_children=frappe.model.get_children,frappe.get_list=frappe.model.get_list,frappe.db={get_list:function(e,t){return t||(t={}),t.doctype=e,t.fields||(t.fields=["name"]),"limit"in t||(t.limit=20),new Promise(function(e){frappe.call({method:"frappe.desk.reportview.get_list",args:t,type:"GET",callback:function(t){e(t.message)}})})},exists:function(e,t){return new Promise(function(n){frappe.db.get_value(e,{name:t},"name").then(function(e){e.message&&e.message.name?n(!0):n(!1)})})},get_value:function(e,t,n,r,i){return frappe.call({method:"frappe.client.get_value",type:"GET",args:{doctype:e,fieldname:n,filters:t,parent:i},callback:function(e){r&&r(e.message)}})},get_single_value:function(e,t){return new Promise(function(n){frappe.call({method:"frappe.client.get_single_value",args:{doctype:e,field:t},type:"GET"}).then(function(e){return n(e?e.message:null)})})},set_value:function(e,t,n,r,i){return frappe.call({method:"frappe.client.set_value",args:{doctype:e,name:t,fieldname:n,value:r},callback:function(e){i&&i(e.message)}})},get_doc:function(e,t,n){return void 0===n&&(n=null),new Promise(function(r,i){frappe.call({method:"frappe.client.get",type:"GET",args:{doctype:e,name:t,filters:n},callback:function(e){frappe.model.sync(e.message),r(e.message)}}).fail(i)})},insert:function(e){return frappe.xcall("frappe.client.insert",{doc:e})},delete_doc:function(e,t){return new Promise(function(n){frappe.call("frappe.client.delete",{doctype:e,name:t},function(e){return n(e.message)})})},count:function(e,t){void 0===t&&(t={});var n=t.filters||{},r=Array.isArray(n)&&n.some(function(t){return t[0]!==e});return frappe.xcall("frappe.desk.reportview.get_count",{doctype:e,filters:n,fields:[],distinct:r})},get_link_options:function(e,t,n){return void 0===t&&(t=""),void 0===n&&(n={}),new Promise(function(r){frappe.call({type:"GET",method:"frappe.desk.search.search_link",args:{doctype:e,txt:t,filters:n},callback:function(e){r(e.results)}})})}},frappe.provide("frappe.meta.docfield_map"),frappe.provide("frappe.meta.docfield_copy"),frappe.provide("frappe.meta.docfield_list"),frappe.provide("frappe.meta.doctypes"),frappe.provide("frappe.meta.precision_map"),frappe.get_meta=function(e){return locals.DocType?locals.DocType[e]:null},$.extend(frappe.meta,{sync:function(e){$.each(e.fields,function(e,t){frappe.meta.add_field(t)}),frappe.meta.sync_messages(e),e.__print_formats&&frappe.model.sync(e.__print_formats),e.__workflow_docs&&frappe.model.sync(e.__workflow_docs)},add_field:function(e){for(var t in frappe.provide("frappe.meta.docfield_map."+e.parent),frappe.meta.docfield_map[e.parent][e.fieldname||e.label]=e,frappe.meta.docfield_list[e.parent]||(frappe.meta.docfield_list[e.parent]=[]),frappe.meta.docfield_list[e.parent]){var n=frappe.meta.docfield_list[e.parent][t];if(e.fieldname==n.fieldname)return}frappe.meta.docfield_list[e.parent].push(e)},make_docfield_copy_for:function(e,t,n){void 0===n&&(n=null);var r=frappe.meta.docfield_copy;r[e]||(r[e]={}),r[e][t]||(r[e][t]={});for(var i=0,a=(n=n||frappe.meta.docfield_list[e]||[]).length;i<a;i++){var o=n[i];r[e][t][o.fieldname||o.label]=copy_dict(o)}},get_field:function(e,t,n){var r=frappe.meta.get_docfield(e,t,n);return r||frappe.model.std_fields.every(function(e){return e.fieldname!==t||(r=e,!1)}),r},get_docfield:function(e,t,n){var r=frappe.meta.get_docfield_copy(e,n);return r?r[t]:null},set_formatter:function(e,t,n,r){frappe.meta.get_docfield(e,t,n).formatter=r},set_indicator_formatter:function(e,t,n,r,i){frappe.meta.get_docfield(e,t,n).formatter=function(e,t,n,a){return repl('<span class="indicator %(color)s">%(name)s</span>',{color:i(),name:r()})}},get_docfields:function(e,t,n){var r=frappe.meta.get_docfield_copy(e,t),i=frappe.meta.sort_docfields(r);return n&&(i=frappe.utils.filter_dict(i,n)),i},get_linked_fields:function(e){return $.map(frappe.get_meta(e).fields,function(e){return"Link"==e.fieldtype?e.options:null})},get_fields_to_check_permissions:function(e){var t=$.map(frappe.meta.get_docfields(e,name),function(e){return"Link"===e.fieldtype&&1!==e.ignore_user_permissions?e:null});return t=t.concat({label:"Name",fieldname:name,options:e})},sort_docfields:function(e){return $.map(e,function(e){return e}).sort(function(e,t){return e.idx-t.idx})},get_docfield_copy:function(e,t){return t?(frappe.meta.docfield_copy[e]&&frappe.meta.docfield_copy[e][t]||frappe.meta.make_docfield_copy_for(e,t),frappe.meta.docfield_copy[e][t]):frappe.meta.docfield_map[e]},get_fieldnames:function(e,t,n){return $.map(frappe.utils.filter_dict(frappe.meta.docfield_map[e],n),function(e){return e.fieldname})},has_field:function(e,t){var n=frappe.meta.docfield_map[e];return n&&n[t]},get_table_fields:function(e){return $.map(frappe.meta.docfield_list[e],function(e){return frappe.model.table_fields.includes(e.fieldtype)?e:null})},get_doctype_for_field:function(e,t){var n=null;return in_list(frappe.model.std_fields_list,t)?n=e:frappe.meta.has_field(e,t)?n=e:(frappe.meta.get_table_fields(e).every(function(e){return!frappe.meta.has_field(e.options,t)||(n=e.options,!1)}),n||console.log(__("Warning: Unable to find {0} in any table related to {1}",[t,__(e)]))),n},get_parentfield:function(e,t){var n=(frappe.get_doc("DocType",e).fields||[]).filter(function(e){return frappe.model.table_fields.includes(e.fieldtype)&&e.options===t});if(!n.length)throw"parentfield not found for "+e+", "+t;return n[0].fieldname},get_label:function(e,t,n){var r={owner:__("Owner"),creation:__("Created On"),modified:__("Last Modified On"),idx:__("Idx"),name:__("Name"),modified_by:__("Last Modified By")};if(r[t])return r[t];var i=this.get_docfield(e,t,n);return(i?i.label:"")||t},get_print_sizes:function(){return["A0","A1","A2","A3","A4","A5","A6","A7","A8","A9","B0","B1","B2","B3","B4","B5","B6","B7","B8","B9","B10","C5E","Comm10E","DLE","Executive","Folio","Ledger","Legal","Letter","Tabloid","Custom"]},get_print_formats:function(e){var t=["Standard"],n=locals.DocType[e].default_print_format,r=frappe.model.get_doc(":Print Settings","Print Settings").enable_raw_printing,i=frappe.get_list("Print Format",{doc_type:e}).sort(function(e,t){return e>t?1:-1});if($.each(i,function(e,n){in_list(t,n.name)||"JS"===n.print_format_type||!cint(r)&&n.raw_printing||t.push(n.name)}),n&&"Standard"!=n){var a=t.indexOf(n);t.splice(a,1).sort(),t.unshift(n)}return t},sync_messages:function(e){e.__messages&&$.extend(frappe._messages,e.__messages)},get_field_currency:function(e,t){var n=frappe.boot.sysdefaults.currency;if(!t&&cur_frm&&(t=cur_frm.doc),e&&e.options)if(t&&-1!=e.options.indexOf(":")){var r=e.options.split(":");if(3==r.length){var i=t[r[1]];!i&&cur_frm&&(i=cur_frm.doc[r[1]]),n=frappe.model.get_value(r[0],i,r[2])||frappe.model.get_value(":"+r[0],i,r[2])||n}}else t&&t[e.options]?n=t[e.options]:cur_frm&&cur_frm.doc[e.options]&&(n=cur_frm.doc[e.options]);return n},get_field_precision:function(e,t){var n=null;if(e&&e.precision)n=cint(e.precision);else if(e&&"Currency"===e.fieldtype){if(!(n=cint(frappe.defaults.get_default("currency_precision")))){var r=get_number_format();n=get_number_format_info(r).precision}}else n=cint(frappe.defaults.get_default("float_precision"))||3;return n}}),$.extend(frappe.model,{docinfo:{},sync:function(e){var t;if(e.docs||e.docinfo||(e={docs:e}),$.isPlainObject(e.docs)&&(e.docs=[e.docs]),e.docs)for(var n=0,r=e.docs.length;n<r;n++){var i=e.docs[n];locals[i.doctype]&&locals[i.doctype][i.name]?frappe.model.update_in_locals(i):frappe.model.add_to_locals(i),i.__last_sync_on=new Date,"DocType"===i.doctype&&frappe.meta.sync(i),i.localname&&(frappe.model.new_names[i.localname]=i.name,$(document).trigger("rename",[i.doctype,i.localname,i.name]),delete locals[i.doctype][i.localname],0===n&&(frappe.model.docinfo[i.doctype][i.name]=frappe.model.docinfo[i.doctype][i.localname],frappe.model.docinfo[i.doctype][i.localname]=void 0))}e.docinfo&&(e.docs?t=e.docs[0]:cur_frm&&(t=cur_frm.doc),t&&(frappe.model.docinfo[t.doctype]||(frappe.model.docinfo[t.doctype]={}),frappe.model.docinfo[t.doctype][t.name]=e.docinfo));return e.docs},add_to_locals:function(e){locals[e.doctype]||(locals[e.doctype]={}),!e.name&&e.__islocal&&(e.parentfield||frappe.model.clear_doc(e),e.name=frappe.model.get_new_name(e.doctype),e.parentfield||frappe.provide("frappe.model.docinfo."+e.doctype+"."+e.name)),locals[e.doctype][e.name]=e;var t=frappe.get_meta(e.doctype);if(!(t?t.istable:e.parentfield))for(var n in e){var r=e[n];if($.isArray(r))for(var i=0,a=r.length;i<a;i++){var o=r[i];"object"!=typeof o||o.parent||(o.parent=e.name),frappe.model.add_to_locals(o)}}},update_in_locals:function(e){var t=locals[e.doctype][e.name],n=function(e,t){Object.keys(t).map(function(n){null==e[n]&&delete t[n]})};for(var r in e){var i=frappe.meta.get_field(e.doctype,r);if(i&&frappe.model.table_fields.includes(i.fieldtype)){e[r]instanceof Array||(e[r]=[]),t[r]instanceof Array||(t[r]=[]);for(var a=0;a<e[r].length;a++){var o=e[r][a],s=t[r][a];s?(locals[o.doctype]||(locals[o.doctype]={}),o.name||(o.name=frappe.model.get_new_name(e.doctype)),locals[o.doctype][o.name]||(delete locals[o.doctype][s.name],locals[o.doctype][o.name]=s),Object.assign(s,o),n(o,s)):(t[r].push(o),o.parent||(o.parent=e.name),frappe.model.add_to_locals(o))}if(t[r].length>e[r].length){for(var l=e[r].length;l<t[r].length;l++){var c=t[r][l];locals[c.doctype]&&locals[c.doctype][c.name]&&delete locals[c.doctype][c.name]}t[r].length=e[r].length}}else t[r]=e[r]}n(e,t)}}),frappe.provide("frappe.model"),$.extend(frappe.model,{new_names:{},new_name_count:{},get_new_doc:function(e,t,n,r){frappe.provide("locals."+e);var i={docstatus:0,doctype:e,name:frappe.model.get_new_name(e),__islocal:1,__unsaved:1,owner:frappe.session.user};if(frappe.model.set_default_values(i,t),t?($.extend(i,{parent:t.name,parentfield:n,parenttype:t.doctype}),t[n]||(t[n]=[]),i.idx=t[n].length+1,t[n].push(i)):frappe.provide("frappe.model.docinfo."+e+"."+i.name),frappe.model.add_to_locals(i),r&&frappe.model.create_mandatory_children(i),t||(i.__run_link_triggers=1),frappe.route_options&&frappe.route_options.name_field){var a=frappe.get_meta(e);a.autoname&&-1!==a.autoname.indexOf("field:")?i[a.autoname.substr(6)]=frappe.route_options.name_field:a.title_field&&(i[a.title_field]=frappe.route_options.name_field),delete frappe.route_options.name_field}return frappe.route_options&&!i.parent&&($.each(frappe.route_options,function(t,n){var r=frappe.meta.has_field(e,t);r&&in_list(["Link","Data","Select","Dynamic Link"],r.fieldtype)&&!r.no_copy&&(i[t]=n)}),frappe.route_options=null),i},make_new_doc_and_get_name:function(e,t){return frappe.model.get_new_doc(e,null,null,t).name},get_new_name:function(e){var t=frappe.model.new_name_count;return t[e]||(t[e]=0),t[e]++,frappe.router.slug("new-"+e+"-"+t[e])},set_default_values:function(e,t){for(var n=e.doctype,r=frappe.meta.get_docfields(n),i=[],a=0;a<r.length;a++){var o=r[a];if(!in_list(frappe.model.no_value_type,o.fieldtype)&&null==e[o.fieldname]){if(o.no_default)continue;var s=frappe.model.get_default_value(o,e,t);s?(in_list(["Int","Check"],o.fieldtype)?s=cint(s):in_list(["Currency","Float"],o.fieldtype)&&(s=flt(s)),e[o.fieldname]=s,i.push(o.fieldname)):"Select"==o.fieldtype&&o.options&&"string"==typeof o.options&&!in_list(["[Select]","Loading..."],o.options)&&(e[o.fieldname]=o.options.split("\n")[0])}}return i},create_mandatory_children:function(e){var t=frappe.get_meta(e.doctype);t&&t.istable||frappe.meta.get_docfields(e.doctype).forEach(function(t){"Table"===t.fieldtype&&t.reqd&&frappe.model.add_child(e,t.fieldname)})},get_default_value:function(e,t,n){var r,i="",a=frappe.defaults.get_user_permissions(),o=[],s=null,l=null;a&&(o=(r=frappe.perm.filter_allowed_docs_for_doctype(a[e.options],t.doctype)).allowed_records,s=r.default_doc);var c=frappe.get_meta(t.doctype),d="Link"===e.fieldtype&&!$.isEmptyObject(a)&&1!=e.ignore_user_permissions&&o.length;if("Link"===e.fieldtype&&"User"!==e.options)if(d&&s)l=s;else{if(!e.ignore_user_permissions){var u=frappe.defaults.get_user_defaults(e.options);u&&1===u.length&&(i=u[0])}i?!i&&e.remember_last_selected_value&&frappe.boot.user.last_selected_values&&(i=frappe.boot.user.last_selected_values[e.options]):i=frappe.defaults.get_user_default(e.fieldname),i&&(!d||o.includes(i))&&(l=i)}if(!l||e.default){var p=String(e.default);if("__user"==p||"user"==p.toLowerCase())l=frappe.session.user;else if("user_fullname"==p)l=frappe.session.user_fullname;else if("Today"==p)l=frappe.datetime.get_today();else if("now"===(p||"").toLowerCase())l=frappe.datetime.now_datetime();else if(":"===p[0]){var f=frappe.model.get_default_from_boot_docs(e,t,n);(!d||o.includes(f))&&(l=f)}else if(e.fieldname===c.title_field)l="";else{var h=!d||o.includes(e.default);("Link"!==e.fieldtype||"User"===e.options||h)&&(l=e.default)}}else"Time"==e.fieldtype&&(l=frappe.datetime.now_time());return e.__default_value=l,l},get_default_from_boot_docs:function(e,t,n){if(frappe.get_list(e.default).length>0){var r=e.default.slice(1).toLowerCase().replace(" ","_"),i=n?n[r]:frappe.defaults.get_user_default(r),a=i?frappe.get_doc(e.default,i):null;if(a&&a[e.fieldname])return a[e.fieldname]}},add_child:function(e,t,n,r){2===arguments.length&&(n=t,t=frappe.meta.get_field(e.doctype,n).options),r=r?r-.1:(e[n]||[]).length+1;var i=frappe.model.get_new_doc(t,e,n);if(i.idx=r,r!==cint(r))for(var a=e[n].sort(function(e,t){return e.idx-t.idx}),o=0,s=a.length;o<s;o++){a[o].idx=o+1}return cur_frm&&cur_frm.doc==e&&cur_frm.dirty(),i},copy_doc:function(e,t,n,r){var i=["name","amended_from","amendment_date","cancel_reason"],a=frappe.model.get_new_doc(e.doctype,n,r);for(var o in e){var s=frappe.meta.get_docfield(e.doctype,o);if(s&&"__"!=o.substr(0,2)&&!in_list(i,o)&&(!s||t||1!=cint(s.no_copy))){var l=e[o]||[];if(frappe.model.table_fields.includes(s.fieldtype))for(var c=0,d=l.length;c<d;c++){var u=l[c];frappe.model.copy_doc(u,t,a,s.fieldname)}else a[o]=e[o]}}var p=frappe.session.user;return a.__islocal=1,a.docstatus=0,a.owner=p,a.creation="",a.modified_by=p,a.modified="",a.lft=null,a.rgt=null,a},open_mapped_doc:function(e){return e.frm&&e.frm.doc.__unsaved?frappe.throw(__("You have unsaved changes in this form. Please save before you continue.")):!e.source_name&&e.frm?e.source_name=e.frm.doc.name:e.frm||e.source_name||(e.source_name=null),frappe.call({type:"POST",method:"frappe.model.mapper.make_mapped_doc",args:{method:e.method,source_name:e.source_name,args:e.args||null,selected_children:e.frm?e.frm.get_selected():null},freeze:!0,freeze_message:e.freeze_message||"",callback:function(t){t.exc||(frappe.model.sync(t.message),e.run_link_triggers&&(frappe.get_doc(t.message.doctype,t.message.name).__run_link_triggers=!0),frappe.set_route("Form",t.message.doctype,t.message.name))}})}}),frappe.create_routes={},frappe.new_doc=function(e,t,n){if("File"!==e)return new Promise(function(r){t&&$.isPlainObject(t)&&(frappe.route_options=t),frappe.model.with_doctype(e,function(){frappe.create_routes[e]?frappe.set_route(frappe.create_routes[e]).then(function(){return r()}):frappe.ui.form.make_quick_entry(e,null,n).then(function(){return r()})})});new frappe.ui.FileUploader({folder:t?t.folder:"Home"})},frappe.provide("frappe.perm"),Object.assign(window,{READ:"read",WRITE:"write",CREATE:"create",DELETE:"delete",SUBMIT:"submit",CANCEL:"cancel",AMEND:"amend"}),$.extend(frappe.perm,{rights:["select","read","write","create","delete","submit","cancel","amend","report","import","export","print","email","share","set_user_permissions"],doctype_perm:{},has_perm:function(e,t,n,r){t||(t=0),frappe.perm.doctype_perm[e]||(frappe.perm.doctype_perm[e]=frappe.perm.get_perm(e));var i=frappe.perm.doctype_perm[e];if(!i||!i[t])return!1;var a=!!i[t][n];if(0===t&&a&&r){var o=frappe.model.get_docinfo(e,r.name);o&&!o.permissions[n]&&(a=!1)}return a},get_perm:function(e,t){var n=[{read:0,permlevel:0}],r=frappe.get_doc("DocType",e),i=frappe.session.user;if(("Administrator"===i||frappe.user_roles.includes("Administrator"))&&(n[0].read=1),!r)return n;if(n=frappe.perm.get_role_permissions(r),t){var a=frappe.model.get_docinfo(e,t.name);if(a&&a.permissions&&Object.keys(a.permissions).forEach(function(e){n[0][e]=a.permissions[e]}),$.isEmptyObject(n[0].if_owner)||(t.owner===i?$.extend(n[0],n[0].if_owner):$.each(n[0].if_owner,function(e){n[0].if_owner[e]&&(n[0][e]=0)})),a&&a.shared)for(var o=0;o<a.shared.length;o++){var s=a.shared[o];s.user===i&&(n[0].read=n[0].read||s.read,n[0].write=n[0].write||s.write,n[0].submit=n[0].submit||s.submit,n[0].share=n[0].share||s.share,s.read&&(n[0].email=-1!==frappe.boot.user.can_email.indexOf(e)?1:0,n[0].print=-1!==frappe.boot.user.can_print.indexOf(e)?1:0))}}return frappe.model.can_read(e)&&!n[0].read&&(n[0].read=1),n},get_role_permissions:function(e){var t=[{read:0,permlevel:0}];return(e.permissions||[]).forEach(function(e){var n=cint(e.permlevel);t[n]||(t[n]={},t[n].permlevel=n),frappe.user_roles.includes(e.role)&&frappe.perm.rights.forEach(function(r){var i=t[n][r]||e[r]||0;i&&(t[n][r]=i)})}),t=t.map(function(e){return e||{}})},get_match_rules:function(e,t){var n=[];t||(t="read");var r=frappe.perm.get_perm(e),i=frappe.defaults.get_user_permissions();if(i&&!$.isEmptyObject(i)){var a={},o=frappe.meta.get_fields_to_check_permissions(e);$.each(o,function(t,n){var r=i[n.options]||[],o=frappe.perm.get_allowed_docs_for_doctype(r,e);o.length&&(a[n.label]=o)}),$.isEmptyObject(a)||n.push(a)}return r[0].if_owner&&r[0].read&&n.push({Owner:frappe.session.user}),n},get_field_display_status:function(e,t,n,r){if(!n&&t&&(n=frappe.perm.get_perm(t.doctype,t)),!n)return e&&(cint(e.hidden)||cint(e.hidden_due_to_dependency))?"None":"Write";e.permlevel||(e.permlevel=0);var i=n[e.permlevel],a="None";if(i&&(i.write&&!e.disabled?a="Write":i.read&&(a="Read")),r&&console.log("By Permission:"+a),cint(e.hidden)&&(a="None"),r&&console.log("By Hidden:"+a),cint(e.hidden_due_to_dependency)&&(a="None"),r&&console.log("By Hidden Due To Dependency:"+a),!t)return a;"Write"===a&&cint(t.docstatus)>0&&(a="Read"),r&&console.log("By Submit:"+a);var o=cint(e.allow_on_submit);return"Read"===a&&o&&1===cint(t.docstatus)&&i.write&&(a="Write"),r&&console.log("By Allow on Submit:"+a),"Read"===a&&cur_frm&&cur_frm.state_fieldname&&(cint(cur_frm.read_only)||in_list(cur_frm.states.update_fields,e.fieldname)||e.fieldname==cur_frm.state_fieldname)&&(a="Read"),r&&console.log("By Workflow:"+a),"Write"===a&&cint(e.read_only)&&(a="Read"),r&&console.log("By Read Only:"+a),"Write"===a&&e.set_only_once&&!t.__islocal&&(a="Read"),r&&console.log("By Set Only Once:"+a),a},is_visible:function(e,t,n){return"string"==typeof e&&(e=frappe.meta.get_docfield(t.doctype,e,t.parent||t.name)),"None"!==frappe.perm.get_field_display_status(e,t,n)},get_allowed_docs_for_doctype:function(e,t){return frappe.perm.filter_allowed_docs_for_doctype(e,t,!1)},filter_allowed_docs_for_doctype:function(e,t,n){void 0===n&&(n=!0);var r=(e||[]).filter(function(e){return e.applicable_for===t||!e.applicable_for}),i=r.map(function(e){return e.doc});return n?{allowed_records:i,default_doc:(1===i.length?i:r.filter(function(e){return e.is_default}).map(function(e){return e.doc}))[0]}:i}}),frappe.provide("frappe.workflow"),frappe.workflow={state_fields:{},workflows:{},setup:function(e){var t=frappe.get_list("Workflow",{document_type:e});t.length?(frappe.workflow.workflows[e]=t[0],frappe.workflow.state_fields[e]=t[0].workflow_state_field):frappe.workflow.state_fields[e]=null},get_state_fieldname:function(e){return void 0===frappe.workflow.state_fields[e]&&frappe.workflow.setup(e),frappe.workflow.state_fields[e]},get_default_state:function(e,t){frappe.workflow.setup(e);var n=null;return $.each(frappe.workflow.workflows[e].states,function(e,r){if(cint(r.doc_status)===cint(t))return n=r.state,!1}),n},get_transitions:function(e){return frappe.workflow.setup(e.doctype),frappe.xcall("frappe.model.workflow.get_transitions",{doc:e})},get_document_state:function(e,t){return frappe.workflow.setup(e),frappe.get_children(frappe.workflow.workflows[e],"states",{state:t})[0]},is_self_approval_enabled:function(e){return frappe.workflow.workflows[e].allow_self_approval},is_read_only:function(e,t){var n=frappe.workflow.get_state_fieldname(e);if(n){var r=locals[e][t];if(!r)return!1;if(r.__islocal)return!1;var i=r[n]||frappe.workflow.get_default_state(e,r.docstatus),a=i?frappe.workflow.get_document_state(e,i)&&frappe.workflow.get_document_state(e,i).allow_edit:null;if(!frappe.user_roles.includes(a))return!0}return!1},get_update_fields:function(e){return $.unique($.map(frappe.workflow.workflows[e].states||[],function(e){return e.update_field}))},get_state:function(e){var t=e[this.get_state_fieldname(e.doctype)];return t||(t=this.get_default_state(e.doctype,e.docstatus)),t},get_all_transitions:function(e){return frappe.workflow.workflows[e].transitions||[]},get_all_transition_actions:function(e){return this.get_all_transitions(e).map(function(e){return e.action})}},frappe.provide("frappe.model.user_settings"),$.extend(frappe.model.user_settings,{get:function(e){return frappe.call("frappe.model.utils.user_settings.get",{doctype:e}).then(function(e){return JSON.parse(e.message||"{}")})},save:function(e,t,n){if("Guest"===frappe.session.user)return Promise.resolve();var r=frappe.model.user_settings[e]||{},i=$.extend(!0,{},r);return $.isPlainObject(n)?(i[t]=i[t]||{},$.extend(i[t],n)):i[t]=n,JSON.stringify(r)!==JSON.stringify(i)?this.update(e,i):Promise.resolve(i)},remove:function(e,t){var n=frappe.model.user_settings[e]||{};return delete n[t],this.update(e,n)},update:function(e,t){return"Guest"===frappe.session.user?Promise.resolve():frappe.call({method:"frappe.model.utils.user_settings.save",args:{doctype:e,user_settings:t},callback:function(t){frappe.model.user_settings[e]=t.message}})}}),frappe.get_user_settings=function(e,t){var n=frappe.model.user_settings[e]||{};return t&&(n=n[t]||{}),n},function(e){function t(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function n(e,n,r,i,a,o){return t(function(e,t){return e<<t|e>>>32-t}(t(t(n,e),t(i,o)),a),r)}function r(e,t,r,i,a,o,s){return n(t&r|~t&i,e,t,a,o,s)}function i(e,t,r,i,a,o,s){return n(t&i|r&~i,e,t,a,o,s)}function a(e,t,r,i,a,o,s){return n(t^r^i,e,t,a,o,s)}function o(e,t,r,i,a,o,s){return n(r^(t|~i),e,t,a,o,s)}function s(e,n){e[n>>5]|=128<<n%32,e[14+(n+64>>>9<<4)]=n;var s,l,c,d,u,p=1732584193,f=-271733879,h=-1732584194,_=271733878;for(s=0;s<e.length;s+=16)l=p,c=f,d=h,u=_,p=r(p,f,h,_,e[s],7,-680876936),_=r(_,p,f,h,e[s+1],12,-389564586),h=r(h,_,p,f,e[s+2],17,606105819),f=r(f,h,_,p,e[s+3],22,-1044525330),p=r(p,f,h,_,e[s+4],7,-176418897),_=r(_,p,f,h,e[s+5],12,1200080426),h=r(h,_,p,f,e[s+6],17,-1473231341),f=r(f,h,_,p,e[s+7],22,-45705983),p=r(p,f,h,_,e[s+8],7,1770035416),_=r(_,p,f,h,e[s+9],12,-1958414417),h=r(h,_,p,f,e[s+10],17,-42063),f=r(f,h,_,p,e[s+11],22,-1990404162),p=r(p,f,h,_,e[s+12],7,1804603682),_=r(_,p,f,h,e[s+13],12,-40341101),h=r(h,_,p,f,e[s+14],17,-1502002290),p=i(p,f=r(f,h,_,p,e[s+15],22,1236535329),h,_,e[s+1],5,-165796510),_=i(_,p,f,h,e[s+6],9,-1069501632),h=i(h,_,p,f,e[s+11],14,643717713),f=i(f,h,_,p,e[s],20,-373897302),p=i(p,f,h,_,e[s+5],5,-701558691),_=i(_,p,f,h,e[s+10],9,38016083),h=i(h,_,p,f,e[s+15],14,-660478335),f=i(f,h,_,p,e[s+4],20,-405537848),p=i(p,f,h,_,e[s+9],5,568446438),_=i(_,p,f,h,e[s+14],9,-1019803690),h=i(h,_,p,f,e[s+3],14,-187363961),f=i(f,h,_,p,e[s+8],20,1163531501),p=i(p,f,h,_,e[s+13],5,-1444681467),_=i(_,p,f,h,e[s+2],9,-51403784),h=i(h,_,p,f,e[s+7],14,1735328473),p=a(p,f=i(f,h,_,p,e[s+12],20,-1926607734),h,_,e[s+5],4,-378558),_=a(_,p,f,h,e[s+8],11,-2022574463),h=a(h,_,p,f,e[s+11],16,1839030562),f=a(f,h,_,p,e[s+14],23,-35309556),p=a(p,f,h,_,e[s+1],4,-1530992060),_=a(_,p,f,h,e[s+4],11,1272893353),h=a(h,_,p,f,e[s+7],16,-155497632),f=a(f,h,_,p,e[s+10],23,-1094730640),p=a(p,f,h,_,e[s+13],4,681279174),_=a(_,p,f,h,e[s],11,-358537222),h=a(h,_,p,f,e[s+3],16,-722521979),f=a(f,h,_,p,e[s+6],23,76029189),p=a(p,f,h,_,e[s+9],4,-640364487),_=a(_,p,f,h,e[s+12],11,-421815835),h=a(h,_,p,f,e[s+15],16,530742520),p=o(p,f=a(f,h,_,p,e[s+2],23,-995338651),h,_,e[s],6,-198630844),_=o(_,p,f,h,e[s+7],10,1126891415),h=o(h,_,p,f,e[s+14],15,-1416354905),f=o(f,h,_,p,e[s+5],21,-57434055),p=o(p,f,h,_,e[s+12],6,1700485571),_=o(_,p,f,h,e[s+3],10,-1894986606),h=o(h,_,p,f,e[s+10],15,-1051523),f=o(f,h,_,p,e[s+1],21,-2054922799),p=o(p,f,h,_,e[s+8],6,1873313359),_=o(_,p,f,h,e[s+15],10,-30611744),h=o(h,_,p,f,e[s+6],15,-1560198380),f=o(f,h,_,p,e[s+13],21,1309151649),p=o(p,f,h,_,e[s+4],6,-145523070),_=o(_,p,f,h,e[s+11],10,-1120210379),h=o(h,_,p,f,e[s+2],15,718787259),f=o(f,h,_,p,e[s+9],21,-343485551),p=t(p,l),f=t(f,c),h=t(h,d),_=t(_,u);return[p,f,h,_]}function l(e){var t,n="";for(t=0;t<32*e.length;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function c(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;for(t=0;t<8*e.length;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function d(e){var t,n,r="0123456789abcdef",i="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),i+=r.charAt(t>>>4&15)+r.charAt(15&t);return i}function u(e){return unescape(encodeURIComponent(e))}function p(e){return function(e){return l(s(c(e),8*e.length))}(u(e))}function f(e,t){return function(e,t){var n,r,i=c(e),a=[],o=[];for(a[15]=o[15]=void 0,i.length>16&&(i=s(i,8*e.length)),n=0;16>n;n+=1)a[n]=909522486^i[n],o[n]=1549556828^i[n];return r=s(a.concat(c(t)),512+8*t.length),l(s(o.concat(r),640))}(u(e),u(t))}function h(e,t,n){return t?n?f(t,e):function(e,t){return d(f(e,t))}(t,e):n?p(e):function(e){return d(p(e))}(e)}"function"==typeof define&&define.amd?define(function(){return h}):e.md5=h}(window),frappe.user_info=function(e){if(e||(e=frappe.session.user),"bot"===e.toLowerCase())return{fullname:__("Bot"),image:"/assets/frappe/images/ui/bot.png",abbr:"B"};if(frappe.boot.user_info&&frappe.boot.user_info[e])t=frappe.boot.user_info[e];else var t={fullname:e||"Unknown"};return t.abbr=frappe.get_abbr(t.fullname),t.color=frappe.get_palette(t.fullname),t},frappe.ui.set_user_background=function(e,t,n){if(t||(t="#page-desktop"),n||(n="Fill Screen"),e){window.cordova&&-1===e.indexOf("http")&&(e=frappe.base_url+e);var r=repl('background: url("%(src)s") center center;',{src:e})}else r="background-color: #4B4C9D;";frappe.dom.set_style(repl("%(selector)s { \t\t%(background)s \t\tbackground-attachment: fixed; \t\t%(style)s \t}",{selector:t,background:r,style:"Fill Screen"===n?"background-size: cover;":""}))},frappe.provide("frappe.user"),$.extend(frappe.user,{name:"Guest",full_name:function(e){return e===frappe.session.user?__("You",null,"Name of the current user. For example: You edited this 5 hours ago."):frappe.user_info(e).fullname},image:function(e){return frappe.user_info(e).image},abbr:function(e){return frappe.user_info(e).abbr},has_role:function(e){for(var t in"string"==typeof e&&(e=[e]),e)if(-1!=(frappe.boot?frappe.boot.user.roles:["Guest"]).indexOf(e[t]))return!0},get_desktop_items:function(){return $.map(frappe.boot.allowed_modules,function(e){var t=e.module_name,n=frappe.modules[t]&&frappe.modules[t].type;if(-1===frappe.boot.user.allow_modules.indexOf(t))return null;var r=null;return"module"===n?(-1!=frappe.boot.user.allow_modules.indexOf(t)||frappe.modules[t].is_help)&&(r=t):"page"===n?-1!=frappe.boot.allowed_pages.indexOf(frappe.modules[t].link)&&(r=t):"list"===n?frappe.model.can_read(frappe.modules[t]._doctype)&&(r=t):"view"===n?r=t:"setup"===n?(frappe.user.has_role("System Manager")||frappe.user.has_role("Administrator"))&&(r=t):r=t,r})},is_report_manager:function(){return frappe.user.has_role(["Administrator","System Manager","Report Manager"])},get_formatted_email:function(e){var t=frappe.user.full_name(e);if(t){var n="";return-1!==t.search(/[\[\]\\()<>@,:;".]/)&&(n='"'),repl("%(quote)s%(fullname)s%(quote)s <%(email)s>",{fullname:t,email:e,quote:n})}return e},get_emails:function(){return Object.keys(frappe.boot.user_info).map(function(e){return frappe.boot.user_info[e].email})},toString:function(){return this.name}}),frappe.session_alive=!0,$(document).bind("mousemove",function(){!1===frappe.session_alive&&$(document).trigger("session_alive"),frappe.session_alive=!0,frappe.session_alive_timeout&&clearTimeout(frappe.session_alive_timeout),frappe.session_alive_timeout=setTimeout("frappe.session_alive=false;",3e4)}),frappe.avatar=function(e,t,n,r,i,a){var o;if(void 0===r&&(r=null),void 0===i&&(i=!1),void 0===a&&(a=!1),e)o=frappe.user_info(e);else{var s=n||frappe.get_cookie("full_name");o={image:null===r?frappe.get_cookie("user_image"):r,fullname:s,abbr:frappe.get_abbr(s),color:frappe.get_palette(s)}}n||(n=o.fullname);var l="";return a&&(t+=" filterable",l='data-filter="_assign,like,%'+e+'%"'),frappe.get_avatar(t,n,r||o.image,i,l)},frappe.get_avatar=function(e,t,n,r,i){if(void 0===n&&(n=null),e||(e="avatar-small"),n)return'<span class="avatar '+e+'" title="'+t+'" '+i+'>\n\t\t\t\t<span class="avatar-frame" style=\'background-image: url("'+(window.cordova&&-1===n.indexOf("http")?frappe.base_url+n:n)+'")\'\n\t\t\t\t\ttitle="'+t+'"></span>\n\t\t\t</span>';var a=frappe.get_abbr(t),o="";if(!r){var s=frappe.get_palette(t);o="background-color: var("+s[0]+"); color: var("+s[1]+")"}return"avatar-small"!==e&&"avatar-xs"!=e||(a=a.substr(0,1)),'<span class="avatar '+e+'" title="'+t+'" '+i+'>\n\t\t\t<div class="avatar-frame standard-image"\n\t\t\t\tstyle="'+o+'">\n\t\t\t\t\t'+a+"\n\t\t\t</div>\n\t\t</span>"},frappe.avatar_group=function(e,t,n){void 0===t&&(t=4),void 0===n&&(n={});var r="",i=e.slice(0,t),a=e.slice(t),o=n.css_class||"",s=i.map(function(e){return frappe.avatar(e,"avatar-small "+o,null,null,!1,n.filterable)}).join("");1===a.length?s+=frappe.avatar(a[0],"avatar-small "+o,null,null,!1,n.filterable):a.length>1&&(s="\n\t\t\t"+s+'\n\t\t\t<span class="avatar avatar-small '+o+'">\n\t\t\t\t<div class="avatar-frame standard-image avatar-extra-count"\n\t\t\t\t\ttitle="'+a.map(function(e){return frappe.user_info(e).fullname}).join(", ")+'">\n\t\t\t\t\t+'+a.length+"\n\t\t\t\t</div>\n\t\t\t</span>\n\t\t"),n.action_icon&&(r='\n\t\t\t<span class="avatar avatar-small">\n\t\t\t\t<div class="avatar-frame avatar-action">\n\t\t\t\t\t'+frappe.utils.icon(n.action_icon,"sm")+"\n\t\t\t\t</div>\n\t\t\t</span>\n\t\t");var l=$('<div class="avatar-group '+(n.align||"right")+" "+(0!=n.overlap?"overlap":"")+'">\n\t\t\t'+s+"\n\t\t\t"+r+"\n\t\t</div>");return l.find(".avatar-action").on("click",n.action),l},frappe.ui.scroll=function(e,t,n){var r=$(".navbar").height()+$(".page-head").height(),i=$(e).offset().top-r-cint(n);t?$("html, body").animate({scrollTop:i}):$(window).scrollTop(i)},frappe.palette=[["--orange-avatar-bg","--orange-avatar-color"],["--pink-avatar-bg","--pink-avatar-color"],["--blue-avatar-bg","--blue-avatar-color"],["--green-avatar-bg","--green-avatar-color"],["--dark-green-avatar-bg","--dark-green-avatar-color"],["--red-avatar-bg","--red-avatar-color"],["--yellow-avatar-bg","--yellow-avatar-color"],["--purple-avatar-bg","--purple-avatar-color"],["--gray-avatar-bg","--gray-avatar-color0"]],frappe.get_palette=function(e){var t=cint((parseInt(md5(e).substr(4,2),16)+1)/5.33);return frappe.palette[t%8]},frappe.get_abbr=function(e,t){if(!e)return"";var n="";return $.each(e.split(" "),function(e,r){return!(n.length>=(t||2))&&(!r.trim().length||void(n+=r.trim()[0]))}),n||"?"},frappe.gravatars={},frappe.get_gravatar=function(e,t){void 0===t&&(t=0);var n=t?"s="+t:"d=retro";return frappe.gravatars[e]||(frappe.gravatars[e]="https://secure.gravatar.com/avatar/"+md5(e)+"?"+n),frappe.gravatars[e]},window.repl=function(e,t){if(null==e)return"";for(var n in t)e=e.split("%("+n+")s").join(t[n]);return e},window.replace_all=function(e,t,n){return e.split(t).join(n)},window.strip_html=function(e){return cstr(e).replace(/<[^>]*>/g,"")},window.strip=function(e,t){if(e)return e=lstrip(e,t),e=rstrip(e,t)},window.lstrip=function(e,t){t||(t=["\n","\t"," "]);for(var n=e.substr(0,1);in_list(t,n);)n=(e=e.substr(1)).substr(0,1);return e},window.rstrip=function(e,t){t||(t=["\n","\t"," "]);for(var n=e.substr(e.length-1);in_list(t,n);)n=(e=e.substr(0,e.length-1)).substr(e.length-1);return e},frappe.get_cookie=function(e){return frappe.get_cookies()[e]},frappe.get_cookies=function(){var e=document.cookie,t=0,n={};return document.cookie.match(/^\s*\$Version=(?:"1"|1);\s*(.*)/)&&(e=RegExp.$1,t=1),0===t?e.split(/[,;]/).map(function(e){var t=e.split(/=/,2),r=decodeURIComponent(t[0].trimLeft()),i=t.length>1?decodeURIComponent(t[1].trimRight()):null;i&&'"'===i.charAt(0)&&(i=i.substr(1,i.length-2)),n[r]=i}):e.match(/(?:^|\s+)([!#$%&'*+\-.0-9A-Z^`a-z|~]+)=([!#$%&'*+\-.0-9A-Z^`a-z|~]*|"(?:[\x20-\x7E\x80\xFF]|\\[\x00-\x7F])*")(?=\s*[,;]|$)/g).map(function(e,t){var r=e,i='"'===t.charAt(0)?t.substr(1,-1).replace(/\\(.)/g,"$1"):t;n[r]=i}),n},frappe.is_mobile=function(){return $(document).width()<768},frappe.utils.xss_sanitise=function(e,t){var n=e,r={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"};if((t=Object.assign({},{strategies:["html","js"]},t)).strategies.includes("html"))for(var i in r){var a=r[i],o=new RegExp(i,"g");n=n.replace(o,a)}return t.strategies.includes("js")&&(n=n.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"")),n},frappe.utils.sanitise_redirect=function(e){return function(e){function t(e){var t=/^(?:https?:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:\/\n?]+)/gim.exec(e);return null==t?"":t[1]}return!!function(e){return/^(?:[a-z]+:)?\/\//i.test(e)}(e)&&t(location.href)!==t(e)}(e=frappe.utils.strip_url(e))?"":function(e){return e.replace(/j[\s]*(&#x.{1,7})?a[\s]*(&#x.{1,7})?v[\s]*(&#x.{1,7})?a[\s]*(&#x.{1,7})?s[\s]*(&#x.{1,7})?c[\s]*(&#x.{1,7})?r[\s]*(&#x.{1,7})?i[\s]*(&#x.{1,7})?p[\s]*(&#x.{1,7})?t/gi,"")}(frappe.utils.xss_sanitise(e,{strategies:["js"]}))},frappe.utils.strip_url=function(e){return e.replace(/^[^A-Za-z0-9(\/\/)#]+/g,"")},frappe.utils.new_auto_repeat_prompt=function(e){var t=[{fieldname:"frequency",fieldtype:"Select",label:__("Frequency"),reqd:1,options:[{label:__("Daily"),value:"Daily"},{label:__("Weekly"),value:"Weekly"},{label:__("Monthly"),value:"Monthly"},{label:__("Quarterly"),value:"Quarterly"},{label:__("Half-yearly"),value:"Half-yearly"},{label:__("Yearly"),value:"Yearly"}]},{fieldname:"start_date",fieldtype:"Date",label:__("Start Date"),reqd:1,default:frappe.datetime.nowdate()},{fieldname:"end_date",fieldtype:"Date",label:__("End Date")}];frappe.prompt(t,function(t){frappe.call({method:"frappe.automation.doctype.auto_repeat.auto_repeat.make_auto_repeat",args:{doctype:e.doc.doctype,docname:e.doc.name,frequency:t.frequency,start_date:t.start_date,end_date:t.end_date},callback:function(t){t.message&&(frappe.show_alert({message:__("Auto Repeat created for this document"),indicator:"green"}),e.reload_doc())}})},__("Auto Repeat"),__("Save"))},frappe.utils.get_page_view_count=function(e){return frappe.call("frappe.website.doctype.web_page_view.web_page_view.get_page_view_count",{path:e})},frappe.urllib={get_arg:function(e){e=e.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.href);return null==t?"":decodeURIComponent(t[1])},get_dict:function(){var e={},t=window.location.href.split("?")[1];if(!t)return e;if(-1!=t.indexOf("#")&&(t=t.split("#")[0]),!t)return e;t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].split("=");e[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return e},get_base_url:function(){var e=frappe.base_url||window.location.origin;return"/"==e.substr(e.length-1,1)&&(e=e.substr(0,e.length-1)),e},get_full_url:function(e){return 0===e.indexOf("http://")||0===e.indexOf("https://")?e:"/"===e.substr(0,1)?frappe.urllib.get_base_url()+e:frappe.urllib.get_base_url()+"/"+e}},window.open_url_post=function(e,t,n){if(!window.cordova){var r=document.createElement("form");for(var i in r.action=e,r.method="POST",r.style.display="none",n&&(r.target="_blank"),t.csrf_token=frappe.csrf_token,t){var a=document.createElement("textarea");a.name=i;var o=t[i];"string"!=typeof o&&(o=JSON.stringify(o)),a.value=o,r.appendChild(a)}return document.body.appendChild(r),r.submit(),r}var s=e+"api/method/"+t.cmd+frappe.utils.make_query_string(t,!1);window.location.href=s},window.get_url_arg=frappe.urllib.get_arg,window.get_url_dict=frappe.urllib.get_dict,frappe.provide("frappe.datetime"),window.comment_when=function(e,t){return'<span class="frappe-timestamp '+(t?" mini":"")+'" data-timestamp="'+e+'" title="'+(frappe.datetime.str_to_user?frappe.datetime.str_to_user(e):e)+'">'+prettyDate(e,t)+"</span>"},frappe.datetime.comment_when=comment_when,frappe.datetime.prettyDate=prettyDate,frappe.datetime.refresh_when=function(){jQuery&&$(".frappe-timestamp").each(function(){$(this).html(prettyDate($(this).attr("data-timestamp"),$(this).hasClass("mini")))})},setInterval(function(){frappe.datetime.refresh_when()},6e4);var showdown=createCommonjsModule(function(e){(function(){function t(e){var t={omitExtraWLInCodeBlocks:{defaultValue:!1,describe:"Omit the default extra whiteline added to code blocks",type:"boolean"},noHeaderId:{defaultValue:!1,describe:"Turn on/off generated header id",type:"boolean"},prefixHeaderId:{defaultValue:!1,describe:"Add a prefix to the generated header ids. Passing a string will prefix that string to the header id. Setting to true will add a generic 'section-' prefix",type:"string"},rawPrefixHeaderId:{defaultValue:!1,describe:'Setting this option to true will prevent showdown from modifying the prefix. This might result in malformed IDs (if, for instance, the " char is used in the prefix)',type:"boolean"},ghCompatibleHeaderId:{defaultValue:!1,describe:"Generate header ids compatible with github style (spaces are replaced with dashes, a bunch of non alphanumeric chars are removed)",type:"boolean"},rawHeaderId:{defaultValue:!1,describe:"Remove only spaces, ' and \" from generated header ids (including prefixes), replacing them with dashes (-). WARNING: This might result in malformed ids",type:"boolean"},headerLevelStart:{defaultValue:!1,describe:"The header blocks level start",type:"integer"},parseImgDimensions:{defaultValue:!1,describe:"Turn on/off image dimension parsing",type:"boolean"},simplifiedAutoLink:{defaultValue:!1,describe:"Turn on/off GFM autolink style",type:"boolean"},excludeTrailingPunctuationFromURLs:{defaultValue:!1,describe:"Excludes trailing punctuation from links generated with autoLinking",type:"boolean"},literalMidWordUnderscores:{defaultValue:!1,describe:"Parse midword underscores as literal underscores",type:"boolean"},literalMidWordAsterisks:{defaultValue:!1,describe:"Parse midword asterisks as literal asterisks",type:"boolean"},strikethrough:{defaultValue:!1,describe:"Turn on/off strikethrough support",type:"boolean"},tables:{defaultValue:!1,describe:"Turn on/off tables support",type:"boolean"},tablesHeaderId:{defaultValue:!1,describe:"Add an id to table headers",type:"boolean"},ghCodeBlocks:{defaultValue:!0,describe:"Turn on/off GFM fenced code blocks support",type:"boolean"},tasklists:{defaultValue:!1,describe:"Turn on/off GFM tasklist support",type:"boolean"},smoothLivePreview:{defaultValue:!1,describe:"Prevents weird effects in live previews due to incomplete input",type:"boolean"},smartIndentationFix:{defaultValue:!1,description:"Tries to smartly fix indentation in es6 strings",type:"boolean"},disableForced4SpacesIndentedSublists:{defaultValue:!1,description:"Disables the requirement of indenting nested sublists by 4 spaces",type:"boolean"},simpleLineBreaks:{defaultValue:!1,description:"Parses simple line breaks as <br> (GFM Style)",type:"boolean"},requireSpaceBeforeHeadingText:{defaultValue:!1,description:"Makes adding a space between `#` and the header text mandatory (GFM Style)",type:"boolean"},ghMentions:{defaultValue:!1,description:"Enables github @mentions",type:"boolean"},ghMentionsLink:{defaultValue:"https://github.com/{u}",description:"Changes the link generated by @mentions. Only applies if ghMentions option is enabled.",type:"string"},encodeEmails:{defaultValue:!0,description:"Encode e-mail addresses through the use of Character Entities, transforming ASCII e-mail addresses into its equivalent decimal entities",type:"boolean"},openLinksInNewWindow:{defaultValue:!1,description:"Open all links in new windows",type:"boolean"},backslashEscapesHTMLTags:{defaultValue:!1,description:"Support for HTML Tag escaping. ex: <div>foo</div>",type:"boolean"},emoji:{defaultValue:!1,description:"Enable emoji support. Ex: `this is a :smile: emoji`",type:"boolean"},underline:{defaultValue:!1,description:"Enable support for underline. Syntax is double or triple underscores: `__underline word__`. With this option enabled, underscores no longer parses into `<em>` and `<strong>`",type:"boolean"},completeHTMLDocument:{defaultValue:!1,description:"Outputs a complete html document, including `<html>`, `<head>` and `<body>` tags",type:"boolean"},metadata:{defaultValue:!1,description:"Enable support for document metadata (defined at the top of the document between `«««` and `»»»` or between `---` and `---`).",type:"boolean"},splitAdjacentBlockquotes:{defaultValue:!1,description:"Split adjacent blockquote blocks",type:"boolean"}};if(!1===e)return JSON.parse(JSON.stringify(t));var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r].defaultValue);return n}var n={},r={},i={},a=t(!0),o="vanilla",s={github:{omitExtraWLInCodeBlocks:!0,simplifiedAutoLink:!0,excludeTrailingPunctuationFromURLs:!0,literalMidWordUnderscores:!0,strikethrough:!0,tables:!0,tablesHeaderId:!0,ghCodeBlocks:!0,tasklists:!0,disableForced4SpacesIndentedSublists:!0,simpleLineBreaks:!0,requireSpaceBeforeHeadingText:!0,ghCompatibleHeaderId:!0,ghMentions:!0,backslashEscapesHTMLTags:!0,emoji:!0,splitAdjacentBlockquotes:!0},original:{noHeaderId:!0,ghCodeBlocks:!1},ghost:{omitExtraWLInCodeBlocks:!0,parseImgDimensions:!0,simplifiedAutoLink:!0,excludeTrailingPunctuationFromURLs:!0,literalMidWordUnderscores:!0,strikethrough:!0,tables:!0,tablesHeaderId:!0,ghCodeBlocks:!0,tasklists:!0,smoothLivePreview:!0,simpleLineBreaks:!0,requireSpaceBeforeHeadingText:!0,ghMentions:!1,encodeEmails:!0},vanilla:t(!0),allOn:function(){var e=t(!0),n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=!0);return n}()};function l(e,t){var r=t?"Error in "+t+" extension->":"Error in unnamed extension",i={valid:!0,error:""};n.helper.isArray(e)||(e=[e]);for(var a=0;a<e.length;++a){var o=r+" sub-extension "+a+": ",s=e[a];if("object"!=typeof s)return i.valid=!1,i.error=o+"must be an object, but "+typeof s+" given",i;if(!n.helper.isString(s.type))return i.valid=!1,i.error=o+'property "type" must be a string, but '+typeof s.type+" given",i;var l=s.type=s.type.toLowerCase();if("language"===l&&(l=s.type="lang"),"html"===l&&(l=s.type="output"),"lang"!==l&&"output"!==l&&"listener"!==l)return i.valid=!1,i.error=o+"type "+l+' is not recognized. Valid values: "lang/language", "output/html" or "listener"',i;if("listener"===l){if(n.helper.isUndefined(s.listeners))return i.valid=!1,i.error=o+'. Extensions of type "listener" must have a property called "listeners"',i}else if(n.helper.isUndefined(s.filter)&&n.helper.isUndefined(s.regex))return i.valid=!1,i.error=o+l+' extensions must define either a "regex" property or a "filter" method',i;if(s.listeners){if("object"!=typeof s.listeners)return i.valid=!1,i.error=o+'"listeners" property must be an object but '+typeof s.listeners+" given",i;for(var c in s.listeners)if(s.listeners.hasOwnProperty(c)&&"function"!=typeof s.listeners[c])return i.valid=!1,i.error=o+'"listeners" property must be an hash of [event name]: [callback]. listeners.'+c+" must be a function but "+typeof s.listeners[c]+" given",i}if(s.filter){if("function"!=typeof s.filter)return i.valid=!1,i.error=o+'"filter" must be a function, but '+typeof s.filter+" given",i}else if(s.regex){if(n.helper.isString(s.regex)&&(s.regex=new RegExp(s.regex,"g")),!(s.regex instanceof RegExp))return i.valid=!1,i.error=o+'"regex" property must either be a string or a RegExp object, but '+typeof s.regex+" given",i;if(n.helper.isUndefined(s.replace))return i.valid=!1,i.error=o+'"regex" extensions must implement a replace string or function',i}}return i}function c(e,t){return"¨E"+t.charCodeAt(0)+"E"}n.helper={},n.extensions={},n.setOption=function(e,t){return a[e]=t,this},n.getOption=function(e){return a[e]},n.getOptions=function(){return a},n.resetOptions=function(){a=t(!0)},n.setFlavor=function(e){if(!s.hasOwnProperty(e))throw Error(e+" flavor was not found");n.resetOptions();var t=s[e];for(var r in o=e,t)t.hasOwnProperty(r)&&(a[r]=t[r])},n.getFlavor=function(){return o},n.getFlavorOptions=function(e){if(s.hasOwnProperty(e))return s[e]},n.getDefaultOptions=function(e){return t(e)},n.subParser=function(e,t){if(n.helper.isString(e)){if(void 0===t){if(r.hasOwnProperty(e))return r[e];throw Error("SubParser named "+e+" not registered!")}r[e]=t}},n.extension=function(e,t){if(!n.helper.isString(e))throw Error("Extension 'name' must be a string");if(e=n.helper.stdExtName(e),n.helper.isUndefined(t)){if(!i.hasOwnProperty(e))throw Error("Extension named "+e+" is not registered!");return i[e]}"function"==typeof t&&(t=t()),n.helper.isArray(t)||(t=[t]);var r=l(t,e);if(!r.valid)throw Error(r.error);i[e]=t},n.getAllExtensions=function(){return i},n.removeExtension=function(e){delete i[e]},n.resetExtensions=function(){i={}},n.validateExtension=function(e){var t=l(e,null);return!!t.valid||(console.warn(t.error),!1)},n.hasOwnProperty("helper")||(n.helper={}),n.helper.isString=function(e){return"string"==typeof e||e instanceof String},n.helper.isFunction=function(e){return e&&"[object Function]"==={}.toString.call(e)},n.helper.isArray=function(e){return Array.isArray(e)},n.helper.isUndefined=function(e){return void 0===e},n.helper.forEach=function(e,t){if(n.helper.isUndefined(e))throw new Error("obj param is required");if(n.helper.isUndefined(t))throw new Error("callback param is required");if(!n.helper.isFunction(t))throw new Error("callback param must be a function/closure");if("function"==typeof e.forEach)e.forEach(t);else if(n.helper.isArray(e))for(var r=0;r<e.length;r++)t(e[r],r,e);else{if("object"!=typeof e)throw new Error("obj does not seem to be an array or an iterable object");for(var i in e)e.hasOwnProperty(i)&&t(e[i],i,e)}},n.helper.stdExtName=function(e){return e.replace(/[_?*+\/\\.^-]/g,"").replace(/\s/g,"").toLowerCase()},n.helper.escapeCharactersCallback=c,n.helper.escapeCharacters=function(e,t,n){var r="(["+t.replace(/([\[\]\\])/g,"\\$1")+"])";n&&(r="\\\\"+r);var i=new RegExp(r,"g");return e=e.replace(i,c)},n.helper.unescapeHTMLEntities=function(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")};var d=function(e,t,n,r){var i,a,o,s,l,c=r||"",d=c.indexOf("g")>-1,u=new RegExp(t+"|"+n,"g"+c.replace(/g/g,"")),p=new RegExp(t,c.replace(/g/g,"")),f=[];do{for(i=0;o=u.exec(e);)if(p.test(o[0]))i++||(s=(a=u.lastIndex)-o[0].length);else if(i&&!--i){l=o.index+o[0].length;var h={left:{start:s,end:a},match:{start:a,end:o.index},right:{start:o.index,end:l},wholeMatch:{start:s,end:l}};if(f.push(h),!d)return f}}while(i&&(u.lastIndex=a));return f};n.helper.matchRecursiveRegExp=function(e,t,n,r){for(var i=d(e,t,n,r),a=[],o=0;o<i.length;++o)a.push([e.slice(i[o].wholeMatch.start,i[o].wholeMatch.end),e.slice(i[o].match.start,i[o].match.end),e.slice(i[o].left.start,i[o].left.end),e.slice(i[o].right.start,i[o].right.end)]);return a},n.helper.replaceRecursiveRegExp=function(e,t,r,i,a){if(!n.helper.isFunction(t)){var o=t;t=function(){return o}}var s=d(e,r,i,a),l=e,c=s.length;if(c>0){var u=[];0!==s[0].wholeMatch.start&&u.push(e.slice(0,s[0].wholeMatch.start));for(var p=0;p<c;++p)u.push(t(e.slice(s[p].wholeMatch.start,s[p].wholeMatch.end),e.slice(s[p].match.start,s[p].match.end),e.slice(s[p].left.start,s[p].left.end),e.slice(s[p].right.start,s[p].right.end))),p<c-1&&u.push(e.slice(s[p].wholeMatch.end,s[p+1].wholeMatch.start));s[c-1].wholeMatch.end<e.length&&u.push(e.slice(s[c-1].wholeMatch.end)),l=u.join("")}return l},n.helper.regexIndexOf=function(e,t,r){if(!n.helper.isString(e))throw"InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string";if(t instanceof RegExp==!1)throw"InvalidArgumentError: second parameter of showdown.helper.regexIndexOf function must be an instance of RegExp";var i=e.substring(r||0).search(t);return i>=0?i+(r||0):i},n.helper.splitAtIndex=function(e,t){if(!n.helper.isString(e))throw"InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string";return[e.substring(0,t),e.substring(t)]},n.helper.encodeEmailAddress=function(e){var t=[function(e){return"&#"+e.charCodeAt(0)+";"},function(e){return"&#x"+e.charCodeAt(0).toString(16)+";"},function(e){return e}];return e=e.replace(/./g,function(e){if("@"===e)e=t[Math.floor(2*Math.random())](e);else{var n=Math.random();e=n>.9?t[2](e):n>.45?t[1](e):t[0](e)}return e})},n.helper.padEnd=function(e,t,n){return t>>=0,n=String(n||" "),e.length>t?String(e):((t-=e.length)>n.length&&(n+=n.repeat(t/n.length)),String(e)+n.slice(0,t))},"undefined"==typeof console&&(console={warn:function(e){alert(e)},log:function(e){alert(e)},error:function(e){throw e}}),n.helper.regexes={asteriskDashAndColon:/([*_:~])/g},n.helper.emojis={"+1":"👍","-1":"👎",100:"💯",1234:"🔢","1st_place_medal":"🥇","2nd_place_medal":"🥈","3rd_place_medal":"🥉","8ball":"🎱",a:"🅰️",ab:"🆎",abc:"🔤",abcd:"🔡",accept:"🉑",aerial_tramway:"🚡",airplane:"✈️",alarm_clock:"⏰",alembic:"⚗️",alien:"👽",ambulance:"🚑",amphora:"🏺",anchor:"⚓️",angel:"👼",anger:"💢",angry:"😠",anguished:"😧",ant:"🐜",apple:"🍎",aquarius:"♒️",aries:"♈️",arrow_backward:"◀️",arrow_double_down:"⏬",arrow_double_up:"⏫",arrow_down:"⬇️",arrow_down_small:"🔽",arrow_forward:"▶️",arrow_heading_down:"⤵️",arrow_heading_up:"⤴️",arrow_left:"⬅️",arrow_lower_left:"↙️",arrow_lower_right:"↘️",arrow_right:"➡️",arrow_right_hook:"↪️",arrow_up:"⬆️",arrow_up_down:"↕️",arrow_up_small:"🔼",arrow_upper_left:"↖️",arrow_upper_right:"↗️",arrows_clockwise:"🔃",arrows_counterclockwise:"🔄",art:"🎨",articulated_lorry:"🚛",artificial_satellite:"🛰",astonished:"😲",athletic_shoe:"👟",atm:"🏧",atom_symbol:"⚛️",avocado:"🥑",b:"🅱️",baby:"👶",baby_bottle:"🍼",baby_chick:"🐤",baby_symbol:"🚼",back:"🔙",bacon:"🥓",badminton:"🏸",baggage_claim:"🛄",baguette_bread:"🥖",balance_scale:"⚖️",balloon:"🎈",ballot_box:"🗳",ballot_box_with_check:"☑️",bamboo:"🎍",banana:"🍌",bangbang:"‼️",bank:"🏦",bar_chart:"📊",barber:"💈",baseball:"⚾️",basketball:"🏀",basketball_man:"⛹️",basketball_woman:"⛹️&zwj;♀️",bat:"🦇",bath:"🛀",bathtub:"🛁",battery:"🔋",beach_umbrella:"🏖",bear:"🐻",bed:"🛏",bee:"🐝",beer:"🍺",beers:"🍻",beetle:"🐞",beginner:"🔰",bell:"🔔",bellhop_bell:"🛎",bento:"🍱",biking_man:"🚴",bike:"🚲",biking_woman:"🚴&zwj;♀️",bikini:"👙",biohazard:"☣️",bird:"🐦",birthday:"🎂",black_circle:"⚫️",black_flag:"🏴",black_heart:"🖤",black_joker:"🃏",black_large_square:"⬛️",black_medium_small_square:"◾️",black_medium_square:"◼️",black_nib:"✒️",black_small_square:"▪️",black_square_button:"🔲",blonde_man:"👱",blonde_woman:"👱&zwj;♀️",blossom:"🌼",blowfish:"🐡",blue_book:"📘",blue_car:"🚙",blue_heart:"💙",blush:"😊",boar:"🐗",boat:"⛵️",bomb:"💣",book:"📖",bookmark:"🔖",bookmark_tabs:"📑",books:"📚",boom:"💥",boot:"👢",bouquet:"💐",bowing_man:"🙇",bow_and_arrow:"🏹",bowing_woman:"🙇&zwj;♀️",bowling:"🎳",boxing_glove:"🥊",boy:"👦",bread:"🍞",bride_with_veil:"👰",bridge_at_night:"🌉",briefcase:"💼",broken_heart:"💔",bug:"🐛",building_construction:"🏗",bulb:"💡",bullettrain_front:"🚅",bullettrain_side:"🚄",burrito:"🌯",bus:"🚌",business_suit_levitating:"🕴",busstop:"🚏",bust_in_silhouette:"👤",busts_in_silhouette:"👥",butterfly:"🦋",cactus:"🌵",cake:"🍰",calendar:"📆",call_me_hand:"🤙",calling:"📲",camel:"🐫",camera:"📷",camera_flash:"📸",camping:"🏕",cancer:"♋️",candle:"🕯",candy:"🍬",canoe:"🛶",capital_abcd:"🔠",capricorn:"♑️",car:"🚗",card_file_box:"🗃",card_index:"📇",card_index_dividers:"🗂",carousel_horse:"🎠",carrot:"🥕",cat:"🐱",cat2:"🐈",cd:"💿",chains:"⛓",champagne:"🍾",chart:"💹",chart_with_downwards_trend:"📉",chart_with_upwards_trend:"📈",checkered_flag:"🏁",cheese:"🧀",cherries:"🍒",cherry_blossom:"🌸",chestnut:"🌰",chicken:"🐔",children_crossing:"🚸",chipmunk:"🐿",chocolate_bar:"🍫",christmas_tree:"🎄",church:"⛪️",cinema:"🎦",circus_tent:"🎪",city_sunrise:"🌇",city_sunset:"🌆",cityscape:"🏙",cl:"🆑",clamp:"🗜",clap:"👏",clapper:"🎬",classical_building:"🏛",clinking_glasses:"🥂",clipboard:"📋",clock1:"🕐",clock10:"🕙",clock1030:"🕥",clock11:"🕚",clock1130:"🕦",clock12:"🕛",clock1230:"🕧",clock130:"🕜",clock2:"🕑",clock230:"🕝",clock3:"🕒",clock330:"🕞",clock4:"🕓",clock430:"🕟",clock5:"🕔",clock530:"🕠",clock6:"🕕",clock630:"🕡",clock7:"🕖",clock730:"🕢",clock8:"🕗",clock830:"🕣",clock9:"🕘",clock930:"🕤",closed_book:"📕",closed_lock_with_key:"🔐",closed_umbrella:"🌂",cloud:"☁️",cloud_with_lightning:"🌩",cloud_with_lightning_and_rain:"⛈",cloud_with_rain:"🌧",cloud_with_snow:"🌨",clown_face:"🤡",clubs:"♣️",cocktail:"🍸",coffee:"☕️",coffin:"⚰️",cold_sweat:"😰",comet:"☄️",computer:"💻",computer_mouse:"🖱",confetti_ball:"🎊",confounded:"😖",confused:"😕",congratulations:"㊗️",construction:"🚧",construction_worker_man:"👷",construction_worker_woman:"👷&zwj;♀️",control_knobs:"🎛",convenience_store:"🏪",cookie:"🍪",cool:"🆒",policeman:"👮",copyright:"©️",corn:"🌽",couch_and_lamp:"🛋",couple:"👫",couple_with_heart_woman_man:"💑",couple_with_heart_man_man:"👨&zwj;❤️&zwj;👨",couple_with_heart_woman_woman:"👩&zwj;❤️&zwj;👩",couplekiss_man_man:"👨&zwj;❤️&zwj;💋&zwj;👨",couplekiss_man_woman:"💏",couplekiss_woman_woman:"👩&zwj;❤️&zwj;💋&zwj;👩",cow:"🐮",cow2:"🐄",cowboy_hat_face:"🤠",crab:"🦀",crayon:"🖍",credit_card:"💳",crescent_moon:"🌙",cricket:"🏏",crocodile:"🐊",croissant:"🥐",crossed_fingers:"🤞",crossed_flags:"🎌",crossed_swords:"⚔️",crown:"👑",cry:"😢",crying_cat_face:"😿",crystal_ball:"🔮",cucumber:"🥒",cupid:"💘",curly_loop:"➰",currency_exchange:"💱",curry:"🍛",custard:"🍮",customs:"🛃",cyclone:"🌀",dagger:"🗡",dancer:"💃",dancing_women:"👯",dancing_men:"👯&zwj;♂️",dango:"🍡",dark_sunglasses:"🕶",dart:"🎯",dash:"💨",date:"📅",deciduous_tree:"🌳",deer:"🦌",department_store:"🏬",derelict_house:"🏚",desert:"🏜",desert_island:"🏝",desktop_computer:"🖥",male_detective:"🕵️",diamond_shape_with_a_dot_inside:"💠",diamonds:"♦️",disappointed:"😞",disappointed_relieved:"😥",dizzy:"💫",dizzy_face:"😵",do_not_litter:"🚯",dog:"🐶",dog2:"🐕",dollar:"💵",dolls:"🎎",dolphin:"🐬",door:"🚪",doughnut:"🍩",dove:"🕊",dragon:"🐉",dragon_face:"🐲",dress:"👗",dromedary_camel:"🐪",drooling_face:"🤤",droplet:"💧",drum:"🥁",duck:"🦆",dvd:"📀","e-mail":"📧",eagle:"🦅",ear:"👂",ear_of_rice:"🌾",earth_africa:"🌍",earth_americas:"🌎",earth_asia:"🌏",egg:"🥚",eggplant:"🍆",eight_pointed_black_star:"✴️",eight_spoked_asterisk:"✳️",electric_plug:"🔌",elephant:"🐘",email:"✉️",end:"🔚",envelope_with_arrow:"📩",euro:"💶",european_castle:"🏰",european_post_office:"🏤",evergreen_tree:"🌲",exclamation:"❗️",expressionless:"😑",eye:"👁",eye_speech_bubble:"👁&zwj;🗨",eyeglasses:"👓",eyes:"👀",face_with_head_bandage:"🤕",face_with_thermometer:"🤒",fist_oncoming:"👊",factory:"🏭",fallen_leaf:"🍂",family_man_woman_boy:"👪",family_man_boy:"👨&zwj;👦",family_man_boy_boy:"👨&zwj;👦&zwj;👦",family_man_girl:"👨&zwj;👧",family_man_girl_boy:"👨&zwj;👧&zwj;👦",family_man_girl_girl:"👨&zwj;👧&zwj;👧",family_man_man_boy:"👨&zwj;👨&zwj;👦",family_man_man_boy_boy:"👨&zwj;👨&zwj;👦&zwj;👦",family_man_man_girl:"👨&zwj;👨&zwj;👧",family_man_man_girl_boy:"👨&zwj;👨&zwj;👧&zwj;👦",family_man_man_girl_girl:"👨&zwj;👨&zwj;👧&zwj;👧",family_man_woman_boy_boy:"👨&zwj;👩&zwj;👦&zwj;👦",family_man_woman_girl:"👨&zwj;👩&zwj;👧",family_man_woman_girl_boy:"👨&zwj;👩&zwj;👧&zwj;👦",family_man_woman_girl_girl:"👨&zwj;👩&zwj;👧&zwj;👧",family_woman_boy:"👩&zwj;👦",family_woman_boy_boy:"👩&zwj;👦&zwj;👦",family_woman_girl:"👩&zwj;👧",family_woman_girl_boy:"👩&zwj;👧&zwj;👦",family_woman_girl_girl:"👩&zwj;👧&zwj;👧",family_woman_woman_boy:"👩&zwj;👩&zwj;👦",family_woman_woman_boy_boy:"👩&zwj;👩&zwj;👦&zwj;👦",family_woman_woman_girl:"👩&zwj;👩&zwj;👧",family_woman_woman_girl_boy:"👩&zwj;👩&zwj;👧&zwj;👦",family_woman_woman_girl_girl:"👩&zwj;👩&zwj;👧&zwj;👧",fast_forward:"⏩",fax:"📠",fearful:"😨",feet:"🐾",female_detective:"🕵️&zwj;♀️",ferris_wheel:"🎡",ferry:"⛴",field_hockey:"🏑",file_cabinet:"🗄",file_folder:"📁",film_projector:"📽",film_strip:"🎞",fire:"🔥",fire_engine:"🚒",fireworks:"🎆",first_quarter_moon:"🌓",first_quarter_moon_with_face:"🌛",fish:"🐟",fish_cake:"🍥",fishing_pole_and_fish:"🎣",fist_raised:"✊",fist_left:"🤛",fist_right:"🤜",flags:"🎏",flashlight:"🔦",fleur_de_lis:"⚜️",flight_arrival:"🛬",flight_departure:"🛫",floppy_disk:"💾",flower_playing_cards:"🎴",flushed:"😳",fog:"🌫",foggy:"🌁",football:"🏈",footprints:"👣",fork_and_knife:"🍴",fountain:"⛲️",fountain_pen:"🖋",four_leaf_clover:"🍀",fox_face:"🦊",framed_picture:"🖼",free:"🆓",fried_egg:"🍳",fried_shrimp:"🍤",fries:"🍟",frog:"🐸",frowning:"😦",frowning_face:"☹️",frowning_man:"🙍&zwj;♂️",frowning_woman:"🙍",middle_finger:"🖕",fuelpump:"⛽️",full_moon:"🌕",full_moon_with_face:"🌝",funeral_urn:"⚱️",game_die:"🎲",gear:"⚙️",gem:"💎",gemini:"♊️",ghost:"👻",gift:"🎁",gift_heart:"💝",girl:"👧",globe_with_meridians:"🌐",goal_net:"🥅",goat:"🐐",golf:"⛳️",golfing_man:"🏌️",golfing_woman:"🏌️&zwj;♀️",gorilla:"🦍",grapes:"🍇",green_apple:"🍏",green_book:"📗",green_heart:"💚",green_salad:"🥗",grey_exclamation:"❕",grey_question:"❔",grimacing:"😬",grin:"😁",grinning:"😀",guardsman:"💂",guardswoman:"💂&zwj;♀️",guitar:"🎸",gun:"🔫",haircut_woman:"💇",haircut_man:"💇&zwj;♂️",hamburger:"🍔",hammer:"🔨",hammer_and_pick:"⚒",hammer_and_wrench:"🛠",hamster:"🐹",hand:"✋",handbag:"👜",handshake:"🤝",hankey:"💩",hatched_chick:"🐥",hatching_chick:"🐣",headphones:"🎧",hear_no_evil:"🙉",heart:"❤️",heart_decoration:"💟",heart_eyes:"😍",heart_eyes_cat:"😻",heartbeat:"💓",heartpulse:"💗",hearts:"♥️",heavy_check_mark:"✔️",heavy_division_sign:"➗",heavy_dollar_sign:"💲",heavy_heart_exclamation:"❣️",heavy_minus_sign:"➖",heavy_multiplication_x:"✖️",heavy_plus_sign:"➕",helicopter:"🚁",herb:"🌿",hibiscus:"🌺",high_brightness:"🔆",high_heel:"👠",hocho:"🔪",hole:"🕳",honey_pot:"🍯",horse:"🐴",horse_racing:"🏇",hospital:"🏥",hot_pepper:"🌶",hotdog:"🌭",hotel:"🏨",hotsprings:"♨️",hourglass:"⌛️",hourglass_flowing_sand:"⏳",house:"🏠",house_with_garden:"🏡",houses:"🏘",hugs:"🤗",hushed:"😯",ice_cream:"🍨",ice_hockey:"🏒",ice_skate:"⛸",icecream:"🍦",id:"🆔",ideograph_advantage:"🉐",imp:"👿",inbox_tray:"📥",incoming_envelope:"📨",tipping_hand_woman:"💁",information_source:"ℹ️",innocent:"😇",interrobang:"⁉️",iphone:"📱",izakaya_lantern:"🏮",jack_o_lantern:"🎃",japan:"🗾",japanese_castle:"🏯",japanese_goblin:"👺",japanese_ogre:"👹",jeans:"👖",joy:"😂",joy_cat:"😹",joystick:"🕹",kaaba:"🕋",key:"🔑",keyboard:"⌨️",keycap_ten:"🔟",kick_scooter:"🛴",kimono:"👘",kiss:"💋",kissing:"😗",kissing_cat:"😽",kissing_closed_eyes:"😚",kissing_heart:"😘",kissing_smiling_eyes:"😙",kiwi_fruit:"🥝",koala:"🐨",koko:"🈁",label:"🏷",large_blue_circle:"🔵",large_blue_diamond:"🔷",large_orange_diamond:"🔶",last_quarter_moon:"🌗",last_quarter_moon_with_face:"🌜",latin_cross:"✝️",laughing:"😆",leaves:"🍃",ledger:"📒",left_luggage:"🛅",left_right_arrow:"↔️",leftwards_arrow_with_hook:"↩️",lemon:"🍋",leo:"♌️",leopard:"🐆",level_slider:"🎚",libra:"♎️",light_rail:"🚈",link:"🔗",lion:"🦁",lips:"👄",lipstick:"💄",lizard:"🦎",lock:"🔒",lock_with_ink_pen:"🔏",lollipop:"🍭",loop:"➿",loud_sound:"🔊",loudspeaker:"📢",love_hotel:"🏩",love_letter:"💌",low_brightness:"🔅",lying_face:"🤥",m:"Ⓜ️",mag:"🔍",mag_right:"🔎",mahjong:"🀄️",mailbox:"📫",mailbox_closed:"📪",mailbox_with_mail:"📬",mailbox_with_no_mail:"📭",man:"👨",man_artist:"👨&zwj;🎨",man_astronaut:"👨&zwj;🚀",man_cartwheeling:"🤸&zwj;♂️",man_cook:"👨&zwj;🍳",man_dancing:"🕺",man_facepalming:"🤦&zwj;♂️",man_factory_worker:"👨&zwj;🏭",man_farmer:"👨&zwj;🌾",man_firefighter:"👨&zwj;🚒",man_health_worker:"👨&zwj;⚕️",man_in_tuxedo:"🤵",man_judge:"👨&zwj;⚖️",man_juggling:"🤹&zwj;♂️",man_mechanic:"👨&zwj;🔧",man_office_worker:"👨&zwj;💼",man_pilot:"👨&zwj;✈️",man_playing_handball:"🤾&zwj;♂️",man_playing_water_polo:"🤽&zwj;♂️",man_scientist:"👨&zwj;🔬",man_shrugging:"🤷&zwj;♂️",man_singer:"👨&zwj;🎤",man_student:"👨&zwj;🎓",man_teacher:"👨&zwj;🏫",man_technologist:"👨&zwj;💻",man_with_gua_pi_mao:"👲",man_with_turban:"👳",tangerine:"🍊",mans_shoe:"👞",mantelpiece_clock:"🕰",maple_leaf:"🍁",martial_arts_uniform:"🥋",mask:"😷",massage_woman:"💆",massage_man:"💆&zwj;♂️",meat_on_bone:"🍖",medal_military:"🎖",medal_sports:"🏅",mega:"📣",melon:"🍈",memo:"📝",men_wrestling:"🤼&zwj;♂️",menorah:"🕎",mens:"🚹",metal:"🤘",metro:"🚇",microphone:"🎤",microscope:"🔬",milk_glass:"🥛",milky_way:"🌌",minibus:"🚐",minidisc:"💽",mobile_phone_off:"📴",money_mouth_face:"🤑",money_with_wings:"💸",moneybag:"💰",monkey:"🐒",monkey_face:"🐵",monorail:"🚝",moon:"🌔",mortar_board:"🎓",mosque:"🕌",motor_boat:"🛥",motor_scooter:"🛵",motorcycle:"🏍",motorway:"🛣",mount_fuji:"🗻",mountain:"⛰",mountain_biking_man:"🚵",mountain_biking_woman:"🚵&zwj;♀️",mountain_cableway:"🚠",mountain_railway:"🚞",mountain_snow:"🏔",mouse:"🐭",mouse2:"🐁",movie_camera:"🎥",moyai:"🗿",mrs_claus:"🤶",muscle:"💪",mushroom:"🍄",musical_keyboard:"🎹",musical_note:"🎵",musical_score:"🎼",mute:"🔇",nail_care:"💅",name_badge:"📛",national_park:"🏞",nauseated_face:"🤢",necktie:"👔",negative_squared_cross_mark:"❎",nerd_face:"🤓",neutral_face:"😐",new:"🆕",new_moon:"🌑",new_moon_with_face:"🌚",newspaper:"📰",newspaper_roll:"🗞",next_track_button:"⏭",ng:"🆖",no_good_man:"🙅&zwj;♂️",no_good_woman:"🙅",night_with_stars:"🌃",no_bell:"🔕",no_bicycles:"🚳",no_entry:"⛔️",no_entry_sign:"🚫",no_mobile_phones:"📵",no_mouth:"😶",no_pedestrians:"🚷",no_smoking:"🚭","non-potable_water":"🚱",nose:"👃",notebook:"📓",notebook_with_decorative_cover:"📔",notes:"🎶",nut_and_bolt:"🔩",o:"⭕️",o2:"🅾️",ocean:"🌊",octopus:"🐙",oden:"🍢",office:"🏢",oil_drum:"🛢",ok:"🆗",ok_hand:"👌",ok_man:"🙆&zwj;♂️",ok_woman:"🙆",old_key:"🗝",older_man:"👴",older_woman:"👵",om:"🕉",on:"🔛",oncoming_automobile:"🚘",oncoming_bus:"🚍",oncoming_police_car:"🚔",oncoming_taxi:"🚖",open_file_folder:"📂",open_hands:"👐",open_mouth:"😮",open_umbrella:"☂️",ophiuchus:"⛎",orange_book:"📙",orthodox_cross:"☦️",outbox_tray:"📤",owl:"🦉",ox:"🐂",package:"📦",page_facing_up:"📄",page_with_curl:"📃",pager:"📟",paintbrush:"🖌",palm_tree:"🌴",pancakes:"🥞",panda_face:"🐼",paperclip:"📎",paperclips:"🖇",parasol_on_ground:"⛱",parking:"🅿️",part_alternation_mark:"〽️",partly_sunny:"⛅️",passenger_ship:"🛳",passport_control:"🛂",pause_button:"⏸",peace_symbol:"☮️",peach:"🍑",peanuts:"🥜",pear:"🍐",pen:"🖊",pencil2:"✏️",penguin:"🐧",pensive:"😔",performing_arts:"🎭",persevere:"😣",person_fencing:"🤺",pouting_woman:"🙎",phone:"☎️",pick:"⛏",pig:"🐷",pig2:"🐖",pig_nose:"🐽",pill:"💊",pineapple:"🍍",ping_pong:"🏓",pisces:"♓️",pizza:"🍕",place_of_worship:"🛐",plate_with_cutlery:"🍽",play_or_pause_button:"⏯",point_down:"👇",point_left:"👈",point_right:"👉",point_up:"☝️",point_up_2:"👆",police_car:"🚓",policewoman:"👮&zwj;♀️",poodle:"🐩",popcorn:"🍿",post_office:"🏣",postal_horn:"📯",postbox:"📮",potable_water:"🚰",potato:"🥔",pouch:"👝",poultry_leg:"🍗",pound:"💷",rage:"😡",pouting_cat:"😾",pouting_man:"🙎&zwj;♂️",pray:"🙏",prayer_beads:"📿",pregnant_woman:"🤰",previous_track_button:"⏮",prince:"🤴",princess:"👸",printer:"🖨",purple_heart:"💜",purse:"👛",pushpin:"📌",put_litter_in_its_place:"🚮",question:"❓",rabbit:"🐰",rabbit2:"🐇",racehorse:"🐎",racing_car:"🏎",radio:"📻",radio_button:"🔘",radioactive:"☢️",railway_car:"🚃",railway_track:"🛤",rainbow:"🌈",rainbow_flag:"🏳️&zwj;🌈",raised_back_of_hand:"🤚",raised_hand_with_fingers_splayed:"🖐",raised_hands:"🙌",raising_hand_woman:"🙋",raising_hand_man:"🙋&zwj;♂️",ram:"🐏",ramen:"🍜",rat:"🐀",record_button:"⏺",recycle:"♻️",red_circle:"🔴",registered:"®️",relaxed:"☺️",relieved:"😌",reminder_ribbon:"🎗",repeat:"🔁",repeat_one:"🔂",rescue_worker_helmet:"⛑",restroom:"🚻",revolving_hearts:"💞",rewind:"⏪",rhinoceros:"🦏",ribbon:"🎀",rice:"🍚",rice_ball:"🍙",rice_cracker:"🍘",rice_scene:"🎑",right_anger_bubble:"🗯",ring:"💍",robot:"🤖",rocket:"🚀",rofl:"🤣",roll_eyes:"🙄",roller_coaster:"🎢",rooster:"🐓",rose:"🌹",rosette:"🏵",rotating_light:"🚨",round_pushpin:"📍",rowing_man:"🚣",rowing_woman:"🚣&zwj;♀️",rugby_football:"🏉",running_man:"🏃",running_shirt_with_sash:"🎽",running_woman:"🏃&zwj;♀️",sa:"🈂️",sagittarius:"♐️",sake:"🍶",sandal:"👡",santa:"🎅",satellite:"📡",saxophone:"🎷",school:"🏫",school_satchel:"🎒",scissors:"✂️",scorpion:"🦂",scorpius:"♏️",scream:"😱",scream_cat:"🙀",scroll:"📜",seat:"💺",secret:"㊙️",see_no_evil:"🙈",seedling:"🌱",selfie:"🤳",shallow_pan_of_food:"🥘",shamrock:"☘️",shark:"🦈",shaved_ice:"🍧",sheep:"🐑",shell:"🐚",shield:"🛡",shinto_shrine:"⛩",ship:"🚢",shirt:"👕",shopping:"🛍",shopping_cart:"🛒",shower:"🚿",shrimp:"🦐",signal_strength:"📶",six_pointed_star:"🔯",ski:"🎿",skier:"⛷",skull:"💀",skull_and_crossbones:"☠️",sleeping:"😴",sleeping_bed:"🛌",sleepy:"😪",slightly_frowning_face:"🙁",slightly_smiling_face:"🙂",slot_machine:"🎰",small_airplane:"🛩",small_blue_diamond:"🔹",small_orange_diamond:"🔸",small_red_triangle:"🔺",small_red_triangle_down:"🔻",smile:"😄",smile_cat:"😸",smiley:"😃",smiley_cat:"😺",smiling_imp:"😈",smirk:"😏",smirk_cat:"😼",smoking:"🚬",snail:"🐌",snake:"🐍",sneezing_face:"🤧",snowboarder:"🏂",snowflake:"❄️",snowman:"⛄️",snowman_with_snow:"☃️",sob:"😭",soccer:"⚽️",soon:"🔜",sos:"🆘",sound:"🔉",space_invader:"👾",spades:"♠️",spaghetti:"🍝",sparkle:"❇️",sparkler:"🎇",sparkles:"✨",sparkling_heart:"💖",speak_no_evil:"🙊",speaker:"🔈",speaking_head:"🗣",speech_balloon:"💬",speedboat:"🚤",spider:"🕷",spider_web:"🕸",spiral_calendar:"🗓",spiral_notepad:"🗒",spoon:"🥄",squid:"🦑",stadium:"🏟",star:"⭐️",star2:"🌟",star_and_crescent:"☪️",star_of_david:"✡️",stars:"🌠",station:"🚉",statue_of_liberty:"🗽",steam_locomotive:"🚂",stew:"🍲",stop_button:"⏹",stop_sign:"🛑",stopwatch:"⏱",straight_ruler:"📏",strawberry:"🍓",stuck_out_tongue:"😛",stuck_out_tongue_closed_eyes:"😝",stuck_out_tongue_winking_eye:"😜",studio_microphone:"🎙",stuffed_flatbread:"🥙",sun_behind_large_cloud:"🌥",sun_behind_rain_cloud:"🌦",sun_behind_small_cloud:"🌤",sun_with_face:"🌞",sunflower:"🌻",sunglasses:"😎",sunny:"☀️",sunrise:"🌅",sunrise_over_mountains:"🌄",surfing_man:"🏄",surfing_woman:"🏄&zwj;♀️",sushi:"🍣",suspension_railway:"🚟",sweat:"😓",sweat_drops:"💦",sweat_smile:"😅",sweet_potato:"🍠",swimming_man:"🏊",swimming_woman:"🏊&zwj;♀️",symbols:"🔣",synagogue:"🕍",syringe:"💉",taco:"🌮",tada:"🎉",tanabata_tree:"🎋",taurus:"♉️",taxi:"🚕",tea:"🍵",telephone_receiver:"📞",telescope:"🔭",tennis:"🎾",tent:"⛺️",thermometer:"🌡",thinking:"🤔",thought_balloon:"💭",ticket:"🎫",tickets:"🎟",tiger:"🐯",tiger2:"🐅",timer_clock:"⏲",tipping_hand_man:"💁&zwj;♂️",tired_face:"😫",tm:"™️",toilet:"🚽",tokyo_tower:"🗼",tomato:"🍅",tongue:"👅",top:"🔝",tophat:"🎩",tornado:"🌪",trackball:"🖲",tractor:"🚜",traffic_light:"🚥",train:"🚋",train2:"🚆",tram:"🚊",triangular_flag_on_post:"🚩",triangular_ruler:"📐",trident:"🔱",triumph:"😤",trolleybus:"🚎",trophy:"🏆",tropical_drink:"🍹",tropical_fish:"🐠",truck:"🚚",trumpet:"🎺",tulip:"🌷",tumbler_glass:"🥃",turkey:"🦃",turtle:"🐢",tv:"📺",twisted_rightwards_arrows:"🔀",two_hearts:"💕",two_men_holding_hands:"👬",two_women_holding_hands:"👭",u5272:"🈹",u5408:"🈴",u55b6:"🈺",u6307:"🈯️",u6708:"🈷️",u6709:"🈶",u6e80:"🈵",u7121:"🈚️",u7533:"🈸",u7981:"🈲",u7a7a:"🈳",umbrella:"☔️",unamused:"😒",underage:"🔞",unicorn:"🦄",unlock:"🔓",up:"🆙",upside_down_face:"🙃",v:"✌️",vertical_traffic_light:"🚦",vhs:"📼",vibration_mode:"📳",video_camera:"📹",video_game:"🎮",violin:"🎻",virgo:"♍️",volcano:"🌋",volleyball:"🏐",vs:"🆚",vulcan_salute:"🖖",walking_man:"🚶",walking_woman:"🚶&zwj;♀️",waning_crescent_moon:"🌘",waning_gibbous_moon:"🌖",warning:"⚠️",wastebasket:"🗑",watch:"⌚️",water_buffalo:"🐃",watermelon:"🍉",wave:"👋",wavy_dash:"〰️",waxing_crescent_moon:"🌒",wc:"🚾",weary:"😩",wedding:"💒",weight_lifting_man:"🏋️",weight_lifting_woman:"🏋️&zwj;♀️",whale:"🐳",whale2:"🐋",wheel_of_dharma:"☸️",wheelchair:"♿️",white_check_mark:"✅",white_circle:"⚪️",white_flag:"🏳️",white_flower:"💮",white_large_square:"⬜️",white_medium_small_square:"◽️",white_medium_square:"◻️",white_small_square:"▫️",white_square_button:"🔳",wilted_flower:"🥀",wind_chime:"🎐",wind_face:"🌬",wine_glass:"🍷",wink:"😉",wolf:"🐺",woman:"👩",woman_artist:"👩&zwj;🎨",woman_astronaut:"👩&zwj;🚀",woman_cartwheeling:"🤸&zwj;♀️",woman_cook:"👩&zwj;🍳",woman_facepalming:"🤦&zwj;♀️",woman_factory_worker:"👩&zwj;🏭",woman_farmer:"👩&zwj;🌾",woman_firefighter:"👩&zwj;🚒",woman_health_worker:"👩&zwj;⚕️",woman_judge:"👩&zwj;⚖️",woman_juggling:"🤹&zwj;♀️",woman_mechanic:"👩&zwj;🔧",woman_office_worker:"👩&zwj;💼",woman_pilot:"👩&zwj;✈️",woman_playing_handball:"🤾&zwj;♀️",woman_playing_water_polo:"🤽&zwj;♀️",woman_scientist:"👩&zwj;🔬",woman_shrugging:"🤷&zwj;♀️",woman_singer:"👩&zwj;🎤",woman_student:"👩&zwj;🎓",woman_teacher:"👩&zwj;🏫",woman_technologist:"👩&zwj;💻",woman_with_turban:"👳&zwj;♀️",womans_clothes:"👚",womans_hat:"👒",women_wrestling:"🤼&zwj;♀️",womens:"🚺",world_map:"🗺",worried:"😟",wrench:"🔧",writing_hand:"✍️",x:"❌",yellow_heart:"💛",yen:"💴",yin_yang:"☯️",yum:"😋",zap:"⚡️",zipper_mouth_face:"🤐",zzz:"💤",octocat:'<img alt=":octocat:" height="20" width="20" align="absmiddle" src="https://assets-cdn.github.com/images/icons/emoji/octocat.png">',showdown:"<span style=\"font-family: 'Anonymous Pro', monospace; text-decoration: underline; text-decoration-style: dashed; text-decoration-color: #3e8b8a;text-underline-position: under;\">S</span>"},n.Converter=function(e){var t={},r=[],c=[],d={},u=o,p={parsed:{},raw:"",format:""};function f(e,t){if(t=t||null,n.helper.isString(e)){if(t=e=n.helper.stdExtName(e),n.extensions[e])return console.warn("DEPRECATION WARNING: "+e+" is an old extension that uses a deprecated loading method.Please inform the developer that the extension should be updated!"),void function(e,t){"function"==typeof e&&(e=e(new n.Converter));n.helper.isArray(e)||(e=[e]);var i=l(e,t);if(!i.valid)throw Error(i.error);for(var a=0;a<e.length;++a)switch(e[a].type){case"lang":r.push(e[a]);break;case"output":c.push(e[a]);break;default:throw Error("Extension loader error: Type unrecognized!!!")}}(n.extensions[e],e);if(n.helper.isUndefined(i[e]))throw Error('Extension "'+e+'" could not be loaded. It was either not found or is not a valid extension.');e=i[e]}"function"==typeof e&&(e=e()),n.helper.isArray(e)||(e=[e]);var a=l(e,t);if(!a.valid)throw Error(a.error);for(var o=0;o<e.length;++o){switch(e[o].type){case"lang":r.push(e[o]);break;case"output":c.push(e[o])}if(e[o].hasOwnProperty("listeners"))for(var s in e[o].listeners)e[o].listeners.hasOwnProperty(s)&&h(s,e[o].listeners[s])}}function h(e,t){if(!n.helper.isString(e))throw Error("Invalid argument in converter.listen() method: name must be a string, but "+typeof e+" given");if("function"!=typeof t)throw Error("Invalid argument in converter.listen() method: callback must be a function, but "+typeof t+" given");d.hasOwnProperty(e)||(d[e]=[]),d[e].push(t)}!function(){for(var r in e=e||{},a)a.hasOwnProperty(r)&&(t[r]=a[r]);if("object"!=typeof e)throw Error("Converter expects the passed parameter to be an object, but "+typeof e+" was passed instead.");for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.extensions&&n.helper.forEach(t.extensions,f)}(),this._dispatch=function(e,t,n,r){if(d.hasOwnProperty(e))for(var i=0;i<d[e].length;++i){var a=d[e][i](e,t,this,n,r);a&&void 0!==a&&(t=a)}return t},this.listen=function(e,t){return h(e,t),this},this.makeHtml=function(e){if(!e)return e;var i={gHtmlBlocks:[],gHtmlMdBlocks:[],gHtmlSpans:[],gUrls:{},gTitles:{},gDimensions:{},gListLevel:0,hashLinkCounts:{},langExtensions:r,outputModifiers:c,converter:this,ghCodeBlocks:[],metadata:{parsed:{},raw:"",format:""}};return e=(e=(e=(e=(e=e.replace(/¨/g,"¨T")).replace(/\$/g,"¨D")).replace(/\r\n/g,"\n")).replace(/\r/g,"\n")).replace(/\u00A0/g,"&nbsp;"),t.smartIndentationFix&&(e=function(e){var t=e.match(/^\s*/)[0].length,n=new RegExp("^\\s{0,"+t+"}","gm");return e.replace(n,"")}(e)),e="\n\n"+e+"\n\n",e=(e=n.subParser("detab")(e,t,i)).replace(/^[ \t]+$/gm,""),n.helper.forEach(r,function(r){e=n.subParser("runExtension")(r,e,t,i)}),e=n.subParser("metadata")(e,t,i),e=n.subParser("hashPreCodeTags")(e,t,i),e=n.subParser("githubCodeBlocks")(e,t,i),e=n.subParser("hashHTMLBlocks")(e,t,i),e=n.subParser("hashCodeTags")(e,t,i),e=n.subParser("stripLinkDefinitions")(e,t,i),e=n.subParser("blockGamut")(e,t,i),e=n.subParser("unhashHTMLSpans")(e,t,i),e=(e=(e=n.subParser("unescapeSpecialChars")(e,t,i)).replace(/¨D/g,"$$")).replace(/¨T/g,"¨"),e=n.subParser("completeHTMLDocument")(e,t,i),n.helper.forEach(c,function(r){e=n.subParser("runExtension")(r,e,t,i)}),p=i.metadata,e},this.makeMarkdown=this.makeMd=function(e,t){if(e=(e=(e=e.replace(/\r\n/g,"\n")).replace(/\r/g,"\n")).replace(/>[ \t]+</,">¨NBSP;<"),!t){if(!window||!window.document)throw new Error("HTMLParser is undefined. If in a webworker or nodejs environment, you need to provide a WHATWG DOM and HTML such as JSDOM");t=window.document}var r=t.createElement("div");r.innerHTML=e;var i={preList:function(e){for(var t=e.querySelectorAll("pre"),r=[],i=0;i<t.length;++i)if(1===t[i].childElementCount&&"code"===t[i].firstChild.tagName.toLowerCase()){var a=t[i].firstChild.innerHTML.trim(),o=t[i].firstChild.getAttribute("data-language")||"";if(""===o)for(var s=t[i].firstChild.className.split(" "),l=0;l<s.length;++l){var c=s[l].match(/^language-(.+)$/);if(null!==c){o=c[1];break}}a=n.helper.unescapeHTMLEntities(a),r.push(a),t[i].outerHTML='<precode language="'+o+'" precodenum="'+i.toString()+'"></precode>'}else r.push(t[i].innerHTML),t[i].innerHTML="",t[i].setAttribute("prenum",i.toString());return r}(r)};!function e(t){for(var n=0;n<t.childNodes.length;++n){var r=t.childNodes[n];3===r.nodeType?/\S/.test(r.nodeValue)?(r.nodeValue=r.nodeValue.split("\n").join(" "),r.nodeValue=r.nodeValue.replace(/(\s)+/g,"$1")):(t.removeChild(r),--n):1===r.nodeType&&e(r)}}(r);for(var a=r.childNodes,o="",s=0;s<a.length;s++)o+=n.subParser("makeMarkdown.node")(a[s],i);return o},this.setOption=function(e,n){t[e]=n},this.getOption=function(e){return t[e]},this.getOptions=function(){return t},this.addExtension=function(e,t){f(e,t=t||null)},this.useExtension=function(e){f(e)},this.setFlavor=function(e){if(!s.hasOwnProperty(e))throw Error(e+" flavor was not found");var n=s[e];for(var r in u=e,n)n.hasOwnProperty(r)&&(t[r]=n[r])},this.getFlavor=function(){return u},this.removeExtension=function(e){n.helper.isArray(e)||(e=[e]);for(var t=0;t<e.length;++t){for(var i=e[t],a=0;a<r.length;++a)r[a]===i&&r[a].splice(a,1);for(;0<c.length;++a)c[0]===i&&c[0].splice(a,1)}},this.getAllExtensions=function(){return{language:r,output:c}},this.getMetadata=function(e){return e?p.raw:p.parsed},this.getMetadataFormat=function(){return p.format},this._setMetadataPair=function(e,t){p.parsed[e]=t},this._setMetadataFormat=function(e){p.format=e},this._setMetadataRaw=function(e){p.raw=e}},n.subParser("anchors",function(e,t,r){var i=function(e,i,a,o,s,l,c){if(n.helper.isUndefined(c)&&(c=""),a=a.toLowerCase(),e.search(/\(<?\s*>? ?(['"].*['"])?\)$/m)>-1)o="";else if(!o){if(a||(a=i.toLowerCase().replace(/ ?\n/g," ")),o="#"+a,n.helper.isUndefined(r.gUrls[a]))return e;o=r.gUrls[a],n.helper.isUndefined(r.gTitles[a])||(c=r.gTitles[a])}var d='<a href="'+(o=o.replace(n.helper.regexes.asteriskDashAndColon,n.helper.escapeCharactersCallback))+'"';return""!==c&&null!==c&&(d+=' title="'+(c=(c=c.replace(/"/g,"&quot;")).replace(n.helper.regexes.asteriskDashAndColon,n.helper.escapeCharactersCallback))+'"'),t.openLinksInNewWindow&&!/^#/.test(o)&&(d+=' rel="noopener noreferrer" target="¨E95Eblank"'),d+=">"+i+"</a>"};return e=(e=(e=(e=(e=r.converter._dispatch("anchors.before",e,t,r)).replace(/\[((?:\[[^\]]*]|[^\[\]])*)] ?(?:\n *)?\[(.*?)]()()()()/g,i)).replace(/\[((?:\[[^\]]*]|[^\[\]])*)]()[ \t]*\([ \t]?<([^>]*)>(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g,i)).replace(/\[((?:\[[^\]]*]|[^\[\]])*)]()[ \t]*\([ \t]?<?([\S]+?(?:\([\S]*?\)[\S]*?)?)>?(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g,i)).replace(/\[([^\[\]]+)]()()()()()/g,i),t.ghMentions&&(e=e.replace(/(^|\s)(\\)?(@([a-z\d]+(?:[a-z\d.-]+?[a-z\d]+)*))/gim,function(e,r,i,a,o){if("\\"===i)return r+a;if(!n.helper.isString(t.ghMentionsLink))throw new Error("ghMentionsLink option must be a string");var s=t.ghMentionsLink.replace(/\{u}/g,o),l="";return t.openLinksInNewWindow&&(l=' rel="noopener noreferrer" target="¨E95Eblank"'),r+'<a href="'+s+'"'+l+">"+a+"</a>"})),e=r.converter._dispatch("anchors.after",e,t,r)});var u=/([*~_]+|\b)(((https?|ftp|dict):\/\/|www\.)[^'">\s]+?\.[^'">\s]+?)()(\1)?(?=\s|$)(?!["<>])/gi,p=/([*~_]+|\b)(((https?|ftp|dict):\/\/|www\.)[^'">\s]+\.[^'">\s]+?)([.!?,()\[\]])?(\1)?(?=\s|$)(?!["<>])/gi,f=/()<(((https?|ftp|dict):\/\/|www\.)[^'">\s]+)()>()/gi,h=/(^|\s)(?:mailto:)?([A-Za-z0-9!#$%&'*+-\/=?^_`{|}~.]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)(?=$|\s)/gim,_=/<()(?:mailto:)?([-.\w]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi,m=function(e){return function(t,r,i,a,o,s,l){var c=i=i.replace(n.helper.regexes.asteriskDashAndColon,n.helper.escapeCharactersCallback),d="",u="",p=r||"",f=l||"";return/^www\./i.test(i)&&(i=i.replace(/^www\./i,"http://www.")),e.excludeTrailingPunctuationFromURLs&&s&&(d=s),e.openLinksInNewWindow&&(u=' rel="noopener noreferrer" target="¨E95Eblank"'),p+'<a href="'+i+'"'+u+">"+c+"</a>"+d+f}},g=function(e,t){return function(r,i,a){var o="mailto:";return i=i||"",a=n.subParser("unescapeSpecialChars")(a,e,t),e.encodeEmails?(o=n.helper.encodeEmailAddress(o+a),a=n.helper.encodeEmailAddress(a)):o+=a,i+'<a href="'+o+'">'+a+"</a>"}};n.subParser("autoLinks",function(e,t,n){return e=(e=(e=n.converter._dispatch("autoLinks.before",e,t,n)).replace(f,m(t))).replace(_,g(t,n)),e=n.converter._dispatch("autoLinks.after",e,t,n)}),n.subParser("simplifiedAutoLinks",function(e,t,n){return t.simplifiedAutoLink?(e=n.converter._dispatch("simplifiedAutoLinks.before",e,t,n),e=(e=t.excludeTrailingPunctuationFromURLs?e.replace(p,m(t)):e.replace(u,m(t))).replace(h,g(t,n)),e=n.converter._dispatch("simplifiedAutoLinks.after",e,t,n)):e}),n.subParser("blockGamut",function(e,t,r){return e=r.converter._dispatch("blockGamut.before",e,t,r),e=n.subParser("blockQuotes")(e,t,r),e=n.subParser("headers")(e,t,r),e=n.subParser("horizontalRule")(e,t,r),e=n.subParser("lists")(e,t,r),e=n.subParser("codeBlocks")(e,t,r),e=n.subParser("tables")(e,t,r),e=n.subParser("hashHTMLBlocks")(e,t,r),e=n.subParser("paragraphs")(e,t,r),e=r.converter._dispatch("blockGamut.after",e,t,r)}),n.subParser("blockQuotes",function(e,t,r){e=r.converter._dispatch("blockQuotes.before",e,t,r),e+="\n\n";var i=/(^ {0,3}>[ \t]?.+\n(.+\n)*\n*)+/gm;return t.splitAdjacentBlockquotes&&(i=/^ {0,3}>[\s\S]*?(?:\n\n)/gm),e=e.replace(i,function(e){return e=(e=(e=e.replace(/^[ \t]*>[ \t]?/gm,"")).replace(/¨0/g,"")).replace(/^[ \t]+$/gm,""),e=n.subParser("githubCodeBlocks")(e,t,r),e=(e=(e=n.subParser("blockGamut")(e,t,r)).replace(/(^|\n)/g,"$1  ")).replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(e,t){var n=t;return n=(n=n.replace(/^  /gm,"¨0")).replace(/¨0/g,"")}),n.subParser("hashBlock")("<blockquote>\n"+e+"\n</blockquote>",t,r)}),e=r.converter._dispatch("blockQuotes.after",e,t,r)}),n.subParser("codeBlocks",function(e,t,r){e=r.converter._dispatch("codeBlocks.before",e,t,r);return e=(e=(e+="¨0").replace(/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=¨0))/g,function(e,i,a){var o=i,s=a,l="\n";return o=n.subParser("outdent")(o,t,r),o=n.subParser("encodeCode")(o,t,r),o=(o=(o=n.subParser("detab")(o,t,r)).replace(/^\n+/g,"")).replace(/\n+$/g,""),t.omitExtraWLInCodeBlocks&&(l=""),o="<pre><code>"+o+l+"</code></pre>",n.subParser("hashBlock")(o,t,r)+s})).replace(/¨0/,""),e=r.converter._dispatch("codeBlocks.after",e,t,r)}),n.subParser("codeSpans",function(e,t,r){return void 0===(e=r.converter._dispatch("codeSpans.before",e,t,r))&&(e=""),e=e.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(e,i,a,o){var s=o;return s=(s=s.replace(/^([ \t]*)/g,"")).replace(/[ \t]*$/g,""),s=i+"<code>"+(s=n.subParser("encodeCode")(s,t,r))+"</code>",s=n.subParser("hashHTMLSpans")(s,t,r)}),e=r.converter._dispatch("codeSpans.after",e,t,r)}),n.subParser("completeHTMLDocument",function(e,t,n){if(!t.completeHTMLDocument)return e;e=n.converter._dispatch("completeHTMLDocument.before",e,t,n);var r="html",i="<!DOCTYPE HTML>\n",a="",o='<meta charset="utf-8">\n',s="",l="";for(var c in void 0!==n.metadata.parsed.doctype&&(i="<!DOCTYPE "+n.metadata.parsed.doctype+">\n","html"!==(r=n.metadata.parsed.doctype.toString().toLowerCase())&&"html5"!==r||(o='<meta charset="utf-8">')),n.metadata.parsed)if(n.metadata.parsed.hasOwnProperty(c))switch(c.toLowerCase()){case"doctype":break;case"title":a="<title>"+n.metadata.parsed.title+"</title>\n";break;case"charset":o="html"===r||"html5"===r?'<meta charset="'+n.metadata.parsed.charset+'">\n':'<meta name="charset" content="'+n.metadata.parsed.charset+'">\n';break;case"language":case"lang":s=' lang="'+n.metadata.parsed[c]+'"',l+='<meta name="'+c+'" content="'+n.metadata.parsed[c]+'">\n';break;default:l+='<meta name="'+c+'" content="'+n.metadata.parsed[c]+'">\n'}return e=i+"<html"+s+">\n<head>\n"+a+o+l+"</head>\n<body>\n"+e.trim()+"\n</body>\n</html>",e=n.converter._dispatch("completeHTMLDocument.after",e,t,n)}),n.subParser("detab",function(e,t,n){return e=(e=(e=(e=(e=(e=n.converter._dispatch("detab.before",e,t,n)).replace(/\t(?=\t)/g,"    ")).replace(/\t/g,"¨A¨B")).replace(/¨B(.+?)¨A/g,function(e,t){for(var n=t,r=4-n.length%4,i=0;i<r;i++)n+=" ";return n})).replace(/¨A/g,"    ")).replace(/¨B/g,""),e=n.converter._dispatch("detab.after",e,t,n)}),n.subParser("ellipsis",function(e,t,n){return e=(e=n.converter._dispatch("ellipsis.before",e,t,n)).replace(/\.\.\./g,"…"),e=n.converter._dispatch("ellipsis.after",e,t,n)}),n.subParser("emoji",function(e,t,r){if(!t.emoji)return e;return e=(e=r.converter._dispatch("emoji.before",e,t,r)).replace(/:([\S]+?):/g,function(e,t){return n.helper.emojis.hasOwnProperty(t)?n.helper.emojis[t]:e}),e=r.converter._dispatch("emoji.after",e,t,r)}),n.subParser("encodeAmpsAndAngles",function(e,t,n){return e=(e=(e=(e=(e=n.converter._dispatch("encodeAmpsAndAngles.before",e,t,n)).replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;")).replace(/<(?![a-z\/?$!])/gi,"&lt;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;"),e=n.converter._dispatch("encodeAmpsAndAngles.after",e,t,n)}),n.subParser("encodeBackslashEscapes",function(e,t,r){return e=(e=(e=r.converter._dispatch("encodeBackslashEscapes.before",e,t,r)).replace(/\\(\\)/g,n.helper.escapeCharactersCallback)).replace(/\\([`*_{}\[\]()>#+.!~=|-])/g,n.helper.escapeCharactersCallback),e=r.converter._dispatch("encodeBackslashEscapes.after",e,t,r)}),n.subParser("encodeCode",function(e,t,r){return e=(e=r.converter._dispatch("encodeCode.before",e,t,r)).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/([*_{}\[\]\\=~-])/g,n.helper.escapeCharactersCallback),e=r.converter._dispatch("encodeCode.after",e,t,r)}),n.subParser("escapeSpecialCharsWithinTagAttributes",function(e,t,r){return e=(e=(e=r.converter._dispatch("escapeSpecialCharsWithinTagAttributes.before",e,t,r)).replace(/<\/?[a-z\d_:-]+(?:[\s]+[\s\S]+?)?>/gi,function(e){return e.replace(/(.)<\/?code>(?=.)/g,"$1`").replace(/([\\`*_~=|])/g,n.helper.escapeCharactersCallback)})).replace(/<!(--(?:(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>/gi,function(e){return e.replace(/([\\`*_~=|])/g,n.helper.escapeCharactersCallback)}),e=r.converter._dispatch("escapeSpecialCharsWithinTagAttributes.after",e,t,r)}),n.subParser("githubCodeBlocks",function(e,t,r){return t.ghCodeBlocks?(e=r.converter._dispatch("githubCodeBlocks.before",e,t,r),e=(e=(e+="¨0").replace(/(?:^|\n)(?: {0,3})(```+|~~~+)(?: *)([^\s`~]*)\n([\s\S]*?)\n(?: {0,3})\1/g,function(e,i,a,o){var s=t.omitExtraWLInCodeBlocks?"":"\n";return o=n.subParser("encodeCode")(o,t,r),o="<pre><code"+(a?' class="'+a+" language-"+a+'"':"")+">"+(o=(o=(o=n.subParser("detab")(o,t,r)).replace(/^\n+/g,"")).replace(/\n+$/g,""))+s+"</code></pre>",o=n.subParser("hashBlock")(o,t,r),"\n\n¨G"+(r.ghCodeBlocks.push({text:e,codeblock:o})-1)+"G\n\n"})).replace(/¨0/,""),r.converter._dispatch("githubCodeBlocks.after",e,t,r)):e}),n.subParser("hashBlock",function(e,t,n){return e=(e=n.converter._dispatch("hashBlock.before",e,t,n)).replace(/(^\n+|\n+$)/g,""),e="\n\n¨K"+(n.gHtmlBlocks.push(e)-1)+"K\n\n",e=n.converter._dispatch("hashBlock.after",e,t,n)}),n.subParser("hashCodeTags",function(e,t,r){e=r.converter._dispatch("hashCodeTags.before",e,t,r);return e=n.helper.replaceRecursiveRegExp(e,function(e,i,a,o){var s=a+n.subParser("encodeCode")(i,t,r)+o;return"¨C"+(r.gHtmlSpans.push(s)-1)+"C"},"<code\\b[^>]*>","</code>","gim"),e=r.converter._dispatch("hashCodeTags.after",e,t,r)}),n.subParser("hashElement",function(e,t,n){return function(e,t){var r=t;return r=(r=(r=r.replace(/\n\n/g,"\n")).replace(/^\n/,"")).replace(/\n+$/g,""),r="\n\n¨K"+(n.gHtmlBlocks.push(r)-1)+"K\n\n"}}),n.subParser("hashHTMLBlocks",function(e,t,r){e=r.converter._dispatch("hashHTMLBlocks.before",e,t,r);var i=["pre","div","h1","h2","h3","h4","h5","h6","blockquote","table","dl","ol","ul","script","noscript","form","fieldset","iframe","math","style","section","header","footer","nav","article","aside","address","audio","canvas","figure","hgroup","output","video","p"],a=function(e,t,n,i){var a=e;return-1!==n.search(/\bmarkdown\b/)&&(a=n+r.converter.makeHtml(t)+i),"\n\n¨K"+(r.gHtmlBlocks.push(a)-1)+"K\n\n"};t.backslashEscapesHTMLTags&&(e=e.replace(/\\<(\/?[^>]+?)>/g,function(e,t){return"&lt;"+t+"&gt;"}));for(var o=0;o<i.length;++o)for(var s,l=new RegExp("^ {0,3}(<"+i[o]+"\\b[^>]*>)","im"),c="<"+i[o]+"\\b[^>]*>",d="</"+i[o]+">";-1!==(s=n.helper.regexIndexOf(e,l));){var u=n.helper.splitAtIndex(e,s),p=n.helper.replaceRecursiveRegExp(u[1],a,c,d,"im");if(p===u[1])break;e=u[0].concat(p)}return e=e.replace(/(\n {0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,n.subParser("hashElement")(e,t,r)),e=(e=n.helper.replaceRecursiveRegExp(e,function(e){return"\n\n¨K"+(r.gHtmlBlocks.push(e)-1)+"K\n\n"},"^ {0,3}\x3c!--","--\x3e","gm")).replace(/(?:\n\n)( {0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,n.subParser("hashElement")(e,t,r)),e=r.converter._dispatch("hashHTMLBlocks.after",e,t,r)}),n.subParser("hashHTMLSpans",function(e,t,n){function r(e){return"¨C"+(n.gHtmlSpans.push(e)-1)+"C"}return e=(e=(e=(e=(e=n.converter._dispatch("hashHTMLSpans.before",e,t,n)).replace(/<[^>]+?\/>/gi,function(e){return r(e)})).replace(/<([^>]+?)>[\s\S]*?<\/\1>/g,function(e){return r(e)})).replace(/<([^>]+?)\s[^>]+?>[\s\S]*?<\/\1>/g,function(e){return r(e)})).replace(/<[^>]+?>/gi,function(e){return r(e)}),e=n.converter._dispatch("hashHTMLSpans.after",e,t,n)}),n.subParser("unhashHTMLSpans",function(e,t,n){e=n.converter._dispatch("unhashHTMLSpans.before",e,t,n);for(var r=0;r<n.gHtmlSpans.length;++r){for(var i=n.gHtmlSpans[r],a=0;/¨C(\d+)C/.test(i);){var o=RegExp.$1;if(i=i.replace("¨C"+o+"C",n.gHtmlSpans[o]),10===a){console.error("maximum nesting of 10 spans reached!!!");break}++a}e=e.replace("¨C"+r+"C",i)}return e=n.converter._dispatch("unhashHTMLSpans.after",e,t,n)}),n.subParser("hashPreCodeTags",function(e,t,r){e=r.converter._dispatch("hashPreCodeTags.before",e,t,r);return e=n.helper.replaceRecursiveRegExp(e,function(e,i,a,o){var s=a+n.subParser("encodeCode")(i,t,r)+o;return"\n\n¨G"+(r.ghCodeBlocks.push({text:e,codeblock:s})-1)+"G\n\n"},"^ {0,3}<pre\\b[^>]*>\\s*<code\\b[^>]*>","^ {0,3}</code>\\s*</pre>","gim"),e=r.converter._dispatch("hashPreCodeTags.after",e,t,r)}),n.subParser("headers",function(e,t,r){e=r.converter._dispatch("headers.before",e,t,r);var i=isNaN(parseInt(t.headerLevelStart))?1:parseInt(t.headerLevelStart),a=t.smoothLivePreview?/^(.+)[ \t]*\n={2,}[ \t]*\n+/gm:/^(.+)[ \t]*\n=+[ \t]*\n+/gm,o=t.smoothLivePreview?/^(.+)[ \t]*\n-{2,}[ \t]*\n+/gm:/^(.+)[ \t]*\n-+[ \t]*\n+/gm;e=(e=e.replace(a,function(e,a){var o=n.subParser("spanGamut")(a,t,r),s=t.noHeaderId?"":' id="'+l(a)+'"',c="<h"+i+s+">"+o+"</h"+i+">";return n.subParser("hashBlock")(c,t,r)})).replace(o,function(e,a){var o=n.subParser("spanGamut")(a,t,r),s=t.noHeaderId?"":' id="'+l(a)+'"',c=i+1,d="<h"+c+s+">"+o+"</h"+c+">";return n.subParser("hashBlock")(d,t,r)});var s=t.requireSpaceBeforeHeadingText?/^(#{1,6})[ \t]+(.+?)[ \t]*#*\n+/gm:/^(#{1,6})[ \t]*(.+?)[ \t]*#*\n+/gm;function l(e){var i,a;if(t.customizedHeaderId){var o=e.match(/\{([^{]+?)}\s*$/);o&&o[1]&&(e=o[1])}return i=e,a=n.helper.isString(t.prefixHeaderId)?t.prefixHeaderId:!0===t.prefixHeaderId?"section-":"",t.rawPrefixHeaderId||(i=a+i),i=t.ghCompatibleHeaderId?i.replace(/ /g,"-").replace(/&amp;/g,"").replace(/¨T/g,"").replace(/¨D/g,"").replace(/[&+$,\/:;=?@"#{}|^¨~\[\]`\\*)(%.!'<>]/g,"").toLowerCase():t.rawHeaderId?i.replace(/ /g,"-").replace(/&amp;/g,"&").replace(/¨T/g,"¨").replace(/¨D/g,"$").replace(/["']/g,"-").toLowerCase():i.replace(/[^\w]/g,"").toLowerCase(),t.rawPrefixHeaderId&&(i=a+i),r.hashLinkCounts[i]?i=i+"-"+r.hashLinkCounts[i]++:r.hashLinkCounts[i]=1,i}return e=e.replace(s,function(e,a,o){var s=o;t.customizedHeaderId&&(s=o.replace(/\s?\{([^{]+?)}\s*$/,""));var c=n.subParser("spanGamut")(s,t,r),d=t.noHeaderId?"":' id="'+l(o)+'"',u=i-1+a.length,p="<h"+u+d+">"+c+"</h"+u+">";return n.subParser("hashBlock")(p,t,r)}),e=r.converter._dispatch("headers.after",e,t,r)}),n.subParser("horizontalRule",function(e,t,r){e=r.converter._dispatch("horizontalRule.before",e,t,r);var i=n.subParser("hashBlock")("<hr />",t,r);return e=(e=(e=e.replace(/^ {0,2}( ?-){3,}[ \t]*$/gm,i)).replace(/^ {0,2}( ?\*){3,}[ \t]*$/gm,i)).replace(/^ {0,2}( ?_){3,}[ \t]*$/gm,i),e=r.converter._dispatch("horizontalRule.after",e,t,r)}),n.subParser("images",function(e,t,r){function i(e,t,i,a,o,s,l,c){var d=r.gUrls,u=r.gTitles,p=r.gDimensions;if(i=i.toLowerCase(),c||(c=""),e.search(/\(<?\s*>? ?(['"].*['"])?\)$/m)>-1)a="";else if(""===a||null===a){if(""!==i&&null!==i||(i=t.toLowerCase().replace(/ ?\n/g," ")),a="#"+i,n.helper.isUndefined(d[i]))return e;a=d[i],n.helper.isUndefined(u[i])||(c=u[i]),n.helper.isUndefined(p[i])||(o=p[i].width,s=p[i].height)}t=t.replace(/"/g,"&quot;").replace(n.helper.regexes.asteriskDashAndColon,n.helper.escapeCharactersCallback);var f='<img src="'+(a=a.replace(n.helper.regexes.asteriskDashAndColon,n.helper.escapeCharactersCallback))+'" alt="'+t+'"';return c&&n.helper.isString(c)&&(f+=' title="'+(c=c.replace(/"/g,"&quot;").replace(n.helper.regexes.asteriskDashAndColon,n.helper.escapeCharactersCallback))+'"'),o&&s&&(f+=' width="'+(o="*"===o?"auto":o)+'"',f+=' height="'+(s="*"===s?"auto":s)+'"'),f+=" />"}return e=(e=(e=(e=(e=(e=r.converter._dispatch("images.before",e,t,r)).replace(/!\[([^\]]*?)] ?(?:\n *)?\[([\s\S]*?)]()()()()()/g,i)).replace(/!\[([^\]]*?)][ \t]*()\([ \t]?<?(data:.+?\/.+?;base64,[A-Za-z0-9+\/=\n]+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,function(e,t,n,r,a,o,s,l){return i(e,t,n,r=r.replace(/\s/g,""),a,o,0,l)})).replace(/!\[([^\]]*?)][ \t]*()\([ \t]?<([^>]*)>(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(?:(["'])([^"]*?)\6))?[ \t]?\)/g,i)).replace(/!\[([^\]]*?)][ \t]*()\([ \t]?<?([\S]+?(?:\([\S]*?\)[\S]*?)?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,i)).replace(/!\[([^\[\]]+)]()()()()()/g,i),e=r.converter._dispatch("images.after",e,t,r)}),n.subParser("italicsAndBold",function(e,t,n){function r(e,t,n){return t+e+n}return e=n.converter._dispatch("italicsAndBold.before",e,t,n),e=t.literalMidWordUnderscores?(e=(e=e.replace(/\b___(\S[\s\S]*?)___\b/g,function(e,t){return r(t,"<strong><em>","</em></strong>")})).replace(/\b__(\S[\s\S]*?)__\b/g,function(e,t){return r(t,"<strong>","</strong>")})).replace(/\b_(\S[\s\S]*?)_\b/g,function(e,t){return r(t,"<em>","</em>")}):(e=(e=e.replace(/___(\S[\s\S]*?)___/g,function(e,t){return/\S$/.test(t)?r(t,"<strong><em>","</em></strong>"):e})).replace(/__(\S[\s\S]*?)__/g,function(e,t){return/\S$/.test(t)?r(t,"<strong>","</strong>"):e})).replace(/_([^\s_][\s\S]*?)_/g,function(e,t){return/\S$/.test(t)?r(t,"<em>","</em>"):e}),e=t.literalMidWordAsterisks?(e=(e=e.replace(/([^*]|^)\B\*\*\*(\S[\s\S]*?)\*\*\*\B(?!\*)/g,function(e,t,n){return r(n,t+"<strong><em>","</em></strong>")})).replace(/([^*]|^)\B\*\*(\S[\s\S]*?)\*\*\B(?!\*)/g,function(e,t,n){return r(n,t+"<strong>","</strong>")})).replace(/([^*]|^)\B\*(\S[\s\S]*?)\*\B(?!\*)/g,function(e,t,n){return r(n,t+"<em>","</em>")}):(e=(e=e.replace(/\*\*\*(\S[\s\S]*?)\*\*\*/g,function(e,t){return/\S$/.test(t)?r(t,"<strong><em>","</em></strong>"):e})).replace(/\*\*(\S[\s\S]*?)\*\*/g,function(e,t){return/\S$/.test(t)?r(t,"<strong>","</strong>"):e})).replace(/\*([^\s*][\s\S]*?)\*/g,function(e,t){return/\S$/.test(t)?r(t,"<em>","</em>"):e}),e=n.converter._dispatch("italicsAndBold.after",e,t,n)}),n.subParser("lists",function(e,t,r){function i(e,i){r.gListLevel++,e=e.replace(/\n{2,}$/,"\n");var a=/(\n)?(^ {0,3})([*+-]|\d+[.])[ \t]+((\[(x|X| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(¨0| {0,3}([*+-]|\d+[.])[ \t]+))/gm,o=/\n[ \t]*\n(?!¨0)/.test(e+="¨0");return t.disableForced4SpacesIndentedSublists&&(a=/(\n)?(^ {0,3})([*+-]|\d+[.])[ \t]+((\[(x|X| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(¨0|\2([*+-]|\d+[.])[ \t]+))/gm),e=(e=e.replace(a,function(e,i,a,s,l,c,d){d=d&&""!==d.trim();var u=n.subParser("outdent")(l,t,r),p="";return c&&t.tasklists&&(p=' class="task-list-item" style="list-style-type: none;"',u=u.replace(/^[ \t]*\[(x|X| )?]/m,function(){var e='<input type="checkbox" disabled style="margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;"';return d&&(e+=" checked"),e+=">"})),u=u.replace(/^([-*+]|\d\.)[ \t]+[\S\n ]*/g,function(e){return"¨A"+e}),i||u.search(/\n{2,}/)>-1?(u=n.subParser("githubCodeBlocks")(u,t,r),u=n.subParser("blockGamut")(u,t,r)):(u=(u=n.subParser("lists")(u,t,r)).replace(/\n$/,""),u=(u=n.subParser("hashHTMLBlocks")(u,t,r)).replace(/\n\n+/g,"\n\n"),u=o?n.subParser("paragraphs")(u,t,r):n.subParser("spanGamut")(u,t,r)),u="<li"+p+">"+(u=u.replace("¨A",""))+"</li>\n"})).replace(/¨0/g,""),r.gListLevel--,i&&(e=e.replace(/\s+$/,"")),e}function a(e,t){if("ol"===t){var n=e.match(/^ *(\d+)\./);if(n&&"1"!==n[1])return' start="'+n[1]+'"'}return""}function o(e,n,r){var o=t.disableForced4SpacesIndentedSublists?/^ ?\d+\.[ \t]/gm:/^ {0,3}\d+\.[ \t]/gm,s=t.disableForced4SpacesIndentedSublists?/^ ?[*+-][ \t]/gm:/^ {0,3}[*+-][ \t]/gm,l="ul"===n?o:s,c="";if(-1!==e.search(l))!function t(d){var u=d.search(l),p=a(e,n);-1!==u?(c+="\n\n<"+n+p+">\n"+i(d.slice(0,u),!!r)+"</"+n+">\n",l="ul"===(n="ul"===n?"ol":"ul")?o:s,t(d.slice(u))):c+="\n\n<"+n+p+">\n"+i(d,!!r)+"</"+n+">\n"}(e);else{var d=a(e,n);c="\n\n<"+n+d+">\n"+i(e,!!r)+"</"+n+">\n"}return c}return e=r.converter._dispatch("lists.before",e,t,r),e+="¨0",e=(e=r.gListLevel?e.replace(/^(( {0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(¨0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,function(e,t,n){return o(t,n.search(/[*+-]/g)>-1?"ul":"ol",!0)}):e.replace(/(\n\n|^\n?)(( {0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(¨0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,function(e,t,n,r){return o(n,r.search(/[*+-]/g)>-1?"ul":"ol",!1)})).replace(/¨0/,""),e=r.converter._dispatch("lists.after",e,t,r)}),n.subParser("metadata",function(e,t,n){if(!t.metadata)return e;function r(e){n.metadata.raw=e,(e=(e=e.replace(/&/g,"&amp;").replace(/"/g,"&quot;")).replace(/\n {4}/g," ")).replace(/^([\S ]+): +([\s\S]+?)$/gm,function(e,t,r){return n.metadata.parsed[t]=r,""})}return e=(e=(e=(e=n.converter._dispatch("metadata.before",e,t,n)).replace(/^\s*«««+(\S*?)\n([\s\S]+?)\n»»»+\n/,function(e,t,n){return r(n),"¨M"})).replace(/^\s*---+(\S*?)\n([\s\S]+?)\n---+\n/,function(e,t,i){return t&&(n.metadata.format=t),r(i),"¨M"})).replace(/¨M/g,""),e=n.converter._dispatch("metadata.after",e,t,n)}),n.subParser("outdent",function(e,t,n){return e=(e=(e=n.converter._dispatch("outdent.before",e,t,n)).replace(/^(\t|[ ]{1,4})/gm,"¨0")).replace(/¨0/g,""),e=n.converter._dispatch("outdent.after",e,t,n)}),n.subParser("paragraphs",function(e,t,r){for(var i=(e=(e=(e=r.converter._dispatch("paragraphs.before",e,t,r)).replace(/^\n+/g,"")).replace(/\n+$/g,"")).split(/\n{2,}/g),a=[],o=i.length,s=0;s<o;s++){var l=i[s];l.search(/¨(K|G)(\d+)\1/g)>=0?a.push(l):l.search(/\S/)>=0&&(l=(l=n.subParser("spanGamut")(l,t,r)).replace(/^([ \t]*)/g,"<p>"),l+="</p>",a.push(l))}for(o=a.length,s=0;s<o;s++){for(var c="",d=a[s],u=!1;/¨(K|G)(\d+)\1/.test(d);){var p=RegExp.$1,f=RegExp.$2;c=(c="K"===p?r.gHtmlBlocks[f]:u?n.subParser("encodeCode")(r.ghCodeBlocks[f].text,t,r):r.ghCodeBlocks[f].codeblock).replace(/\$/g,"$$$$"),d=d.replace(/(\n\n)?¨(K|G)\d+\2(\n\n)?/,c),/^<pre\b[^>]*>\s*<code\b[^>]*>/.test(d)&&(u=!0)}a[s]=d}return e=(e=(e=a.join("\n")).replace(/^\n+/g,"")).replace(/\n+$/g,""),r.converter._dispatch("paragraphs.after",e,t,r)}),n.subParser("runExtension",function(e,t,n,r){if(e.filter)t=e.filter(t,r.converter,n);else if(e.regex){var i=e.regex;i instanceof RegExp||(i=new RegExp(i,"g")),t=t.replace(i,e.replace)}return t}),n.subParser("spanGamut",function(e,t,r){return e=r.converter._dispatch("spanGamut.before",e,t,r),e=n.subParser("codeSpans")(e,t,r),e=n.subParser("escapeSpecialCharsWithinTagAttributes")(e,t,r),e=n.subParser("encodeBackslashEscapes")(e,t,r),e=n.subParser("images")(e,t,r),e=n.subParser("anchors")(e,t,r),e=n.subParser("autoLinks")(e,t,r),e=n.subParser("simplifiedAutoLinks")(e,t,r),e=n.subParser("emoji")(e,t,r),e=n.subParser("underline")(e,t,r),e=n.subParser("italicsAndBold")(e,t,r),e=n.subParser("strikethrough")(e,t,r),e=n.subParser("ellipsis")(e,t,r),e=n.subParser("hashHTMLSpans")(e,t,r),e=n.subParser("encodeAmpsAndAngles")(e,t,r),t.simpleLineBreaks?/\n\n¨K/.test(e)||(e=e.replace(/\n+/g,"<br />\n")):e=e.replace(/  +\n/g,"<br />\n"),e=r.converter._dispatch("spanGamut.after",e,t,r)}),n.subParser("strikethrough",function(e,t,r){return t.strikethrough&&(e=(e=r.converter._dispatch("strikethrough.before",e,t,r)).replace(/(?:~){2}([\s\S]+?)(?:~){2}/g,function(e,i){return function(e){return t.simplifiedAutoLink&&(e=n.subParser("simplifiedAutoLinks")(e,t,r)),"<del>"+e+"</del>"}(i)}),e=r.converter._dispatch("strikethrough.after",e,t,r)),e}),n.subParser("stripLinkDefinitions",function(e,t,r){var i=function(e,i,a,o,s,l,c){return i=i.toLowerCase(),a.match(/^data:.+?\/.+?;base64,/)?r.gUrls[i]=a.replace(/\s/g,""):r.gUrls[i]=n.subParser("encodeAmpsAndAngles")(a,t,r),l?l+c:(c&&(r.gTitles[i]=c.replace(/"|'/g,"&quot;")),t.parseImgDimensions&&o&&s&&(r.gDimensions[i]={width:o,height:s}),"")};return e=(e=(e=(e+="¨0").replace(/^ {0,3}\[(.+)]:[ \t]*\n?[ \t]*<?(data:.+?\/.+?;base64,[A-Za-z0-9+\/=\n]+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n\n|(?=¨0)|(?=\n\[))/gm,i)).replace(/^ {0,3}\[(.+)]:[ \t]*\n?[ \t]*<?([^>\s]+)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n+|(?=¨0))/gm,i)).replace(/¨0/,"")}),n.subParser("tables",function(e,t,r){if(!t.tables)return e;function i(e,i){return"<td"+i+">"+n.subParser("spanGamut")(e,t,r)+"</td>\n"}function a(e){var a,o=e.split("\n");for(a=0;a<o.length;++a)/^ {0,3}\|/.test(o[a])&&(o[a]=o[a].replace(/^ {0,3}\|/,"")),/\|[ \t]*$/.test(o[a])&&(o[a]=o[a].replace(/\|[ \t]*$/,"")),o[a]=n.subParser("codeSpans")(o[a],t,r);var s,l,c,d,u=o[0].split("|").map(function(e){return e.trim()}),p=o[1].split("|").map(function(e){return e.trim()}),f=[],h=[],_=[],m=[];for(o.shift(),o.shift(),a=0;a<o.length;++a)""!==o[a].trim()&&f.push(o[a].split("|").map(function(e){return e.trim()}));if(u.length<p.length)return e;for(a=0;a<p.length;++a)_.push((s=p[a],/^:[ \t]*--*$/.test(s)?' style="text-align:left;"':/^--*[ \t]*:[ \t]*$/.test(s)?' style="text-align:right;"':/^:[ \t]*--*[ \t]*:$/.test(s)?' style="text-align:center;"':""));for(a=0;a<u.length;++a)n.helper.isUndefined(_[a])&&(_[a]=""),h.push((l=u[a],c=_[a],d=void 0,d="",l=l.trim(),(t.tablesHeaderId||t.tableHeaderId)&&(d=' id="'+l.replace(/ /g,"_").toLowerCase()+'"'),"<th"+d+c+">"+(l=n.subParser("spanGamut")(l,t,r))+"</th>\n"));for(a=0;a<f.length;++a){for(var g=[],v=0;v<h.length;++v)n.helper.isUndefined(f[a][v]),g.push(i(f[a][v],_[v]));m.push(g)}return function(e,t){for(var n="<table>\n<thead>\n<tr>\n",r=e.length,i=0;i<r;++i)n+=e[i];for(n+="</tr>\n</thead>\n<tbody>\n",i=0;i<t.length;++i){n+="<tr>\n";for(var a=0;a<r;++a)n+=t[i][a];n+="</tr>\n"}return n+="</tbody>\n</table>\n"}(h,m)}return e=(e=(e=(e=r.converter._dispatch("tables.before",e,t,r)).replace(/\\(\|)/g,n.helper.escapeCharactersCallback)).replace(/^ {0,3}\|?.+\|.+\n {0,3}\|?[ \t]*:?[ \t]*(?:[-=]){2,}[ \t]*:?[ \t]*\|[ \t]*:?[ \t]*(?:[-=]){2,}[\s\S]+?(?:\n\n|¨0)/gm,a)).replace(/^ {0,3}\|.+\|[ \t]*\n {0,3}\|[ \t]*:?[ \t]*(?:[-=]){2,}[ \t]*:?[ \t]*\|[ \t]*\n( {0,3}\|.+\|[ \t]*\n)*(?:\n|¨0)/gm,a),e=r.converter._dispatch("tables.after",e,t,r)}),n.subParser("underline",function(e,t,r){return t.underline?(e=r.converter._dispatch("underline.before",e,t,r),e=(e=t.literalMidWordUnderscores?(e=e.replace(/\b___(\S[\s\S]*?)___\b/g,function(e,t){return"<u>"+t+"</u>"})).replace(/\b__(\S[\s\S]*?)__\b/g,function(e,t){return"<u>"+t+"</u>"}):(e=e.replace(/___(\S[\s\S]*?)___/g,function(e,t){return/\S$/.test(t)?"<u>"+t+"</u>":e})).replace(/__(\S[\s\S]*?)__/g,function(e,t){return/\S$/.test(t)?"<u>"+t+"</u>":e})).replace(/(_)/g,n.helper.escapeCharactersCallback),e=r.converter._dispatch("underline.after",e,t,r)):e}),n.subParser("unescapeSpecialChars",function(e,t,n){return e=(e=n.converter._dispatch("unescapeSpecialChars.before",e,t,n)).replace(/¨E(\d+)E/g,function(e,t){var n=parseInt(t);return String.fromCharCode(n)}),e=n.converter._dispatch("unescapeSpecialChars.after",e,t,n)}),n.subParser("makeMarkdown.blockquote",function(e,t){var r="";if(e.hasChildNodes())for(var i=e.childNodes,a=i.length,o=0;o<a;++o){var s=n.subParser("makeMarkdown.node")(i[o],t);""!==s&&(r+=s)}return r="> "+(r=r.trim()).split("\n").join("\n> ")}),n.subParser("makeMarkdown.codeBlock",function(e,t){var n=e.getAttribute("language"),r=e.getAttribute("precodenum");return"```"+n+"\n"+t.preList[r]+"\n```"}),n.subParser("makeMarkdown.codeSpan",function(e){return"`"+e.innerHTML+"`"}),n.subParser("makeMarkdown.emphasis",function(e,t){var r="";if(e.hasChildNodes()){r+="*";for(var i=e.childNodes,a=i.length,o=0;o<a;++o)r+=n.subParser("makeMarkdown.node")(i[o],t);r+="*"}return r}),n.subParser("makeMarkdown.header",function(e,t,r){var i=new Array(r+1).join("#"),a="";if(e.hasChildNodes()){a=i+" ";for(var o=e.childNodes,s=o.length,l=0;l<s;++l)a+=n.subParser("makeMarkdown.node")(o[l],t)}return a}),n.subParser("makeMarkdown.hr",function(){return"---"}),n.subParser("makeMarkdown.image",function(e){var t="";return e.hasAttribute("src")&&(t+="!["+e.getAttribute("alt")+"](",t+="<"+e.getAttribute("src")+">",e.hasAttribute("width")&&e.hasAttribute("height")&&(t+=" ="+e.getAttribute("width")+"x"+e.getAttribute("height")),e.hasAttribute("title")&&(t+=' "'+e.getAttribute("title")+'"'),t+=")"),t}),n.subParser("makeMarkdown.links",function(e,t){var r="";if(e.hasChildNodes()&&e.hasAttribute("href")){var i=e.childNodes,a=i.length;r="[";for(var o=0;o<a;++o)r+=n.subParser("makeMarkdown.node")(i[o],t);r+="](",r+="<"+e.getAttribute("href")+">",e.hasAttribute("title")&&(r+=' "'+e.getAttribute("title")+'"'),r+=")"}return r}),n.subParser("makeMarkdown.list",function(e,t,r){var i="";if(!e.hasChildNodes())return"";for(var a=e.childNodes,o=a.length,s=e.getAttribute("start")||1,l=0;l<o;++l)if(void 0!==a[l].tagName&&"li"===a[l].tagName.toLowerCase()){i+=("ol"===r?s.toString()+". ":"- ")+n.subParser("makeMarkdown.listItem")(a[l],t),++s}return(i+="\n\x3c!-- --\x3e\n").trim()}),n.subParser("makeMarkdown.listItem",function(e,t){for(var r="",i=e.childNodes,a=i.length,o=0;o<a;++o)r+=n.subParser("makeMarkdown.node")(i[o],t);return/\n$/.test(r)?r=r.split("\n").join("\n    ").replace(/^ {4}$/gm,"").replace(/\n\n+/g,"\n\n"):r+="\n",r}),n.subParser("makeMarkdown.node",function(e,t,r){r=r||!1;var i="";if(3===e.nodeType)return n.subParser("makeMarkdown.txt")(e,t);if(8===e.nodeType)return"\x3c!--"+e.data+"--\x3e\n\n";if(1!==e.nodeType)return"";switch(e.tagName.toLowerCase()){case"h1":r||(i=n.subParser("makeMarkdown.header")(e,t,1)+"\n\n");break;case"h2":r||(i=n.subParser("makeMarkdown.header")(e,t,2)+"\n\n");break;case"h3":r||(i=n.subParser("makeMarkdown.header")(e,t,3)+"\n\n");break;case"h4":r||(i=n.subParser("makeMarkdown.header")(e,t,4)+"\n\n");break;case"h5":r||(i=n.subParser("makeMarkdown.header")(e,t,5)+"\n\n");break;case"h6":r||(i=n.subParser("makeMarkdown.header")(e,t,6)+"\n\n");break;case"p":r||(i=n.subParser("makeMarkdown.paragraph")(e,t)+"\n\n");break;case"blockquote":r||(i=n.subParser("makeMarkdown.blockquote")(e,t)+"\n\n");break;case"hr":r||(i=n.subParser("makeMarkdown.hr")(e,t)+"\n\n");break;case"ol":r||(i=n.subParser("makeMarkdown.list")(e,t,"ol")+"\n\n");break;case"ul":r||(i=n.subParser("makeMarkdown.list")(e,t,"ul")+"\n\n");break;case"precode":r||(i=n.subParser("makeMarkdown.codeBlock")(e,t)+"\n\n");break;case"pre":r||(i=n.subParser("makeMarkdown.pre")(e,t)+"\n\n");break;case"table":r||(i=n.subParser("makeMarkdown.table")(e,t)+"\n\n");break;case"code":i=n.subParser("makeMarkdown.codeSpan")(e,t);break;case"em":case"i":i=n.subParser("makeMarkdown.emphasis")(e,t);break;case"strong":case"b":i=n.subParser("makeMarkdown.strong")(e,t);break;case"del":i=n.subParser("makeMarkdown.strikethrough")(e,t);break;case"a":i=n.subParser("makeMarkdown.links")(e,t);break;case"img":i=n.subParser("makeMarkdown.image")(e,t);break;default:i=e.outerHTML+"\n\n"}return i}),n.subParser("makeMarkdown.paragraph",function(e,t){var r="";if(e.hasChildNodes())for(var i=e.childNodes,a=i.length,o=0;o<a;++o)r+=n.subParser("makeMarkdown.node")(i[o],t);return r=r.trim()}),n.subParser("makeMarkdown.pre",function(e,t){var n=e.getAttribute("prenum");return"<pre>"+t.preList[n]+"</pre>"}),n.subParser("makeMarkdown.strikethrough",function(e,t){var r="";if(e.hasChildNodes()){r+="~~";for(var i=e.childNodes,a=i.length,o=0;o<a;++o)r+=n.subParser("makeMarkdown.node")(i[o],t);r+="~~"}return r}),n.subParser("makeMarkdown.strong",function(e,t){var r="";if(e.hasChildNodes()){r+="**";for(var i=e.childNodes,a=i.length,o=0;o<a;++o)r+=n.subParser("makeMarkdown.node")(i[o],t);r+="**"}return r}),n.subParser("makeMarkdown.table",function(e,t){var r,i,a="",o=[[],[]],s=e.querySelectorAll("thead>tr>th"),l=e.querySelectorAll("tbody>tr");for(r=0;r<s.length;++r){var c=n.subParser("makeMarkdown.tableCell")(s[r],t),d="---";if(s[r].hasAttribute("style"))switch(s[r].getAttribute("style").toLowerCase().replace(/\s/g,"")){case"text-align:left;":d=":---";break;case"text-align:right;":d="---:";break;case"text-align:center;":d=":---:"}o[0][r]=c.trim(),o[1][r]=d}for(r=0;r<l.length;++r){var u=o.push([])-1,p=l[r].getElementsByTagName("td");for(i=0;i<s.length;++i){var f=" ";void 0!==p[i]&&(f=n.subParser("makeMarkdown.tableCell")(p[i],t)),o[u].push(f)}}var h=3;for(r=0;r<o.length;++r)for(i=0;i<o[r].length;++i){var _=o[r][i].length;_>h&&(h=_)}for(r=0;r<o.length;++r){for(i=0;i<o[r].length;++i)1===r?":"===o[r][i].slice(-1)?o[r][i]=n.helper.padEnd(o[r][i].slice(-1),h-1,"-")+":":o[r][i]=n.helper.padEnd(o[r][i],h,"-"):o[r][i]=n.helper.padEnd(o[r][i],h);a+="| "+o[r].join(" | ")+" |\n"}return a.trim()}),n.subParser("makeMarkdown.tableCell",function(e,t){var r="";if(!e.hasChildNodes())return"";for(var i=e.childNodes,a=i.length,o=0;o<a;++o)r+=n.subParser("makeMarkdown.node")(i[o],t,!0);return r.trim()}),n.subParser("makeMarkdown.txt",function(e){var t=e.nodeValue;return t=(t=t.replace(/ +/g," ")).replace(/¨NBSP;/g," "),t=(t=(t=(t=(t=(t=(t=(t=(t=n.helper.unescapeHTMLEntities(t)).replace(/([*_~|`])/g,"\\$1")).replace(/^(\s*)>/g,"\\$1>")).replace(/^#/gm,"\\#")).replace(/^(\s*)([-=]{3,})(\s*)$/,"$1\\$2$3")).replace(/^( {0,3}\d+)\./gm,"$1\\.")).replace(/^( {0,3})([+-])/gm,"$1\\$2")).replace(/]([\s]*)\(/g,"\\]$1\\(")).replace(/^ {0,3}\[([\S \t]*?)]:/gm,"\\[$1]:")});e.exports?e.exports=n:this.showdown=n}).call(commonjsGlobal)});function flt$1(e,t,n){if(null==e||""==e)return 0;if("number"!=typeof e&&String(parseFloat(e))!=e){if(-1!=(e+="").indexOf(" ")){var r=e.split(" ");e=isNaN(parseFloat(r[0]))?r.slice(r.length-1).join(" "):e}e=strip_number_groups(e,n),e=parseFloat(e),isNaN(e)&&(e=0)}return e=parseFloat(e),null!=t?_round(e,t):e}function strip_number_groups(e,t){t||(t=get_number_format$1());var n=get_number_format_info$1(t),r=new RegExp("."===n.group_sep?"\\.":n.group_sep,"g");if(e=e.replace(r,""),"."!==n.decimal_str&&""!==n.decimal_str){var i=new RegExp(n.decimal_str,"g");e=e.replace(i,".")}return e}function format_currency$1(e,t,n){var r=get_number_format$1(t),i=get_currency_symbol(t);return void 0===n&&(n=frappe.boot.sysdefaults.currency_precision||null),i?i+" "+format_number(e,r,n):format_number(e,r,n)}function get_currency_symbol(e){return frappe.boot?frappe.boot.sysdefaults&&"Yes"==frappe.boot.sysdefaults.hide_currency_symbol?null:(e||(e=frappe.boot.sysdefaults.currency),frappe.model.get_value(":Currency",e,"symbol")||e):frappe.currency_symbols[e]}function get_number_format$1(e){return frappe.boot&&frappe.boot.sysdefaults&&frappe.boot.sysdefaults.number_format||"#,###.##"}function get_number_format_info$1(e){var t=frappe.number_format_info[e];return t||(t={decimal_str:".",group_sep:","}),t.precision=e.split(t.decimal_str).slice(1)[0].length,t}function _round(e,t){var n=e<0,r=cint(t),i=Math.pow(10,r),a=+(r?Math.abs(e)*i:Math.abs(e)).toFixed(8),o=Math.floor(a),s=t||.5!=a-o?Math.round(a):o%2==0?o:o+1;return s=r?s/i:s,n?-s:s}function roundNumber(e,t){return _round(e,t)}function precision$1(e,t){if(cur_frm){t||(t=cur_frm.doc);var n=frappe.meta.get_docfield(t.doctype,e,t.parent||t.name);return n||console.log(e+": could not find docfield in method precision()"),frappe.meta.get_field_precision(n,t)}return frappe.boot.sysdefaults.float_precision}function in_list$1(e,t){return e.includes(t)}function remainder(e,t,n){n=cint(n);var r=Math.pow(10,n);if(n)var i=e*r%(t*r)/r;else i=e%t;return flt$1(i,n)}function round_based_on_smallest_currency_fraction(e,t,n){var r=flt$1(frappe.model.get_value(":Currency",t,"smallest_currency_fraction_value"));if(r){var i=remainder(e,r,n);i>r/2?e+=r-i:e-=i}else e=_round(e);return e}function fmt_money(e,t){return format_currency$1(e,t)}frappe.provide("frappe.tools"),frappe.tools.downloadify=function(e,t,n){if(t&&t.length&&!has_common(t,t))frappe.msgprint(__("Export not allowed. You need {0} role to export.",[frappe.utils.comma_or(t)]));else{var r=n+".csv",i=frappe.tools.to_csv(e),a=document.createElement("a");if("download"in a){var o=new Blob([i],{type:"text/csv;charset=UTF-8"});a.href=URL.createObjectURL(o),a.download=r}else a.href="data:attachment/csv,"+encodeURIComponent(i),a.download=r,a.target="_blank";document.body.appendChild(a),a.click(),document.body.removeChild(a)}},frappe.markdown=function(e){for(frappe.md2html||(frappe.md2html=new showdown.Converter);"\n"===e.substr(0,1);)e=e.substr(1);for(var t=0,n=e.split("\n")[0];-1!==["\n","\t"].indexOf(n.substr(0,1));)t++,n=n.substr(1);if(t&&t!=n.length){var r=[];$.each(e.split("\n"),function(e,n){r.push(n.substr(t))}),e=r.join("\n")}return frappe.md2html.makeHtml(e)},frappe.tools.to_csv=function(e){var t=[];return $.each(e,function(e,n){n=$.map(n,function(e){return null==e&&(e=""),"string"==typeof e?'"'+$("<i>").html(e.replace(/"/g,'""')).text()+'"':e}),t.push(n.join(","))}),t.join("\n")},frappe.provide("frappe.datetime"),frappe.defaultDateFormat="YYYY-MM-DD",frappe.defaultTimeFormat="HH:mm:ss",frappe.defaultDatetimeFormat=frappe.defaultDateFormat+" "+frappe.defaultTimeFormat,moment.defaultFormat=frappe.defaultDateFormat,frappe.provide("frappe.datetime"),$.extend(frappe.datetime,{convert_to_user_tz:function(e,t){if(frappe.sys_defaults.time_zone)var n=moment.tz(e,frappe.sys_defaults.time_zone).local();else n=moment(e);return!1===t?n:n.format(frappe.defaultDatetimeFormat)},convert_to_system_tz:function(e,t){if(frappe.sys_defaults.time_zone)var n=moment(e).tz(frappe.sys_defaults.time_zone);else n=moment(e);return!1===t?n:n.format(frappe.defaultDatetimeFormat)},is_timezone_same:function(){return!frappe.sys_defaults.time_zone||moment().tz(frappe.sys_defaults.time_zone).utcOffset()===moment().utcOffset()},str_to_obj:function(e){return moment(e,frappe.defaultDatetimeFormat)._d},obj_to_str:function(e){return moment(e).locale("en").format()},obj_to_user:function(e){return moment(e).format(frappe.datetime.get_user_date_fmt().toUpperCase())},get_diff:function(e,t){return moment(e).diff(t,"days")},get_hour_diff:function(e,t){return moment(e).diff(t,"hours")},get_day_diff:function(e,t){return moment(e).diff(t,"days")},add_days:function(e,t){return moment(e).add(t,"days").format()},add_months:function(e,t){return moment(e).add(t,"months").format()},week_start:function(){return moment().startOf("week").format()},week_end:function(){return moment().endOf("week").format()},month_start:function(){return moment().startOf("month").format()},month_end:function(){return moment().endOf("month").format()},quarter_start:function(){return moment().startOf("quarter").format()},quarter_end:function(){return moment().endOf("quarter").format()},year_start:function(){return moment().startOf("year").format()},year_end:function(){return moment().endOf("year").format()},get_user_time_fmt:function(){return frappe.sys_defaults&&frappe.sys_defaults.time_format||"HH:mm:ss"},get_user_date_fmt:function(){return frappe.sys_defaults&&frappe.sys_defaults.date_format||"yyyy-mm-dd"},get_user_fmt:function(){return frappe.sys_defaults&&frappe.sys_defaults.date_format||"yyyy-mm-dd"},str_to_user:function(e,t){if(void 0===t&&(t=!1),!e)return"";var n=frappe.datetime.get_user_time_fmt();if(t)return moment(e,frappe.defaultTimeFormat).format(n);var r=frappe.datetime.get_user_date_fmt().toUpperCase();return"string"!=typeof e||-1===e.indexOf(" ")?moment(e).format(r):moment(e,"YYYY-MM-DD HH:mm:ss").format(r+" "+n)},get_datetime_as_string:function(e){return moment(e).format("YYYY-MM-DD HH:mm:ss")},user_to_str:function(e,t){void 0===t&&(t=!1);var n=frappe.datetime.get_user_time_fmt();if(t)return moment(e,n).format(frappe.defaultTimeFormat);var r=frappe.datetime.get_user_date_fmt().toUpperCase(),i="YYYY-MM-DD";return-1!==e.indexOf(" ")&&(r+=" "+n,i+=" HH:mm:ss"),moment(e,[r.replace("YYYY","YY"),r]).locale("en").format(i)},user_to_obj:function(e){return frappe.datetime.str_to_obj(frappe.datetime.user_to_str(e))},global_date_format:function(e){var t=moment(e);return t._f&&-1!==t._f.indexOf("HH")?t.format("Do MMMM YYYY, h:mma"):t.format("Do MMMM YYYY")},now_date:function(e){return void 0===e&&(e=!1),frappe.datetime._date(frappe.defaultDateFormat,e)},now_time:function(e){return void 0===e&&(e=!1),frappe.datetime._date(frappe.defaultTimeFormat,e)},now_datetime:function(e){return void 0===e&&(e=!1),frappe.datetime._date(frappe.defaultDatetimeFormat,e)},_date:function(e,t){void 0===t&&(t=!1);var n,r=frappe.sys_defaults&&frappe.sys_defaults.time_zone;return n=r?moment.tz(r):moment(),t?frappe.datetime.moment_to_date_obj(n):n.format(e)},moment_to_date_obj:function(e){var t=new Date,n=e.toArray();return t.setFullYear(n[0]),t.setMonth(n[1]),t.setDate(n[2]),t.setHours(n[3]),t.setMinutes(n[4]),t.setSeconds(n[5]),t.setMilliseconds(n[6]),t},nowdate:function(){return frappe.datetime.now_date()},get_today:function(){return frappe.datetime.now_date()},get_time:function(e){return moment(e).format("hh:mm A")},validate:function(e){return moment(e,[frappe.defaultDateFormat,frappe.defaultDatetimeFormat,frappe.defaultTimeFormat],!0).isValid()}}),Object.defineProperties(window,{dateutil:{get:function(){return console.warn("Please use `frappe.datetime` instead of `dateutil`. It will be deprecated soon."),frappe.datetime},configurable:!0},date:{get:function(){return console.warn("Please use `frappe.datetime` instead of `date`. It will be deprecated soon."),frappe.datetime},configurable:!0},get_today:{get:function(){return console.warn("Please use `frappe.datetime.get_today` instead of `get_today`. It will be deprecated soon."),frappe.datetime.get_today},configurable:!0}}),window.cstr=function(e){return null==e?"":e+""},window.cint=function(e,t){return!0===e?1:!1===e?0:("0"!==(e+="")&&(e=lstrip(e,["0"])),e=parseInt(e),isNaN(e)&&(e=void 0===t?0:t),e)},window.toTitle=function(e){var t=e.split(" "),n=[];for(var r in t)n[r]=t[r].charAt(0).toUpperCase()+t[r].slice(1);return n.join(" ")},window.is_null=function(e){if(null==e||""===cstr(e).trim())return!0},window.copy_dict=function(e){var t={};for(var n in e)t[n]=e[n];return t},window.validate_email=function(e){return frappe.utils.validate_type(e,"email")},window.validate_phone=function(e){return frappe.utils.validate_type(e,"phone")},window.validate_name=function(e){return frappe.utils.validate_type(e,"name")},window.validate_url=function(e){return frappe.utils.validate_type(e,"url")},window.nth=function(e){var t="th";return"1"==((e=cint(e))+"").substr(-1)&&(t="st"),"2"==(e+"").substr(-1)&&(t="nd"),"3"==(e+"").substr(-1)&&(t="rd"),e+t},window.has_words=function(e,t){if(!t)return!0;if(!e)return!1;for(var n=0,r=e.length;n<r;n++)if(-1!=t.indexOf(e[n]))return!0;return!1},window.has_common=function(e,t){if(!e||!t)return!1;for(var n=0,r=e.length;n<r;n++)if(in_list(t,e[n]))return!0;return!1},window.frappe||(window.frappe={}),frappe.number_format_info={"#,###.##":{decimal_str:".",group_sep:","},"#.###,##":{decimal_str:",",group_sep:"."},"# ###.##":{decimal_str:".",group_sep:" "},"# ###,##":{decimal_str:",",group_sep:" "},"#'###.##":{decimal_str:".",group_sep:"'"},"#, ###.##":{decimal_str:".",group_sep:", "},"#,##,###.##":{decimal_str:".",group_sep:","},"#,###.###":{decimal_str:".",group_sep:","},"#.###":{decimal_str:"",group_sep:"."},"#,###":{decimal_str:"",group_sep:","}},window.format_number=function(e,t,n){t||(t=get_number_format$1(),null==n&&(n=cint(frappe.defaults.get_default("float_precision"))||3));var r=get_number_format_info$1(t);null==n&&(n=r.precision);var i=!1;(e=flt$1(e,n,t))<0&&(i=!0);var a=(e=(e=Math.abs(e)).toFixed(n)).split("."),o=r.group_sep?3:0;if(o){for(var s=a[0],l="",c=(s.length,s.length);c>=0;c--){var d=replace_all(l,r.group_sep,"").length;"#,##,###.##"==t&&-1!=l.indexOf(",")&&(o=2,d+=1),l+=s.charAt(c),!d||(d+1)%o||0==c||(l+=r.group_sep)}a[0]=l.split("").reverse().join("")}return a[0]+""==""&&(a[0]="0"),a[1]=a[1]&&r.decimal_str?r.decimal_str+a[1]:"",(i?"-":"")+a[0]+a[1]},Object.assign(window,{flt:flt$1,cint:cint,strip_number_groups:strip_number_groups,format_currency:format_currency$1,fmt_money:fmt_money,get_currency_symbol:get_currency_symbol,get_number_format:get_number_format$1,get_number_format_info:get_number_format_info$1,_round:_round,roundNumber:roundNumber,precision:precision$1,remainder:remainder,round_based_on_smallest_currency_fraction:round_based_on_smallest_currency_fraction,in_list:in_list$1}),frappe.provide("frappe.help"),frappe.help.youtube_id={},frappe.help.has_help=function(e){return frappe.help.youtube_id[e]},frappe.help.show=function(e){frappe.help.youtube_id[e]&&frappe.help.show_video(frappe.help.youtube_id[e])},frappe.help.show_video=function(e,t){if(frappe.utils.is_url(e)){e=e.match('(?:youtube.com/(?:[^/]+/.+/|(?:v|e(?:mbed)?)/|.*[?&]v=)|youtu.be/)([^"&?\\s]{11})')[1]}var n=new frappe.ui.Dialog({title:t||__("Help"),size:"large"}),r=$('<div class="video-player" data-plyr-provider="youtube" data-plyr-embed-id="'+e+'"></div>');r.appendTo(n.body),n.show(),n.$wrapper.addClass("video-modal");var i=new frappe.Plyr(r[0],{hideControls:!0,resetOnEnd:!0});n.onhide=function(){i.destroy()}},$("body").on("click","a.help-link",function(){var e=$(this).attr("data-doctype");e&&frappe.help.show(e)}),frappe.provide("frappe.help.help_links"),frappe.help.help_links["data-import-tool"]=[{label:"Importing and Exporting Data",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/data/data-import-tool.html"}],frappe.help.help_links["modules/Setup"]=[{label:"Users and Permissions",url:"http://frappe.github.io/erpnext/user/manual/en/setting-up/users-and-permissions/"},{label:"Settings",url:"http://frappe.github.io/erpnext/user/manual/en/setting-up/settings/"},{label:"Data Management",url:"http://frappe.github.io/erpnext/user/manual/en/setting-up/data/"},{label:"Email",url:"http://frappe.github.io/erpnext/user/manual/en/setting-up/email/"},{label:"Printing",url:"http://frappe.github.io/erpnext/user/manual/en/setting-up/print/"}],frappe.help.help_links["List/User"]=[{label:"Adding Users",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/users-and-permissions/adding-users"},{label:"Rename User",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/articles/rename-user"}],frappe.help.help_links["permission-manager"]=[{label:"Role Permissions Manager",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/users-and-permissions/role-based-permissions"}],frappe.help.help_links["user-permissions"]=[{label:"User Permissions",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/users-and-permissions/user-permissions"}],frappe.help.help_links["Form/System Settings"]=[{label:"System Settings",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/settings/system-settings"}],frappe.help.help_links["List/Email Account"]=[{label:"Email Account",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/email/email-account"}],frappe.help.help_links["List/Notification"]=[{label:"Notification",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/email/email-alerts"}],frappe.help.help_links["Form/Print Settings"]=[{label:"Print Settings",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/print/print-settings"}],frappe.help.help_links["print-format-builder"]=[{label:"Print Format Builder",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/print/print-format-builder"}],frappe.provide("frappe.contacts"),$.extend(frappe.contacts,{clear_address_and_contact:function(e){$(e.fields_dict.address_html.wrapper).html(""),e.fields_dict.contact_html&&$(e.fields_dict.contact_html.wrapper).html("")},render_address_and_contact:function(e){e.fields_dict.address_html&&"addr_list"in e.doc.__onload&&$(e.fields_dict.address_html.wrapper).html(frappe.render_template("address_list",e.doc.__onload)).find(".btn-address").on("click",function(){frappe.new_doc("Address")}),e.fields_dict.contact_html&&"contact_list"in e.doc.__onload&&$(e.fields_dict.contact_html.wrapper).html(frappe.render_template("contact_list",e.doc.__onload)).find(".btn-contact").on("click",function(){frappe.new_doc("Contact")})},get_last_doc:function(e){var t=frappe.route_history.slice().reverse().find(function(t){return"Form"===t[0]&&t[1]!==e.doctype}),n=t&&t[1],r=t&&t[2];return t&&t.length>3&&(r=t.slice(2).join("/")),{doctype:n,docname:r}}}),frappe.preview_email=function(e,t,n,r,i){return void 0===r&&(r=!1),void 0===i&&(i=!1),frappe.call({method:"frappe.email.email_body.get_email_html",args:{subject:"Test",template:e,args:t,header:n,with_container:r}}).then(function(e){var t=e.message;if(t=t.replace(/embed=/,"src="),i)return t;var n=frappe.msgprint({message:'<iframe width="100%" height="600px" style="border: none;"></iframe>',wide:!0});setTimeout(function(){n.$wrapper.find("iframe").contents().find("html").html(t),n.$wrapper.find(".modal-dialog").css("width","70%")},1e3)})},frappe.provide("frappe.file_manager"),frappe.file_manager=function(){var e=[],t=null,n=null;function r(){e=[],t=null,n=null}return{cut:function(n,r){e=n,t=r},paste:function(i){return new Promise(function(a,o){if(0===e.length||!t)return r(),void a();n=i,frappe.call({method:"frappe.core.doctype.file.file.move_file",args:{file_list:e,new_parent:n,old_parent:t},callback:function(e){r(),a(e)}}).fail(o)})},get can_paste(){return Boolean(e.length>0&&t)},get old_folder(){return t},get files_to_move(){return e}}}();var script={name:"ProgressRing",props:{primary:String,secondary:String,radius:Number,progress:Number,stroke:Number},data:function(){var e=this.radius-2*this.stroke;return{normalizedRadius:e,circumference:2*e*Math.PI}},computed:{strokeDashoffset:function(){return this.circumference-this.progress/100*this.circumference}}},__vue_script__=script,__vue_render__=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("svg",{attrs:{height:2*e.radius,width:2*e.radius}},[n("circle",{style:{stroke:e.secondary,strokeDashoffset:0},attrs:{"stroke-dasharray":e.circumference+" "+e.circumference,"stroke-width":e.stroke,fill:"transparent",r:e.normalizedRadius,cx:e.radius,cy:e.radius}}),e._v(" "),n("circle",{style:{stroke:e.primary,strokeDashoffset:e.strokeDashoffset},attrs:{"stroke-dasharray":e.circumference+" "+e.circumference,"stroke-width":e.stroke,fill:"transparent",r:e.normalizedRadius,cx:e.radius,cy:e.radius}}),e._v(" "),n("text",{style:{color:"var(--text-color)",fontSize:"var(--text-xs)",fontWeight:"var(--text-bold)"},attrs:{"dominant-baseline":"middle","text-anchor":"middle",x:e.radius,y:e.radius}},[e._v("\n\t\t"+e._s(e.progress)+"%\n\t")])])},__vue_staticRenderFns__=[];__vue_render__._withStripped=!0;var __vue_inject_styles__=function(e){e&&e("data-v-b9e62506_0",{source:"\ncircle[data-v-b9e62506] {\n\ttransition: stroke-dashoffset 0.35s;\n\ttransform: rotate(-90deg);\n\ttransform-origin: 50% 50%;\n}\n",map:{version:3,sources:["/home/runner/work/frappe/frappe/frappe-bench/apps/frappe/frappe/public/js/frappe/file_uploader/ProgressRing.vue"],names:[],mappings:";AAsEA;CACA,mCAAA;CACA,yBAAA;CACA,yBAAA;AACA",file:"ProgressRing.vue",sourcesContent:['<template>\n\t<svg :height="radius * 2" :width="radius * 2">\n\t\t<circle\n\t\t\t:stroke-dasharray="circumference + \' \' + circumference"\n\t\t\t:style="{\n\t\t\t\tstroke: secondary,\n\t\t\t\tstrokeDashoffset: 0\n\t\t\t}"\n\t\t\t:stroke-width="stroke"\n\t\t\tfill="transparent"\n\t\t\t:r="normalizedRadius"\n\t\t\t:cx="radius"\n\t\t\t:cy="radius"\n\t\t/>\n\t\t<circle\n\t\t\t:stroke-dasharray="circumference + \' \' + circumference"\n\t\t\t:style="{\n\t\t\t\tstroke: primary,\n\t\t\t\tstrokeDashoffset: strokeDashoffset\n\t\t\t}"\n\t\t\t:stroke-width="stroke"\n\t\t\tfill="transparent"\n\t\t\t:r="normalizedRadius"\n\t\t\t:cx="radius"\n\t\t\t:cy="radius"\n\t\t/>\n\t\t<text\n\t\t\tdominant-baseline="middle"\n\t\t\ttext-anchor="middle"\n\t\t\t:x="radius"\n\t\t\t:y="radius"\n\t\t\t:style="{\n\t\t\t\tcolor: \'var(--text-color)\',\n\t\t\t\tfontSize: \'var(--text-xs)\',\n\t\t\t\tfontWeight: \'var(--text-bold)\'\n\t\t\t}"\n\t\t>\n\t\t\t{{ progress }}%\n\t\t</text>\n\t</svg>\n</template>\n<script>\nexport default {\n\tname: "ProgressRing",\n\tprops: {\n\t\tprimary: String,\n\t\tsecondary: String,\n\t\tradius: Number,\n\t\tprogress: Number,\n\t\tstroke: Number\n\t},\n\tdata() {\n\t\tconst normalizedRadius = this.radius - this.stroke * 2;\n\t\tconst circumference = normalizedRadius * 2 * Math.PI;\n\n\t\treturn {\n\t\t\tnormalizedRadius,\n\t\t\tcircumference\n\t\t};\n\t},\n\tcomputed: {\n\t\tstrokeDashoffset() {\n\t\t\treturn (\n\t\t\t\tthis.circumference - (this.progress / 100) * this.circumference\n\t\t\t);\n\t\t}\n\t}\n};\n<\/script>\n<style scoped>\ncircle {\n\ttransition: stroke-dashoffset 0.35s;\n\ttransform: rotate(-90deg);\n\ttransform-origin: 50% 50%;\n}\n</style>\n']},media:void 0})},__vue_scope_id__="data-v-b9e62506",__vue_module_identifier__=void 0,__vue_is_functional_template__=!1;function __vue_normalize__(e,t,n,r,i,a,o,s){var l,c=("function"==typeof n?n.options:n)||{};if(c.__file="/home/runner/work/frappe/frappe/frappe-bench/apps/frappe/frappe/public/js/frappe/file_uploader/ProgressRing.vue",c.render||(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,i&&(c.functional=!0)),c._scopeId=r,t&&(l=function(e){t.call(this,o(e))}),void 0!==l)if(c.functional){var d=c.render;c.render=function(e,t){return l.call(t),d(e,t)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return c}function __vue_create_injector__(){var e=document.head||document.getElementsByTagName("head")[0],t=__vue_create_injector__.styles||(__vue_create_injector__.styles={}),n="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,i){if(!document.querySelector('style[data-vue-ssr-id~="'+r+'"]')){var a=n?i.media||"default":r,o=t[a]||(t[a]={ids:[],parts:[],element:void 0});if(!o.ids.includes(r)){var s=i.source,l=o.ids.length;if(o.ids.push(r),n&&(o.element=o.element||document.querySelector("style[data-group="+a+"]")),!o.element){var c=o.element=document.createElement("style");c.type="text/css",i.media&&c.setAttribute("media",i.media),n&&(c.setAttribute("data-group",a),c.setAttribute("data-next-index","0")),e.appendChild(c)}if(n&&(l=parseInt(o.element.getAttribute("data-next-index")),o.element.setAttribute("data-next-index",l+1)),o.element.styleSheet)o.parts.push(s),o.element.styleSheet.cssText=o.parts.filter(Boolean).join("\n");else{var d=document.createTextNode(s),u=o.element.childNodes;u[l]&&o.element.removeChild(u[l]),u.length?o.element.insertBefore(d,u[l]):o.element.appendChild(d)}}}}}var ProgressRing=__vue_normalize__({render:__vue_render__,staticRenderFns:__vue_staticRenderFns__},__vue_inject_styles__,__vue_script__,__vue_scope_id__,__vue_is_functional_template__,__vue_module_identifier__,__vue_create_injector__,void 0),script$1={name:"FilePreview",props:["file"],components:{ProgressRing:ProgressRing},data:function(){return{src:null}},mounted:function(){var e=this;if(this.is_image&&window.FileReader){var t=new FileReader;t.onload=function(){return e.src=t.result},t.readAsDataURL(this.file.file_obj)}},filters:{file_size:function(e){return frappe.form.formatters.FileSize(e)},file_name:function(e){return e}},computed:{private_icon:function(){return frappe.utils.icon(this.is_private?"lock":"unlock")},is_private:function(){return this.file.doc?this.file.doc.is_private:this.file.private},uploaded:function(){return this.file.total&&this.file.total===this.file.progress&&!this.file.failed},is_image:function(){return this.file.file_obj.type.startsWith("image")},progress:function(){var e=Math.round(100*this.file.progress/this.file.total);return isNaN(e)&&(e=0),e}}},__vue_script__$1=script$1,__vue_render__$1=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"file-preview"},[n("div",{staticClass:"file-icon"},[e.is_image?n("img",{attrs:{src:e.src,alt:e.file.name}}):n("div",{staticClass:"fallback",domProps:{innerHTML:e._s(e.frappe.utils.icon("file","md"))}})]),e._v(" "),n("div",[n("div",[e.file.doc?n("a",{staticClass:"flex",attrs:{href:e.file.doc.file_url,target:"_blank"}},[n("span",{staticClass:"file-name"},[e._v(e._s(e._f("file_name")(e.file.name)))]),e._v(" "),n("div",{staticClass:"ml-2",domProps:{innerHTML:e._s(e.private_icon)}})]):n("span",{staticClass:"flex"},[n("span",{staticClass:"file-name"},[e._v(e._s(e._f("file_name")(e.file.name)))]),e._v(" "),n("button",{staticClass:"ml-2 btn-reset",attrs:{title:e.__("Toggle Public/Private")},on:{click:function(t){return e.$emit("toggle_private")}}},[n("div",{domProps:{innerHTML:e._s(e.private_icon)}})])])]),e._v(" "),n("div",[n("span",{staticClass:"file-size"},[e._v("\n\t\t\t\t"+e._s(e._f("file_size")(e.file.file_obj.size))+"\n\t\t\t")])])]),e._v(" "),n("div",{staticClass:"file-actions"},[n("ProgressRing",{directives:[{name:"show",rawName:"v-show",value:e.file.uploading&&!e.uploaded,expression:"file.uploading && !uploaded"}],attrs:{primary:"var(--primary-color)",secondary:"var(--gray-200)",radius:"24",progress:e.progress,stroke:"3"}}),e._v(" "),e.uploaded?n("div",{domProps:{innerHTML:e._s(e.frappe.utils.icon("solid-success","lg"))}}):e._e(),e._v(" "),e.file.failed?n("div",{domProps:{innerHTML:e._s(e.frappe.utils.icon("solid-red","lg"))}}):e._e(),e._v(" "),e.uploaded||e.file.uploading?e._e():n("button",{staticClass:"btn",domProps:{innerHTML:e._s(e.frappe.utils.icon("delete","md"))},on:{click:function(t){return e.$emit("remove")}}})],1)])},__vue_staticRenderFns__$1=[];__vue_render__$1._withStripped=!0;var __vue_inject_styles__$1=function(e){e&&e("data-v-10a7fce0_0",{source:"\n.file-preview {\n\tdisplay: flex;\n\talign-items: center;\n\tpadding: 0.75rem;\n\tborder: 1px solid transparent;\n}\n.file-preview + .file-preview {\n\tborder-top-color: var(--border-color);\n}\n.file-preview:hover {\n\tbackground-color: var(--bg-color);\n\tborder-color: var(--dark-border-color);\n\tborder-radius: var(--border-radius);\n}\n.file-preview:hover + .file-preview {\n\tborder-top-color: transparent;\n}\n.file-icon {\n\tborder-radius: var(--border-radius);\n\twidth: 2.625rem;\n\theight: 2.625rem;\n\toverflow: hidden;\n\tmargin-right: var(--margin-md);\n\tflex-shrink: 0;\n}\n.file-icon img {\n\twidth: 100%;\n\theight: 100%;\n\tobject-fit: cover;\n}\n.file-icon .fallback {\n\twidth: 100%;\n\theight: 100%;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tborder: 1px solid var(--border-color);\n\tborder-radius: var(--border-radius);\n}\n.file-name {\n\tfont-size: var(--text-base);\n\tfont-weight: var(--text-bold);\n\tcolor: var(--text-color);\n\tdisplay: -webkit-box;\n\t-webkit-line-clamp: 1;\n\t-webkit-box-orient: vertical;\n\toverflow: hidden;\n}\n.file-size {\n\tfont-size: var(--text-sm);\n\tcolor: var(--text-light);\n}\n.file-actions {\n\twidth: 3rem;\n\tflex-shrink: 0;\n\tmargin-left: auto;\n\ttext-align: center;\n}\n.file-actions .btn {\n\tpadding: var(--padding-xs);\n\tbox-shadow: none;\n}\n",map:{version:3,sources:["/home/runner/work/frappe/frappe/frappe-bench/apps/frappe/frappe/public/js/frappe/file_uploader/FilePreview.vue"],names:[],mappings:";AAuGA;CACA,aAAA;CACA,mBAAA;CACA,gBAAA;CACA,6BAAA;AACA;AAEA;CACA,qCAAA;AACA;AAEA;CACA,iCAAA;CACA,sCAAA;CACA,mCAAA;AACA;AAEA;CACA,6BAAA;AACA;AAEA;CACA,mCAAA;CACA,eAAA;CACA,gBAAA;CACA,gBAAA;CACA,8BAAA;CACA,cAAA;AACA;AAEA;CACA,WAAA;CACA,YAAA;CACA,iBAAA;AACA;AAEA;CACA,WAAA;CACA,YAAA;CACA,aAAA;CACA,mBAAA;CACA,uBAAA;CACA,qCAAA;CACA,mCAAA;AACA;AAEA;CACA,2BAAA;CACA,6BAAA;CACA,wBAAA;CACA,oBAAA;CACA,qBAAA;CACA,4BAAA;CACA,gBAAA;AACA;AAEA;CACA,yBAAA;CACA,wBAAA;AACA;AAEA;CACA,WAAA;CACA,cAAA;CACA,iBAAA;CACA,kBAAA;AACA;AAEA;CACA,0BAAA;CACA,gBAAA;AACA",file:"FilePreview.vue",sourcesContent:['<template>\n\t<div class="file-preview">\n\t\t<div class="file-icon">\n\t\t\t<img\n\t\t\t\tv-if="is_image"\n\t\t\t\t:src="src"\n\t\t\t\t:alt="file.name"\n\t\t\t>\n\t\t\t<div class="fallback" v-else v-html="frappe.utils.icon(\'file\', \'md\')">\n\t\t\t</div>\n\t\t</div>\n\t\t<div>\n\t\t\t<div>\n\t\t\t\t<a class="flex" :href="file.doc.file_url" v-if="file.doc" target="_blank">\n\t\t\t\t\t<span class="file-name">{{ file.name | file_name }}</span>\n\t\t\t\t\t<div class="ml-2" v-html="private_icon"></div>\n\t\t\t\t</a>\n\t\t\t\t<span class="flex" v-else>\n\t\t\t\t\t<span class="file-name">{{ file.name | file_name }}</span>\n\t\t\t\t\t<button class="ml-2 btn-reset" @click="$emit(\'toggle_private\')" :title="__(\'Toggle Public/Private\')">\n\t\t\t\t\t\t<div v-html="private_icon"></div>\n\t\t\t\t\t</button>\n\t\t\t\t</span>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<span class="file-size">\n\t\t\t\t\t{{ file.file_obj.size | file_size }}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="file-actions">\n\t\t\t<ProgressRing\n\t\t\t\tv-show="file.uploading && !uploaded"\n\t\t\t\tprimary="var(--primary-color)"\n\t\t\t\tsecondary="var(--gray-200)"\n\t\t\t\tradius="24"\n\t\t\t\t:progress="progress"\n\t\t\t\tstroke="3"\n\t\t\t/>\n\t\t\t<div v-if="uploaded" v-html="frappe.utils.icon(\'solid-success\', \'lg\')"></div>\n\t\t\t<div v-if="file.failed" v-html="frappe.utils.icon(\'solid-red\', \'lg\')"></div>\n\t\t\t<button v-if="!uploaded && !file.uploading" class="btn" @click="$emit(\'remove\')" v-html="frappe.utils.icon(\'delete\', \'md\')"></button>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport ProgressRing from \'./ProgressRing.vue\';\nexport default {\n\tname: \'FilePreview\',\n\tprops: [\'file\'],\n\tcomponents: {\n\t\tProgressRing\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tsrc: null\n\t\t}\n\t},\n\tmounted() {\n\t\tif (this.is_image) {\n\t\t\tif (window.FileReader) {\n\t\t\t\tlet fr = new FileReader();\n\t\t\t\tfr.onload = () => this.src = fr.result;\n\t\t\t\tfr.readAsDataURL(this.file.file_obj);\n\t\t\t}\n\t\t}\n\t},\n\tfilters: {\n\t\tfile_size(value) {\n\t\t\treturn frappe.form.formatters.FileSize(value);\n\t\t},\n\t\tfile_name(value) {\n\t\t\treturn value;\n\t\t\t// return frappe.utils.file_name_ellipsis(value, 9);\n\t\t}\n\t},\n\tcomputed: {\n\t\tprivate_icon() {\n\t\t\treturn frappe.utils.icon(this.is_private ? \'lock\' : \'unlock\');\n\t\t},\n\t\tis_private() {\n\t\t\treturn this.file.doc ? this.file.doc.is_private : this.file.private;\n\t\t},\n\t\tuploaded() {\n\t\t\treturn this.file.total && this.file.total === this.file.progress && !this.file.failed;\n\t\t},\n\t\tis_image() {\n\t\t\treturn this.file.file_obj.type.startsWith(\'image\');\n\t\t},\n\t\tprogress() {\n\t\t\tlet value = Math.round((this.file.progress * 100) / this.file.total);\n\t\t\tif (isNaN(value)) {\n\t\t\t\tvalue = 0;\n\t\t\t}\n\t\t\treturn value;\n\t\t}\n\t}\n}\n<\/script>\n\n<style>\n.file-preview {\n\tdisplay: flex;\n\talign-items: center;\n\tpadding: 0.75rem;\n\tborder: 1px solid transparent;\n}\n\n.file-preview + .file-preview {\n\tborder-top-color: var(--border-color);\n}\n\n.file-preview:hover {\n\tbackground-color: var(--bg-color);\n\tborder-color: var(--dark-border-color);\n\tborder-radius: var(--border-radius);\n}\n\n.file-preview:hover + .file-preview {\n\tborder-top-color: transparent;\n}\n\n.file-icon {\n\tborder-radius: var(--border-radius);\n\twidth: 2.625rem;\n\theight: 2.625rem;\n\toverflow: hidden;\n\tmargin-right: var(--margin-md);\n\tflex-shrink: 0;\n}\n\n.file-icon img {\n\twidth: 100%;\n\theight: 100%;\n\tobject-fit: cover;\n}\n\n.file-icon .fallback {\n\twidth: 100%;\n\theight: 100%;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tborder: 1px solid var(--border-color);\n\tborder-radius: var(--border-radius);\n}\n\n.file-name {\n\tfont-size: var(--text-base);\n\tfont-weight: var(--text-bold);\n\tcolor: var(--text-color);\n\tdisplay: -webkit-box;\n\t-webkit-line-clamp: 1;\n\t-webkit-box-orient: vertical;\n\toverflow: hidden;\n}\n\n.file-size {\n\tfont-size: var(--text-sm);\n\tcolor: var(--text-light);\n}\n\n.file-actions {\n\twidth: 3rem;\n\tflex-shrink: 0;\n\tmargin-left: auto;\n\ttext-align: center;\n}\n\n.file-actions .btn {\n\tpadding: var(--padding-xs);\n\tbox-shadow: none;\n}\n</style>\n']},media:void 0})},__vue_scope_id__$1=void 0,__vue_module_identifier__$1=void 0,__vue_is_functional_template__$1=!1;function __vue_normalize__$1(e,t,n,r,i,a,o,s){var l,c=("function"==typeof n?n.options:n)||{};if(c.__file="/home/runner/work/frappe/frappe/frappe-bench/apps/frappe/frappe/public/js/frappe/file_uploader/FilePreview.vue",c.render||(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,i&&(c.functional=!0)),c._scopeId=r,t&&(l=function(e){t.call(this,o(e))}),void 0!==l)if(c.functional){var d=c.render;c.render=function(e,t){return l.call(t),d(e,t)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return c}function __vue_create_injector__$1(){var e=document.head||document.getElementsByTagName("head")[0],t=__vue_create_injector__$1.styles||(__vue_create_injector__$1.styles={}),n="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,i){if(!document.querySelector('style[data-vue-ssr-id~="'+r+'"]')){var a=n?i.media||"default":r,o=t[a]||(t[a]={ids:[],parts:[],element:void 0});if(!o.ids.includes(r)){var s=i.source,l=o.ids.length;if(o.ids.push(r),n&&(o.element=o.element||document.querySelector("style[data-group="+a+"]")),!o.element){var c=o.element=document.createElement("style");c.type="text/css",i.media&&c.setAttribute("media",i.media),n&&(c.setAttribute("data-group",a),c.setAttribute("data-next-index","0")),e.appendChild(c)}if(n&&(l=parseInt(o.element.getAttribute("data-next-index")),o.element.setAttribute("data-next-index",l+1)),o.element.styleSheet)o.parts.push(s),o.element.styleSheet.cssText=o.parts.filter(Boolean).join("\n");else{var d=document.createTextNode(s),u=o.element.childNodes;u[l]&&o.element.removeChild(u[l]),u.length?o.element.insertBefore(d,u[l]):o.element.appendChild(d)}}}}}var FilePreview=__vue_normalize__$1({render:__vue_render__$1,staticRenderFns:__vue_staticRenderFns__$1},__vue_inject_styles__$1,__vue_script__$1,__vue_scope_id__$1,__vue_is_functional_template__$1,__vue_module_identifier__$1,__vue_create_injector__$1,void 0),script$2={name:"TreeNode",props:["node","selected_node"],components:{TreeNode:function(){return frappe.ui.components.TreeNode}},computed:{icon:function(){var e={open:frappe.utils.icon("folder-open","md"),closed:frappe.utils.icon("folder-normal","md"),leaf:frappe.utils.icon("primitive-dot","xs"),search:frappe.utils.icon("search")};return this.node.by_search?e.search:this.node.is_leaf?e.leaf:this.node.open?e.open:e.closed}}},__vue_script__$2=script$2,__vue_render__$2=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tree-node",class:{opened:e.node.open}},[n("span",{staticClass:"tree-link",class:{active:e.node.value===e.selected_node.value},attrs:{disabled:e.node.fetching},on:{click:function(t){return e.$emit("node-click",e.node)}}},[n("div",{domProps:{innerHTML:e._s(e.icon)}}),e._v(" "),n("a",{staticClass:"tree-label"},[e._v(e._s(e.node.label))])]),e._v(" "),n("ul",{directives:[{name:"show",rawName:"v-show",value:e.node.open,expression:"node.open"}],staticClass:"tree-children"},[e._l(e.node.children,function(t){return n("TreeNode",{key:t.value,attrs:{node:t,selected_node:e.selected_node},on:{"node-click":function(t){return e.$emit("node-click",t)},"load-more":function(t){return e.$emit("load-more",t)}}})}),e._v(" "),e.node.has_more_children?n("button",{staticClass:"btn btn-xs btn-load-more",attrs:{disabled:e.node.children_loading},on:{click:function(t){return e.$emit("load-more",e.node)}}},[e._v("\n\t\t\t"+e._s(e.node.children_loading?e.__("Loading..."):e.__("Load more"))+"\n\t\t")]):e._e()],2)])},__vue_staticRenderFns__$2=[];__vue_render__$2._withStripped=!0;var __vue_inject_styles__$2=function(e){e&&e("data-v-3c35ce3a_0",{source:"\n.btn-load-more[data-v-3c35ce3a] {\n\tmargin-left: 1.6rem;\n\tmargin-top: 0.5rem;\n}\n",map:{version:3,sources:["/home/runner/work/frappe/frappe/frappe-bench/apps/frappe/frappe/public/js/frappe/file_uploader/TreeNode.vue"],names:[],mappings:";AAwDA;CACA,mBAAA;CACA,kBAAA;AACA",file:"TreeNode.vue",sourcesContent:['<template>\n\t<div class="tree-node" :class="{ opened: node.open }">\n\t\t<span\n\t\t\tclass="tree-link"\n\t\t\t@click="$emit(\'node-click\', node)"\n\t\t\t:class="{ active: node.value === selected_node.value }"\n\t\t\t:disabled="node.fetching"\n\t\t>\n\t\t\t<div v-html="icon"></div>\n\t\t\t<a class="tree-label">{{ node.label }}</a>\n\t\t</span>\n\t\t<ul class="tree-children" v-show="node.open">\n\t\t\t<TreeNode\n\t\t\t\tv-for="n in node.children"\n\t\t\t\t:key="n.value"\n\t\t\t\t:node="n"\n\t\t\t\t:selected_node="selected_node"\n\t\t\t\t@node-click="n => $emit(\'node-click\', n)"\n\t\t\t\t@load-more="n => $emit(\'load-more\', n)"\n\t\t\t/>\n\t\t\t<button\n\t\t\t\tclass="btn btn-xs btn-load-more"\n\t\t\t\tv-if="node.has_more_children"\n\t\t\t\t@click="$emit(\'load-more\', node)"\n\t\t\t\t:disabled="node.children_loading"\n\t\t\t>\n\t\t\t\t{{ node.children_loading ? __("Loading...") : __("Load more") }}\n\t\t\t</button>\n\t\t</ul>\n\t</div>\n</template>\n<script>\nexport default {\n\tname: "TreeNode",\n\tprops: ["node", "selected_node"],\n\tcomponents: {\n\t\tTreeNode: () => frappe.ui.components.TreeNode\n\t},\n\tcomputed: {\n\t\ticon() {\n\t\t\tlet icons = {\n\t\t\t\topen: frappe.utils.icon("folder-open", "md"),\n\t\t\t\tclosed: frappe.utils.icon("folder-normal", "md"),\n\t\t\t\tleaf: frappe.utils.icon("primitive-dot", "xs"),\n\t\t\t\tsearch: frappe.utils.icon("search")\n\t\t\t};\n\n\t\t\tif (this.node.by_search) return icons.search;\n\t\t\tif (this.node.is_leaf) return icons.leaf;\n\t\t\tif (this.node.open) return icons.open;\n\t\t\treturn icons.closed;\n\t\t}\n\t}\n};\n<\/script>\n<style scoped>\n.btn-load-more {\n\tmargin-left: 1.6rem;\n\tmargin-top: 0.5rem;\n}\n</style>\n']},media:void 0})},__vue_scope_id__$2="data-v-3c35ce3a",__vue_module_identifier__$2=void 0,__vue_is_functional_template__$2=!1;function __vue_normalize__$2(e,t,n,r,i,a,o,s){var l,c=("function"==typeof n?n.options:n)||{};if(c.__file="/home/runner/work/frappe/frappe/frappe-bench/apps/frappe/frappe/public/js/frappe/file_uploader/TreeNode.vue",c.render||(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,i&&(c.functional=!0)),c._scopeId=r,t&&(l=function(e){t.call(this,o(e))}),void 0!==l)if(c.functional){var d=c.render;c.render=function(e,t){return l.call(t),d(e,t)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return c}function __vue_create_injector__$2(){var e=document.head||document.getElementsByTagName("head")[0],t=__vue_create_injector__$2.styles||(__vue_create_injector__$2.styles={}),n="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,i){if(!document.querySelector('style[data-vue-ssr-id~="'+r+'"]')){var a=n?i.media||"default":r,o=t[a]||(t[a]={ids:[],parts:[],element:void 0});if(!o.ids.includes(r)){var s=i.source,l=o.ids.length;if(o.ids.push(r),n&&(o.element=o.element||document.querySelector("style[data-group="+a+"]")),!o.element){var c=o.element=document.createElement("style");c.type="text/css",i.media&&c.setAttribute("media",i.media),n&&(c.setAttribute("data-group",a),c.setAttribute("data-next-index","0")),e.appendChild(c)}if(n&&(l=parseInt(o.element.getAttribute("data-next-index")),o.element.setAttribute("data-next-index",l+1)),o.element.styleSheet)o.parts.push(s),o.element.styleSheet.cssText=o.parts.filter(Boolean).join("\n");else{var d=document.createTextNode(s),u=o.element.childNodes;u[l]&&o.element.removeChild(u[l]),u.length?o.element.insertBefore(d,u[l]):o.element.appendChild(d)}}}}}var TreeNode=__vue_normalize__$2({render:__vue_render__$2,staticRenderFns:__vue_staticRenderFns__$2},__vue_inject_styles__$2,__vue_script__$2,__vue_scope_id__$2,__vue_is_functional_template__$2,__vue_module_identifier__$2,__vue_create_injector__$2,void 0),script$3={name:"FileBrowser",components:{TreeNode:TreeNode},data:function(){return{node:{label:__("Home"),value:"Home",children:[],children_start:0,children_loading:!1,is_leaf:!1,fetching:!1,fetched:!1,open:!1,filtered:!0},selected_node:{},search_text:"",page_length:10}},mounted:function(){this.toggle_node(this.node)},methods:{toggle_node:function(e){var t=this;e.fetched||e.is_leaf?(e.open=!e.open,this.select_node(e)):(e.fetching=!0,e.children_start=0,e.children_loading=!1,this.get_files_in_folder(e.value,0).then(function(n){var r=n.files,i=n.has_more;e.open=!0,e.children=r,e.fetched=!0,e.fetching=!1,e.children_start+=t.page_length,e.has_more_children=i}))},load_more:function(e){var t=this;if(e.has_more_children){var n=e.children_start;e.children_loading=!0,this.get_files_in_folder(e.value,n).then(function(n){var r=n.files,i=n.has_more;e.children=e.children.concat(r),e.children_start+=t.page_length,e.has_more_children=i,e.children_loading=!1})}},select_node:function(e){e.is_leaf&&(this.selected_node=e)},get_files_in_folder:function(e,t){var n=this;return frappe.call("frappe.core.doctype.file.file.get_files_in_folder",{folder:e,start:t,page_length:this.page_length}).then(function(e){var t=e.message||{},r=t.files;void 0===r&&(r=[]);var i=t.has_more;return void 0===i&&(i=!1),r.sort(function(e,t){return e.is_folder&&t.is_folder?e.modified<t.modified?-1:1:e.is_folder?-1:t.is_folder?1:0}),{files:r=r.map(function(e){return n.make_file_node(e)}),has_more:i}})},search_by_name:frappe.utils.debounce(function(){var e=this;""!==this.search_text?this.search_text.length<3||frappe.call("frappe.core.doctype.file.file.get_files_by_search_text",{text:this.search_text}).then(function(t){var n=t.message||[];n=n.map(function(t){return e.make_file_node(t)}),e.folder_node||(e.folder_node=e.node),e.node={label:__("Search Results"),value:"",children:n,by_search:!0,open:!0,filtered:!0}}):this.node=this.folder_node},300),make_file_node:function(e){var t=e.file_name||e.name;return{label:frappe.utils.file_name_ellipsis(t,40),filename:t,file_url:e.file_url,value:e.name,is_leaf:!e.is_folder,fetched:!e.is_folder,children:[],children_loading:!1,children_start:0,open:!1,fetching:!1,filtered:!0}}}},__vue_script__$3=script$3,__vue_render__$3=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"file-browser"},[n("div",[n("a",{staticClass:"text-muted text-medium",attrs:{href:""},on:{click:function(t){return t.preventDefault(),e.$emit("hide-browser")}}},[e._v("\n\t\t\t"+e._s(e.__("← Back to upload files"))+"\n\t\t")])]),e._v(" "),n("div",{staticClass:"file-browser-list"},[n("div",{staticClass:"file-filter"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.search_text,expression:"search_text"}],staticClass:"form-control input-xs",attrs:{type:"search",placeholder:e.__("Search by filename or extension")},domProps:{value:e.search_text},on:{input:[function(t){t.target.composing||(e.search_text=t.target.value)},e.search_by_name]}})]),e._v(" "),n("TreeNode",{staticClass:"tree with-skeleton",attrs:{node:e.node,selected_node:e.selected_node},on:{"node-click":function(t){return e.toggle_node(t)},"load-more":function(t){return e.load_more(t)}}})],1)])},__vue_staticRenderFns__$3=[];__vue_render__$3._withStripped=!0;var __vue_inject_styles__$3=function(e){e&&e("data-v-3c7cd3b1_0",{source:"\n.file-browser-list {\n\theight: 300px;\n\toverflow: hidden;\n\tmargin-top: 10px;\n}\n.file-filter {\n\tpadding: 3px;\n}\n.tree {\n\toverflow: auto;\n\theight: 100%;\n\tpadding-left: 0;\n\tpadding-right: 0;\n\tpadding-bottom: 4rem;\n}\n",map:{version:3,sources:["/home/runner/work/frappe/frappe/frappe-bench/apps/frappe/frappe/public/js/frappe/file_uploader/FileBrowser.vue"],names:[],mappings:";AAkLA;CACA,aAAA;CACA,gBAAA;CACA,gBAAA;AACA;AAEA;CACA,YAAA;AACA;AAEA;CACA,cAAA;CACA,YAAA;CACA,eAAA;CACA,gBAAA;CACA,oBAAA;AACA",file:"FileBrowser.vue",sourcesContent:['<template>\n\t<div class="file-browser">\n\t\t<div>\n\t\t\t<a\n\t\t\t\thref=""\n\t\t\t\tclass="text-muted text-medium"\n\t\t\t\t@click.prevent="$emit(\'hide-browser\')"\n\t\t\t>\n\t\t\t\t{{ __("← Back to upload files") }}\n\t\t\t</a>\n\t\t</div>\n\t\t<div class="file-browser-list">\n\t\t\t<div class="file-filter">\n\t\t\t\t<input\n\t\t\t\t\ttype="search"\n\t\t\t\t\tclass="form-control input-xs"\n\t\t\t\t\t:placeholder="__(\'Search by filename or extension\')"\n\t\t\t\t\tv-model="search_text"\n\t\t\t\t\t@input="search_by_name"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<TreeNode\n\t\t\t\tclass="tree with-skeleton"\n\t\t\t\t:node="node"\n\t\t\t\t:selected_node="selected_node"\n\t\t\t\t@node-click="n => toggle_node(n)"\n\t\t\t\t@load-more="n => load_more(n)"\n\t\t\t/>\n\t\t</div>\n\t</div>\n</template>\n<script>\nimport TreeNode from "./TreeNode.vue";\n\nexport default {\n\tname: "FileBrowser",\n\tcomponents: {\n\t\tTreeNode\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tnode: {\n\t\t\t\tlabel: __("Home"),\n\t\t\t\tvalue: "Home",\n\t\t\t\tchildren: [],\n\t\t\t\tchildren_start: 0,\n\t\t\t\tchildren_loading: false,\n\t\t\t\tis_leaf: false,\n\t\t\t\tfetching: false,\n\t\t\t\tfetched: false,\n\t\t\t\topen: false,\n\t\t\t\tfiltered: true\n\t\t\t},\n\t\t\tselected_node: {},\n\t\t\tsearch_text: "",\n\t\t\tpage_length: 10\n\t\t};\n\t},\n\tmounted() {\n\t\tthis.toggle_node(this.node);\n\t},\n\tmethods: {\n\t\ttoggle_node(node) {\n\t\t\tif (!node.fetched && !node.is_leaf) {\n\t\t\t\tnode.fetching = true;\n\t\t\t\tnode.children_start = 0;\n\t\t\t\tnode.children_loading = false;\n\t\t\t\tthis.get_files_in_folder(node.value, 0).then(\n\t\t\t\t\t({ files, has_more }) => {\n\t\t\t\t\t\tnode.open = true;\n\t\t\t\t\t\tnode.children = files;\n\t\t\t\t\t\tnode.fetched = true;\n\t\t\t\t\t\tnode.fetching = false;\n\t\t\t\t\t\tnode.children_start += this.page_length;\n\t\t\t\t\t\tnode.has_more_children = has_more;\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tnode.open = !node.open;\n\t\t\t\tthis.select_node(node);\n\t\t\t}\n\t\t},\n\t\tload_more(node) {\n\t\t\tif (node.has_more_children) {\n\t\t\t\tlet start = node.children_start;\n\t\t\t\tnode.children_loading = true;\n\t\t\t\tthis.get_files_in_folder(node.value, start).then(\n\t\t\t\t\t({ files, has_more }) => {\n\t\t\t\t\t\tnode.children = node.children.concat(files);\n\t\t\t\t\t\tnode.children_start += this.page_length;\n\t\t\t\t\t\tnode.has_more_children = has_more;\n\t\t\t\t\t\tnode.children_loading = false;\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\t\tselect_node(node) {\n\t\t\tif (node.is_leaf) {\n\t\t\t\tthis.selected_node = node;\n\t\t\t}\n\t\t},\n\t\tget_files_in_folder(folder, start) {\n\t\t\treturn frappe\n\t\t\t\t.call("frappe.core.doctype.file.file.get_files_in_folder", {\n\t\t\t\t\tfolder,\n\t\t\t\t\tstart,\n\t\t\t\t\tpage_length: this.page_length\n\t\t\t\t})\n\t\t\t\t.then(r => {\n\t\t\t\t\tlet { files = [], has_more = false } = r.message || {};\n\t\t\t\t\tfiles.sort((a, b) => {\n\t\t\t\t\t\tif (a.is_folder && b.is_folder) {\n\t\t\t\t\t\t\treturn a.modified < b.modified ? -1 : 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (a.is_folder) {\n\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (b.is_folder) {\n\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t});\n\t\t\t\t\tfiles = files.map(file => this.make_file_node(file));\n\t\t\t\t\treturn { files, has_more };\n\t\t\t\t});\n\t\t},\n\t\tsearch_by_name: frappe.utils.debounce(function() {\n\t\t\tif (this.search_text === "") {\n\t\t\t\tthis.node = this.folder_node;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this.search_text.length < 3) return;\n\t\t\tfrappe\n\t\t\t\t.call(\n\t\t\t\t\t"frappe.core.doctype.file.file.get_files_by_search_text",\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: this.search_text\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t.then(r => {\n\t\t\t\t\tlet files = r.message || [];\n\t\t\t\t\tfiles = files.map(file => this.make_file_node(file));\n\t\t\t\t\tif (!this.folder_node) {\n\t\t\t\t\t\tthis.folder_node = this.node;\n\t\t\t\t\t}\n\t\t\t\t\tthis.node = {\n\t\t\t\t\t\tlabel: __("Search Results"),\n\t\t\t\t\t\tvalue: "",\n\t\t\t\t\t\tchildren: files,\n\t\t\t\t\t\tby_search: true,\n\t\t\t\t\t\topen: true,\n\t\t\t\t\t\tfiltered: true\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t}, 300),\n\t\tmake_file_node(file) {\n\t\t\tlet filename = file.file_name || file.name;\n\t\t\tlet label = frappe.utils.file_name_ellipsis(filename, 40);\n\t\t\treturn {\n\t\t\t\tlabel: label,\n\t\t\t\tfilename: filename,\n\t\t\t\tfile_url: file.file_url,\n\t\t\t\tvalue: file.name,\n\t\t\t\tis_leaf: !file.is_folder,\n\t\t\t\tfetched: !file.is_folder, // fetched if node is leaf\n\t\t\t\tchildren: [],\n\t\t\t\tchildren_loading: false,\n\t\t\t\tchildren_start: 0,\n\t\t\t\topen: false,\n\t\t\t\tfetching: false,\n\t\t\t\tfiltered: true\n\t\t\t};\n\t\t}\n\t}\n};\n<\/script>\n\n<style>\n.file-browser-list {\n\theight: 300px;\n\toverflow: hidden;\n\tmargin-top: 10px;\n}\n\n.file-filter {\n\tpadding: 3px;\n}\n\n.tree {\n\toverflow: auto;\n\theight: 100%;\n\tpadding-left: 0;\n\tpadding-right: 0;\n\tpadding-bottom: 4rem;\n}\n</style>\n']},media:void 0})},__vue_scope_id__$3=void 0,__vue_module_identifier__$3=void 0,__vue_is_functional_template__$3=!1;function __vue_normalize__$3(e,t,n,r,i,a,o,s){var l,c=("function"==typeof n?n.options:n)||{};if(c.__file="/home/runner/work/frappe/frappe/frappe-bench/apps/frappe/frappe/public/js/frappe/file_uploader/FileBrowser.vue",c.render||(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,i&&(c.functional=!0)),c._scopeId=r,t&&(l=function(e){t.call(this,o(e))}),void 0!==l)if(c.functional){var d=c.render;c.render=function(e,t){return l.call(t),d(e,t)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return c}function __vue_create_injector__$3(){var e=document.head||document.getElementsByTagName("head")[0],t=__vue_create_injector__$3.styles||(__vue_create_injector__$3.styles={}),n="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,i){if(!document.querySelector('style[data-vue-ssr-id~="'+r+'"]')){var a=n?i.media||"default":r,o=t[a]||(t[a]={ids:[],parts:[],element:void 0});if(!o.ids.includes(r)){var s=i.source,l=o.ids.length;if(o.ids.push(r),n&&(o.element=o.element||document.querySelector("style[data-group="+a+"]")),!o.element){var c=o.element=document.createElement("style");c.type="text/css",i.media&&c.setAttribute("media",i.media),n&&(c.setAttribute("data-group",a),c.setAttribute("data-next-index","0")),e.appendChild(c)}if(n&&(l=parseInt(o.element.getAttribute("data-next-index")),o.element.setAttribute("data-next-index",l+1)),o.element.styleSheet)o.parts.push(s),o.element.styleSheet.cssText=o.parts.filter(Boolean).join("\n");else{var d=document.createTextNode(s),u=o.element.childNodes;u[l]&&o.element.removeChild(u[l]),u.length?o.element.insertBefore(d,u[l]):o.element.appendChild(d)}}}}}var FileBrowser=__vue_normalize__$3({render:__vue_render__$3,staticRenderFns:__vue_staticRenderFns__$3},__vue_inject_styles__$3,__vue_script__$3,__vue_scope_id__$3,__vue_is_functional_template__$3,__vue_module_identifier__$3,__vue_create_injector__$3,void 0),script$4={name:"WebLink",data:function(){return{url:""}}},__vue_script__$4=script$4,__vue_render__$4=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"file-web-link margin-bottom"},[n("a",{staticClass:"text-muted text-medium",attrs:{href:""},on:{click:function(t){return t.preventDefault(),e.$emit("hide-web-link")}}},[e._v("\n\t\t"+e._s(e.__("← Back to upload files"))+"\n\t")]),e._v(" "),n("div",{staticClass:"input-group"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.url,expression:"url"}],staticClass:"form-control",attrs:{type:"text",placeholder:e.__("Attach a web link")},domProps:{value:e.url},on:{input:function(t){t.target.composing||(e.url=t.target.value)}}})])])},__vue_staticRenderFns__$4=[];__vue_render__$4._withStripped=!0;var __vue_inject_styles__$4=function(e){e&&e("data-v-b0be0cfe_0",{source:"\n.file-web-link .input-group {\n\tmargin-top: 10px;\n}\n",map:{version:3,sources:["/home/runner/work/frappe/frappe/frappe-bench/apps/frappe/frappe/public/js/frappe/file_uploader/WebLink.vue"],names:[],mappings:";AA6BA;CACA,gBAAA;AACA",file:"WebLink.vue",sourcesContent:['<template>\n\t<div class="file-web-link margin-bottom">\n\t\t<a href class="text-muted text-medium"\n\t\t\t@click.prevent="$emit(\'hide-web-link\')"\n\t\t>\n\t\t\t{{ __(\'← Back to upload files\') }}\n\t\t</a>\n\t\t<div class="input-group">\n\t\t\t<input\n\t\t\t\ttype="text"\n\t\t\t\tclass="form-control"\n\t\t\t\t:placeholder="__(\'Attach a web link\')"\n\t\t\t\tv-model="url"\n\t\t\t>\n\t\t</div>\n\t</div>\n</template>\n<script>\nexport default {\n\tname: \'WebLink\',\n\tdata() {\n\t\treturn {\n\t\t\turl: \'\',\n\t\t}\n\t}\n}\n<\/script>\n\n<style>\n.file-web-link .input-group {\n\tmargin-top: 10px;\n}\n</style>\n']},media:void 0})},__vue_scope_id__$4=void 0,__vue_module_identifier__$4=void 0,__vue_is_functional_template__$4=!1;function __vue_normalize__$4(e,t,n,r,i,a,o,s){var l,c=("function"==typeof n?n.options:n)||{};if(c.__file="/home/runner/work/frappe/frappe/frappe-bench/apps/frappe/frappe/public/js/frappe/file_uploader/WebLink.vue",c.render||(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,i&&(c.functional=!0)),c._scopeId=r,t&&(l=function(e){t.call(this,o(e))}),void 0!==l)if(c.functional){var d=c.render;c.render=function(e,t){return l.call(t),d(e,t)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return c}function __vue_create_injector__$4(){var e=document.head||document.getElementsByTagName("head")[0],t=__vue_create_injector__$4.styles||(__vue_create_injector__$4.styles={}),n="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,i){if(!document.querySelector('style[data-vue-ssr-id~="'+r+'"]')){var a=n?i.media||"default":r,o=t[a]||(t[a]={ids:[],parts:[],element:void 0});if(!o.ids.includes(r)){var s=i.source,l=o.ids.length;if(o.ids.push(r),n&&(o.element=o.element||document.querySelector("style[data-group="+a+"]")),!o.element){var c=o.element=document.createElement("style");c.type="text/css",i.media&&c.setAttribute("media",i.media),n&&(c.setAttribute("data-group",a),c.setAttribute("data-next-index","0")),e.appendChild(c)}if(n&&(l=parseInt(o.element.getAttribute("data-next-index")),o.element.setAttribute("data-next-index",l+1)),o.element.styleSheet)o.parts.push(s),o.element.styleSheet.cssText=o.parts.filter(Boolean).join("\n");else{var d=document.createTextNode(s),u=o.element.childNodes;u[l]&&o.element.removeChild(u[l]),u.length?o.element.insertBefore(d,u[l]):o.element.appendChild(d)}}}}}var WebLink=__vue_normalize__$4({render:__vue_render__$4,staticRenderFns:__vue_staticRenderFns__$4},__vue_inject_styles__$4,__vue_script__$4,__vue_scope_id__$4,__vue_is_functional_template__$4,__vue_module_identifier__$4,__vue_create_injector__$4,void 0);class GoogleDrivePicker{constructor(e){void 0===e&&(e={});var t=e.pickerCallback,n=e.enabled,r=e.appId,i=e.developerKey,a=e.clientId;this.scope=["https://www.googleapis.com/auth/drive.readonly"],this.pickerApiLoaded=!1,this.enabled=n,this.appId=r,this.pickerCallback=t,this.developerKey=i,this.clientId=a}loadPicker(){$.ajax({method:"GET",url:"https://apis.google.com/js/api.js",dataType:"script",cache:!0}).done(this.loadGapi.bind(this))}loadGapi(){frappe.boot.user.google_drive_token||gapi.load("auth",this.onAuthApiLoad.bind(this)),gapi.load("picker",this.onPickerApiLoad.bind(this))}onAuthApiLoad(){gapi.auth.authorize({client_id:this.clientId,scope:this.scope,immediate:!1},this.handleAuthResult.bind(this))}handleAuthResult(e){e&&!e.error&&(frappe.boot.user.google_drive_token=e.access_token,this.createPicker())}onPickerApiLoad(){this.pickerApiLoaded=!0,this.createPicker()}createPicker(){if(this.pickerApiLoaded&&frappe.boot.user.google_drive_token){var e=new google.picker.DocsView(google.picker.ViewId.DOCS).setParent("root").setIncludeFolders(!0);(new google.picker.PickerBuilder).setAppId(this.appId).setDeveloperKey(this.developerKey).setOAuthToken(frappe.boot.user.google_drive_token).addView(e).setLocale(frappe.boot.lang).setCallback(this.pickerCallback).build().setVisible(!0)}}}var script$5={name:"FileUploader",props:{show_upload_button:{default:!0},disable_file_browser:{default:!1},allow_multiple:{default:!0},as_dataurl:{default:!1},doctype:{default:null},docname:{default:null},fieldname:{default:null},folder:{default:"Home"},method:{default:null},on_success:{default:null},restrictions:{default:function(){return{max_file_size:null,max_number_of_files:null,allowed_file_types:[]}}},upload_notes:{default:null}},components:{FilePreview:FilePreview,FileBrowser:FileBrowser,WebLink:WebLink},data:function(){return{files:[],is_dragging:!1,currently_uploading:-1,show_file_browser:!1,show_web_link:!1,allow_take_photo:!1,google_drive_settings:{enabled:!1}}},created:function(){var e=this;this.allow_take_photo=window.navigator.mediaDevices,"Guest"!==frappe.user_id&&frappe.call({method:"frappe.integrations.doctype.google_settings.google_settings.get_file_picker_settings",callback:function(t){t.exc||(e.google_drive_settings=t.message)}})},watch:{files:function(e,t){!this.allow_multiple&&e.length>1&&(this.files=[e[e.length-1]])}},computed:{upload_complete:function(){return this.files.length>0&&this.files.every(function(e){return 0!==e.total&&e.progress===e.total})}},methods:{dragover:function(){this.is_dragging=!0},dragleave:function(){this.is_dragging=!1},dropfiles:function(e){this.is_dragging=!1,this.add_files(e.dataTransfer.files)},browse_files:function(){this.$refs.file_input.click()},on_file_input:function(e){this.add_files(this.$refs.file_input.files)},remove_file:function(e){this.files=this.files.filter(function(t){return t!==e})},toggle_all_private:function(){var e,t=this.files.filter(function(e){return e.private});e=t.length<this.files.length,this.files=this.files.map(function(t){return t.private=e,t})},add_files:function(e){var t=Array.from(e).filter(this.check_restrictions).map(function(e){var t=e.type.startsWith("image");return{file_obj:e,name:e.name,doc:null,progress:0,total:0,failed:!1,uploading:!1,private:!t}});this.files=this.files.concat(t)},check_restrictions:function(e){var t=this.restrictions,n=t.max_file_size,r=t.allowed_file_types,i=(e.type,e.name.split(".").pop(),!0),a=!0;return r.length&&(i=r.some(function(t){return t.includes("/")?!!e.type&&e.type.match(t):"."===t[0]&&e.name.endsWith(t)})),n&&null!=e.size&&(a=e.size<n),i||console.warn("File skipped because of invalid file type",e),a||console.warn("File skipped because of invalid file size",e.size,e),i&&a},upload_files:function(){var e=this;return this.show_file_browser?this.upload_via_file_browser():this.show_web_link?this.upload_via_web_link():this.as_dataurl?this.return_as_dataurl():frappe.run_serially(this.files.map(function(t,n){return function(){return e.upload_file(t,n)}}))},upload_via_file_browser:function(){var e=this.$refs.file_browser.selected_node;return e.value?this.upload_file({file_url:e.file_url}):(frappe.msgprint(__("Click on a file to select it.")),Promise.reject())},upload_via_web_link:function(){var e=this.$refs.web_link.url;return e?(e=decodeURI(e),this.upload_file({file_url:e})):(frappe.msgprint(__("Invalid URL")),Promise.reject())},return_as_dataurl:function(){var e=this,t=this.files.map(function(t){return frappe.dom.file_to_base64(t.file_obj).then(function(n){t.dataurl=n,e.on_success&&e.on_success(t)})});return Promise.all(t)},upload_file:function(e,t){var n=this;return this.currently_uploading=t,new Promise(function(t,r){var i=new XMLHttpRequest;i.upload.addEventListener("loadstart",function(t){e.uploading=!0}),i.upload.addEventListener("progress",function(t){t.lengthComputable&&(e.progress=t.loaded,e.total=t.total)}),i.upload.addEventListener("load",function(n){e.uploading=!1,t()}),i.addEventListener("error",function(t){e.failed=!0,r()}),i.onreadystatechange=function(){if(i.readyState==XMLHttpRequest.DONE)if(200===i.status){var t=null,r=null;try{"File"===(t=JSON.parse(i.responseText)).message.doctype&&(r=t.message)}catch(e){t=i.responseText}e.doc=r,n.on_success&&n.on_success(r,t)}else if(403===i.status){var a=JSON.parse(i.responseText);frappe.msgprint({title:__("Not permitted"),indicator:"red",message:a._error_message})}else{e.failed=!0;var o=null;try{o=JSON.parse(i.responseText)}catch(e){}frappe.request.cleanup({},o)}},i.open("POST","/api/method/upload_file",!0),i.setRequestHeader("Accept","application/json"),i.setRequestHeader("X-Frappe-CSRF-Token",frappe.csrf_token);var a=new FormData;e.file_obj&&a.append("file",e.file_obj,e.name),a.append("is_private",+e.private),a.append("folder",n.folder),e.file_url&&a.append("file_url",e.file_url),e.file_name&&a.append("file_name",e.file_name),n.doctype&&n.docname&&(a.append("doctype",n.doctype),a.append("docname",n.docname)),n.fieldname&&a.append("fieldname",n.fieldname),n.method&&a.append("method",n.method),i.send(a)})},capture_image:function(){var e=this,t=new frappe.ui.Capture({animate:!1,error:!0});t.show(),t.submit(function(t){var n="capture_"+frappe.datetime.now_datetime().replaceAll(/[: -]/g,"_")+".png";e.url_to_file(t,n,"image/png").then(function(t){return e.add_files([t])})})},show_google_drive_picker:function(){var e=this,t=cur_dialog;t.hide(),new GoogleDrivePicker(Object.assign({},{pickerCallback:function(n){return e.google_drive_callback(n,t)}},this.google_drive_settings)).loadPicker()},google_drive_callback:function(e,t){e.action==google.picker.Action.PICKED?this.upload_file({file_url:e.docs[0].url,file_name:e.docs[0].name}):e.action==google.picker.Action.CANCEL&&t.show()},url_to_file:function(e,t,n){return fetch(e).then(function(e){return e.arrayBuffer()}).then(function(e){return new File([e],t,{type:n})})}}},__vue_script__$5=script$5,__vue_render__$5=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"file-uploader",on:{dragover:function(t){return t.preventDefault(),e.dragover(t)},dragleave:function(t){return t.preventDefault(),e.dragleave(t)},drop:function(t){return t.preventDefault(),e.dropfiles(t)}}},[n("div",{directives:[{name:"show",rawName:"v-show",value:0===e.files.length&&!e.show_file_browser&&!e.show_web_link,expression:"files.length === 0 && !show_file_browser && !show_web_link"}],staticClass:"file-upload-area"},[e.is_dragging?n("div",[e._v("\n\t\t\t"+e._s(e.__("Drop files here"))+"\n\t\t")]):n("div",[n("div",{staticClass:"text-center"},[e._v("\n\t\t\t\t"+e._s(e.__("Drag and drop files here or upload from"))+"\n\t\t\t")]),e._v(" "),n("div",{staticClass:"mt-2 text-center"},[n("button",{staticClass:"btn btn-file-upload",on:{click:e.browse_files}},[n("svg",{attrs:{width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[n("circle",{attrs:{cx:"15",cy:"15",r:"15",fill:"url(#paint0_linear)"}}),e._v(" "),n("path",{attrs:{d:"M13.5 22V19",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}}),e._v(" "),n("path",{attrs:{d:"M16.5 22V19",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}}),e._v(" "),n("path",{attrs:{d:"M10.5 22H19.5",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}}),e._v(" "),n("path",{attrs:{d:"M7.5 16H22.5",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}}),e._v(" "),n("path",{attrs:{d:"M21 8H9C8.17157 8 7.5 8.67157 7.5 9.5V17.5C7.5 18.3284 8.17157 19 9 19H21C21.8284 19 22.5 18.3284 22.5 17.5V9.5C22.5 8.67157 21.8284 8 21 8Z",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}}),e._v(" "),n("defs",[n("linearGradient",{attrs:{id:"paint0_linear",x1:"0",y1:"0",x2:"0",y2:"30",gradientUnits:"userSpaceOnUse"}},[n("stop",{attrs:{"stop-color":"#2C9AF1"}}),e._v(" "),n("stop",{attrs:{offset:"1","stop-color":"#2490EF"}})],1)],1)]),e._v(" "),n("div",{staticClass:"mt-1"},[e._v(e._s(e.__("My Device")))])]),e._v(" "),n("input",{ref:"file_input",staticClass:"hidden",attrs:{type:"file",multiple:e.allow_multiple,accept:e.restrictions.allowed_file_types.join(", ")},on:{change:e.on_file_input}}),e._v(" "),e.disable_file_browser?e._e():n("button",{staticClass:"btn btn-file-upload",on:{click:function(t){e.show_file_browser=!0}}},[n("svg",{attrs:{width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[n("circle",{attrs:{cx:"15",cy:"15",r:"15",fill:"#48BB74"}}),e._v(" "),n("path",{attrs:{d:"M13.0245 11.5H8C7.72386 11.5 7.5 11.7239 7.5 12V20C7.5 21.1046 8.39543 22 9.5 22H20.5C21.6046 22 22.5 21.1046 22.5 20V14.5C22.5 14.2239 22.2761 14 22 14H15.2169C15.0492 14 14.8926 13.9159 14.8 13.776L13.4414 11.724C13.3488 11.5841 13.1922 11.5 13.0245 11.5Z",stroke:"white","stroke-miterlimit":"10","stroke-linecap":"square"}}),e._v(" "),n("path",{attrs:{d:"M8.87939 9.5V8.5C8.87939 8.22386 9.10325 8 9.37939 8H20.6208C20.8969 8 21.1208 8.22386 21.1208 8.5V12",stroke:"white","stroke-miterlimit":"10","stroke-linecap":"round","stroke-linejoin":"round"}})]),e._v(" "),n("div",{staticClass:"mt-1"},[e._v(e._s(e.__("Library")))])]),e._v(" "),n("button",{staticClass:"btn btn-file-upload",on:{click:function(t){e.show_web_link=!0}}},[n("svg",{attrs:{width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[n("circle",{attrs:{cx:"15",cy:"15",r:"15",fill:"#ECAC4B"}}),e._v(" "),n("path",{attrs:{d:"M12.0469 17.9543L17.9558 12.0454",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}}),e._v(" "),n("path",{attrs:{d:"M13.8184 11.4547L15.7943 9.47873C16.4212 8.85205 17.2714 8.5 18.1578 8.5C19.0443 8.5 19.8945 8.85205 20.5214 9.47873V9.47873C21.1481 10.1057 21.5001 10.9558 21.5001 11.8423C21.5001 12.7287 21.1481 13.5789 20.5214 14.2058L18.5455 16.1818",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}}),e._v(" "),n("path",{attrs:{d:"M11.4547 13.8184L9.47873 15.7943C8.85205 16.4212 8.5 17.2714 8.5 18.1578C8.5 19.0443 8.85205 19.8945 9.47873 20.5214V20.5214C10.1057 21.1481 10.9558 21.5001 11.8423 21.5001C12.7287 21.5001 13.5789 21.1481 14.2058 20.5214L16.1818 18.5455",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}})]),e._v(" "),n("div",{staticClass:"mt-1"},[e._v(e._s(e.__("Link")))])]),e._v(" "),e.allow_take_photo?n("button",{staticClass:"btn btn-file-upload",on:{click:e.capture_image}},[n("svg",{attrs:{width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[n("circle",{attrs:{cx:"15",cy:"15",r:"15",fill:"#CE315B"}}),e._v(" "),n("path",{attrs:{d:"M11.5 10.5H9.5C8.67157 10.5 8 11.1716 8 12V20C8 20.8284 8.67157 21.5 9.5 21.5H20.5C21.3284 21.5 22 20.8284 22 20V12C22 11.1716 21.3284 10.5 20.5 10.5H18.5L17.3 8.9C17.1111 8.64819 16.8148 8.5 16.5 8.5H13.5C13.1852 8.5 12.8889 8.64819 12.7 8.9L11.5 10.5Z",stroke:"white","stroke-linejoin":"round"}}),e._v(" "),n("circle",{attrs:{cx:"15",cy:"16",r:"2.5",stroke:"white"}})]),e._v(" "),n("div",{staticClass:"mt-1"},[e._v(e._s(e.__("Camera")))])]):e._e(),e._v(" "),e.google_drive_settings.enabled?n("button",{staticClass:"btn btn-file-upload",on:{click:e.show_google_drive_picker}},[n("svg",{attrs:{width:"30",height:"30"}},[n("image",{attrs:{"xlink:href":"/assets/frappe/icons/social/google_drive.svg",width:"30",height:"30"}})]),e._v(" "),n("div",{staticClass:"mt-1"},[e._v(e._s(e.__("Google Drive")))])]):e._e()]),e._v(" "),n("div",{staticClass:"text-muted text-medium"},[e._v("\n\t\t\t\t"+e._s(e.upload_notes)+"\n\t\t\t")])])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.files.length&&!e.show_file_browser&&!e.show_web_link,expression:"files.length && !show_file_browser && !show_web_link"}],staticClass:"file-preview-area"},[n("div",{staticClass:"file-preview-container"},e._l(e.files,function(t,r){return n("FilePreview",{key:t.name,attrs:{file:t},on:{remove:function(n){return e.remove_file(t)},toggle_private:function(e){t.private=!t.private}}})}),1),e._v(" "),e.show_upload_button&&-1===e.currently_uploading?n("div",{staticClass:"flex align-center"},[n("button",{staticClass:"btn btn-primary btn-sm margin-right",on:{click:e.upload_files}},[1===e.files.length?n("span",[e._v("\n\t\t\t\t\t"+e._s(e.__("Upload file"))+"\n\t\t\t\t")]):n("span",[e._v("\n\t\t\t\t\t"+e._s(e.__("Upload {0} files",[e.files.length]))+"\n\t\t\t\t")])]),e._v(" "),n("div",{staticClass:"text-muted text-medium"},[e._v("\n\t\t\t\t"+e._s(e.__("Click on the lock icon to toggle public/private"))+"\n\t\t\t")])]):e._e()]),e._v(" "),e.show_file_browser&&!e.disable_file_browser?n("FileBrowser",{ref:"file_browser",on:{"hide-browser":function(t){e.show_file_browser=!1}}}):e._e(),e._v(" "),e.show_web_link?n("WebLink",{ref:"web_link",on:{"hide-web-link":function(t){e.show_web_link=!1}}}):e._e()],1)},__vue_staticRenderFns__$5=[];__vue_render__$5._withStripped=!0;var __vue_inject_styles__$5=function(e){e&&e("data-v-432240f4_0",{source:"\n.file-upload-area {\n\tmin-height: 16rem;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tborder: 1px dashed var(--dark-border-color);\n\tborder-radius: var(--border-radius);\n\tcursor: pointer;\n\tbackground-color: var(--bg-color);\n}\n.btn-file-upload {\n\tbackground-color: transparent;\n\tborder: none;\n\tbox-shadow: none;\n\tfont-size: var(--text-xs);\n}\n",map:{version:3,sources:["/home/runner/work/frappe/frappe/frappe-bench/apps/frappe/frappe/public/js/frappe/file_uploader/FileUploader.vue"],names:[],mappings:";AA6eA;CACA,iBAAA;CACA,aAAA;CACA,mBAAA;CACA,uBAAA;CACA,2CAAA;CACA,mCAAA;CACA,eAAA;CACA,iCAAA;AACA;AAEA;CACA,6BAAA;CACA,YAAA;CACA,gBAAA;CACA,yBAAA;AACA",file:"FileUploader.vue",sourcesContent:['<template>\n\t<div class="file-uploader"\n\t\t@dragover.prevent="dragover"\n\t\t@dragleave.prevent="dragleave"\n\t\t@drop.prevent="dropfiles"\n\t>\n\t\t<div\n\t\t\tclass="file-upload-area"\n\t\t\tv-show="files.length === 0 && !show_file_browser && !show_web_link"\n\t\t>\n\t\t\t<div v-if="!is_dragging">\n\t\t\t\t<div class="text-center">\n\t\t\t\t\t{{ __(\'Drag and drop files here or upload from\') }}\n\t\t\t\t</div>\n\t\t\t\t<div class="mt-2 text-center">\n\t\t\t\t\t<button class="btn btn-file-upload" @click="browse_files">\n\t\t\t\t\t\t<svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t\t<circle cx="15" cy="15" r="15" fill="url(#paint0_linear)"/>\n\t\t\t\t\t\t\t<path d="M13.5 22V19" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>\n\t\t\t\t\t\t\t<path d="M16.5 22V19" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>\n\t\t\t\t\t\t\t<path d="M10.5 22H19.5" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>\n\t\t\t\t\t\t\t<path d="M7.5 16H22.5" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>\n\t\t\t\t\t\t\t<path d="M21 8H9C8.17157 8 7.5 8.67157 7.5 9.5V17.5C7.5 18.3284 8.17157 19 9 19H21C21.8284 19 22.5 18.3284 22.5 17.5V9.5C22.5 8.67157 21.8284 8 21 8Z" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>\n\t\t\t\t\t\t\t<defs>\n\t\t\t\t\t\t\t<linearGradient id="paint0_linear" x1="0" y1="0" x2="0" y2="30" gradientUnits="userSpaceOnUse">\n\t\t\t\t\t\t\t<stop stop-color="#2C9AF1"/>\n\t\t\t\t\t\t\t<stop offset="1" stop-color="#2490EF"/>\n\t\t\t\t\t\t\t</linearGradient>\n\t\t\t\t\t\t\t</defs>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t<div class="mt-1">{{ __(\'My Device\') }}</div>\n\t\t\t\t\t</button>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype="file"\n\t\t\t\t\t\tclass="hidden"\n\t\t\t\t\t\tref="file_input"\n\t\t\t\t\t\t@change="on_file_input"\n\t\t\t\t\t\t:multiple="allow_multiple"\n\t\t\t\t\t\t:accept="restrictions.allowed_file_types.join(\', \')"\n\t\t\t\t\t>\n\t\t\t\t\t<button class="btn btn-file-upload" v-if="!disable_file_browser" @click="show_file_browser = true">\n\t\t\t\t\t\t<svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t\t<circle cx="15" cy="15" r="15" fill="#48BB74"/>\n\t\t\t\t\t\t\t<path d="M13.0245 11.5H8C7.72386 11.5 7.5 11.7239 7.5 12V20C7.5 21.1046 8.39543 22 9.5 22H20.5C21.6046 22 22.5 21.1046 22.5 20V14.5C22.5 14.2239 22.2761 14 22 14H15.2169C15.0492 14 14.8926 13.9159 14.8 13.776L13.4414 11.724C13.3488 11.5841 13.1922 11.5 13.0245 11.5Z" stroke="white" stroke-miterlimit="10" stroke-linecap="square"/>\n\t\t\t\t\t\t\t<path d="M8.87939 9.5V8.5C8.87939 8.22386 9.10325 8 9.37939 8H20.6208C20.8969 8 21.1208 8.22386 21.1208 8.5V12" stroke="white" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t<div class="mt-1">{{ __(\'Library\') }}</div>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button class="btn btn-file-upload" @click="show_web_link = true">\n\t\t\t\t\t\t<svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t\t<circle cx="15" cy="15" r="15" fill="#ECAC4B"/>\n\t\t\t\t\t\t\t<path d="M12.0469 17.9543L17.9558 12.0454" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>\n\t\t\t\t\t\t\t<path d="M13.8184 11.4547L15.7943 9.47873C16.4212 8.85205 17.2714 8.5 18.1578 8.5C19.0443 8.5 19.8945 8.85205 20.5214 9.47873V9.47873C21.1481 10.1057 21.5001 10.9558 21.5001 11.8423C21.5001 12.7287 21.1481 13.5789 20.5214 14.2058L18.5455 16.1818" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>\n\t\t\t\t\t\t\t<path d="M11.4547 13.8184L9.47873 15.7943C8.85205 16.4212 8.5 17.2714 8.5 18.1578C8.5 19.0443 8.85205 19.8945 9.47873 20.5214V20.5214C10.1057 21.1481 10.9558 21.5001 11.8423 21.5001C12.7287 21.5001 13.5789 21.1481 14.2058 20.5214L16.1818 18.5455" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t<div class="mt-1">{{ __(\'Link\') }}</div>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button v-if="allow_take_photo" class="btn btn-file-upload" @click="capture_image">\n\t\t\t\t\t\t<svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t\t<circle cx="15" cy="15" r="15" fill="#CE315B"/>\n\t\t\t\t\t\t\t<path d="M11.5 10.5H9.5C8.67157 10.5 8 11.1716 8 12V20C8 20.8284 8.67157 21.5 9.5 21.5H20.5C21.3284 21.5 22 20.8284 22 20V12C22 11.1716 21.3284 10.5 20.5 10.5H18.5L17.3 8.9C17.1111 8.64819 16.8148 8.5 16.5 8.5H13.5C13.1852 8.5 12.8889 8.64819 12.7 8.9L11.5 10.5Z" stroke="white" stroke-linejoin="round"/>\n\t\t\t\t\t\t\t<circle cx="15" cy="16" r="2.5" stroke="white"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t<div class="mt-1">{{ __(\'Camera\') }}</div>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button v-if="google_drive_settings.enabled" class="btn btn-file-upload" @click="show_google_drive_picker">\n\t\t\t\t\t\t<svg width="30" height="30">\n\t\t\t\t\t\t\t<image xlink:href="/assets/frappe/icons/social/google_drive.svg" width="30" height="30"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t<div class="mt-1">{{ __(\'Google Drive\') }}</div>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<div class="text-muted text-medium">\n\t\t\t\t\t{{ upload_notes }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-else>\n\t\t\t\t{{ __(\'Drop files here\') }}\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="file-preview-area" v-show="files.length && !show_file_browser && !show_web_link">\n\t\t\t<div class="file-preview-container">\n\t\t\t\t<FilePreview\n\t\t\t\t\tv-for="(file, i) in files"\n\t\t\t\t\t:key="file.name"\n\t\t\t\t\t:file="file"\n\t\t\t\t\t@remove="remove_file(file)"\n\t\t\t\t\t@toggle_private="file.private = !file.private"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class="flex align-center" v-if="show_upload_button && currently_uploading === -1">\n\t\t\t\t<button\n\t\t\t\t\tclass="btn btn-primary btn-sm margin-right"\n\t\t\t\t\t@click="upload_files"\n\t\t\t\t>\n\t\t\t\t\t<span v-if="files.length === 1">\n\t\t\t\t\t\t{{ __(\'Upload file\') }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span v-else>\n\t\t\t\t\t\t{{ __(\'Upload {0} files\', [files.length]) }}\n\t\t\t\t\t</span>\n\t\t\t\t</button>\n\t\t\t\t<div class="text-muted text-medium">\n\t\t\t\t\t{{ __(\'Click on the lock icon to toggle public/private\') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<FileBrowser\n\t\t\tref="file_browser"\n\t\t\tv-if="show_file_browser && !disable_file_browser"\n\t\t\t@hide-browser="show_file_browser = false"\n\t\t/>\n\t\t<WebLink\n\t\t\tref="web_link"\n\t\t\tv-if="show_web_link"\n\t\t\t@hide-web-link="show_web_link = false"\n\t\t/>\n\t</div>\n</template>\n\n<script>\nimport FilePreview from \'./FilePreview.vue\';\nimport FileBrowser from \'./FileBrowser.vue\';\nimport WebLink from \'./WebLink.vue\';\nimport GoogleDrivePicker from \'../../integrations/google_drive_picker\';\n\nexport default {\n\tname: \'FileUploader\',\n\tprops: {\n\t\tshow_upload_button: {\n\t\t\tdefault: true\n\t\t},\n\t\tdisable_file_browser: {\n\t\t\tdefault: false\n\t\t},\n\t\tallow_multiple: {\n\t\t\tdefault: true\n\t\t},\n\t\tas_dataurl: {\n\t\t\tdefault: false\n\t\t},\n\t\tdoctype: {\n\t\t\tdefault: null\n\t\t},\n\t\tdocname: {\n\t\t\tdefault: null\n\t\t},\n\t\tfieldname: {\n\t\t\tdefault: null\n\t\t},\n\t\tfolder: {\n\t\t\tdefault: \'Home\'\n\t\t},\n\t\tmethod: {\n\t\t\tdefault: null\n\t\t},\n\t\ton_success: {\n\t\t\tdefault: null\n\t\t},\n\t\trestrictions: {\n\t\t\tdefault: () => ({\n\t\t\t\tmax_file_size: null, // 2048 -> 2KB\n\t\t\t\tmax_number_of_files: null,\n\t\t\t\tallowed_file_types: [] // [\'image/*\', \'video/*\', \'.jpg\', \'.gif\', \'.pdf\']\n\t\t\t})\n\t\t},\n\t\tupload_notes: {\n\t\t\tdefault: null // "Images or video, upto 2MB"\n\t\t}\n\t},\n\tcomponents: {\n\t\tFilePreview,\n\t\tFileBrowser,\n\t\tWebLink\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tfiles: [],\n\t\t\tis_dragging: false,\n\t\t\tcurrently_uploading: -1,\n\t\t\tshow_file_browser: false,\n\t\t\tshow_web_link: false,\n\t\t\tallow_take_photo: false,\n\t\t\tgoogle_drive_settings: {\n\t\t\t\tenabled: false\n\t\t\t}\n\t\t}\n\t},\n\tcreated() {\n\t\tthis.allow_take_photo = window.navigator.mediaDevices;\n\t\tif (frappe.user_id !== "Guest") {\n\t\t\tfrappe.call({\n\t\t\t\t// method only available after login\n\t\t\t\tmethod: "frappe.integrations.doctype.google_settings.google_settings.get_file_picker_settings",\n\t\t\t\tcallback: (resp) => {\n\t\t\t\t\tif (!resp.exc) {\n\t\t\t\t\t\tthis.google_drive_settings = resp.message;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\twatch: {\n\t\tfiles(newvalue, oldvalue) {\n\t\t\tif (!this.allow_multiple && newvalue.length > 1) {\n\t\t\t\tthis.files = [newvalue[newvalue.length - 1]];\n\t\t\t}\n\t\t}\n\t},\n\tcomputed: {\n\t\tupload_complete() {\n\t\t\treturn this.files.length > 0\n\t\t\t\t&& this.files.every(\n\t\t\t\t\tfile => file.total !== 0 && file.progress === file.total);\n\t\t}\n\t},\n\tmethods: {\n\t\tdragover() {\n\t\t\tthis.is_dragging = true;\n\t\t},\n\t\tdragleave() {\n\t\t\tthis.is_dragging = false;\n\t\t},\n\t\tdropfiles(e) {\n\t\t\tthis.is_dragging = false;\n\t\t\tthis.add_files(e.dataTransfer.files);\n\t\t},\n\t\tbrowse_files() {\n\t\t\tthis.$refs.file_input.click();\n\t\t},\n\t\ton_file_input(e) {\n\t\t\tthis.add_files(this.$refs.file_input.files);\n\t\t},\n\t\tremove_file(file) {\n\t\t\tthis.files = this.files.filter(f => f !== file);\n\t\t},\n\t\ttoggle_all_private() {\n\t\t\tlet flag;\n\t\t\tlet private_values = this.files.filter(file => file.private);\n\t\t\tif (private_values.length < this.files.length) {\n\t\t\t\t// there are some private and some public\n\t\t\t\t// set all to private\n\t\t\t\tflag = true;\n\t\t\t} else {\n\t\t\t\t// all are private, set all to public\n\t\t\t\tflag = false;\n\t\t\t}\n\t\t\tthis.files = this.files.map(file => {\n\t\t\t\tfile.private = flag;\n\t\t\t\treturn file;\n\t\t\t});\n\t\t},\n\t\tadd_files(file_array) {\n\t\t\tlet files = Array.from(file_array)\n\t\t\t\t.filter(this.check_restrictions)\n\t\t\t\t.map(file => {\n\t\t\t\t\tlet is_image = file.type.startsWith(\'image\');\n\t\t\t\t\treturn {\n\t\t\t\t\t\tfile_obj: file,\n\t\t\t\t\t\tname: file.name,\n\t\t\t\t\t\tdoc: null,\n\t\t\t\t\t\tprogress: 0,\n\t\t\t\t\t\ttotal: 0,\n\t\t\t\t\t\tfailed: false,\n\t\t\t\t\t\tuploading: false,\n\t\t\t\t\t\tprivate: !is_image\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\tthis.files = this.files.concat(files);\n\t\t},\n\t\tcheck_restrictions(file) {\n\t\t\tlet { max_file_size, allowed_file_types } = this.restrictions;\n\n\t\t\tlet mime_type = file.type;\n\t\t\tlet extension = \'.\' + file.name.split(\'.\').pop();\n\n\t\t\tlet is_correct_type = true;\n\t\t\tlet valid_file_size = true;\n\n\t\t\tif (allowed_file_types.length) {\n\t\t\t\tis_correct_type = allowed_file_types.some((type) => {\n\t\t\t\t\t// is this is a mime-type\n\t\t\t\t\tif (type.includes(\'/\')) {\n\t\t\t\t\t\tif (!file.type) return false;\n\t\t\t\t\t\treturn file.type.match(type);\n\t\t\t\t\t}\n\n\t\t\t\t\t// otherwise this is likely an extension\n\t\t\t\t\tif (type[0] === \'.\') {\n\t\t\t\t\t\treturn file.name.endsWith(type);\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (max_file_size && file.size != null) {\n\t\t\t\tvalid_file_size = file.size < max_file_size;\n\t\t\t}\n\n\t\t\tif (!is_correct_type) {\n\t\t\t\tconsole.warn(\'File skipped because of invalid file type\', file);\n\t\t\t}\n\t\t\tif (!valid_file_size) {\n\t\t\t\tconsole.warn(\'File skipped because of invalid file size\', file.size, file);\n\t\t\t}\n\n\t\t\treturn is_correct_type && valid_file_size;\n\t\t},\n\t\tupload_files() {\n\t\t\tif (this.show_file_browser) {\n\t\t\t\treturn this.upload_via_file_browser();\n\t\t\t}\n\t\t\tif (this.show_web_link) {\n\t\t\t\treturn this.upload_via_web_link();\n\t\t\t}\n\t\t\tif (this.as_dataurl) {\n\t\t\t\treturn this.return_as_dataurl();\n\t\t\t}\n\t\t\treturn frappe.run_serially(\n\t\t\t\tthis.files.map(\n\t\t\t\t\t(file, i) =>\n\t\t\t\t\t\t() => this.upload_file(file, i)\n\t\t\t\t)\n\t\t\t);\n\t\t},\n\t\tupload_via_file_browser() {\n\t\t\tlet selected_file = this.$refs.file_browser.selected_node;\n\t\t\tif (!selected_file.value) {\n\t\t\t\tfrappe.msgprint(__(\'Click on a file to select it.\'));\n\t\t\t\treturn Promise.reject();\n\t\t\t}\n\n\t\t\treturn this.upload_file({\n\t\t\t\tfile_url: selected_file.file_url\n\t\t\t});\n\t\t},\n\t\tupload_via_web_link() {\n\t\t\tlet file_url = this.$refs.web_link.url;\n\t\t\tif (!file_url) {\n\t\t\t\tfrappe.msgprint(__(\'Invalid URL\'));\n\t\t\t\treturn Promise.reject();\n\t\t\t}\n\t\t\tfile_url = decodeURI(file_url)\n\t\t\treturn this.upload_file({\n\t\t\t\tfile_url\n\t\t\t});\n\t\t},\n\t\treturn_as_dataurl() {\n\t\t\tlet promises = this.files.map(file =>\n\t\t\t\tfrappe.dom.file_to_base64(file.file_obj)\n\t\t\t\t\t.then(dataurl => {\n\t\t\t\t\t\tfile.dataurl = dataurl;\n\t\t\t\t\t\tthis.on_success && this.on_success(file);\n\t\t\t\t\t})\n\t\t\t);\n\t\t\treturn Promise.all(promises);\n\t\t},\n\t\tupload_file(file, i) {\n\t\t\tthis.currently_uploading = i;\n\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tlet xhr = new XMLHttpRequest();\n\t\t\t\txhr.upload.addEventListener(\'loadstart\', (e) => {\n\t\t\t\t\tfile.uploading = true;\n\t\t\t\t})\n\t\t\t\txhr.upload.addEventListener(\'progress\', (e) => {\n\t\t\t\t\tif (e.lengthComputable) {\n\t\t\t\t\t\tfile.progress = e.loaded;\n\t\t\t\t\t\tfile.total = e.total;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\txhr.upload.addEventListener(\'load\', (e) => {\n\t\t\t\t\tfile.uploading = false;\n\t\t\t\t\tresolve();\n\t\t\t\t})\n\t\t\t\txhr.addEventListener(\'error\', (e) => {\n\t\t\t\t\tfile.failed = true;\n\t\t\t\t\treject();\n\t\t\t\t})\n\t\t\t\txhr.onreadystatechange = () => {\n\t\t\t\t\tif (xhr.readyState == XMLHttpRequest.DONE) {\n\t\t\t\t\t\tif (xhr.status === 200) {\n\t\t\t\t\t\t\tlet r = null;\n\t\t\t\t\t\t\tlet file_doc = null;\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tr = JSON.parse(xhr.responseText);\n\t\t\t\t\t\t\t\tif (r.message.doctype === \'File\') {\n\t\t\t\t\t\t\t\t\tfile_doc = r.message;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\t\tr = xhr.responseText;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tfile.doc = file_doc;\n\n\t\t\t\t\t\t\tif (this.on_success) {\n\t\t\t\t\t\t\t\tthis.on_success(file_doc, r);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (xhr.status === 403) {\n\t\t\t\t\t\t\tlet response = JSON.parse(xhr.responseText);\n\t\t\t\t\t\t\tfrappe.msgprint({\n\t\t\t\t\t\t\t\ttitle: __(\'Not permitted\'),\n\t\t\t\t\t\t\t\tindicator: \'red\',\n\t\t\t\t\t\t\t\tmessage: response._error_message\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfile.failed = true;\n\t\t\t\t\t\t\tlet error = null;\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\terror = JSON.parse(xhr.responseText);\n\t\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\t\t// pass\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfrappe.request.cleanup({}, error);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\txhr.open(\'POST\', \'/api/method/upload_file\', true);\n\t\t\t\txhr.setRequestHeader(\'Accept\', \'application/json\');\n\t\t\t\txhr.setRequestHeader(\'X-Frappe-CSRF-Token\', frappe.csrf_token);\n\n\t\t\t\tlet form_data = new FormData();\n\t\t\t\tif (file.file_obj) {\n\t\t\t\t\tform_data.append(\'file\', file.file_obj, file.name);\n\t\t\t\t}\n\t\t\t\tform_data.append(\'is_private\', +file.private);\n\t\t\t\tform_data.append(\'folder\', this.folder);\n\n\t\t\t\tif (file.file_url) {\n\t\t\t\t\tform_data.append(\'file_url\', file.file_url);\n\t\t\t\t}\n\n\t\t\t\tif (file.file_name) {\n\t\t\t\t\tform_data.append(\'file_name\', file.file_name);\n\t\t\t\t}\n\n\t\t\t\tif (this.doctype && this.docname) {\n\t\t\t\t\tform_data.append(\'doctype\', this.doctype);\n\t\t\t\t\tform_data.append(\'docname\', this.docname);\n\t\t\t\t}\n\n\t\t\t\tif (this.fieldname) {\n\t\t\t\t\tform_data.append(\'fieldname\', this.fieldname);\n\t\t\t\t}\n\n\t\t\t\tif (this.method) {\n\t\t\t\t\tform_data.append(\'method\', this.method);\n\t\t\t\t}\n\n\t\t\t\txhr.send(form_data);\n\t\t\t});\n\t\t},\n\t\tcapture_image() {\n\t\t\tconst capture = new frappe.ui.Capture({\n\t\t\t\tanimate: false,\n\t\t\t\terror: true\n\t\t\t});\n\t\t\tcapture.show();\n\t\t\tcapture.submit(data_url => {\n\t\t\t\tlet filename = `capture_${frappe.datetime.now_datetime().replaceAll(/[: -]/g, \'_\')}.png`;\n\t\t\t\tthis.url_to_file(data_url, filename, \'image/png\').then((file) =>\n\t\t\t\t\tthis.add_files([file])\n\t\t\t\t);\n\t\t\t});\n\t\t},\n\t\tshow_google_drive_picker() {\n\t\t\tlet dialog = cur_dialog;\n\t\t\tdialog.hide();\n\t\t\tlet google_drive = new GoogleDrivePicker({\n\t\t\t\tpickerCallback: data => this.google_drive_callback(data, dialog),\n\t\t\t\t...this.google_drive_settings\n\t\t\t});\n\t\t\tgoogle_drive.loadPicker();\n\t\t},\n\t\tgoogle_drive_callback(data, dialog) {\n\t\t\tif (data.action == google.picker.Action.PICKED) {\n\t\t\t\tthis.upload_file({\n\t\t\t\t\tfile_url: data.docs[0].url,\n\t\t\t\t\tfile_name: data.docs[0].name\n\t\t\t\t});\n\t\t\t} else if (data.action == google.picker.Action.CANCEL) {\n\t\t\t\tdialog.show();\n\t\t\t}\n\t\t},\n\t\turl_to_file(url, filename, mime_type) {\n\t\t\treturn fetch(url)\n\t\t\t\t\t.then(res => res.arrayBuffer())\n\t\t\t\t\t.then(buffer => new File([buffer], filename, { type: mime_type }));\n\t\t},\n\t}\n}\n<\/script>\n<style>\n.file-upload-area {\n\tmin-height: 16rem;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tborder: 1px dashed var(--dark-border-color);\n\tborder-radius: var(--border-radius);\n\tcursor: pointer;\n\tbackground-color: var(--bg-color);\n}\n\n.btn-file-upload {\n\tbackground-color: transparent;\n\tborder: none;\n\tbox-shadow: none;\n\tfont-size: var(--text-xs);\n}\n</style>\n']},media:void 0})},__vue_scope_id__$5=void 0,__vue_module_identifier__$5=void 0,__vue_is_functional_template__$5=!1;function __vue_normalize__$5(e,t,n,r,i,a,o,s){var l,c=("function"==typeof n?n.options:n)||{};if(c.__file="/home/runner/work/frappe/frappe/frappe-bench/apps/frappe/frappe/public/js/frappe/file_uploader/FileUploader.vue",c.render||(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,i&&(c.functional=!0)),c._scopeId=r,t&&(l=function(e){t.call(this,o(e))}),void 0!==l)if(c.functional){var d=c.render;c.render=function(e,t){return l.call(t),d(e,t)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return c}function __vue_create_injector__$5(){var e=document.head||document.getElementsByTagName("head")[0],t=__vue_create_injector__$5.styles||(__vue_create_injector__$5.styles={}),n="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,i){if(!document.querySelector('style[data-vue-ssr-id~="'+r+'"]')){var a=n?i.media||"default":r,o=t[a]||(t[a]={ids:[],parts:[],element:void 0});if(!o.ids.includes(r)){var s=i.source,l=o.ids.length;if(o.ids.push(r),n&&(o.element=o.element||document.querySelector("style[data-group="+a+"]")),!o.element){var c=o.element=document.createElement("style");c.type="text/css",i.media&&c.setAttribute("media",i.media),n&&(c.setAttribute("data-group",a),c.setAttribute("data-next-index","0")),e.appendChild(c)}if(n&&(l=parseInt(o.element.getAttribute("data-next-index")),o.element.setAttribute("data-next-index",l+1)),o.element.styleSheet)o.parts.push(s),o.element.styleSheet.cssText=o.parts.filter(Boolean).join("\n");else{var d=document.createTextNode(s),u=o.element.childNodes;u[l]&&o.element.removeChild(u[l]),u.length?o.element.insertBefore(d,u[l]):o.element.appendChild(d)}}}}}var FileUploaderComponent=__vue_normalize__$5({render:__vue_render__$5,staticRenderFns:__vue_staticRenderFns__$5},__vue_inject_styles__$5,__vue_script__$5,__vue_scope_id__$5,__vue_is_functional_template__$5,__vue_module_identifier__$5,__vue_create_injector__$5,void 0);class FileUploader{constructor(e){var t=this;void 0===e&&(e={});var n=e.wrapper,r=e.method,i=e.on_success,a=e.doctype,o=e.docname,s=e.fieldname,l=e.files,c=e.folder,d=e.restrictions,u=e.upload_notes,p=e.allow_multiple,f=e.as_dataurl,h=e.disable_file_browser,_=e.frm;_&&_.attachments.max_reached(!0),n?this.wrapper=n.get?n.get(0):n:this.make_dialog(),this.$fileuploader=new Vue({el:this.wrapper,render:function(e){return e(FileUploaderComponent,{props:{show_upload_button:!Boolean(t.dialog),doctype:a,docname:o,fieldname:s,method:r,folder:c,on_success:i,restrictions:d,upload_notes:u,allow_multiple:p,as_dataurl:f,disable_file_browser:h}})}}),this.uploader=this.$fileuploader.$children[0],this.uploader.$watch("files",function(e){var n=e.every(function(e){return e.private});t.dialog&&t.dialog.set_secondary_action_label(n?__("Set all public"):__("Set all private"))},{deep:!0}),l&&l.length&&this.uploader.add_files(l)}upload_files(){var e=this;return this.dialog&&this.dialog.get_primary_btn().prop("disabled",!0),this.uploader.upload_files().then(function(){e.dialog&&e.dialog.hide()})}make_dialog(){var e=this;this.dialog=new frappe.ui.Dialog({title:__("Upload"),primary_action_label:__("Upload"),primary_action:function(){return e.upload_files()},secondary_action_label:__("Set all private"),secondary_action:function(){e.uploader.toggle_all_private()}}),this.wrapper=this.dialog.body,this.dialog.show(),this.dialog.$wrapper.on("hidden.bs.modal",function(){$(this).data("bs.modal",null),$(this).remove()})}}frappe.provide("frappe.ui"),frappe.ui.FileUploader=FileUploader,frappe.provide("frappe.ui"),frappe.ui.Tree=class{constructor(e){e.parent;var t=e.label,n=e.root_value,r=e.icon_set,i=(e.toolbar,e.expandable,e.with_skeleton);void 0===i&&(i=1);e.args,e.method,e.get_label,e.on_render,e.on_click;$.extend(this,arguments[0]),null==n&&(this.root_value=t),this.setup_treenode_class(),this.nodes={},this.wrapper=$('<div class="tree">').appendTo(this.parent),i&&this.wrapper.addClass("with-skeleton"),r||(this.icon_set={open:frappe.utils.icon("folder-open","md"),closed:frappe.utils.icon("folder-normal","md"),leaf:frappe.utils.icon("primitive-dot","xs")}),this.setup_root_node()}get_nodes(e,t){var n=this,r=Object.assign({},this.args);return r.parent=e,r.is_root=t,new Promise(function(e){frappe.call({method:n.method,args:r,callback:function(t){n.on_get_node&&n.on_get_node(t.message),e(t.message)}})})}get_all_nodes(e,t,n){var r=this,i=Object.assign({},this.args);return i.label=n||e,i.parent=e,i.is_root=t,i.tree_method=this.method,new Promise(function(e){frappe.call({method:"frappe.desk.treeview.get_all_nodes",args:i,callback:function(t){r.on_get_node&&r.on_get_node(t.message,!0),e(t.message)}})})}setup_treenode_class(){var e=this;this.TreeNode=class{constructor(t){t.parent,t.label,t.parent_label,t.expandable,t.is_root,t.data;$.extend(this,arguments[0]),this.loaded=0,this.expanded=0,this.parent_label&&(this.parent_node=e.nodes[this.parent_label]),e.nodes[this.label]=this,e.make_node_element(this),e.on_render&&e.on_render(this)}}}setup_root_node(){this.root_node=new this.TreeNode({parent:this.wrapper,label:this.label,parent_label:null,expandable:!0,is_root:!0,data:{value:this.root_value}}),this.expand_node(this.root_node,!1)}refresh(){this.selected_node.parent_node&&this.load_children(this.selected_node.parent_node,!0)}make_node_element(e){e.$tree_link=$('<span class="tree-link">').attr("data-label",e.label).data("node",e).appendTo(e.parent),e.$ul=$('<ul class="tree-children">').hide().appendTo(e.parent),this.make_icon_and_label(e),this.toolbar&&(e.$toolbar=this.get_toolbar(e).insertAfter(e.$tree_link))}add_node(e,t){var n=$('<li class="tree-node">');return new this.TreeNode({parent:n.appendTo(e.$ul),parent_label:e.label,label:t.value,title:t.title,expandable:t.expandable,data:t})}reload_node(e){this.load_children(e)}toggle(){this.get_selected_node().toggle()}get_selected_node(){return this.selected_node}set_selected_node(e){this.selected_node=e}load_children(e,t){var n=this;void 0===t&&(t=!1);var r=e.label,i=e.data.value,a=e.is_root;t?frappe.run_serially([function(){return n.get_all_nodes(i,a,r)},function(e){return n.render_children_of_all_nodes(e)},function(){return n.set_selected_node(e)}]):frappe.run_serially([function(){return n.get_nodes(i,a)},function(t){return n.render_node_children(e,t)},function(){return n.set_selected_node(e)}])}render_children_of_all_nodes(e){var t=this;e.map(function(e){return t.render_node_children(t.nodes[e.parent],e.data)})}render_node_children(e,t){var n=this;e.$ul.empty(),t&&$.each(t,function(t,r){var i=n.add_node(e,r);i.$tree_link.data("node-data",r).data("node",i)}),e.expanded=!1,e.loaded=!0,this.expand_node(e)}on_node_click(e){this.expand_node(e),frappe.dom.activate(this.wrapper,e.$tree_link,"tree-link"),e.$toolbar&&this.show_toolbar(e)}expand_node(e,t){void 0===t&&(t=!0),this.set_selected_node(e),t&&this.on_click&&this.on_click(e),e.expandable&&this.toggle_node(e),this.select_link(e),e.expanded=!e.expanded,e.parent.toggleClass("opened",e.expanded)}toggle_node(e){if(e.expandable&&this.get_nodes&&!e.loaded)return this.load_children(e);e.$ul&&(e.$ul.children().length&&e.$ul.toggle(!e.expanded),this.icon_set&&(e.expanded?e.$tree_link.find(".icon").parent().addClass("node-parent").html(this.icon_set.closed):e.$tree_link.find(".icon").parent().html(this.icon_set.open)))}select_link(e){this.wrapper.find(".selected").removeClass("selected"),e.$tree_link.toggleClass("selected")}show_toolbar(e){this.cur_toolbar&&$(this.cur_toolbar).hide(),this.cur_toolbar=e.$toolbar,e.$toolbar.show()}get_node_label(e){return this.get_label?this.get_label(e):e.title&&e.title!=e.label?__(e.title)+" <span class='text-muted'>("+e.label+")</span>":__(e.title||e.label)}make_icon_and_label(e){var t=this,n="";this.icon_set&&(n=e.expandable?'<span class="node-parent">'+this.icon_set.closed+"</span>":"<span>"+this.icon_set.leaf+"</span>"),$(n).appendTo(e.$tree_link),$('<a class="tree-label"> '+this.get_node_label(e)+"</a>").appendTo(e.$tree_link),e.$tree_link.on("click",function(){setTimeout(function(){t.on_node_click(e)},100)}),e.$tree_link.hover(function(){$(this).parent().addClass("hover-active")},function(){$(this).parent().removeClass("hover-active")})}get_toolbar(e){var t=this,n=$('<span class="tree-node-toolbar btn-group"></span>').hide();return Object.keys(this.toolbar).map(function(r){var i=t.toolbar[r];if(i.label&&(!i.condition||i.condition(e))){var a=i.get_label?i.get_label():i.label;$("<button class='btn btn-default btn-xs'></button>").html(a).addClass("tree-toolbar-button "+(i.btnClass||"")).appendTo(n).on("click",function(){i.click(e)})}}),n}},frappe.provide("frappe.pages"),frappe.provide("frappe.views"),window.cur_page=null,frappe.views.Container=Class.extend({_intro:"Container contains pages inside `#container` and manages \t\t\tpage creation, switching",init:function(){this.container=$("#body").get(0),this.page=null,this.pagewidth=$(this.container).width(),this.pagemargin=50;var e=this;$(document).on("page-change",function(){var t=frappe.get_route_str();$("body").attr("data-route",t),$("body").attr("data-sidebar",e.has_sidebar()?1:0)}),$(document).bind("rename",function(e,t,n,r){frappe.breadcrumbs.rename(t,n,r)})},add_page:function(e){var t=$('<div class="content page-container"></div>').attr("id","page-"+e).attr("data-page-route",e).hide().appendTo(this.container).get(0);return t.label=e,frappe.pages[e]=t,t},change_to:function(e){if(cur_page=this,this.page&&this.page.label===e&&$(this.page).trigger("show"),e.tagName)var t=e;else t=frappe.pages[e];if(t)return window.cur_dialog&&cur_dialog.display&&!cur_dialog.keep_open&&(cur_dialog.minimizable?cur_dialog.is_minimized||cur_dialog.toggle_minimize():cur_dialog.hide()),this.page&&this.page!=t&&($(this.page).hide(),$(this.page).trigger("hide")),this.page&&this.page==t||(this.page=t,$(this.page).show()),$(document).trigger("page-change"),this.page._route=frappe.router.get_sub_path(),$(this.page).trigger("show"),!this.page.disable_scroll_to_top&&frappe.utils.scroll_to(0),frappe.breadcrumbs.update(),this.page;console.log(__("Page not found")+": "+e)},has_sidebar:function(){var e=0,t=frappe.get_route_str();if(!(e=frappe.ui.pages[t]&&!frappe.ui.pages[t].single_column)){var n=t.split("/").slice(0,2).join("/");e=$('.page-container[data-page-route="'+n+'"] .layout-side-section').length?1:0}return e}}),frappe.breadcrumbs={all:{},preferred:{File:"",Dashboard:"Customization","Dashboard Chart":"Customization","Dashboard Chart Source":"Customization"},module_map:{Core:"Settings",Email:"Settings",Custom:"Settings",Workflow:"Settings",Printing:"Settings",Setup:"Settings","Event Streaming":"Tools",Automation:"Tools"},set_doctype_module:function(e,t){localStorage["preferred_breadcrumbs:"+e]=t},get_doctype_module:function(e){return localStorage["preferred_breadcrumbs:"+e]},add:function(e,t,n){var r;r="object"==typeof e?e:{module:e,doctype:t,type:n},this.all[frappe.breadcrumbs.current_page()]=r,this.update()},current_page:function(){return frappe.get_route_str()},update:function(){var e=this.all[frappe.breadcrumbs.current_page()];if(this.clear(),!e)return this.toggle(!1);if("Custom"===e.type)this.set_custom_breadcrumbs(e);else{this.set_workspace_breadcrumb(e);var t=frappe.get_route()[0];t=t?t.toLowerCase():null,e.doctype&&["print","form"].includes(t)?(this.set_list_breadcrumb(e),this.set_form_breadcrumb(e,t)):e.doctype&&"list"===t&&this.set_list_breadcrumb(e)}this.toggle(!0)},set_custom_breadcrumbs:function(e){var t='<li><a href="'+e.route+'">'+e.label+"</a></li>";this.$breadcrumbs.append(t)},set_workspace_breadcrumb:function(e){e.workspace||this.set_workspace(e),e.workspace&&!e.module_info.blocked&&frappe.visible_modules.includes(e.module_info.module)&&$('<li><a href="/app/'+frappe.router.slug(e.workspace)+'">'+__(e.workspace)+"</a></li>").appendTo(this.$breadcrumbs)},set_workspace:function(e){this.setup_modules();var t=this.get_doctype_module(e.doctype);t?e.module=t:void 0!==this.preferred[e.doctype]&&(e.module=this.preferred[e.doctype]),e.module&&(this.module_map[e.module]&&(e.module=this.module_map[e.module]),e.module_info=frappe.get_module(e.module),e.module_info&&frappe.boot.module_page_map[e.module]&&(e.workspace=frappe.boot.module_page_map[e.module]))},set_list_breadcrumb:function(e){var t=e.doctype,n=frappe.get_doc("DocType",t);if("User"===t&&!frappe.user.has_role("System Manager")||n&&n.issingle);else{var r,i=frappe.router.slug(frappe.router.doctype_layout||t);if(-1!==frappe.boot.treeviews.indexOf(t))r=i+"/view/"+(frappe.model.user_settings[t].last_view||"Tree");else r=i;$('<li><a href="/app/'+r+'">'+__(t)+"</a></li>").appendTo(this.$breadcrumbs)}},set_form_breadcrumb:function(e,t){var n=e.doctype,r=frappe.get_route()[2],i="/app/"+frappe.router.slug(n)+"/"+r;if($('<li><a href="'+i+'">'+__(r)+"</a></li>").appendTo(this.$breadcrumbs),"form"===t){var a=this.$breadcrumbs.find("li").last();a.addClass("disabled"),a.css("cursor","copy"),a.click(function(e){e.stopImmediatePropagation(),frappe.utils.copy_to_clipboard(a.text())})}},setup_modules:function(){frappe.visible_modules||(frappe.visible_modules=$.map(frappe.boot.allowed_workspaces,function(e){return e.module}))},rename:function(e,t,n){var r=["Form",e,t].join("/"),i=["Form",e,n].join("/");this.all[i]=this.all[r],delete frappe.breadcrumbs.all[r],this.update()},clear:function(){this.$breadcrumbs=$("#navbar-breadcrumbs").empty()},toggle:function(e){e?$("body").addClass("no-breadcrumbs"):$("body").removeClass("no-breadcrumbs")}},frappe.provide("frappe.pages"),frappe.provide("frappe.views"),frappe.views.Factory=class{constructor(e){$.extend(this,e)}show(){var e=frappe.get_route_str();if(frappe.pages[e])frappe.container.change_to(e),this.on_show&&this.on_show();else{var t=frappe.get_route();t[1]?this.make(t):frappe.show_not_found(t)}}make_page(e,t){return frappe.make_page(e,t)}},frappe.make_page=function(e,t){if(!t)t=frappe.get_route_str();var n=frappe.container.add_page(t);return frappe.ui.make_app_page({parent:n,single_column:!e}),frappe.container.change_to(t),n},frappe.provide("frappe.views.pageview"),frappe.provide("frappe.standard_pages"),frappe.views.pageview={with_page:function(e,t){if(frappe.standard_pages[e])return frappe.pages[e]||frappe.standard_pages[e](),void t();if(locals.Page&&locals.Page[e]&&locals.Page[e].script||e==window.page_name)t();else if(localStorage["_page:"+e]&&1!=frappe.boot.developer_mode)frappe.model.sync(JSON.parse(localStorage["_page:"+e])),t();else if(e)return frappe.call({method:"frappe.desk.desk_page.getpage",args:{name:e},callback:function(n){n.docs._dynamic_page||(localStorage["_page:"+e]=JSON.stringify(n.docs)),t()},freeze:!0})},show:function(e){e||(e=frappe.boot?frappe.boot.home_page:window.page_name),frappe.model.with_doctype("Page",function(){frappe.views.pageview.with_page(e,function(t){t&&t.exc?t[403]||frappe.show_not_found(e):frappe.pages[e]||new frappe.views.Page(e),frappe.container.change_to(e)})})}},frappe.views.Page=class{constructor(e){this.name=e;var t=this;if(e==window.page_name)this.wrapper=document.getElementById("page-"+e),this.wrapper.label=document.title||window.page_name,this.wrapper.page_name=window.page_name,frappe.pages[window.page_name]=this.wrapper;else{if(this.pagedoc=locals.Page[this.name],!this.pagedoc)return void frappe.show_not_found(e);this.wrapper=frappe.container.add_page(this.name),this.wrapper.page_name=this.pagedoc.name,this.pagedoc.content&&(this.wrapper.innerHTML=this.pagedoc.content),frappe.dom.eval(this.pagedoc.__script||this.pagedoc.script||""),frappe.dom.set_style(this.pagedoc.style||""),frappe.breadcrumbs.add(this.pagedoc.module||null)}this.trigger_page_event("on_page_load"),$(this.wrapper).on("show",function(){window.cur_frm=null,t.trigger_page_event("on_page_show"),t.trigger_page_event("refresh")})}trigger_page_event(e){this.wrapper[e]&&this.wrapper[e](this.wrapper)}},frappe.show_not_found=function(e){frappe.show_message_page({page_name:e,message:__("Sorry! I could not find what you were looking for."),img:"/assets/frappe/images/ui/bubble-tea-sorry.svg"})},frappe.show_not_permitted=function(e){frappe.show_message_page({page_name:e,message:__("Sorry! You are not permitted to view this page."),img:"/assets/frappe/images/ui/bubble-tea-sorry.svg"})},frappe.show_message_page=function(e){e.page_name||(e.page_name=frappe.get_route_str()),e.icon?e.img=repl('<span class="%(icon)s message-page-icon"></span> ',e):e.img&&(e.img=repl('<img src="%(img)s" class="message-page-image">',e));var t=frappe.pages[e.page_name]||frappe.container.add_page(e.page_name);$(t).html(repl('<div class="page message-page">\t\t\t<div class="text-center message-page-content">\t\t\t\t%(img)s\t\t\t\t<p class="lead">%(message)s</p>\t\t\t\t<a class="btn btn-default btn-sm btn-home" href="#">%(home)s</a>\t\t\t</div>\t\t</div>',{img:e.img||"",message:e.message||"",home:__("Home")})),frappe.container.change_to(e.page_name)},frappe.provide("frappe.search"),frappe.provide("frappe.tags"),frappe.search.AwesomeBar=Class.extend({setup:function(e){var t=this;$(".search-bar").removeClass("hidden");var n=$(e),r=n.get(0);this.options=[],this.global_results=[];var i=new Awesomplete(r,{minChars:0,maxItems:99,autoFirst:!0,list:[],filter:function(e,t){return!0},data:function(e,t){return{label:e.index||"",value:e.value}},item:function(e,t){var n=this.get_item(e.value),r="<span>"+__(n.label||n.value)+"</span>";return n.description&&n.value!==n.description&&(r+='<br><span class="text-muted ellipsis">'+__(n.description)+"</span>"),$("<li></li>").data("item.autocomplete",n).html('<a style="font-weight:normal">'+r+"</a>").get(0)},sort:function(e,t){return t.label-e.label}});r.awesomplete=i,this.awesomplete=i,n.on("input",frappe.utils.debounce(function(e){var n=e.target.value.trim().replace(/\s\s+/g," "),r=n.lastIndexOf(" ");t.global_results=[],t.options=[],n&&n.length>1?(-1!==r&&t.set_specifics(n.slice(0,r),n.slice(r+1)),t.add_defaults(n),t.options=t.options.concat(t.build_options(n)),t.options=t.options.concat(t.global_results)):(t.options=t.options.concat(t.deduplicate(frappe.search.utils.get_recent_pages(n||""))),t.options=t.options.concat(frappe.search.utils.get_frequent_links())),t.add_help(),i.list=t.deduplicate(t.options)},100));n.on("focus",function(){this.autocomplete_open||$(this).trigger("input")}),n.on("awesomplete-open",function(e){t.autocomplete_open=e.target}),n.on("awesomplete-close",function(e){t.autocomplete_open=!1}),n.on("awesomplete-select",function(e){var t=e.originalEvent.text.value,r=i.get_item(t);r.route_options&&(frappe.route_options=r.route_options),r.onclick?r.onclick(r.match):frappe.set_route(r.route),n.val("")}),n.on("awesomplete-selectcomplete",function(e){n.val("")}),n.on("keydown",null,"esc",function(){n.blur()}),frappe.search.utils.setup_recent(),frappe.tags.utils.fetch_tags()},add_help:function(){this.options.push({value:__("Help on Search"),index:-10,default:"Help",onclick:function(){var e='<table class="table table-bordered">\t\t\t\t\t<tr><td style="width: 50%">'+__("Create a new record")+"</td><td>"+__("new type of document")+"</td></tr>\t\t\t\t\t<tr><td>"+__("List a document type")+"</td><td>"+__("document type..., e.g. customer")+"</td></tr>\t\t\t\t\t<tr><td>"+__("Search in a document type")+"</td><td>"+__("text in document type")+"</td></tr>\t\t\t\t\t<tr><td>"+__("Tags")+"</td><td>"+__("tag name..., e.g. #tag")+"</td></tr>\t\t\t\t\t<tr><td>"+__("Open a module or tool")+"</td><td>"+__("module name...")+"</td></tr>\t\t\t\t\t<tr><td>"+__("Calculate")+"</td><td>"+__("e.g. (55 + 434) / 4 or =Math.sin(Math.PI/2)...")+"</td></tr>\t\t\t\t</table>";frappe.msgprint(e,__("Search Help"))}})},set_specifics:function(e,t){var n=this;this.build_options(e).forEach(function(e){e.type&&0===e.type.toLowerCase().indexOf(t.toLowerCase())&&n.options.push(e)})},add_defaults:function(e){this.make_global_search(e),this.make_search_in_current(e),this.make_calculator(e),this.make_random(e)},build_options:function(e){var t=frappe.search.utils.get_creatables(e).concat(frappe.search.utils.get_search_in_list(e),frappe.search.utils.get_doctypes(e),frappe.search.utils.get_reports(e),frappe.search.utils.get_pages(e),frappe.search.utils.get_workspaces(e),frappe.search.utils.get_dashboards(e),frappe.search.utils.get_recent_pages(e||""),frappe.search.utils.get_executables(e));return"#"===e.charAt(0)&&(t=frappe.tags.utils.get_tags(e)),this.deduplicate(t).sort(function(e,t){return t.index-e.index})},deduplicate:function(e){var t=[],n=[];return e.forEach(function(e){if(e.route){"List"===e.route[0]&&"Report"!==e.route[2]&&"Inbox"!==e.route[2]&&e.route.splice(2);var r="string"==typeof e.route?e.route:e.route.join("/");if(-1===n.indexOf(r))t.push(e),n.push(r);else{var i=n.indexOf(r);t[i].index<e.index&&!e.recent&&(t[i]=e)}}else t.push(e),n.push("")}),t},set_global_results:function(e,t){this.global_results=this.global_results.concat(e)},make_global_search:function(e){"#"!==e.charAt(0)&&this.options.push({label:'\n\t\t\t\t<span class="flex justify-between text-medium">\n\t\t\t\t\t<span class="ellipsis">'+__("Search for {0}",[frappe.utils.xss_sanitise(e).bold()])+"</span>\n\t\t\t\t\t<kbd>↵</kbd>\n\t\t\t\t</span>\n\t\t\t",value:__("Search for {0}",[e]),match:e,index:100,default:"Search",onclick:function(){frappe.searchdialog.search.init_search(e,"global_search")}})},make_search_in_current:function(e){var t=frappe.get_route();if("List"===t[0]&&-1===e.indexOf(" in")){var n={};n[frappe.get_meta(frappe.container.page.list_view.doctype).title_field||"name"]=["like","%"+e+"%"],this.options.push({label:__("Find {0} in {1}",[e.bold(),__(t[1]).bold()]),value:__("Find {0} in {1}",[e,__(t[1])]),route_options:n,onclick:function(){cur_list.show()},index:90,default:"Current",match:e})}},make_calculator:function(txt){var first=txt.substr(0,1);if(first==parseInt(first)||"("===first||"="===first){"="===first&&(txt=txt.substr(1));try{var val=eval(txt),formatted_value=__("{0} = {1}",[txt,(val+"").bold()]);this.options.push({label:formatted_value,value:__("{0} = {1}",[txt,val]),match:val,index:80,default:"Calculator",onclick:function(){frappe.msgprint(formatted_value,"Result")}})}catch(e){}}},make_random:function(e){e.toLowerCase().includes("random")&&this.options.push({label:"Generate Random Password",value:frappe.utils.get_random(16),onclick:function(){frappe.msgprint(frappe.utils.get_random(16),"Result")}})}}),frappe.provide("frappe.search"),frappe.ui.Notifications=class{constructor(){this.tabs={},this.notification_settings=frappe.boot.notification_settings,this.make()}make(){this.dropdown=$(".navbar").find(".dropdown-notifications").removeClass("hidden"),this.dropdown_list=this.dropdown.find(".notifications-list"),this.header_items=this.dropdown_list.find(".header-items"),this.header_actions=this.dropdown_list.find(".header-actions"),this.body=this.dropdown_list.find(".notification-list-body"),this.panel_events=this.dropdown_list.find(".panel-events"),this.panel_notifications=this.dropdown_list.find(".panel-notifications"),this.user=frappe.session.user,this.setup_headers(),this.setup_dropdown_events()}setup_headers(){var e=this;$('<span class="notification-settings pull-right" data-action="go_to_settings">\n\t\t\t'+frappe.utils.icon("setting-gear")+"\n\t\t</span>").on("click",function(t){t.stopImmediatePropagation(),e.dropdown.dropdown("hide"),frappe.set_route("Form","Notification Settings",frappe.session.user)}).appendTo(this.header_actions).attr("title",__("Notification Settings")).tooltip({delay:{show:600,hide:100},trigger:"hover"}),$('<span class="mark-all-read pull-right" data-action="mark_all_as_read">\n\t\t\t'+frappe.utils.icon("mark-as-read")+"\n\t\t</span>").on("click",function(t){return e.mark_all_as_read(t)}).appendTo(this.header_actions).attr("title",__("Mark all as read")).tooltip({delay:{show:600,hide:100},trigger:"hover"}),this.categories=[{label:__("Notifications"),id:"notifications",view:NotificationsView,el:this.panel_notifications},{label:__("Today's Events"),id:"todays_events",view:EventsView,el:this.panel_events}];var t=$('<ul class="notification-item-tabs nav nav-tabs" role="tablist"></ul>');this.categories=this.categories.map(function(n){return n.$tab=$(function(e){return'<li class="notifications-category '+("notifications"==e.id?"active":"")+'"\n\t\t\t\t\tid="'+e.id+'"\n\t\t\t\t\tdata-toggle="collapse"\n\t\t\t\t>'+e.label+"</li>"}(n)),n.$tab.on("click",function(t){t.stopImmediatePropagation(),e.switch_tab(n)}),t.append(n.$tab),n}),t.appendTo(this.header_items),this.categories.forEach(function(t){e.make_tab_view(t)}),this.switch_tab(this.categories[0])}switch_tab(e){var t=this;this.categories.forEach(function(e){e.$tab.removeClass("active")}),e.$tab.addClass("active"),Object.keys(this.tabs).forEach(function(e){return t.tabs[e].hide()}),this.tabs[e.id].show()}make_tab_view(e){var t=new e.view(e.el,this.dropdown,this.notification_settings);this.tabs[e.id]=t}mark_all_as_read(e){e.stopImmediatePropagation(),this.dropdown_list.find(".unread").removeClass("unread"),frappe.call("frappe.desk.doctype.notification_log.notification_log.mark_all_as_read")}setup_dropdown_events(){this.dropdown.on("hide.bs.dropdown",function(e){var t=$(e.currentTarget).data("closable");return $(e.currentTarget).data("closable",!0),t}),this.dropdown.on("click",function(e){$(e.currentTarget).data("closable",!0)})}},frappe.ui.notifications={get_notification_config:function(){return frappe.xcall("frappe.desk.notifications.get_notification_info").then(function(e){return frappe.ui.notifications.config=e,e})},show_open_count_list:function(e){var t=this;frappe.ui.notifications.config?this.route_to_list_with_filters(e):this.get_notification_config().then(function(){t.route_to_list_with_filters(e)})},route_to_list_with_filters:function(e){var t=frappe.ui.notifications.config.conditions[e];t&&$.isPlainObject(t)&&(frappe.route_options||(frappe.route_options={}),$.extend(frappe.route_options,t)),frappe.set_route("List",e)}};class BaseNotificationsView{constructor(e,t,n){this.wrapper=e,this.parent=t,this.settings=n,this.max_length=20,this.container=$("<div></div>").appendTo(this.wrapper),this.make()}show(){this.container.show()}hide(){this.container.hide()}}class NotificationsView extends BaseNotificationsView{make(){var e=this;this.notifications_icon=this.parent.find(".notifications-icon"),this.notifications_icon.attr("title",__("Notifications")).tooltip({delay:{show:600,hide:100},trigger:"hover"}),this.setup_notification_listeners(),this.get_notifications_list(this.max_length).then(function(t){e.dropdown_items=t,e.render_notifications_dropdown(),0==e.settings.seen&&e.toggle_notification_icon(!1)})}update_dropdown(){var e=this;this.get_notifications_list(1).then(function(t){var n=t[0];e.dropdown_items.unshift(n),e.dropdown_items.length>e.max_length&&(e.container.find(".recent-notification").last().remove(),e.dropdown_items.pop()),e.insert_into_dropdown()})}change_activity_status(){this.container.find(".activity-status")&&this.container.find(".activity-status").replaceWith('<a class="recent-item text-center text-muted"\n\t\t\t\t\thref="/app/List/Notification Log">\n\t\t\t\t\t<div class="full-log-btn">'+__("View Full Log")+"</div>\n\t\t\t\t</a>")}mark_as_read(e,t){frappe.call("frappe.desk.doctype.notification_log.notification_log.mark_as_read",{docname:e}).then(function(){t.removeClass("unread")})}insert_into_dropdown(){var e=this.dropdown_items[0],t=this.get_dropdown_item_html(e);$(t).prependTo(this.container),this.change_activity_status()}get_dropdown_item_html(e){var t=this,n=this.get_item_link(e),r=e.read?"":"unread",i=e.subject,a=i.match(/<b class="subject-title">(.*?)<\/b>/),o='<div class="message">\n\t\t\t<div>'+(i=a?i.replace(a[1],frappe.ellipsis(strip_html(a[1]),100)):i)+'</div>\n\t\t\t<div class="notification-timestamp text-muted">\n\t\t\t\t'+frappe.datetime.comment_when(e.creation)+"\n\t\t\t</div>\n\t\t</div>",s=e.from_user,l=frappe.avatar(s,"avatar-medium user-avatar"),c=$('<a class="recent-item notification-item '+r+'"\n\t\t\t\thref="'+n+'"\n\t\t\t\tdata-name="'+e.name+'"\n\t\t\t>\n\t\t\t\t<div class="notification-body">\n\t\t\t\t\t'+l+"\n\t\t\t\t\t"+o+'\n\t\t\t\t</div>\n\t\t\t\t<div class="mark-as-read" title="'+__("Mark as Read")+'">\n\t\t\t\t</div>\n\t\t\t</a>');if(!e.read){var d=c.find(".mark-as-read");d.tooltip({delay:{show:600,hide:100},trigger:"hover"}),d.on("click",function(n){n.preventDefault(),n.stopImmediatePropagation(),t.mark_as_read(e.name,c)}),c.on("click",function(){t.mark_as_read(e.name,c)})}return c}render_notifications_dropdown(){var e=this;this.settings&&!this.settings.enabled?this.container.html('<li class="recent-item notification-item">\n\t\t\t\t<span class="text-muted">\n\t\t\t\t\t'+__("Notifications Disabled")+"\n\t\t\t\t</span></li>"):this.dropdown_items.length?(this.container.empty(),this.dropdown_items.forEach(function(t){e.container.append(e.get_dropdown_item_html(t))}),this.container.append('<a class="list-footer"\n\t\t\t\t\thref="/app/List/Notification Log">\n\t\t\t\t\t\t<div class="full-log-btn">'+__("See all Activity")+"</div>\n\t\t\t\t\t</a>")):this.container.append($('<div class="notification-null-state">\n\t\t\t\t\t<div class="text-center">\n\t\t\t\t\t\t<img src="/assets/frappe/images/ui-states/notification-empty-state.svg" alt="Generic Empty State" class="null-state">\n\t\t\t\t\t\t<div class="title">'+__("No New notifications")+'</div>\n\t\t\t\t\t\t<div class="subtitle">\n\t\t\t\t\t\t\t'+__("Looks like you haven’t received any notifications.")+"\n\t\t\t\t\t</div></div></div>"))}get_notifications_list(e){return frappe.db.get_list("Notification Log",{fields:["*"],limit:e,order_by:"creation desc"})}get_item_link(e){var t="Alert"==e.type?"Notification Log":e.document_type,n="Alert"==e.type?e.name:e.document_name;return frappe.utils.get_form_link(t,n)}toggle_notification_icon(e){this.notifications_icon.find(".notifications-seen").toggle(e),this.notifications_icon.find(".notifications-unseen").toggle(!e)}toggle_seen(e){frappe.call("frappe.desk.doctype.notification_settings.notification_settings.set_seen_value",{value:cint(e),user:frappe.session.user})}setup_notification_listeners(){var e=this;frappe.realtime.on("notification",function(){e.toggle_notification_icon(!1),e.update_dropdown()}),frappe.realtime.on("indicator_hide",function(){e.toggle_notification_icon(!0)}),this.parent.on("show.bs.dropdown",function(){e.toggle_seen(!0),e.notifications_icon.find(".notifications-unseen").is(":visible")&&(e.toggle_notification_icon(!0),frappe.call("frappe.desk.doctype.notification_log.notification_log.trigger_indicator_hide"))})}}class EventsView extends BaseNotificationsView{make(){var e=this,t=frappe.datetime.get_today();frappe.xcall("frappe.desk.doctype.event.event.get_events",{start:t,end:t}).then(function(t){e.render_events_html(t)})}render_events_html(e){var t="";if(e.length){t=e.map(function(e){var t=__("All Day");if(!e.all_day){var n=frappe.datetime.get_time(e.starts_on),r=frappe.datetime.get_day_diff(e.ends_on,e.starts_on),i=frappe.datetime.get_time(e.ends_on);r>1&&(i=__("Rest of the day")),t=n+" - "+i}var a="";e.particpants&&(a=frappe.avatar_group(e.particpants,3));var o="";return e.location&&(o=", "+e.location),'<a class="recent-item event" href="/app/event/'+e.name+'">\n\t\t\t\t\t<div class="event-border" style="border-color: '+e.color+'"></div>\n\t\t\t\t\t<div class="event-item">\n\t\t\t\t\t\t<div class="event-subject">'+e.subject+'</div>\n\t\t\t\t\t\t<div class="event-time">'+t+o+"</div>\n\t\t\t\t\t\t"+a+"\n\t\t\t\t\t</div>\n\t\t\t\t</a>"}).join("")}else t='\n\t\t\t\t<div class="notification-null-state">\n\t\t\t\t\t<div class="text-center">\n\t\t\t\t\t<img src="/assets/frappe/images/ui-states/event-empty-state.svg" alt="Generic Empty State" class="null-state">\n\t\t\t\t\t<div class="title">'+__("No Upcoming Events")+'</div>\n\t\t\t\t\t<div class="subtitle">\n\t\t\t\t\t\t'+__("There are no upcoming events for you.")+"\n\t\t\t\t</div></div></div>\n\t\t\t";this.container.html(t)}}frappe.provide("frappe.search"),frappe.search.SearchDialog=class{constructor(e){$.extend(this,e),this.make()}make(){this.search_dialog=new frappe.ui.Dialog({minimizable:!0,size:"large"}),this.set_header(),this.$wrapper=$(this.search_dialog.$wrapper).addClass("search-dialog"),this.$body=$(this.search_dialog.body),this.$input=this.$wrapper.find(".search-input"),this.setup()}set_header(){this.search_dialog.header.addClass("search-header").find(".title-section").html('<div class="input-group text-muted">\n\t\t\t\t\t<input type="text" class="form-control search-input">\n\t\t\t\t</div>\n\t\t\t\t<span class="search-icon">\n\t\t\t\t\t'+frappe.utils.icon("search")+"\n\t\t\t\t</span>")}setup(){this.modal_state=0,this.current_keyword="",this.more_count=20,this.full_lists={},this.nav_lists={},this.init_search_objects(),this.bind_input(),this.bind_events()}init_search_objects(){this.searches={global_search:{input_placeholder:__("Search"),empty_state_text:__("Search for anything"),no_results_status:function(){return __("No Results found")},get_results:function(e,t){var n=frappe.search.utils.get_nav_results(e);frappe.search.utils.get_global_results(e,0,1e3).then(function(r){n=n.concat(r),t(n,e)},function(e){console.error(e)})}},tags:{input_placeholder:__("Search"),empty_state_text:__("Search for anything"),no_results_status:function(e){return"<div>"+__("No documents found tagged with {0}",[e])+"</div>"},get_results:function(e,t){var n=frappe.search.utils.get_nav_results(e);frappe.tags.utils.get_tag_results(e).then(function(r){n=n.concat(r),t(n,e)},function(e){console.error(e)})}}}}update(e){this.$wrapper.find(".loading-state").addClass("hide"),this.$body.append(e),this.$body.find(".search-results").length>1?(this.$body.find(".search-results").first().addClass("hide"),e.removeClass("hide"),this.$body.find(".search-results").first().remove()):e.removeClass("hide")}put_placeholder(e){var t=$('<div class="row search-results hide">\n\t\t\t<div class="empty-state">\n\t\t\t\t<div class="text-center">\n\t\t\t\t\t<img src="/assets/frappe/images/ui-states/search-empty-state.svg"\n\t\t\t\t\t\talt="Generic Empty State"\n\t\t\t\t\t\tclass="null-state"\n\t\t\t\t\t>\n\t\t\t\t\t<div class="empty-state-text">'+e+"</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>");this.update(t)}bind_input(){var e=this;this.$input.on("input",function(t){var n=$(t.currentTarget);clearTimeout(n.data("timeout")),n.data("timeout",setTimeout(function(){if(e.$input.val()!==e.current_keyword){var t=e.$input.val();t.length>1?e.get_results(t):(e.current_keyword="",e.put_placeholder(e.search.empty_state_text))}},300))})}bind_events(){var e=this;this.$body.on("click",".list-link",function(t){var n=$(t.currentTarget);e.$body.find(".search-sidebar").find(".list-link").removeClass("active selected"),n.addClass("active selected");var r=n.attr("data-category");e.$body.find(".results-area").empty().html(e.full_lists[r]),e.$body.find(".module-section-link").first().focus()}),this.$body.on("click",".section-more",function(t){var n=$(t.currentTarget).attr("data-category");e.$body.find(".search-sidebar").find('*[data-category="'+n+'"]').trigger("click")}),this.$body.on("click",".all-results-link",function(){e.$body.find(".search-sidebar").find('*[data-category="All Results"]').trigger("click")}),this.$body.on("click",".list-more",function(t){var n=$(t.currentTarget),r=n.attr("data-category"),i=n.attr("data-search"),a=e.$body.find(".result").length;if("Global"===i)frappe.search.utils.get_global_results(e.current_keyword,a,e.more_count,r).then(function(t){t.length&&e.add_more_results(t)},function(e){console.error(e)});else{var o=e.nav_lists[r].slice(0,e.more_count);e.nav_lists[r].splice(0,e.more_count),e.add_more_results([{title:r,results:o}])}}),this.$body.on("click",".switch-to-global-search",function(){e.search=e.searches.global_search,e.$input.attr("placeholder",e.search.input_placeholder),e.put_placeholder(e.search.empty_state_text),e.get_results(e.current_keyword)})}init_search(e,t){var n=this;this.search=this.searches[t],this.$input.attr("placeholder",this.search.input_placeholder),this.put_placeholder(this.search.empty_state_text),this.get_results(e),this.search_dialog.show(),this.$input.val(e),setTimeout(function(){return n.$input.select()},500)}get_results(e){this.current_keyword=e,this.$body.find(".empty-state").length>0?this.put_placeholder(__("Searching ...")):this.$wrapper.find(".loading-state").removeClass("hide"),"#"===this.current_keyword.charAt(0)?this.search=this.searches.tags:this.search=this.searches.global_search,this.search.get_results(e,this.parse_results.bind(this))}parse_results(e,t){(e=e.filter(function(e){return e.results.length>0})).length>0?this.render_data(e):this.put_placeholder(this.search.no_results_status(t))}render_data(e){var t=this,n=$(frappe.render_template("search")).addClass("hide"),r=n.find(".search-sidebar").empty(),i='<li class="search-sidebar-item standard-sidebar-item list-link" data-category="{0}"><a><span class="ellipsis">{1}</span></a></li>';this.modal_state=0,this.full_lists={"All Results":$('<div class="results-summary"></div>')},this.nav_lists={},e.forEach(function(e){r.append($(__(i,[e.title,__(e.title)]))),t.add_section_to_summary(e.title,e.results),t.full_lists[e.title]=t.render_full_list(e.title,e.results,e.fetch_type)}),e.length>1&&r.prepend($(__(i,["All Results",__("All Results")]))),this.update(n.clone()),this.$body.find(".list-link").first().trigger("click")}render_full_list(e,t,n){var r=this,i=$('<div class="results-summary">\n\t\t\t<div class="result-section full-list '+e+'-section col-sm-12">\n\t\t\t\t<div class="result-title"> '+__(e)+'</div>\n\t\t\t\t<div class="result-body">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>');return t.slice(0,20).forEach(function(t){i.find(".result-body").append(r.render_result(e,t))}),t.length>0&&("Nav"===n&&(this.nav_lists[e]=t),t.length>20&&$('<a class="list-more" data-search="'+n+'"\n\t\t\t\t\tdata-category="'+e+'" data-count="20">\n\t\t\t\t\t\t'+__("More")+"\n\t\t\t\t</a>").appendTo(i.find(".result-body"))),i}add_section_to_summary(e,t){var n=this,r="";t.length>4&&(r='<div>\n\t\t\t\t<a class="section-more" data-category="'+e+'">'+__("More")+"</a>\n\t\t\t</div>"),$('<div class="col-sm-12 result-section" data-type="'+e+'">\n\t\t\t<div class="result-title">'+__(e)+'</div>\n\t\t\t<div class="result-body">\n\t\t\t\t'+r+"\n\t\t\t</div>\n\t\t</div>").appendTo(this.full_lists["All Results"]).find(".result-body").prepend(t.slice(0,4).map(function(t){return n.render_result(e,t)}))}get_link(e){var t="";return e.route?t='href="/app/'+e.route.join("/")+'"':e.data_path&&(t="data-path="+e.data_path+'"'),t}render_result(e,t){var n="";if(void 0!==t.image){var r=frappe.get_avatar("avatar-medium",t.label,t.image);n="<a "+this.get_link(t)+'>\n\t\t\t\t<div class="result-image">\n\t\t\t\t\t'+r+"\n\t\t\t\t</div>\n\t\t\t</a>"}var i="<a "+this.get_link(t)+' class="result-section-link">'+t.label+"</a>",a=t.description?"<b>"+i+'</b><div class="description"> '+t.description+" </div>":i,o=$('<div class="result '+e+'-result">\n\t\t\t'+n+"\n\t\t\t"+('<div class="result-text">\n\t\t\t'+a+"\n\t\t</div>")+"\n\t\t\t"+(t.subtypes||"")+"\n\t\t</div>");return t.description||this.handle_result_click(t,o),o}handle_result_click(e,t){e.route_options&&(frappe.route_options=e.route_options),t.on("click",function(){if(e.onclick)e.onclick(e.match);else{var t=window.location.hash;frappe.set_route(e.route),window.location.hash==t&&frappe.router.route()}})}add_more_results(e){var t=this,n=$('<div class="more-results last"></div>');if(e[0].results&&e[0].results.forEach(function(r){n.append(t.render_result(e[0].title,r))}),this.$body.find(".list-more").before(n),e[0].results.length<this.more_count){this.$body.find(".list-more").hide();var r=this.$body.find(".result").length,i=$('<div class="results-status">'+r+" results found</div>");this.$body.find(".more-results:last").append(i)}this.$body.find(".more-results.last").slideDown(200,function(){})}},frappe.provide("frappe.tags"),frappe.tags.utils={get_tags:function(e){e=e.slice(1);var t=[],n=function(n){var r=frappe.tags.tags[n],i=frappe.search.utils.fuzzy_search(e,r);i&&t.push({type:"Tag",label:__("#{0}",[frappe.search.utils.bolden_match_part(__(r),e)]),value:__("#{0}",[__(r)]),index:1+i,match:r,onclick:function(){frappe.searchdialog.search.init_search("#".concat(r),"tags")}})};for(var r in frappe.tags.tags)n(r);return t},fetch_tags:function(){frappe.call({method:"frappe.desk.doctype.tag.tag.get_tags_list_for_awesomebar",callback:function(e){e&&e.message&&(frappe.tags.tags=$.extend([],e.message))}})},get_tag_results:function(e){function t(e){var t,n,r=[];return e.forEach(function(e){var i,a="";e.content&&(a=function(e){var t=null;if(e.length>110)t=e.slice(0,110)+"...";else{var n=e.length;t=e.slice(0,n)+"..."}return t}(e.content)),t={label:e.name,value:e.name,description:a,route:["Form",e.doctype,e.name]},i=e.doctype,(n=r.find(function(e){return e.title===i}))?n.results.push(t):(n={title:e.doctype,results:[t],fetch_type:"Global"},r.push(n))}),r}return new Promise(function(n){frappe.call({method:"frappe.desk.doctype.tag.tag.get_documents_for_tag",args:{tag:e},callback:function(e){e.message?n(t(e.message)):n([])}})})}},frappe.templates.search='<div class="search-results flex">  <div class="col-md-3 col-sm-3 hidden-xs layout-side-section">   <ul class="overlay-sidebar list-unstyled search-sidebar"></ul>  </div>  <div class="col-md-9 col-sm-9 layout-main-section results-area">   </div> </div> ',frappe.provide("frappe.search"),frappe.search.utils={setup_recent:function(){this.recent=JSON.parse(frappe.boot.user.recent||"[]")||[]},get_recent_pages:function(e){null===e&&(e="");var t=[],n=[];return this.recent.forEach(function(e,n){t.push([e[1],["Form",e[0],e[1]]])}),t=t.reverse(),frappe.route_history.forEach(function(e,n){"Form"===e[0]?t.push([e[2],e]):["List","Tree","Workspaces","query-report"].includes(e[0])||"Report"===e[2]?e[1]&&t.push([e[1],e]):e[0]&&t.push([frappe.route_titles[e.join("/")]||e[0],e])}),function(e,t,r){e.forEach(function(e,i){var a=$.isArray(e)?e[0]:e;if(a=__(a||"").toLowerCase().replace(/-/g," "),t===a||-1!==a.indexOf(t)){var o=r(e);o&&($.isPlainObject(o)&&(o=[o]),o.forEach(function(t){t.match=e,t.recent=!0}),n=o.concat(n))}})}(t,e,function(e){var t={route:e[1]};if("Form"===e[1][0])e[1].length>2&&e[1][1]!==e[1][2]?(t.label=__(e[1][1])+" "+e[1][2].bold(),t.value=__(e[1][1])+" "+e[1][2]):(t.label=__(e[1][1]).bold(),t.value=__(e[1][1]));else if(["List","Tree","Workspaces","query-report"].includes(e[1][0])&&e[1].length>1){var n=e[1][0],r=n;"Workspaces"===n?r="Workspace":"query-report"!==n&&"Report"!==e[1][2]||(r="Report"),t.label=__("{0} "+r,[__(e[1][1]).bold()]),t.value=__("{0} "+r,[__(e[1][1])])}else e[0]?(t.label=e[0].bold(),t.value=e[0]):console.log("Illegal match",e);return t.index=80,t}),n},get_frequent_links:function(){var e=[];return frappe.boot.frequently_visited_links.forEach(function(t){var n=frappe.utils.get_route_label(t.route);e.push({route:t.route,label:n,value:n,index:t.count})}),e.length?e:this.get_recent_pages("")},get_search_in_list:function(e){var t=this,n=[];if(in_list(e.split(" "),"in")&&"in"!==e.slice(-2)){var r=e.split(" in ");frappe.boot.user.can_read.forEach(function(e){if(frappe.boot.user.can_search.includes(e)){var i=t.fuzzy_search(r[1],e);i&&n.push({type:"In List",label:__("Find {0} in {1}",[__(r[0]),t.bolden_match_part(__(e),r[1])]),value:__("Find {0} in {1}",[__(r[0]),__(e)]),route_options:{name:["like","%"+r[0]+"%"]},index:1+i,route:["List",e]})}})}return n},get_creatables:function(e){var t=this,n=[];return e.split(" ")[0].toLowerCase()===__("new")&&frappe.boot.user.can_create.forEach(function(r){var i=t.fuzzy_search(e.substr(4),r);i&&n.push({type:"New",label:__("New {0}",[t.bolden_match_part(__(r),e.substr(4))]),value:__("New {0}",[__(r)]),index:1+i,match:r,onclick:function(){frappe.new_doc(r,!0)}})}),n},get_doctypes:function(e){var t,n,r=this,i=[],a=function(i,a,o){var s="List"===i&&n.endsWith("List"),l=r.bolden_match_part(__(n),e);if(s)var c=l;else c=__("{0} "+(s?"":i),[l]);return{type:i,label:c,value:__("{0} "+i,[n]),index:t+o,match:n,route:a}};return frappe.boot.user.can_read.forEach(function(o){if(t=r.fuzzy_search(e,o))if(n=o,in_list(frappe.boot.single_types,o))i.push(a("",["Form",o,o],.05));else if(frappe.boot.user.can_search.includes(o)){if(in_list(frappe.boot.user.can_create,o)){var s=o;i.push({type:"New",label:__("New {0}",[r.bolden_match_part(__(o),e)]),value:__("New {0}",[__(o)]),index:t+.015,match:o,onclick:function(){frappe.new_doc(s,!0)}})}in_list(frappe.boot.treeviews,o)?i.push(a("Tree",["Tree",o],.05)):(i.push(a("List",["List",o],.05)),frappe.model.can_get_report(o)&&i.push(a("Report",["List",o,"Report"],.04)))}}),i},get_reports:function(e){var t,n=this,r=[];return Object.keys(frappe.boot.user.all_reports).forEach(function(i){var a=n.fuzzy_search(e,i);if(a>0){var o=frappe.boot.user.all_reports[i];t="Report Builder"==o.report_type?["List",o.ref_doctype,"Report",i]:["query-report",i],r.push({type:"Report",label:__("Report {0}",[n.bolden_match_part(__(i),e)]),value:__("Report {0}",[__(i)]),index:a,route:t})}}),r},get_pages:function(e){var t=this,n=[];this.pages={},$.each(frappe.boot.page_info,function(e,n){t.pages[n.title]=n,n.name=e}),Object.keys(this.pages).forEach(function(r){if("Hub"!=r&&"hub"!=r){var i=t.fuzzy_search(e,r);if(i){var a=t.pages[r];n.push({type:"Page",label:__("Open {0}",[t.bolden_match_part(__(r),e)]),value:__("Open {0}",[__(r)]),match:r,index:i,route:[a.route||a.name]})}}});var r="Calendar";return 0===__("calendar").indexOf(e.toLowerCase())&&n.push({type:"Calendar",value:__("Open {0}",[__(r)]),index:t.fuzzy_search(e,"Calendar"),match:r,route:["List","Event",r]}),r="Hub",0===__("hub").indexOf(e.toLowerCase())&&n.push({type:"Hub",value:__("Open {0}",[__(r)]),index:t.fuzzy_search(e,"Hub"),match:r,route:[r,"Item"]}),0===__("email inbox").indexOf(e.toLowerCase())&&n.push({type:"Inbox",value:__("Open {0}",[__("Email Inbox")]),index:t.fuzzy_search(e,"email inbox"),match:r,route:["List","Communication","Inbox"]}),n},get_workspaces:function(e){var t=this,n=[];return frappe.boot.allowed_workspaces.forEach(function(r){var i=t.fuzzy_search(e,r.name);if(i>0){var a={type:"Workspace",label:__("Open {0}",[t.bolden_match_part(__(r.name),e)]),value:__("Open {0}",[__(r.name)]),index:i,route:[frappe.router.slug(r.name)]};n.push(a)}}),n},get_dashboards:function(e){var t=this,n=[];return frappe.boot.dashboards.forEach(function(r){var i=t.fuzzy_search(e,r.name);if(i>0){var a={type:"Dashboard",label:__("{0} Dashboard",[t.bolden_match_part(__(r.name),e)]),value:__("{0} Dashboard",[__(r.name)]),index:i,route:["dashboard-view",r.name]};n.push(a)}}),n},get_global_results:function(e,t,n,r){void 0===r&&(r="");var i=this;function a(t){var n,r,a=[];function o(t,n){for(var r=t.split(" ||| "),a=[],o=0,s="",l=0;l<r.length;l++){var c=r[l];if(-1!==c.toLowerCase().indexOf(e)){if(-1!==c.indexOf(" &&& "))var d=c.indexOf(" &&& "),u=c.slice(d+5);else d=c.indexOf(" : "),u=c.slice(d+3);if(u.length>120){var p="",f=u.indexOf(e);p+=f<60?u.slice(0,f):"..."+u.slice(f-60,f),p+=u.slice(f,f+60),u=p+=f+60<u.length?"...":""}var h=c.slice(0,d),_=300-o;if(!((o+=h.length+u.length+2)<300)){h.length<_?(_-=h.length,s='<span class="field-name text-muted">'+i.bolden_match_part(h,e)+": </span> ",u=(u=u.slice(0,_)).slice(0,u.lastIndexOf(" "))+" ...",s+=i.bolden_match_part(u,e),a.push(s)):a.push("...");break}s='<span class="field-name text-muted">'+i.bolden_match_part(h,e)+": </span> "+i.bolden_match_part(u,e),-1===a.indexOf(s)&&n!==u&&a.push(s)}}return a.join(", ")}return t.forEach(function(e){var t;n={label:e.name,value:e.name,description:o(e.content,e.name),route:["Form",e.doctype,e.name]},(e.image||null===e.image)&&(n.image=e.image),t=e.doctype,(r=a.find(function(e){return e.title===t}))?r.results.push(n):(r={title:e.doctype,results:[n],fetch_type:"Global"},a.push(r))}),a}return new Promise(function(i,o){frappe.call({method:"frappe.utils.global_search.search",args:{text:e,start:t,limit:n,doctype:r},callback:function(e){e.message?i(a(e.message)):i([])}})})},get_nav_results:function(e){function t(e){var t=[],n=[];return e.forEach(function(e){if(e.route){"List"===e.route[0]&&e.route[2]&&e.route.splice(2);var r=e.route.join("/");if(-1===t.indexOf(r))t.push(r),n.push(e);else{var i=t.indexOf(r);n[i].index>e.index&&(n[i]=e)}}else n.push(e)}),n.sort(function(e,t){return t.index-e.index})}var n=[],r=[];t(this.get_doctypes(e)).forEach(function(e){""===e.type?r.push(e):n.push(e)});var i=e.split(" in ")[0];return[{title:__("Recents"),fetch_type:"Nav",results:t(this.get_recent_pages(e))},{title:__("Create a new ..."),fetch_type:"Nav",results:t(this.get_creatables(e))},{title:__("Lists"),fetch_type:"Nav",results:n},{title:__("Reports"),fetch_type:"Nav",results:t(this.get_reports(e))},{title:__("Administration"),fetch_type:"Nav",results:t(this.get_pages(e))},{title:__("Workspace"),fetch_type:"Nav",results:t(this.get_workspaces(e))},{title:__("Dashboard"),fetch_type:"Nav",results:t(this.get_dashboards(e))},{title:__("Setup"),fetch_type:"Nav",results:r},{title:__("Find '{0}' in ...",[i]),fetch_type:"Nav",results:t(this.get_search_in_list(e))}]},fuzzy_search:function(e,t){e=e||"";var n=__(t||""),r=n.replace(/-/g," "),i=n.length,a=e.length,o=a/i;if(a>i)return 0;if([n,r].includes(e)||[n,r].some(function(t){return 0===t.toLowerCase().indexOf(e)}))return 10+o;if(-1!==n.indexOf(e)&&e!==e.toLowerCase())return 9+o;if(n=n.toLowerCase(),e=e.toLowerCase(),-1!==n.indexOf(e))return 8+o;var s=0,l=0;e:for(var c=0,d=0;c<a;c++){if(0!==l&&s++,s>3)return 0;var u=e.charCodeAt(c);for(l=0;d<i;){if(n.charCodeAt(d++)===u)continue e;if(++l>2)return 0}return 0}return s+l>0?(5+o)/(s+l):0},bolden_match_part:function(e,t){var n="";if(0===this.fuzzy_search(t,e))return e;if(this.fuzzy_search(t,e)>6){var r=new RegExp("("+t+")","ig");return e.replace(r,"<mark>$1</mark>")}var i=e,a=(e=e.toLowerCase()).length;t=t.toLowerCase();e:for(var o=0,s=0;o<t.length;o++){for(var l=t.charCodeAt(o);s<a;){if(e.charCodeAt(s)===l){var c=i.charAt(s);c===c.toLowerCase()?n+="<mark>"+t.charAt(o)+"</mark>":n+="<mark>"+t.charAt(o).toUpperCase()+"</mark>",s++;continue e}n+=i.charAt(s),s++}return i}return n+=i.slice(s)},get_executables:function(e){var t=this,n=[];return this.searchable_functions.forEach(function(r){var i=r.label.toLowerCase(),a=e.toLowerCase();a!==i&&0!==i.indexOf(a)||n.push({type:"Executable",value:t.bolden_match_part(__(r.label),a),index:t.fuzzy_search(a,i),match:r.label,onclick:function(){return r.action.apply(t,r.args)}})}),n},make_function_searchable:function(e,t,n){if(void 0===t&&(t=null),void 0===n&&(n=null),"function"!=typeof e)throw new Error("First argument should be a function");this.searchable_functions.push({label:t||e.name,action:e,args:n})},searchable_functions:[]},frappe.provide("frappe.ui.misc"),frappe.ui.misc.about=function(){if(!frappe.ui.misc.about_dialog){var e=new frappe.ui.Dialog({title:__("Frappe Framework")});$(e.body).html(repl("<div>\t\t<p>"+__("Open Source Applications for the Web")+"</p>  \t\t<p><i class='fa fa-globe fa-fw'></i>\t\t\tWebsite: <a href='https://frappeframework.com' target='_blank'>https://frappeframework.com</a></p>\t\t<p><i class='fa fa-github fa-fw'></i>\t\t\tSource: <a href='https://github.com/frappe' target='_blank'>https://github.com/frappe</a></p>\t\t<p><i class='fa fa-linkedin fa-fw'></i>\t\t\tLinkedin: <a href='https://linkedin.com/company/frappe-tech' target='_blank'>https://linkedin.com/company/frappe-tech</a></p>\t\t<p><i class='fa fa-facebook fa-fw'></i>\t\t\tFacebook: <a href='https://facebook.com/erpnext' target='_blank'>https://facebook.com/erpnext</a></p>\t\t<p><i class='fa fa-twitter fa-fw'></i>\t\t\tTwitter: <a href='https://twitter.com/erpnext' target='_blank'>https://twitter.com/erpnext</a></p>\t\t<hr>\t\t<h4>Installed Apps</h4>\t\t<div id='about-app-versions'>Loading versions...</div>\t\t<hr>\t\t<p class='text-muted'>&copy; Frappe Technologies Pvt. Ltd and contributors </p> \t\t</div>",frappe.app)),frappe.ui.misc.about_dialog=e,frappe.ui.misc.about_dialog.on_page_show=function(){frappe.versions?t(frappe.versions):frappe.call({method:"frappe.utils.change_log.get_versions",callback:function(e){t(e.message)}})};var t=function(e){var t=$("#about-app-versions").empty();$.each(Object.keys(e).sort(),function(n,r){var i=e[r];if(i.branch)var a=$.format("<p><b>{0}:</b> v{1} ({2})<br></p>",[i.title,i.branch_version||i.version,i.branch]);else a=$.format("<p><b>{0}:</b> v{1}<br></p>",[i.title,i.version]);$(a).appendTo(t)}),frappe.versions=e}}frappe.ui.misc.about_dialog.show()},frappe.templates.navbar='<header class="navbar navbar-expand sticky-top" role="navigation">  <div class="container">   <a class="navbar-brand navbar-home" href="/app">    <img class="app-logo" style="width: {{ navbar_settings.logo_width || 24 }}px" src="{{ frappe.boot.app_logo_url }}">   </a>   <ul class="nav navbar-nav d-none d-sm-flex" id="navbar-breadcrumbs"></ul>   <div class="collapse navbar-collapse justify-content-end">    <form class="form-inline fill-width justify-content-end" role="search" onsubmit="return false;">     <div class="input-group search-bar text-muted hidden">      <input       id="navbar-search"       type="text"       class="form-control"       placeholder="{%= __("Search or type a command (Ctrl + G)") %}"       aria-haspopup="true"      >      <span class="search-icon">       <svg class="icon icon-sm"><use xlink:href="#icon-search"></use></svg>      </span>     </div>    </form>    <ul class="navbar-nav">     <li class="nav-item dropdown dropdown-notifications dropdown-mobile hidden">      <a       class="nav-link notifications-icon text-muted"       data-toggle="dropdown"       aria-haspopup="true"       aria-expanded="true"       href="#"       onclick="return false;">       <span class="notifications-seen">        <svg class="icon icon-md"><use href="#icon-notification"></use></svg>       </span>       <span class="notifications-unseen">        <svg class="icon icon-md"><use href="#icon-notification-with-indicator"></use></svg>       </span>      </a>      <div class="dropdown-menu notifications-list dropdown-menu-right" role="menu">       <div class="notification-list-header">        <div class="header-items"></div>        <div class="header-actions"></div>       </div>       <div class="notification-list-body">        <div class="panel-notifications"></div>        <div class="panel-events"></div>       </div>      </div>     </li>     <li class="nav-item dropdown dropdown-message dropdown-mobile hidden">      <a       class="nav-link notifications-icon text-muted"       data-toggle="dropdown"       aria-haspopup="true"       aria-expanded="true"       href="#"       onclick="return false;">       <span>        <svg class="icon icon-md"><use href="#icon-small-message"></use></svg>       </span>      </a>     </li>     <li class="vertical-bar d-none d-sm-block"></li>     <li class="nav-item dropdown dropdown-help dropdown-mobile d-none d-lg-block">      <a class="nav-link" data-toggle="dropdown" href="#" onclick="return false;">       {{ __("Help") }}       <span>        <svg class="icon icon-xs"><use href="#icon-small-down"></use></svg>       </span>      </a>      <div class="dropdown-menu dropdown-menu-right" id="toolbar-help" role="menu">       <div id="help-links"></div>       <div class="dropdown-divider documentation-links"></div>       {% for item in navbar_settings.help_dropdown %}        {% if (!item.hidden) { %}         {% if (item.route) { %}          <a class="dropdown-item" href="{{ item.route }}">           {%= __(item.item_label) %}          </a>         {% } else if (item.action) { %}          <a class="dropdown-item" onclick="return {{ item.action }}">           {%= __(item.item_label) %}          </a>         {% } else { %}          <div class="dropdown-divider"></div>         {% } %}        {% } %}       {% endfor %}      </div>     </li>     <li class="nav-item dropdown dropdown-navbar-user dropdown-mobile">      <a class="nav-link" data-toggle="dropdown" href="#" onclick="return false;">       {{ avatar }}      </a>      <div class="dropdown-menu dropdown-menu-right" id="toolbar-user" role="menu">       {% for item in navbar_settings.settings_dropdown %}        {% if (!item.hidden) { %}         {% if (item.route) { %}          <a class="dropdown-item" href="{{ item.route }}">           {%= __(item.item_label) %}          </a>         {% } else if (item.action) { %}          <a class="dropdown-item" onclick="return {{ item.action }}">           {%= __(item.item_label) %}          </a>         {% } else { %}          <div class="dropdown-divider"></div>         {% } %}        {% } %}       {% endfor %}      </div>     </li>    </ul>   </div>  </div> </header> ',frappe.provide("frappe.ui.toolbar"),frappe.provide("frappe.search"),frappe.ui.toolbar.Toolbar=class{constructor(){$("header").replaceWith(frappe.render_template("navbar",{avatar:frappe.avatar(frappe.session.user,"avatar-medium"),navbar_settings:frappe.boot.navbar_settings})),$(".dropdown-toggle").dropdown(),this.setup_awesomebar(),this.setup_notifications(),this.setup_help(),this.make()}make(){this.bind_events(),$(document).trigger("toolbar_setup")}bind_events(){$(document).on("page-change",function(){$("header .navbar .custom-menu").remove()}),$("#search-modal").on("shown.bs.modal",function(){var e=$(this);setTimeout(function(){e.find("#modal-search").focus()},300)}),$(".navbar-toggle-full-width").click(function(){frappe.ui.toolbar.toggle_full_width()})}setup_help(){if(!frappe.boot.desk_settings.notifications)return $(".navbar .vertical-bar").removeClass("d-sm-block"),void $(".dropdown-help").removeClass("d-lg-block");function e(e){var t=e.target.href;t.indexOf("blob")>0&&window.open(t,"_blank"),$(e.target).attr("data-path")&&e.preventDefault()}frappe.provide("frappe.help"),frappe.help.show_results=e,this.search=new frappe.search.SearchDialog,frappe.provide("frappe.searchdialog"),frappe.searchdialog.search=this.search,$(".dropdown-help .dropdown-toggle").on("click",function(){$(".dropdown-help input").focus()}),$(".dropdown-help .dropdown-menu").on("click","input, button",function(e){e.stopPropagation()}),$("#input-help").on("keydown",function(e){13==e.which&&$(this).val("")}),$(document).on("page-change",function(){var t=$(".dropdown-help #help-links");t.html("");for(var n=frappe.get_route_str(),r=n.split("/"),i=[],a=0;a<r.length;a++){var o=n.split("/",a+1).join("/"),s=frappe.help.help_links[o]||[];i=$.merge(i,s)}0===i.length?t.next().hide():t.next().show();for(a=0;a<i.length;a++){var l=i[a],c=l.url;$("<a>",{href:c,class:"dropdown-item",text:l.label,target:"_blank"}).appendTo(t)}$(".dropdown-help .dropdown-menu").on("click","a",e)}),frappe.get_modal("","").addClass("help-modal"),$(document).on("click",".help-modal a",e)}setup_awesomebar(){frappe.boot.desk_settings.search_bar&&((new frappe.search.AwesomeBar).setup("#navbar-search"),frappe.search.utils.make_function_searchable(function(){frappe.set_route("List","Client Script")},__("Custom Script List")))}setup_notifications(){frappe.boot.desk_settings.notifications&&"Guest"!==frappe.session.user&&(this.notifications=new frappe.ui.Notifications)}},$.extend(frappe.ui.toolbar,{add_dropdown_button:function(e,t,n,r){var i=frappe.ui.toolbar.get_menu(e);return i.find("li:not(.custom-menu)").length&&!i.find(".divider").length&&frappe.ui.toolbar.add_menu_divider(i),$('<li class="custom-menu"><a><i class="fa-fw '+r+'"></i> '+t+"</a></li>").insertBefore(i.find(".divider")).find("a").click(function(){n.apply(this)})},get_menu:function(e){return $("#navbar-"+e.toLowerCase())},add_menu_divider:function(e){e="string"==typeof e?frappe.ui.toolbar.get_menu(e):e,$('<li class="divider custom-menu"></li>').prependTo(e)},add_icon_link:function(e,t,n,r){var i=$(".navbar-right").get(0),a=$('<li class="'+r+'">\n\t\t\t<a class="btn" href="'+e+'" title="'+frappe.utils.to_title_case(r,!0)+'" aria-haspopup="true" aria-expanded="true">\n\t\t\t\t<div>\n\t\t\t\t\t<i class="octicon '+t+'"></i>\n\t\t\t\t</div>\n\t\t\t</a>\n\t\t</li>').get(0);i.insertBefore(a,i.children[n])},toggle_full_width:function(){var e=JSON.parse(localStorage.container_fullwidth||"false");e=!e,localStorage.container_fullwidth=e,frappe.ui.toolbar.set_fullwidth_if_enabled(),$(document.body).trigger("toggleFullWidth")},set_fullwidth_if_enabled:function(){var e=JSON.parse(localStorage.container_fullwidth||"false");$(document.body).toggleClass("full-width",e)},show_shortcuts:function(e){return e.preventDefault(),frappe.ui.keys.show_keyboard_shortcut_dialog(),!1}}),frappe.ui.toolbar.clear_cache=frappe.utils.throttle(function(){frappe.assets.clear_local_storage(),frappe.xcall("frappe.sessions.clear").then(function(e){frappe.show_alert({message:e,indicator:"info"}),location.reload(!0)})},1e4),frappe.ui.toolbar.show_about=function(){try{frappe.ui.misc.about()}catch(e){console.log(e)}return!1},frappe.ui.toolbar.route_to_user=function(){frappe.set_route("Form","User",frappe.session.user)},frappe.ui.toolbar.view_website=function(){var e=window.open();e.opener=null,e.location="/index"},frappe.ui.toolbar.setup_session_defaults=function(){var e=[];frappe.call({method:"frappe.core.doctype.session_default_settings.session_default_settings.get_session_default_values",callback:function(t){e=JSON.parse(t.message);var n=frappe.perm.get_perm("Session Default Settings");(in_list(frappe.user_roles,"System Manager")||1==n[0].read)&&(e[e.length]={fieldname:"settings",fieldtype:"Button",label:__("Settings"),click:function(){frappe.set_route("Form","Session Default Settings","Session Default Settings")}}),frappe.prompt(e,function(t){e.forEach(function(e){t[e.fieldname]||(t[e.fieldname]="")}),frappe.call({method:"frappe.core.doctype.session_default_settings.session_default_settings.set_session_default_values",args:{default_values:t},callback:function(e){"success"==e.message?(frappe.show_alert({message:__("Session Defaults Saved"),indicator:"green"}),frappe.ui.toolbar.clear_cache()):frappe.show_alert({message:__("An error occurred while setting Session Defaults"),indicator:"red"})}})},__("Session Defaults"),__("Save"))}})},frappe.last_edited_communication={};var separator_element="<div>---</div>";frappe.views.CommunicationComposer=class{constructor(e){$.extend(this,e),this.doc||(this.doc=this.frm&&this.frm.doc||{}),this.make()}make(){var e=this;this.dialog=new frappe.ui.Dialog({title:this.title||this.subject||__("New Email"),no_submit_on_enter:!0,fields:this.get_fields(),primary_action_label:__("Send"),primary_action:function(){e.send_action()},secondary_action_label:__("Discard"),secondary_action:function(){e.dialog.hide(),e.clear_cache()},size:"large",minimizable:!0}),$(this.dialog.$wrapper.find(".form-section").get(0)).addClass("to_section"),this.prepare(),this.dialog.show(),this.frm&&$(document).trigger("form-typing",[this.frm])}get_fields(){var e=this,t=[{label:__("To"),fieldtype:"MultiSelect",reqd:0,fieldname:"recipients"},{fieldtype:"Button",label:frappe.utils.icon("down"),fieldname:"option_toggle_button",click:function(){e.toggle_more_options()}},{fieldtype:"Section Break",hidden:1,fieldname:"more_options"},{label:__("CC"),fieldtype:"MultiSelect",fieldname:"cc"},{label:__("BCC"),fieldtype:"MultiSelect",fieldname:"bcc"},{label:__("Email Template"),fieldtype:"Link",options:"Email Template",fieldname:"email_template"},{fieldtype:"Section Break"},{label:__("Subject"),fieldtype:"Data",reqd:1,fieldname:"subject",length:524288},{label:__("Message"),fieldtype:"Text Editor",fieldname:"content",onchange:frappe.utils.debounce(this.save_as_draft.bind(this),300)},{fieldtype:"Section Break"},{label:__("Send me a copy"),fieldtype:"Check",fieldname:"send_me_a_copy",default:frappe.boot.user.send_me_a_copy},{label:__("Send Read Receipt"),fieldtype:"Check",fieldname:"send_read_receipt"},{label:__("Attach Document Print"),fieldtype:"Check",fieldname:"attach_document_print"},{label:__("Select Print Format"),fieldtype:"Select",fieldname:"select_print_format"},{label:__("Select Languages"),fieldtype:"Select",fieldname:"language_sel"},{fieldtype:"Column Break"},{label:__("Select Attachments"),fieldtype:"HTML",fieldname:"select_attachments"}],n=frappe.boot.email_accounts.filter(function(e){return!in_list(["All Accounts","Sent","Spam","Trash"],e.email_account)&&e.enable_outgoing});return n.length&&t.unshift({label:__("From"),fieldtype:"Select",reqd:1,fieldname:"sender",options:n.map(function(e){return e.email_id})}),t}toggle_more_options(e){e=e||this.dialog.fields_dict.more_options.df.hidden,this.dialog.set_df_property("more_options","hidden",!e);var t=frappe.utils.icon(e?"up-line":"down");this.dialog.get_field("option_toggle_button").set_label(t)}prepare(){this.setup_multiselect_queries(),this.setup_subject_and_recipients(),this.setup_print_language(),this.setup_print(),this.setup_attach(),this.setup_email(),this.setup_email_template(),this.setup_last_edited_communication(),this.set_values()}setup_multiselect_queries(){var e=this;["recipients","cc","bcc"].forEach(function(t){e.dialog.fields_dict[t].get_data=function(){var n=e.dialog.fields_dict[t].get_value().match(/[^,\s*]*$/)[0]||"";frappe.call({method:"frappe.email.get_contact_list",args:{txt:n},callback:function(n){e.dialog.fields_dict[t].set_data(n.message)}})}})}setup_subject_and_recipients(){if(this.subject=this.subject||"",this.forward||this.recipients||!this.last_email||(this.recipients=this.last_email.sender,this.cc=this.last_email.cc,this.bcc=this.last_email.bcc),this.forward||this.recipients||(this.recipients=this.frm&&this.frm.timeline.get_recipient()),!this.subject&&this.frm){var e=this.frm.timeline.get_last_email();e&&(this.subject=e.subject,this.recipients||(this.recipients=e.sender),"re"!=strip(this.subject.toLowerCase().split(":")[0])&&(this.subject=__("Re: {0}",[this.subject]))),this.subject||(this.subject=this.frm.doc.name,this.frm.meta.subject_field&&this.frm.doc[this.frm.meta.subject_field]?this.subject=this.frm.doc[this.frm.meta.subject_field]:this.frm.meta.title_field&&this.frm.doc[this.frm.meta.title_field]&&(this.subject=this.frm.doc[this.frm.meta.title_field]));var t="#"+this.frm.doc.name;this.subject.includes(t)||(this.subject=this.subject+" ("+t+")")}this.frm&&!this.recipients&&(this.recipients=this.frm.doc[this.frm.email_field])}setup_email_template(){var e=this;this.dialog.fields_dict.email_template.df.onchange=function(){var t=e.dialog.fields_dict.email_template.get_value();t&&frappe.call({method:"frappe.email.doctype.email_template.email_template.get_email_template",args:{template_name:t,doc:e.doc,_lang:e.dialog.get_value("language_sel")},callback:function(n){!function(n){if(e.reply_added!==t){var r=e.dialog.fields_dict.content,i=e.dialog.fields_dict.subject,a=r.get_value()||"";a=a.split("\x3c!-- salutation-ends --\x3e")[1]||a,r.set_value(n.message+"<br>"+a),i.set_value(n.subject),e.reply_added=t}}(n.message)}})}}setup_last_edited_communication(){var e=this;this.frm?(this.doctype=this.frm.doctype,this.key=this.frm.docname):this.doctype=this.key="Inbox",this.last_email&&(this.key=this.key+":"+this.last_email.name),this.subject&&(this.key=this.key+":"+this.subject),this.dialog.on_hide=function(){$.extend(e.get_last_edited_communication(!0),e.dialog.get_values(!0)),e.frm&&$(document).trigger("form-stopped-typing",[e.frm])}}get_last_edited_communication(e){return frappe.last_edited_communication[this.doctype]||(frappe.last_edited_communication[this.doctype]={}),!e&&frappe.last_edited_communication[this.doctype][this.key]||(frappe.last_edited_communication[this.doctype][this.key]={}),frappe.last_edited_communication[this.doctype][this.key]}async set_values(){for(var e=0,t=["recipients","cc","bcc","sender"];e<t.length;e+=1){var n=t[e];await this.dialog.set_value(n,this[n]||"")}var r=frappe.utils.html2text(this.subject)||"";if(await this.dialog.set_value("subject",r),await this.set_values_from_last_edited_communication(),await this.set_content(),this.frm&&!this.is_a_reply&&!this.content_set){var i=this.frm.meta.default_email_template||"";await this.dialog.set_value("email_template",i)}for(var a=0,o=["email_template","cc","bcc"];a<o.length;a+=1){var s=o[a];if(this.dialog.get_value(s)){this.toggle_more_options(!0);break}}}async set_values_from_last_edited_communication(){if(!this.txt&&!this.message){var e=this.get_last_edited_communication();if(e.content){if(e.email_template){var t=this.dialog.fields_dict.email_template;await t.set_model_value(e.email_template),delete e.email_template}await this.dialog.set_values(e),this.content_set=!0}}}selected_format(){return this.dialog.fields_dict.select_print_format.input.value||this.frm&&this.frm.meta.default_print_format||"Standard"}get_print_format(e){return e||(e=this.selected_format()),locals["Print Format"]&&locals["Print Format"][e]?locals["Print Format"][e]:{}}setup_print_language(){var e=this.dialog.fields_dict;this.lang_code=this.doc.language||this.get_print_format().default_print_language||frappe.boot.lang;var t=this;$(e.language_sel.input).change(function(){t.lang_code=this.value}),$(e.language_sel.input).empty().add_options(frappe.get_languages()),this.lang_code&&$(e.language_sel.input).val(this.lang_code)}setup_print(){var e=this.dialog.fields_dict;if($(e.attach_document_print.input).click(function(){$(e.select_print_format.wrapper).toggle($(this).prop("checked"))}),$(e.select_print_format.wrapper).toggle(!1),this.frm){var t=frappe.meta.get_print_formats(this.frm.meta.name);$(e.select_print_format.input).empty().add_options(t).val(t[0])}else $(e.attach_document_print.wrapper).toggle(!1)}setup_attach(){var e=this,t=this.dialog.fields_dict,n=$(t.select_attachments.wrapper);this.attachments||(this.attachments=[]);var r={folder:"Home/Attachments",on_success:function(t){e.attachments.push(t),e.render_attachment_rows(t)}};this.frm&&(r={doctype:this.frm.doctype,docname:this.frm.docname,folder:"Home/Attachments",on_success:function(t){e.frm.attachments.attachment_uploaded(t),e.render_attachment_rows(t)}}),$('\n\t\t\t<label class="control-label">\n\t\t\t\t'+__("Select Attachments")+"\n\t\t\t</label>\n\t\t\t<div class='attach-list'></div>\n\t\t\t<p class='add-more-attachments'>\n\t\t\t\t<button class='btn btn-xs btn-default'>\n\t\t\t\t\t"+frappe.utils.icon("small-add","xs")+"&nbsp;\n\t\t\t\t\t"+__("Add Attachment")+"\n\t\t\t\t</button>\n\t\t\t</p>\n\t\t").appendTo(n.empty()),n.find(".add-more-attachments button").on("click",function(){return new frappe.ui.FileUploader(r)}),this.render_attachment_rows()}render_attachment_rows(e){var t=this,n=this.dialog.fields_dict.select_attachments,r=$(n.wrapper).find(".attach-list");if(e)r.append(this.get_attachment_row(e,!0));else{var i=[];this.attachments&&this.attachments.length&&(i=i.concat(this.attachments)),this.frm&&(i=i.concat(this.frm.get_files())),i.length&&$.each(i,function(e,n){n.file_name&&(r.find('[data-file-name="'+n.name+'"]').length||(n.file_url=frappe.urllib.get_full_url(n.file_url),r.append(t.get_attachment_row(n))))})}}get_attachment_row(e,t){return $('<p class="checkbox flex">\n\t\t\t<label class="ellipsis" title="'+e.file_name+'">\n\t\t\t\t<input\n\t\t\t\t\ttype="checkbox"\n\t\t\t\t\tdata-file-name="'+e.name+'"\n\t\t\t\t\t'+(t?"checked":"")+'>\n\t\t\t\t</input>\n\t\t\t\t<span class="ellipsis">'+e.file_name+'</span>\n\t\t\t</label>\n\t\t\t&nbsp;\n\t\t\t<a href="'+e.file_url+'" target="_blank" class="btn-linkF">\n\t\t\t\t'+frappe.utils.icon("link-url")+"\n\t\t\t</a>\n\t\t</p>")}setup_email(){var e=this.dialog.fields_dict;this.attach_document_print&&($(e.attach_document_print.input).click(),$(e.select_print_format.wrapper).toggle(!0)),$(e.send_me_a_copy.input).on("click",function(){var t=e.send_me_a_copy.get_value();frappe.db.set_value("User",frappe.session.user,"send_me_a_copy",t),frappe.boot.user.send_me_a_copy=t})}send_action(){var e=this.dialog.get_primary_btn(),t=this.get_values();if(t){var n=$.map($(this.dialog.wrapper).find("[data-file-name]:checked"),function(e){return $(e).attr("data-file-name")});t.attach_document_print?this.send_email(e,t,n,null,t.select_print_format||""):this.send_email(e,t,n)}}get_values(){for(var e=this.dialog.get_values(),t=0,n=this.dialog.fields.length;t<n;t++){var r=this.dialog.fields[t];r.is_cc_checkbox&&(e[r.fieldname]&&(e.cc=(e.cc?e.cc+", ":"")+r.fieldname,e.bcc=(e.bcc?e.bcc+", ":"")+r.fieldname),delete e[r.fieldname])}return e}save_as_draft(){if(this.dialog&&this.frm){var e=this.dialog.get_value("content");e=e.split(separator_element)[0],localforage.setItem(this.frm.doctype+this.frm.docname,e).catch(function(e){e&&(console.log(e),console.warn("[Communication] IndexedDB is full. Cannot save message as draft"))})}}clear_cache(){this.delete_saved_draft(),this.get_last_edited_communication(!0)}delete_saved_draft(){this.dialog&&this.frm&&localforage.removeItem(this.frm.doctype+this.frm.docname).catch(function(e){e&&(console.log(e),console.warn("[Communication] IndexedDB is full. Cannot save message as draft"))})}send_email(e,t,n,r,i){var a=this;if(this.dialog.hide(),t.recipients){if(t.attach_document_print||(r=null,i=null),!this.frm||frappe.model.can_email(this.doc.doctype,this.frm))return frappe.call({method:"frappe.core.doctype.communication.email.make",args:{recipients:t.recipients,cc:t.cc,bcc:t.bcc,subject:t.subject,content:t.content,doctype:a.doc.doctype,name:a.doc.name,send_email:1,print_html:r,send_me_a_copy:t.send_me_a_copy,print_format:i,sender:t.sender,sender_full_name:t.sender?frappe.user.full_name():void 0,email_template:t.email_template,attachments:n,_lang:a.lang_code,read_receipt:t.send_read_receipt,print_letterhead:a.is_print_letterhead_checked()},btn:e,callback:function(e){if(e.exc){if(frappe.msgprint(__("There were errors while sending email. Please try again.")),a.error)try{a.error(e)}catch(e){console.log(e)}}else if(frappe.utils.play_sound("email"),e.message.emails_not_sent_to&&frappe.msgprint(__("Email not sent to {0} (unsubscribed / disabled)",[frappe.utils.escape_html(e.message.emails_not_sent_to)])),a.clear_cache(),a.frm&&a.frm.reload_doc(),a.success)try{a.success(e)}catch(e){console.log(e)}}});frappe.msgprint(__("You are not allowed to send emails related to this document"))}else frappe.msgprint(__("Enter Email Recipient(s)"))}is_print_letterhead_checked(){return this.frm&&$(this.frm.wrapper).find(".form-print-wrapper").is(":visible")?$(this.frm.wrapper).find(".print-letterhead").prop("checked")?1:0:(frappe.model.get_doc(":Print Settings","Print Settings")||{with_letterhead:1}).with_letterhead?1:0}async set_content(){if(!this.content_set){var e=this.txt||this.message||"";if(!e&&this.frm){var t=this.frm,n=t.doctype,r=t.docname;e=await localforage.getItem(n+r)||""}e&&(this.content_set=!0),e+=await this.get_signature();this.real_name&&!e.includes("\x3c!-- salutation-ends --\x3e")&&(e="\n\t\t\t\t<p>"+__("Dear {0},",[this.real_name],"Salutation in new email")+",</p>\n\t\t\t\t\x3c!-- salutation-ends --\x3e<br>\n\t\t\t\t"+e+"\n\t\t\t"),this.is_a_reply&&(e+=this.get_earlier_reply()),await this.dialog.set_value("content",e)}}async get_signature(){var e=frappe.boot.user.email_signature;e||(e=(await frappe.db.get_value("Email Account",{default_outgoing:1,add_signature:1},"signature")).message.signature);return e?(frappe.utils.is_html(e)||(e=e.replace(/\n/g,"<br>")),"<br>\x3c!-- signature-included --\x3e"+e):""}get_earlier_reply(){var e=this.last_email||this.frm&&this.frm.timeline.get_last_email(!0);if(!e)return"";var t=e.original_comment||e.content;(t=this.html2text(t).replace(/\n/g,"<br>")).length>20480&&(t=(t+="<div>"+__("Message clipped")+"</div>"+t).slice(0,20480));var n=frappe.datetime.global_date_format(e.communication_date||e.creation);return"\n\t\t\t<div><br></div>\n\t\t\t"+separator_element+"\n\t\t\t<p>\n\t\t\t"+__("On {0}, {1} wrote:",[n,e.sender])+"\n\t\t\t</p>\n\t\t\t<blockquote>\n\t\t\t"+t+"\n\t\t\t</blockquote>\n\t\t"}html2text(e){var t=document.createElement("div");return t.innerHTML=e.replace(/<\/div>/g,"<br></div>").replace(/<\/p>/g,"<br></p>").replace(/<br>/g,"\n"),t.textContent.replace(/\n{3,}/g,"\n\n")}},frappe.views.TranslationManager=class{constructor(e){Object.assign(this,e),this.make()}make(){var e=this;this.data=[],this.dialog=new frappe.ui.Dialog({fields:this.get_fields(),title:__("Translate {0}",[this.df.label]),no_submit_on_enter:!0,primary_action_label:__("Update Translations"),primary_action:function(t){return e.update_translations(t).then(function(){e.dialog.hide(),e.data=[],frappe.msgprint({title:__("Success"),message:__("Successfully updated translations"),indicator:"green"})})}}),this.get_translations_data().then(function(t){var n;(n=e.data).push.apply(n,t||[]),e.dialog.refresh(),e.dialog.show()})}get_fields(){var e=this;return[{label:__("Source Text"),fieldname:"source",fieldtype:"Data",read_only:1,bold:1,default:this.source_text},{label:__("Translations"),fieldname:"translation_data",fieldtype:"Table",fields:[{label:"Language",fieldname:"language",fieldtype:"Link",options:"Language",in_list_view:1,columns:3},{label:"Translation",fieldname:"translation",fieldtype:"Text",in_list_view:1,columns:7}],data:this.data,get_data:function(){return e.data}}]}get_translations_data(){return frappe.db.get_list("Translation",{fields:["name","language","translated_text as translation"],filters:{source_text:strip_html(this.source_text)}})}update_translations(e){var t=e.source,n=e.translation_data;void 0===n&&(n=[]);var r={};return n.map(function(e){r[e.language]=e.translation}),frappe.call({method:"frappe.translate.update_translations_for_source",btn:this.dialog.get_primary_btn(),args:{source:t,translation_dict:r}}).fail(function(){frappe.msgprint({title:__("Something went wrong"),message:__("Please try again"),indicator:"red"})})}},frappe.standard_pages.Workspaces=function(){var e=frappe.container.add_page("Workspaces");frappe.ui.make_app_page({parent:e,name:"Workspaces",title:__("Workspace")}),frappe.workspace=new frappe.views.Workspace(e),$(e).bind("show",function(){frappe.workspace.show()})},frappe.views.Workspace=class{constructor(e){this.wrapper=$(e),this.page=e.page,this.prepare_container(),this.show_or_hide_sidebar(),this.setup_dropdown(),this.pages={},this.sidebar_items={},this.sidebar_categories=["Modules","Domains","Places","Administration"],this.setup_workspaces(),this.make_sidebar()}setup_workspaces(){this.workspaces={};for(var e=0,t=frappe.boot.allowed_workspaces;e<t.length;e+=1){var n=t[e];this.workspaces[n.category]||(this.workspaces[n.category]=[]),this.workspaces[n.category].push(n)}}show(){var e=this.get_page_to_show();this.page.set_title(""+__(e)),this.show_page(e)}prepare_container(){var e=$('\n\t\t\t<div class="list-sidebar overlay-sidebar hidden-xs hidden-sm">\n\t\t\t\t<div class="desk-sidebar list-unstyled sidebar-menu"></div>\n\t\t\t</div>\n\t\t').appendTo(this.wrapper.find(".layout-side-section"));this.sidebar=e.find(".desk-sidebar"),this.body=this.wrapper.find(".layout-main-section")}get_page_to_show(){var e;return e=localStorage.current_workspace?localStorage.current_workspace:this.workspaces?this.workspaces.Modules[0].name:frappe.boot.allowed_workspaces?frappe.boot.allowed_workspaces[0].name:"Build",frappe.get_route()[1]||e}make_sidebar(){var e=this;this.sidebar_categories.forEach(function(t){e.workspaces[t]&&e.build_sidebar_section(t,e.workspaces[t])})}build_sidebar_section(e,t){var n=this,r=$('<div class="standard-sidebar-section"></div>');$('<div class="standard-sidebar-label">'+__(e)+"</div>").appendTo(r);var i=function(e){e.name==n.get_page_to_show()&&(e.selected=!0,n.current_page_name=e.name);var t=function(e){return $('\n\t\t\t\t<a\n\t\t\t\t\thref="/app/'+frappe.router.slug(e.name)+'"\n\t\t\t\t\tclass="desk-sidebar-item standard-sidebar-item '+(e.selected?"selected":"")+'"\n\t\t\t\t>\n\t\t\t\t\t<span>'+frappe.utils.icon(e.icon||"folder-normal","md")+'</span>\n\t\t\t\t\t<span class="sidebar-item-label">'+(e.label||e.name)+"<span>\n\t\t\t\t</a>\n\t\t\t")}(e);t.appendTo(r),n.sidebar_items[e.name]=t};t.forEach(function(e){return i(e)}),r.appendTo(this.sidebar)}show_page(e){this.current_page_name&&this.pages[this.current_page_name]&&this.pages[this.current_page_name].hide(),this.sidebar_items&&this.sidebar_items[this.current_page_name]&&(this.sidebar_items[this.current_page_name].removeClass("selected"),this.sidebar_items[e].addClass("selected")),this.current_page_name=e,localStorage.current_workspace=e,this.pages[e]?this.pages[e].show():this.make_page(e),this.current_page=this.pages[e],this.setup_dropdown()}make_page(e){var t=new DesktopPage({container:this.body,page_name:e});return this.pages[e]=t,t}customize(){var e=this;this.current_page&&this.current_page.allow_customization&&(this.page.clear_menu(),this.current_page.customize(),this.page.set_primary_action(__("Save Customizations"),function(){e.current_page.save_customization(),e.page.clear_primary_action(),e.page.clear_secondary_action(),e.setup_dropdown()},null,__("Saving")),this.page.set_secondary_action(__("Discard"),function(){e.current_page.reload(),frappe.show_alert({message:__("Customizations Discarded"),indicator:"info"}),e.page.clear_primary_action(),e.page.clear_secondary_action(),e.setup_dropdown()}))}setup_dropdown(){var e=this;this.page.clear_menu(),this.page.set_secondary_action(__("Customize"),function(){e.customize()}),this.page.add_menu_item(__("Reset Customizations"),function(){e.current_page.reset_customization()},1),this.page.add_menu_item(__("Toggle Sidebar"),function(){e.toggle_side_bar()},1)}toggle_side_bar(){var e=JSON.parse(localStorage.show_workspace_sidebar||"true");e=!e,localStorage.show_workspace_sidebar=e,this.show_or_hide_sidebar(),$(document.body).trigger("toggleDeskSidebar")}show_or_hide_sidebar(){var e=JSON.parse(localStorage.show_workspace_sidebar||"true");$("#page-workspace .layout-side-section").toggleClass("hidden",!e)}};class DesktopPage{constructor(e){var t=e.container,n=e.page_name;frappe.desk_page=this,this.container=t,this.page_name=n,this.sections={},this.allow_customization=!1,this.reload()}show(){frappe.desk_page=this,this.page.show(),this.sections.shortcuts&&this.sections.shortcuts.widgets_list.forEach(function(e){e.set_actions()})}hide(){this.page.hide()}reload(){this.in_customize_mode=!1,this.page&&this.page.remove(),this.make()}make(){var e=this;this.page=$('<div class="desk-page" data-page-name='+this.page_name+"></div>"),this.page.append(frappe.render_template("workspace_loading_skeleton")),this.page.appendTo(this.container),this.get_data().then(function(){if(0==Object.keys(e.data).length)return delete localStorage.current_workspace,void frappe.set_route("workspace");e.refresh()}).finally(this.page.find(".workspace_loading_skeleton").remove)}refresh(){this.page.empty(),this.allow_customization=this.data.allow_customization||!1,frappe.is_mobile()&&(this.allow_customization=!1),this.data.onboarding&&this.data.onboarding.items.length&&this.make_onboarding(),this.make_charts(),this.make_shortcuts(),this.make_cards()}get_data(){var e=this;return frappe.xcall("frappe.desk.desktop.get_desktop_page",{page:this.page_name}).then(function(t){if(e.data=t,0!=Object.keys(e.data).length)return frappe.dashboard_utils.get_dashboard_settings().then(function(t){var n=t.chart_config?JSON.parse(t.chart_config):{};e.data.charts.items&&e.data.charts.items.map(function(e){e.chart_settings=n[e.chart_name]||{}})})})}customize(){var e=this;this.in_customize_mode||($(".widget.onboarding-widget-box").hide(),Object.keys(this.sections).forEach(function(t){e.sections[t].customize()}),this.in_customize_mode=!0)}save_customization(){var e=this;frappe.dom.freeze();var t={};this.sections.charts&&(t.charts=this.sections.charts.get_widget_config()),this.sections.shortcuts&&(t.shortcuts=this.sections.shortcuts.get_widget_config()),this.sections.cards&&(t.cards=this.sections.cards.get_widget_config()),frappe.call("frappe.desk.desktop.save_customization",{page:this.page_name,config:t}).then(function(t){frappe.dom.unfreeze(),t.message?(frappe.show_alert({message:__("Customizations Saved Successfully"),indicator:"green"}),e.reload()):(frappe.throw({message:__("Something went wrong while saving customizations"),indicator:"red"}),e.reload())})}reset_customization(){var e=this;frappe.call("frappe.desk.desktop.reset_customization",{page:this.page_name}).then(function(){frappe.show_alert({message:__("Removed page customizations"),indicator:"green"}),e.reload()})}make_onboarding(){this.onboarding_widget=frappe.widget.make_widget({label:this.data.onboarding.label||__("Let's Get Started"),subtitle:this.data.onboarding.subtitle,steps:this.data.onboarding.items,success:this.data.onboarding.success,docs_url:this.data.onboarding.docs_url,user_can_dismiss:this.data.onboarding.user_can_dismiss,widget_type:"onboarding",container:this.page,options:{allow_sorting:!1,allow_create:!1,allow_delete:!1,allow_hiding:!1,allow_edit:!1,max_widget_count:2}})}make_charts(){this.sections.charts=new frappe.widget.WidgetGroup({container:this.page,type:"chart",columns:1,class_name:"widget-charts",hidden:Boolean(this.onboarding_widget),options:{allow_sorting:this.allow_customization,allow_create:this.allow_customization,allow_delete:this.allow_customization,allow_hiding:!1,allow_edit:!0,max_widget_count:2},widgets:this.data.charts.items})}make_shortcuts(){this.sections.shortcuts=new frappe.widget.WidgetGroup({title:this.data.shortcuts.label||__("Your Shortcuts"),container:this.page,type:"shortcut",columns:3,options:{allow_sorting:this.allow_customization,allow_create:this.allow_customization,allow_delete:this.allow_customization,allow_hiding:!1,allow_edit:!0},widgets:this.data.shortcuts.items})}make_cards(){var e=new frappe.widget.WidgetGroup({title:this.data.cards.label||__("Reports & Masters"),container:this.page,type:"links",columns:3,options:{allow_sorting:this.allow_customization,allow_create:!1,allow_delete:!1,allow_hiding:this.allow_customization,allow_edit:!1},widgets:this.data.cards.items});this.sections.cards=e}}class WidgetDialog{constructor(e){Object.assign(this,e),this.editing=Boolean(this.values&&Object.keys(this.values).length)}make(){this.make_dialog(),this.setup_dialog_events(),this.dialog.show(),this.editing&&this.set_default_values()}make_dialog(){var e=this;this.dialog=new frappe.ui.Dialog({title:this.get_title(),fields:this.get_fields(),primary_action:function(t){t=e.process_data(t),e.editing||t.name||(t.name=e.type+"-"+e.label+"-"+frappe.utils.get_random(20)),e.dialog.hide(),e.primary_action(t)},primary_action_label:this.primary_action_label||__("Add")})}get_title(){var e=this.editing?"Edit":"Add",t=e=e+" "+frappe.model.unscrub(this.type);return __(t)}get_fields(){}set_default_values(){return this.dialog.set_values(this.values)}process_data(e){return e}setup_dialog_events(){}hide_field(e){this.dialog.set_df_property(e,"hidden",!0)}show_field(e){this.dialog.set_df_property(e,"hidden",!1)}setup_filter(e){var t=this;this.filter_group&&(this.filter_group.wrapper.empty(),delete this.filter_group);var n=this.dialog.get_field("filter_area_loading").$wrapper;if($('<span class="text-muted">'+__("Loading Filters...")+"</span>").appendTo(n),this.filters=[],this.values&&this.values.stats_filter){var r=new Function("return "+this.values.stats_filter)();this.filters=Object.keys(r).map(function(e){var n=r[e];return[t.values.link_to,e,n[0],n[1],!1]})}this.filter_group=new frappe.ui.FilterGroup({parent:this.dialog.get_field("filter_area").$wrapper,doctype:e,on_change:function(){}}),frappe.model.with_doctype(e,function(){t.filter_group.add_filters_to_filter_group(t.filters),t.hide_field("filter_area_loading"),t.show_field("filter_area")})}}class ChartDialog extends WidgetDialog{constructor(e){super(e)}get_fields(){return[{fieldtype:"Link",fieldname:"chart_name",label:"Chart Name",options:"Dashboard Chart",reqd:1},{fieldtype:"Data",fieldname:"label",label:"Label"}]}process_data(e){return e.label=e.label?e.label:e.chart_name,e}}class ShortcutDialog extends WidgetDialog{constructor(e){super(e)}hide_filters(){this.hide_field("count_section_break"),this.hide_field("filters_section_break")}show_filters(){this.show_field("count_section_break"),this.show_field("filters_section_break")}get_fields(){var e=this;return[{fieldtype:"Select",fieldname:"type",label:"Type",reqd:1,options:"DocType\nReport\nPage\nDashboard",onchange:function(){"DocType"==e.dialog.get_value("type")?e.dialog.fields_dict.link_to.get_query=function(){return{query:"frappe.core.report.permitted_documents_for_user.permitted_documents_for_user.query_doctypes",filters:{user:frappe.session.user}}}:e.dialog.fields_dict.link_to.get_query=null}},{fieldtype:"Data",fieldname:"label",label:"Label"},{fieldtype:"Column Break",fieldname:"column_break_4"},{fieldtype:"Dynamic Link",fieldname:"link_to",label:"Link To",reqd:1,options:"type",onchange:function(){if("DocType"==e.dialog.get_value("type")){var t=e.dialog.get_value("link_to");t&&frappe.boot.single_types.includes(t)?e.hide_filters():t&&(e.setup_filter(t),e.show_filters());var n=["List","Report Builder","Dashboard","New"];frappe.boot.treeviews.includes(t)&&n.push("Tree"),frappe.boot.calendars.includes(t)&&n.push("Calendar"),e.dialog.set_df_property("doc_view","options",n.join("\n"))}else e.hide_filters()}},{fieldtype:"Select",fieldname:"doc_view",label:"DocType View",options:"List\nReport Builder\nDashboard\nTree\nNew\nCalendar",description:__("Which view of the associated DocType should this shortcut take you to?"),default:"List",depends_on:function(t){if(e.dialog){var n=e.dialog.get_value("link_to"),r=frappe.boot.single_types.includes(n);return"DocType"==t.type&&!r}return!1}},{fieldtype:"Section Break",fieldname:"filters_section_break",label:__("Count Filter"),hidden:1},{fieldtype:"HTML",fieldname:"filter_area_loading"},{fieldtype:"HTML",fieldname:"filter_area",hidden:1},{fieldtype:"Section Break",fieldname:"count_section_break",label:__("Count Customizations"),hidden:1},{fieldtype:"Select",fieldname:"color",label:__("Color"),options:["Grey","Green","Red","Orange","Pink","Yellow","Blue","Cyan"],default:"Grey",onchange:function(){var t=e.dialog.fields_dict.color.value.toLowerCase(),n=e.dialog.fields_dict.color.$input;n.parent().find(".color-box").get(0)||$('<div class="color-box"></div>').insertBefore(n.get(0)),n.parent().find(".color-box").get(0).style.backgroundColor="var(--text-on-"+t+")"}},{fieldtype:"Column Break",fieldname:"column_break_3"},{fieldtype:"Data",fieldname:"format",label:__("Format"),description:__("For Example: {} Open")}]}set_default_values(){var e=this;super.set_default_values().then(function(){e.dialog.fields_dict.link_to.df.onchange()})}process_data(e){if("DocType"==this.dialog.get_value("type")&&this.filter_group){var t=this.filter_group.get_filters(),n=null;t.length&&(n={},t.forEach(function(e){n[e[1]]=[e[2],e[3]]}),n=JSON.stringify(n)),e.stats_filter=n}return e.label=e.label?e.label:frappe.model.unscrub(e.link_to),e}}class NumberCardDialog extends WidgetDialog{constructor(e){super(e)}get_fields(){var e=this;return[{fieldtype:"Select",label:__("Choose Existing Card or create New Card"),fieldname:"new_or_existing",options:["New Card","Existing Card"]},{fieldtype:"Link",fieldname:"card",label:__("Number Cards"),options:"Number Card",get_query:function(){return{query:"frappe.desk.doctype.number_card.number_card.get_cards_for_user",filters:{document_type:e.document_type}}},depends_on:'eval: doc.new_or_existing == "Existing Card"'},{fieldtype:"Section Break",fieldname:"sb_1",depends_on:'eval: doc.new_or_existing == "New Card"'},{label:__("Label"),fieldname:"label",fieldtype:"Data",mandatory_depends_on:'eval: doc.new_or_existing == "New Card"'},{label:__("Doctype"),fieldname:"document_type",fieldtype:"Link",options:"DocType",onchange:function(){e.document_type=e.dialog.get_value("document_type"),e.set_aggregate_function_fields(e.dialog.get_values()),e.setup_filter(e.document_type)},hidden:1},{label:__("Color"),fieldname:"color",fieldtype:"Color"},{fieldtype:"Column Break",fieldname:"cb_1"},{label:__("Function"),fieldname:"function",fieldtype:"Select",options:["Count","Sum","Average","Minimum","Maximum"],mandatory_depends_on:'eval: doc.new_or_existing == "New Card"'},{label:__("Function Based On"),fieldname:"aggregate_function_based_on",fieldtype:"Select",depends_on:"eval: doc.function !== 'Count'",mandatory_depends_on:'eval: doc.function !== "Count" && doc.new_or_existing == "New Card"'},{fieldtype:"Section Break",fieldname:"sb_1",label:__("Add Filters"),depends_on:'eval: doc.new_or_existing == "New Card"'},{fieldtype:"HTML",fieldname:"filter_area_loading"},{fieldtype:"HTML",fieldname:"filter_area",hidden:1},{fieldtype:"Section Break",fieldname:"sb_1"}]}setup_dialog_events(){this.document_type||(this.default_values.doctype?(this.document_type=this.default_values.doctype,this.setup_filter(this.default_values.doctype),this.set_aggregate_function_fields()):this.show_field("document_type"))}set_aggregate_function_fields(){var e=[];this.document_type&&frappe.get_meta(this.document_type).fields.map(function(t){if(frappe.model.numeric_fieldtypes.includes(t.fieldtype)){if("Currency"==t.fieldtype&&(!t.options||"Company:company:default_currency"!==t.options))return;e.push({label:t.label,value:t.fieldname})}}),this.dialog.set_df_property("aggregate_function_based_on","options",e)}process_data(e){return"Existing Card"==e.new_or_existing&&(e.name=e.card),e.stats_filter=JSON.stringify(this.filter_group.get_filters()),e.document_type=this.document_type,e}}function get_dialog_constructor(e){return{chart:ChartDialog,shortcut:ShortcutDialog,number_card:NumberCardDialog}[e]||WidgetDialog}class Widget{constructor(e){Object.assign(this,e),this.make()}refresh(){this.set_title(),this.set_actions(),this.set_body(),this.setup_events()}get_config(){return{name:this.name,label:this.label}}customize(e){var t=this;if(this.in_customize_mode=!0,this.action_area.empty(),e.allow_sorting&&this.add_custom_button(frappe.utils.icon("drag","xs"),null,"drag-handle"),e.allow_delete&&this.add_custom_button(frappe.utils.icon("delete","xs"),function(){return t.delete()},"",""+__("Delete")),e.allow_hiding){this.hidden&&(this.widget.removeClass("hidden"),this.body.css("opacity",.5),this.title_field.css("opacity",.5),this.footer.css("opacity",.5));var n=this.hidden?"fa fa-eye":"fa fa-eye-slash",r=this.hidden?""+__("Show"):""+__("Hide");this.add_custom_button('<i class="'+n+'" aria-hidden="true"></i>',function(){return t.hide_or_show()},"show-or-hide-button",r),this.show_or_hide_button=this.action_area.find(".show-or-hide-button")}if(e.allow_edit&&this.add_custom_button(frappe.utils.icon("edit","xs"),function(){return t.edit()}),e.allow_resize){var i="Full"==this.width?""+__("Collapse"):""+__("Expand");this.add_custom_button('<i class="fa fa-expand" aria-hidden="true"></i>',function(){return t.toggle_width()},"resize-button",i),this.resize_button=this.action_area.find(".resize-button")}}make(){this.make_widget(),this.widget.appendTo(this.container)}make_widget(){this.widget=$('<div class="widget\n\t\t\t'+(this.hidden?"hidden":" ")+"\n\t\t\t"+(this.shadow?"widget-shadow":" ")+'\n\t\t" data-widget-name="'+(this.name?this.name:"")+'">\n\t\t\t<div class="widget-head">\n\t\t\t\t<div>\n\t\t\t\t\t<div class="widget-title ellipsis"></div>\n\t\t\t\t\t<div class="widget-subtitle"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="widget-control"></div>\n\t\t\t</div>\n\t\t\t<div class="widget-body">\n\t\t    </div>\n\t\t    <div class="widget-footer">\n\t\t    </div>\n\t\t</div>'),this.title_field=this.widget.find(".widget-title"),this.subtitle_field=this.widget.find(".widget-subtitle"),this.body=this.widget.find(".widget-body"),this.action_area=this.widget.find(".widget-control"),this.head=this.widget.find(".widget-head"),this.footer=this.widget.find(".widget-footer"),this.refresh()}set_title(e){var t=this.label||this.name,n=e?frappe.ellipsis(t,e):t;if(this.icon){var r=frappe.utils.icon(this.icon);this.title_field[0].innerHTML=r+" <span>"+n+"</span>"}else this.title_field[0].innerHTML=n,e&&this.title_field[0].setAttribute("title",this.label);this.subtitle&&this.subtitle_field.html(this.subtitle)}add_custom_button(e,t,n,r,i){void 0===n&&(n=""),void 0===r&&(r=""),i||(i="btn-secondary");var a=$('<button class="btn '+i+" btn-xs "+n+'" title="'+r+'">'+e+"</button>");a.click(function(e){e.stopPropagation(),t&&t()}),a.appendTo(this.action_area)}delete(e){var t=this;void 0===e&&(e=!0);var n=function(e){t.widget.remove(),t.options.on_delete&&t.options.on_delete(t.name,e)};e?(this.widget.addClass("zoom-out"),setTimeout(function(){n(!0)},300)):n(!1)}edit(){var e=this,t=get_dialog_constructor(this.widget_type);this.edit_dialog=new t({label:this.label,type:this.widget_type,values:this.get_config(),primary_action:function(t){Object.assign(e,t),t.name=e.name,e.refresh()},primary_action_label:__("Save")}),this.edit_dialog.make()}toggle_width(){"Full"==this.width?(this.widget.removeClass("full-width"),this.width=null,this.refresh()):(this.widget.addClass("full-width"),this.width="Full",this.refresh());var e="Full"==this.width?""+__("Collapse"):""+__("Expand");this.resize_button.attr("title",e)}hide_or_show(){this.hidden?(this.body.css("opacity",1),this.title_field.css("opacity",1),this.footer.css("opacity",1),this.hidden=!1):(this.body.css("opacity",.5),this.title_field.css("opacity",.5),this.footer.css("opacity",.5),this.hidden=!0),this.show_or_hide_button.empty();var e=this.hidden?"fa fa-eye":"fa fa-eye-slash",t=this.hidden?""+__("Show"):""+__("Hide");$('<i class="'+e+'" aria-hidden="true" title="'+t+'"></i>').appendTo(this.show_or_hide_button)}setup_events(){}set_actions(){}set_body(){}}frappe.provide("frappe.widget.utils"),frappe.provide("frappe.dashboards"),frappe.provide("frappe.dashboards.chart_sources");class ChartWidget extends Widget{constructor(e){e.shadow=!0,super(e),this.height=this.height||240}get_config(){return{name:this.name,chart_name:this.chart_name,label:this.label,hidden:this.hidden,width:this.width}}refresh(){delete this.dashboard_chart,this.set_body(),this.make_chart()}set_chart_title(){var e=this.widget.width()<600?20:60;this.set_title(e)}set_body(){this.widget.addClass("dashboard-widget-box"),"Full"==this.width&&this.widget.addClass("full-width")}setup_container(){this.body.empty(),"Heatmap"==this.chart_doc.type&&this.setup_heatmap_container(),this.loading=$('<div class="chart-loading-state text-muted" style="height: '+this.height+'px;">'+__("Loading...")+"</div>"),this.loading.appendTo(this.body),this.empty=$('<div class="chart-loading-state text-muted" style="height: '+this.height+'px;">'+__("No Data...")+"</div>"),this.empty.hide().appendTo(this.body),this.chart_wrapper=$("<div></div>"),this.chart_wrapper.appendTo(this.body),this.$heatmap_legend=null,this.set_chart_title()}setup_heatmap_container(){this.widget.addClass("heatmap-chart"),this.widget.removeClass("full-width").addClass("full-width"),this.width="Full"}set_summary(){var e=this;this.$summary?this.$summary.empty():(this.$summary=$('<div class="report-summary"></div>').hide(),this.head.after(this.$summary)),this.summary.forEach(function(t){frappe.utils.build_summary_item(t).appendTo(e.$summary)}),this.summary.length&&this.$summary.show()}make_chart(){var e=this;this.get_settings().then(function(){if(!e.settings)return e.deleted=!0,void e.widget.remove();e.chart_settings||(e.chart_settings={}),e.setup_container(),e.in_customize_mode||(e.action_area.empty(),e.prepare_chart_actions(),e.chart_doc.timeseries&&"Custom"!==e.chart_doc.chart_type&&e.render_time_series_filters()),frappe.run_serially([function(){return e.prepare_chart_object()},function(){return e.setup_filter_button()},function(){return e.fetch_and_update_chart()}])})}render_time_series_filters(){var e=this.get_time_series_filters();frappe.dashboard_utils.render_chart_filters(e,"chart-actions",this.action_area,0)}get_time_series_filters(){var e=this;return"Heatmap"==this.chart_doc.type?[{label:this.chart_settings.heatmap_year||this.chart_doc.heatmap_year,options:frappe.dashboard_utils.get_years_since_creation(frappe.boot.user.creation),action:function(t){e.selected_heatmap_year=t,e.save_chart_config_for_user({heatmap_year:e.selected_heatmap_year}),e.fetch_and_update_chart()}}]:[{label:this.chart_settings.time_interval||this.chart_doc.time_interval,options:["Yearly","Quarterly","Monthly","Weekly","Daily"],icon:"calendar",class:"time-interval-filter",action:function(t){e.selected_time_interval=t,e.save_chart_config_for_user({time_interval:e.selected_time_interval}),e.fetch_and_update_chart()}},{label:this.chart_settings.timespan||this.chart_doc.timespan,options:["Select Date Range","Last Year","Last Quarter","Last Month","Last Week"],class:"timespan-filter",action:function(t){e.selected_timespan=t,"Select Date Range"===e.selected_timespan?e.render_date_range_field():(e.selected_from_date=null,e.selected_to_date=null,e.date_field_wrapper&&(e.date_field_wrapper.hide(),e.title_field.show(),e.subtitle_field.show(),e.head.css("flex-direction","row")),e.save_chart_config_for_user({timespan:e.selected_timespan,from_date:null,to_date:null}),e.fetch_and_update_chart())}}]}fetch_and_update_chart(){var e=this;this.args={timespan:this.selected_timespan||this.chart_settings.timespan,time_interval:this.selected_time_interval||this.chart_settings.time_interval,from_date:this.selected_from_date||this.chart_settings.from_date,to_date:this.selected_to_date||this.chart_settings.to_date,heatmap_year:this.selected_heatmap_year||this.chart_settings.heatmap_year},this.fetch(this.filters,!0,this.args).then(function(t){"Report"==e.chart_doc.chart_type&&(e.report_result=t,e.summary=t.report_summary,t=e.get_report_chart_data(t)),e.update_chart_object(),e.data=t,e.render()})}render_date_range_field(){var e=this;this.date_field_wrapper&&this.date_field_wrapper.is(":visible")||(this.date_field_wrapper=$('<div class="dashboard-date-field pull-right"></div>').insertAfter(this.action_area.find(".timespan-filter")),"Full"!==this.width&&this.widget.width()<700&&(this.title_field.hide(),this.subtitle_field.hide(),this.head.css("flex-direction","row-reverse")),this.date_range_field=frappe.ui.form.make_control({df:{fieldtype:"DateRange",fieldname:"from_date",placeholder:"Date Range",input_class:"input-xs",default:[this.chart_settings.from_date,this.chart_settings.to_date],value:[this.chart_settings.from_date,this.chart_settings.to_date],reqd:1,change:function(){var t=e.date_range_field.get_value();e.selected_from_date=t[0],e.selected_to_date=t[1],t&&2==t.length&&(e.save_chart_config_for_user({timespan:e.selected_timespan,from_date:e.selected_from_date,to_date:e.selected_to_date}),e.fetch_and_update_chart())}},parent:this.date_field_wrapper,render_input:1}),this.date_range_field.$input.focus())}get_report_chart_data(e){if(e.chart&&this.chart_doc.use_report_chart)return e.chart.data;var t=[];this.chart_doc.y_axis.map(function(e){t.push(e.y_field)});var n={y_fields:t,x_field:this.chart_doc.x_field,chart_type:this.chart_doc.type,color:this.chart_doc.color},r=e.columns.map(function(e){return frappe.report_utils.prepare_field_from_column(e)});return frappe.report_utils.make_chart_options(r,e,n).data}prepare_chart_actions(){var e=this,t=[{label:__("Refresh"),action:"action-refresh",handler:function(){delete e.dashboard_chart,e.make_chart()}},{label:__("Edit"),action:"action-edit",handler:function(){frappe.set_route("Form","Dashboard Chart",e.chart_doc.name)}},{label:__("Reset Chart"),action:"action-reset",handler:function(){e.reset_chart(),delete e.dashboard_chart,e.make_chart()}}];this.chart_doc.document_type?t.push({label:__("{0} List",[this.chart_doc.document_type]),action:"action-list",handler:function(){frappe.set_route("List",e.chart_doc.document_type)}}):"Report"===this.chart_doc.chart_type&&t.push({label:__("{0} Report",[this.chart_doc.report_name]),action:"action-list",handler:function(){frappe.set_route("query-report",e.chart_doc.report_name)}}),this.set_chart_actions(t)}setup_filter_button(){var e=this;this.is_document_type="Report"!==this.chart_doc.chart_type&&"Custom"!==this.chart_doc.chart_type,this.filter_button=$('<div class="filter-chart btn btn-xs pull-right">\n\t\t\t\t'+frappe.utils.icon("filter","sm")+"\n\t\t\t</div>"),this.filter_button.appendTo(this.action_area),this.is_document_type?(this.filter_group&&(this.filters=this.filter_group.get_filters()),this.create_filter_group_and_add_filters()):this.filter_button.on("click",function(){var t;frappe.dashboard_utils.get_filters_for_chart_type(e.chart_doc).then(function(n){t=e.is_document_type?[{fieldtype:"HTML",fieldname:"filter_area"}]:n?n.filter(function(e){return e.fieldname}).map(function(e){return Object.assign(e,e.dashboard_config||{}),e}):[{fieldtype:"HTML",options:__("No Filters Set")}],e.setup_filter_dialog(t)})})}setup_filter_dialog(e){var t=this,n=new frappe.ui.Dialog({title:__("Set Filters for {0}",[this.chart_doc.chart_name]),fields:e,primary_action:function(){var e=this.get_values();e&&(this.hide(),t.filters=e,t.save_chart_config_for_user({filters:t.filters}),t.fetch_and_update_chart())},primary_action_label:"Set"});n.show(),"Report"==this.chart_doc.chart_type&&(frappe.query_report=new frappe.views.QueryReport({filters:n.fields_list}),frappe.query_reports[this.chart_doc.report_name].onload&&frappe.query_reports[this.chart_doc.report_name].onload(frappe.query_report)),n.set_values(this.filters)}reset_chart(){this.save_chart_config_for_user(null,1),this.chart_settings={},this.filters=null,this.selected_time_interval=null,this.selected_timespan=null,this.selected_heatmap_year=null}save_chart_config_for_user(e,t){void 0===t&&(t=0),Object.assign(this.chart_settings,e),frappe.xcall("frappe.desk.doctype.dashboard_settings.dashboard_settings.save_chart_config",{reset:t,config:this.chart_settings,chart_name:this.chart_doc.chart_name})}create_filter_group_and_add_filters(){var e=this;this.filter_group=new frappe.ui.FilterGroup({doctype:this.chart_doc.document_type,parent_doctype:this.chart_doc.parent_document_type,filter_button:this.filter_button,on_change:function(){e.filters=e.filter_group.get_filters(),e.save_chart_config_for_user({filters:e.filters}),e.fetch_and_update_chart()}}),this.filters&&frappe.model.with_doctype(this.chart_doc.document_type,function(){e.filter_group.add_filters_to_filter_group(e.filters)})}set_chart_actions(e){this.chart_actions=$('<div class="chart-actions dropdown pull-right">\n\t\t\t<button data-toggle="dropdown"\n\t\t\t\taria-haspopup="true"aria-expanded="false"\n\t\t\t\tclass="btn btn-xs btn-secondary chart-menu"\n\t\t\t>\n\t\t\t\t<svg class="icon icon-sm">\n\t\t\t\t\t<use xlink:href="#icon-dot-horizontal">\n\t\t\t\t\t</use>\n\t\t\t\t</svg>\n\t\t\t</button>\n\t\t\t<ul class="dropdown-menu dropdown-menu-right">\n\t\t\t\t'+e.map(function(e){return'<li><a class="dropdown-item" data-action="'+e.action+'">'+e.label+"</a></li>"}).join("")+"\n\t\t\t</ul>\n\t\t</div>\n\t\t"),this.chart_actions.find("a[data-action]").each(function(t,n){var r=n.dataset.action;$(n).click(e.find(function(e){return e.action===r}))}),this.chart_actions.appendTo(this.action_area)}fetch(e,t,n){void 0===t&&(t=!1);var r=this.settings.method;return n="Report"==this.chart_doc.chart_type?{report_name:this.chart_doc.report_name,filters:e,ignore_prepared_report:1}:{chart_name:this.chart_doc.name,filters:e,refresh:t?1:0,time_interval:n&&n.time_interval?n.time_interval:null,timespan:n&&n.timespan?n.timespan:null,from_date:n&&n.from_date?n.from_date:null,to_date:n&&n.to_date?n.to_date:null,heatmap_year:n&&n.heatmap_year?n.heatmap_year:null},frappe.xcall(r,n)}render(){if(this.data&&this.data.labels&&Object.keys(this.data).length){this.loading.hide(),this.empty.hide(),this.chart_wrapper.show();var e=this.get_chart_args();this.dashboard_chart?this.dashboard_chart.update(this.data):this.dashboard_chart=frappe.utils.make_chart(this.chart_wrapper[0],e),"Full"==this.width&&this.summary&&this.set_summary(),"Heatmap"==this.chart_doc.type&&this.render_heatmap_legend()}else this.chart_wrapper.hide(),this.loading.hide(),this.$summary&&this.$summary.hide(),this.empty.show()}get_chart_args(){var e=this,t=this.get_chart_colors(),n={data:this.data,type:{Line:"line",Bar:"bar",Percentage:"percentage",Pie:"pie",Donut:"donut",Heatmap:"heatmap"}[this.chart_doc.type],colors:t,height:this.height,maxSlices:["Pie","Donut"].includes(this.chart_doc.type)?6:9,axisOptions:{xIsSeries:this.chart_doc.timeseries,shortenYAxisNumbers:1}};if(this.report_result&&this.report_result.chart&&(n.tooltipOptions={formatTooltipY:function(t){return frappe.format(t,{fieldtype:e.report_result.chart.fieldtype,options:e.report_result.chart.options},{always_show_decimals:!0,inline:!0})}}),"Heatmap"==this.chart_doc.type){var r=parseInt(this.selected_heatmap_year||this.chart_settings.heatmap_year||this.chart_doc.heatmap_year);n.data.start=new Date(r+"-01-01"),n.data.end=new Date(r+1+"-01-01")}var i=function(e){var t=JSON.parse(e);for(var r in t)"object"==typeof n[r]&&"object"==typeof t[r]?n[r]=Object.assign(n[r],t[r]):n[r]=t[r]};return this.custom_options&&i(this.custom_options),this.chart_doc.custom_options&&i(this.chart_doc.custom_options),n}get_chart_colors(){var e=[];return this.chart_doc.y_axis.length?this.chart_doc.y_axis.map(function(t){e.push(t.color)}):["Line","Bar"].includes(this.chart_doc.type)?e=[this.chart_doc.color||[]]:"Heatmap"==this.chart_doc.type&&(e=[]),e}render_heatmap_legend(){var e,t=function(t){e=JSON.parse(t).colors};this.custom_options&&t(this.custom_options),this.chart_doc.custom_options&&t(this.chart_doc.custom_options),!this.$heatmap_legend&&this.widget.width()>991&&(this.$heatmap_legend=$('\n\t\t\t\t<div class="heatmap-legend">\n\t\t\t\t\t<ul class="legend-colors">\n\t\t\t\t\t\t<li style="background-color: '+(e[0]||"#ebedf0")+'"></li>\n\t\t\t\t\t\t<li style="background-color: '+(e[1]||"#c6e48b")+'"></li>\n\t\t\t\t\t\t<li style="background-color: '+(e[2]||"#7bc96f")+'"></li>\n\t\t\t\t\t\t<li style="background-color: '+(e[3]||"#239a3b")+'"></li>\n\t\t\t\t\t\t<li style="background-color: '+(e[4]||"#196127")+'"></li>\n\t\t\t\t\t</ul>\n\t\t\t\t\t<div class="legend-label">\n\t\t\t\t\t\t<div style="margin-bottom: 45px">'+__("Less")+"</div>\n\t\t\t\t\t\t<div>"+__("More")+"</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t"),this.body.append(this.$heatmap_legend))}update_last_synced(){if(this.chart_doc.last_synced_on){var e=__("Last synced {0}",[comment_when(this.chart_doc.last_synced_on)]);this.subtitle_field.html(e)}}update_chart_object(){var e=this;frappe.db.get_doc("Dashboard Chart",this.chart_doc.name).then(function(t){e.chart_doc=t,e.update_last_synced()})}prepare_chart_object(){return"Heatmap"!=this.chart_doc.type||this.chart_doc.heatmap_year||(this.chart_doc.heatmap_year=frappe.dashboard_utils.get_year(frappe.datetime.now_date())),this.set_chart_filters()}set_chart_filters(){var e=this,t=this.chart_settings.filters||null,n=frappe.dashboard_utils.get_all_filters(this.chart_doc);return"Report"==this.chart_doc.chart_type?frappe.dashboard_utils.get_filters_for_chart_type(this.chart_doc).then(function(r){n=e.update_default_date_filters(r,n),e.filters=frappe.utils.parse_array(t)||frappe.utils.parse_array(e.filters)||frappe.utils.parse_array(n)}):(this.filters=frappe.utils.parse_array(t)||frappe.utils.parse_array(this.filters)||frappe.utils.parse_array(n),Promise.resolve())}update_default_date_filters(e,t){return e&&e.map(function(e){["Date","DateRange"].includes(e.fieldtype)&&e.default&&(e.reqd||t[e.fieldname])&&(t[e.fieldname]=e.default)}),t}get_settings(){var e=this;return frappe.model.with_doc("Dashboard Chart",this.chart_name).then(function(t){if(t){if(e.chart_doc=t,"Custom"==e.chart_doc.chart_type){if(frappe.dashboards.chart_sources[e.chart_doc.source])return e.settings=frappe.dashboards.chart_sources[e.chart_doc.source],Promise.resolve();return frappe.xcall("frappe.desk.doctype.dashboard_chart_source.dashboard_chart_source.get_config",{name:e.chart_doc.source}).then(function(t){frappe.dom.eval(t),e.settings=frappe.dashboards.chart_sources[e.chart_doc.source]})}return"Report"==e.chart_doc.chart_type?(e.settings={method:"frappe.desk.query_report.run"},Promise.resolve()):(e.settings={method:"frappe.desk.doctype.dashboard_chart.dashboard_chart.get"},Promise.resolve())}})}}frappe.provide("frappe.utils");class ShortcutWidget extends Widget{constructor(e){e.shadow=!0,super(e)}get_config(){return{name:this.name,icon:this.icon,label:this.label,format:this.format,link_to:this.link_to,doc_view:this.doc_view,color:this.color,restrict_to_domain:this.restrict_to_domain,stats_filter:this.stats_filter,type:this.type}}setup_events(){var e=this;this.widget.click(function(){if(!e.in_customize_mode){var t=frappe.utils.generate_route({route:e.route,name:e.link_to,type:e.type,is_query_report:e.is_query_report,doctype:e.ref_doctype,doc_view:e.doc_view}),n=e.get_doctype_filter();"DocType"==e.type&&n&&(frappe.route_options=n),frappe.set_route(t)}})}set_actions(){var e=this;if(!this.in_customize_mode){this.widget.addClass("shortcut-widget-box");var t=this.get_doctype_filter();"DocType"==this.type&&t&&frappe.db.count(this.link_to,{filters:t}).then(function(t){return e.set_count(t)})}}get_doctype_filter(){var e=new Function("return "+this.stats_filter)();return e||null}set_count(e){var t=this;this.action_area.empty();var n=t.format?__(t.format).replace(/{}/g,e):e,r=this.color&&e?this.color.toLowerCase():"gray";$('<div class="indicator-pill ellipsis '+r+'">'+n+"</div>").appendTo(this.action_area)}}frappe.provide("frappe.utils");class LinksWidget extends Widget{constructor(e){e.icon=e.icon||"file",super(e)}get_config(){return{name:this.name,links:JSON.stringify(this.links),label:this.label,hidden:this.hidden}}set_body(){var e=this;this.options={},this.options.links=this.links,this.widget.addClass("links-widget-box");var t=function(e){return e.dependencies&&e.incomplete_dependencies};this.link_list=this.links.map(function(e){var n={name:e.link_to,type:e.link_type,doctype:e.doctype,is_query_report:e.is_query_report};"report"!=e.link_type.toLowerCase()||e.is_query_report||(n.doctype=e.dependencies);var r=frappe.utils.generate_route(n);return $('<a href="'+r+'" class="link-item ellipsis '+(e.onboard?"onboard-spotlight":"")+" "+function(e){return t(e)?"disabled-link":""}(e)+'" type="'+e.type+'">\n\t\t\t\t\t<span class="indicator-pill no-margin '+function(e){return e.open_count?"red":e.onboard?e.count?"blue":"yellow":"gray"}(e)+'"></span>\n\t\t\t\t\t'+function(e){return t(e)?'<span class="link-content ellipsis disabled-link">'+(e.label?e.label:e.name)+'</span>\n\t\t\t\t\t<div class="module-link-popover popover fade top in" role="tooltip" style="display: none;">\n\t\t\t\t\t\t<div class="arrow"></div>\n\t\t\t\t\t\t<h3 class="popover-title" style="display: none;"></h3>\n\t\t\t\t\t\t<div class="popover-content" style="padding: 12px;">\n\t\t\t\t\t\t\t<div class="small text-muted">'+__("You need to create these first: ")+'</div>\n\t\t\t\t\t\t\t<div class="small">'+e.incomplete_dependencies.join(", ")+"</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>":e.youtube_id?'<span class="link-content help-video-link ellipsis" data-youtubeid="'+e.youtube_id+'">\n\t\t\t\t\t\t'+(e.label?e.label:e.name)+"</span>":'<span class="link-content ellipsis">'+(e.label?e.label:e.name)+"</span>"}(e)+"\n\t\t\t</a>")}),this.link_list.forEach(function(t){return t.appendTo(e.body)})}setup_events(){var e=this;this.link_list.forEach(function(t){var n=t.find(".link-content");if(t.hasClass("disabled-link")){var r=t.find(".module-link-popover");n.mouseover(function(){e.in_customize_mode||r.show()}),n.mouseout(function(){return r.hide()})}else n.click(function(t){if(!e.in_customize_mode&&n.hasClass("help-video-link")){var r=t.currentTarget.dataset.youtubeid;frappe.help.show_video(r)}})})}}frappe.provide("frappe.utils");class OnboardingWidget extends Widget{make_body(){var e=this;this.steps_wrapper=$('<div class="onboarding-steps-wrapper"></div>').appendTo(this.body),this.step_preview=$('<div class="onboarding-step-preview">\n\t\t\t<div class="onboarding-step-body"></div>\n\t\t\t<div class="onboarding-step-footer"></div>\n\t\t</div>').appendTo(this.body),this.step_body=this.step_preview.find(".onboarding-step-body"),this.step_footer=this.step_preview.find(".onboarding-step-footer"),this.steps.forEach(function(t,n){e.add_step(t,n)}),this.show_step(this.steps[0])}add_step(e,t){var n=this,r="pending";e.is_skipped&&(r="skipped"),e.is_complete&&(r="complete");var i=$('<a class="onboarding-step '+r+'">\n\t\t\t\t<div class="step-title">\n\t\t\t\t\t<div class="step-index step-pending">'+__(t+1)+'</div>\n\t\t\t\t\t<div class="step-index step-skipped">'+frappe.utils.icon("tick","xs")+'</div>\n\t\t\t\t\t<div class="step-index step-complete">'+frappe.utils.icon("tick","xs")+"</div>\n\t\t\t\t\t<div>"+__(e.title)+"</div>\n\t\t\t\t</div>\n\t\t\t</a>");if(e.$step=i,!e.is_complete&&!e.is_skipped){var a=$('<div class="step-skip">'+__("Skip")+"</div>");a.appendTo(i),a.on("click",function(){n.skip_step(e),event.stopPropagation()})}return i.on("click",function(){return n.show_step(e)}),i.appendTo(this.steps_wrapper),i}show_step(e){var t=this;this.active_step&&this.active_step.$step.removeClass("active"),e.$step.addClass("active"),this.active_step=e;var n={"Watch Video":function(e){return t.show_video(e)},"Create Entry":function(e){e.is_complete?frappe.set_route("/app/List/"+e.reference_document):e.show_full_form?t.create_entry(e):t.show_quick_entry(e)},"Show Form Tour":function(e){return t.show_form_tour(e)},"Update Settings":function(e){return t.update_settings(e)},"View Report":function(e){return t.open_report(e)},"Go to Page":function(e){return t.go_to_page(e)}},r=function(){t.step_body.empty(),t.step_footer.empty(),t.step_body.html(e.description?frappe.markdown(e.description):"<h1>"+e.title+"</h1>"),e.intro_video_url?$('<button class="btn btn-primary btn-sm">'+__("Watch Tutorial")+"</button>").appendTo(t.step_footer).on("click",i):$('<button class="btn btn-primary btn-sm">'+__(e.action_label||e.action)+"</button>").appendTo(t.step_footer).on("click",function(){return n[e.action](e)})},i=function(){t.step_body.empty(),t.step_footer.empty();var i=$('<div class="video-player" data-plyr-provider="youtube" data-plyr-embed-id="'+e.intro_video_url+'"></div>');i.appendTo(t.step_body);var a=new frappe.Plyr(i[0],{hideControls:!0,resetOnEnd:!0});$('<button class="btn btn-primary btn-sm">'+__(e.action_label||e.action)+"</button>").appendTo(t.step_footer).on("click",function(){a.pause(),n[e.action](e)}),$(window).one("hashchange",function(){a.pause()}),$('<button class="btn btn-secondary ml-2 btn-sm">'+__("Back")+"</button>").appendTo(t.step_footer).on("click",r)};r()}go_to_page(e){this.mark_complete(e),frappe.set_route(e.path).then(function(){var t=e.callback_message||__("You can continue with the onboarding after exploring this page"),n=e.callback_title||__("Awesome Work"),r=frappe.msgprint({message:t,title:n,primary_action:{action:function(){r.hide()},label:function(){return __("Continue")}},wide:!0})})}open_report(e){var t=this,n=frappe.utils.generate_route({name:e.reference_report,type:"report",is_query_report:"Report Builder"!==e.report_type,doctype:e.report_reference_doctype}),r=frappe.get_route();frappe.set_route(n).then(function(){var n=frappe.msgprint({message:__(e.report_description),title:__(e.reference_report),primary_action:{action:function(){frappe.set_route(r).then(function(){t.mark_complete(e)}),n.hide()},label:function(){return __("Continue")}},secondary_action:{action:function(){n.hide(),frappe.set_route(r).then(function(){t.mark_complete(e)})},label:__("Go Back")}});frappe.msg_dialog.custom_onhide=function(){return t.mark_complete(e)}})}show_form_tour(e){var t,n=this;t=e.is_single?frappe.router.slug(e.reference_document):frappe.router.slug(e.reference_document)+"/new";var r=frappe.get_route();frappe.route_hooks={},frappe.route_hooks.after_load=function(t){t.show_tour(function(){var t=frappe.msgprint({message:__("Let's take you back to onboarding"),title:__("Great Job"),primary_action:{action:function(){frappe.set_route(r).then(function(){n.mark_complete(e)}),t.hide()},label:function(){return __("Continue")}}})})},frappe.set_route(t)}update_settings(e){var t=this,n=frappe.get_route();frappe.route_hooks={},frappe.route_hooks.after_load=function(t){t.scroll_to_field(e.field),t.doc.__unsaved=!0},frappe.route_hooks.after_save=function(r){var i=!1,a={},o=r.doc[e.field],s=null;o&&"%"==e.value_to_validate&&(i=!0),o==e.value_to_validate&&(i=!0),cstr(o)==cstr(e.value_to_validate)&&(i=!0),i?(a.message=__("Let's take you back to onboarding"),a.title=__("Looks Great"),a.primary_action={action:function(){frappe.set_route(n).then(function(){t.mark_complete(e)})},label:__("Continue")},s=function(){return a.primary_action.action()}):(a.message=__("Looks like you didn't change the value"),a.title=__("Oops"),a.secondary_action={action:function(){return frappe.set_route(n)},label:__("Go Back")},a.primary_action={action:function(){frappe.set_route(n).then(function(){setTimeout(function(){t.skip_step(e)},300)})},label:__("Skip Step")},s=function(){return a.secondary_action.action()}),frappe.msgprint(a),frappe.msg_dialog.custom_onhide=function(){return s()}},frappe.set_route("Form",e.reference_document)}create_entry(e){var t=this,n=frappe.get_route();frappe.route_hooks={},frappe.route_hooks.after_load=function(e){e.show_tour(function(){frappe.msgprint({message:__("Awesome, now try making an entry yourself"),title:__("Great")})})};var r=function(){frappe.msgprint({message:__("You're doing great, let's take you back to the onboarding page."),title:__("Good Work 🎉"),primary_action:{action:function(){frappe.set_route(n).then(function(){t.mark_complete(e)})},label:__("Continue")}}),frappe.msg_dialog.custom_onhide=function(){t.mark_complete(e)}};e.is_submittable?(frappe.route_hooks.after_save=function(){frappe.msgprint({message:__("Submit this document to complete this step."),title:__("Great")})},frappe.route_hooks.after_submit=r):frappe.route_hooks.after_save=r,frappe.set_route("Form",e.reference_document,"new")}show_quick_entry(e){var t=this,n=frappe.get_route_str();frappe.ui.form.make_quick_entry(e.reference_document,function(){if(frappe.get_route_str()!=n){var r=frappe.msgprint({message:__("Let's take you back to onboarding"),title:__("Looks Great"),primary_action:{action:function(){r.hide(),frappe.set_route(n).then(function(){t.mark_complete(e)})},label:__("Continue")}});frappe.msg_dialog.custom_onhide=function(){frappe.set_route(n).then(function(){t.mark_complete(e)})}}else frappe.msgprint({message:__("Let us continue with the onboarding"),title:__("Looks Great")}),t.mark_complete(e)},null,null,!0)}show_video(e){frappe.help.show_video(e.video_url,e.title),this.mark_complete(e)}mark_complete(e){var t=e.$step;this.update_step_status(e,"is_complete",1,function(){e.is_complete=!0,t.removeClass("skipped"),t.addClass("complete")})}skip_step(e){var t=e.$step;this.update_step_status(e,"is_skipped",1,function(){e.is_skipped=!0,t.removeClass("complete"),t.removeClass("pending"),t.addClass("skipped")})}update_step_status(e,t,n,r){var i=this,a={is_complete:"complete",is_skipped:"skipped"};frappe.route_hooks={},frappe.call("frappe.desk.desktop.update_onboarding_step",{name:e.name,field:t,value:n}).then(function(){r(),e.$step.removeClass("pending").removeClass("complete").removeClass("skipped").addClass(a[t]),0==i.steps.filter(function(e){return!(e.is_complete||e.is_skipped)}).length&&i.show_success()})}show_success(){var e=this,t=this.success||__("You seem good to go!"),n=this.success_state_image||"/assets/frappe/images/ui-states/success-color.png",r="";this.docs_url&&(r=__('Congratulations on completing the module setup. If you want to learn more you can refer to the documentation <a target="_blank" href="{0}">here</a>.',[this.docs_url]));var i=$('<div class="text-center onboarding-success">\n\t\t\t\t\t<img src="'+n+'" alt="Success State" class="zoom-in success-state">\n\t\t\t\t\t<h3>'+t+'</h3>\n\t\t\t\t\t<div class="text-muted">'+r+'</div>\n\t\t\t\t\t<button class="btn btn-primary btn-sm">'+__("Continue")+"</button>\n\t\t\t</div>\n\t\t");i.find(".btn").on("click",function(){return e.delete()}),this.step_preview.empty(),i.appendTo(this.step_preview)}set_body(){this.widget.addClass("onboarding-widget-box"),this.is_dismissed()?this.widget.hide():this.make_body()}is_dismissed(){var e=JSON.parse(localStorage.getItem("dismissed-onboarding")||"{}");if(Object.keys(e).includes(this.label)){var t=new Date(e[this.label]),n=new Date;return frappe.datetime.get_hour_diff(n,t)<24}return!1}set_actions(){var e=this;this.action_area.empty();var t=$('<div class="small" style="cursor:pointer;">'+__("Dismiss",null,"Stop showing the onboarding widget.")+"</div>");t.on("click",function(){var t=JSON.parse(localStorage.getItem("dismissed-onboarding")||"{}");t[e.label]=frappe.datetime.now_datetime(),localStorage.setItem("dismissed-onboarding",JSON.stringify(t)),e.delete()}),t.appendTo(this.action_area)}}class NewWidget{constructor(e){Object.assign(this,e),this.make()}customize(){}make(){this.make_widget(),this.widget.appendTo(this.container),this.setup_events()}get_title(){var e="New "+frappe.model.unscrub(this.type);return __(e)}make_widget(){var e="new-"+frappe.scrub(frappe.model.unscrub(this.type),"-")+"-widget";this.widget=$('<div class="widget new-widget '+e+'">\n\t\t\t\t+ '+this.get_title()+"\n\t\t\t</div>"),this.body=this.widget}setup_events(){var e=this;this.widget.on("click",function(){e.custom_dialog?e.custom_dialog():e.open_dialog()})}open_dialog(){var e=get_dialog_constructor(this.type);this.dialog=new e({label:this.label,type:this.type,values:!1,default_values:this.default_values,primary_action:this.on_create}),this.dialog.make()}delete(){this.widget.remove()}}frappe.provide("frappe.utils");class NumberCardWidget extends Widget{constructor(e){e.shadow=!0,super(e)}get_config(){return{name:this.name,label:this.label,color:this.color,hidden:this.hidden}}refresh(){this.set_body()}set_body(){this.widget.addClass("number-widget-box"),this.make_card()}set_title(){$(this.title_field).html('<div class="number-label">'+this.card_doc.label+"</div>")}make_card(){var e=this;frappe.model.with_doc("Number Card",this.name).then(function(t){if(t)e.card_doc=t,e.render_card();else{if(!e.document_type)return void e.delete(!1);frappe.run_serially([function(){return e.create_number_card()},function(){return e.render_card()}])}e.set_events()})}create_number_card(){var e=this;return this.set_doc_args(),frappe.xcall("frappe.desk.doctype.number_card.number_card.create_number_card",{args:this.card_doc}).then(function(t){e.name=t.name,e.card_doc=t,e.widget.attr("data-widget-name",e.name)})}set_events(){var e=this;$(this.body).click(function(){e.in_customize_mode||"Custom"==e.card_doc.type||e.set_route()})}set_route(){var e="Report"!==this.card_doc.type,t=e?this.card_doc.document_type:this.card_doc.report_name,n=frappe.utils.generate_route({name:t,type:e?"doctype":"report",is_query_report:!e});if(e){var r=JSON.parse(this.card_doc.filters_json);frappe.route_options=r.reduce(function(e,t){var n;return Object.assign(e,((n={})[t[0]+"."+t[1]]=[t[2],t[3]],n))},{})}frappe.set_route(n)}set_doc_args(){this.card_doc=Object.assign({},{document_type:this.document_type,label:this.label,function:this.function,aggregate_function_based_on:this.aggregate_function_based_on,color:this.color,filters_json:this.stats_filter})}get_settings(e){var t=this;return this.filters=this.get_filters(),{Custom:{method:this.card_doc.method,args:{filters:this.filters},get_number:function(e){return t.get_number_for_custom_card(e)}},Report:{method:"frappe.desk.query_report.run",args:{report_name:this.card_doc.report_name,filters:this.filters,ignore_prepared_report:1},get_number:function(e){return t.get_number_for_report_card(e)}},"Document Type":{method:"frappe.desk.doctype.number_card.number_card.get_result",args:{doc:this.card_doc,filters:this.filters},get_number:function(e){return t.get_number_for_doctype_card(e)}}}[e]}get_filters(){return frappe.dashboard_utils.get_all_filters(this.card_doc)}render_card(){var e=this;this.prepare_actions(),this.set_title(),this.set_loading_state(),this.card_doc.type||(this.card_doc.type="Document Type"),this.settings=this.get_settings(this.card_doc.type),frappe.run_serially([function(){return e.render_number()},function(){return e.render_stats()}])}set_loading_state(){$(this.body).html('<div class="number-card-loading text-muted">\n\t\t\t'+__("Loading...")+"\n\t\t</div>")}get_number(){var e=this;return frappe.xcall(this.settings.method,this.settings.args).then(function(t){return e.settings.get_number(t)})}get_number_for_custom_card(e){"object"==typeof e?(this.number=e.value,this.set_formatted_number(e)):this.formatted_number=e}get_number_for_doctype_card(e){var t=this;if(this.number=e,"Count"!==this.card_doc.function)return frappe.model.with_doctype(this.card_doc.document_type,function(){var e=frappe.meta.get_docfield(t.card_doc.document_type,t.card_doc.aggregate_function_based_on);t.set_formatted_number(e)});this.formatted_number=e}get_number_for_report_card(e){var t=this.card_doc.report_field,n=e.result.reduce(function(e,n){return n[t]&&e.push(n[t]),e},[]),r=e.columns.find(function(e){return e.fieldname==t});this.number=frappe.report_utils.get_result_of_fn(this.card_doc.report_function,n),this.set_formatted_number(r)}set_formatted_number(e){var t=frappe.sys_defaults.country,n=frappe.utils.shorten_number(this.number,t,5).split(" "),r=n[1]||"",i=$(frappe.format(n[0],e)).text();this.formatted_number=i+" "+r}render_number(){var e=this;return this.get_number().then(function(){$(e.body).html('<div class="widget-content">\n\t\t\t\t<div class="number" style="color:'+e.card_doc.color+'">'+e.formatted_number+"</div>\n\t\t\t\t</div>")})}render_stats(){var e=this;if("Document Type"===this.card_doc.type){var t="",n="";return this.get_percentage_stats().then(function(){0==e.percentage_stat||null==e.percentage_stat?n="grey-stat":e.percentage_stat>0?(t='<span class="indicator-pill-round green">\n\t\t\t\t\t\t'+frappe.utils.icon("arrow-up-right","xs")+"\n\t\t\t\t\t</span>",n="green-stat"):(t='<span class="indicator-pill-round red">\n\t\t\t\t\t\t'+frappe.utils.icon("arrow-down-left","xs")+"\n\t\t\t\t\t</span>",n="red-stat");var r={Daily:__("since yesterday"),Weekly:__("since last week"),Monthly:__("since last month"),Yearly:__("since last year")}[e.card_doc.stats_time_interval];$(e.body).find(".widget-content").append('<div class="card-stats '+n+'">\n\t\t\t\t<span class="percentage-stat-area">\n\t\t\t\t\t'+t+'\n\t\t\t\t\t<span class="percentage-stat">\n\t\t\t\t\t\t'+function(){if(null==e.percentage_stat)return NaN;var t=e.percentage_stat.split(" "),n=t[1]||"";return Math.abs(t[0])+" "+n}()+' %\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t\t<span class="stat-period text-muted">\n\t\t\t\t\t'+r+"\n\t\t\t\t</span>\n\t\t\t</div>")})}}get_percentage_stats(){var e=this;return frappe.xcall("frappe.desk.doctype.number_card.number_card.get_percentage_difference",{doc:this.card_doc,filters:this.filters,result:this.number}).then(function(t){void 0!==t&&(e.percentage_stat=frappe.utils.shorten_number(t))})}prepare_actions(){var e=this,t=[{label:__("Refresh"),action:"action-refresh",handler:function(){e.render_card()}},{label:__("Edit"),action:"action-edit",handler:function(){frappe.set_route("Form","Number Card",e.name)}}];this.set_card_actions(t)}set_card_actions(e){this.card_actions=$('<div class="card-actions dropdown pull-right">\n\t\t\t\t<a data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n\t\t\t\t...\n\t\t\t\t</a>\n\t\t\t\t<ul class="dropdown-menu" style="max-height: 300px; overflow-y: auto;">\n\t\t\t\t\t'+e.map(function(e){return'<li class="dropdown-item">\n\t\t\t\t\t\t\t\t\t<a data-action="'+e.action+'">'+e.label+"</a>\n\t\t\t\t\t\t\t\t</li>"}).join("")+"\n\t\t\t\t</ul>\n\t\t\t</div>"),this.card_actions.find("a[data-action]").each(function(t,n){var r=n.dataset.action;$(n).click(e.find(function(e){return e.action===r}))}),this.action_area.html(this.card_actions)}}frappe.provide("frappe.widget"),frappe.widget.widget_factory={chart:ChartWidget,base:Widget,shortcut:ShortcutWidget,links:LinksWidget,onboarding:OnboardingWidget,number_card:NumberCardWidget},frappe.widget.make_widget=function(e){var t=frappe.widget.widget_factory[e.widget_type];if(t)return new t(e);console.warn("Invalid Widget Name: "+e.widget_type)};class WidgetGroup{constructor(e){Object.assign(this,e),this.widgets_list=[],this.widgets_dict={},this.widget_order=[],this.make()}make(){this.make_container(),this.title?this.set_title():this.title_area.remove(),this.widgets&&this.make_widgets()}make_container(){var e=$('<div class="widget-group '+(this.class_name||"")+'">\n\t\t\t\t<div class="widget-group-head">\n\t\t\t\t\t<div class="widget-group-title"></div>\n\t\t\t\t\t<div class="widget-group-control"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="widget-group-body grid-col-'+this.columns+'">\n\t\t\t\t</div>\n\t\t\t</div>');this.widget_area=e,this.hidden&&this.widget_area.hide(),this.title_area=e.find(".widget-group-title"),this.control_area=e.find(".widget-group-control"),this.body=e.find(".widget-group-body"),!this.widgets.length&&this.widget_area.hide(),e.appendTo(this.container)}set_title(){this.title_area[0].innerText=this.title}make_widgets(){var e=this;this.body.empty(),this.widgets.forEach(function(t){e.add_widget(t)})}add_widget(e){var t=this,n=frappe.widget.make_widget(Object.assign({},e,{widget_type:this.type,container:this.body,height:this.height||null,options:Object.assign({},this.options,{on_delete:function(e){return t.on_delete(e)}})}));return this.widgets_list.push(n),this.widgets_dict[e.name]=n,n}remove_widget(e){e.widget.remove(),this.widgets_list.filter(function(t){if(t.name==e.name)return!1}),delete this.widgets_dict[e.name]}customize(){var e=this;this.hidden||this.widget_area.show(),this.widgets_list.forEach(function(t){t.customize(e.options)}),this.options.allow_create&&this.setup_new_widget(),this.options.allow_sorting&&this.setup_sortable()}setup_new_widget(){var e=this,t=this.options&&this.options.max_widget_count||Number.POSITIVE_INFINITY;this.widgets_list.length<t&&(this.new_widget=new NewWidget({container:this.body,type:this.type,custom_dialog:this.custom_dialog,default_values:this.default_values,on_create:function(n){e.new_widget.delete(),delete e.new_widget,n.in_customize_mode=1,e.add_widget(n).customize(e.options),e.widgets_list.length<t&&e.setup_new_widget()}}))}on_delete(e,t){this.widgets_list=this.widgets_list.filter(function(t){return e!=t.name}),delete this.widgets_dict[e],this.update_widget_order(),!this.new_widget&&t&&this.setup_new_widget()}update_widget_order(){var e=this;this.widget_order=[],this.body.children().each(function(t,n){var r=n.dataset.widgetName;r&&e.widget_order.push(r)})}setup_sortable(){var e=this,t=this.body[0];this.sortable=new Sortable(t,{animation:150,handle:".drag-handle",onEnd:function(){return e.update_widget_order()}})}get_widget_config(){this.update_widget_order();var e={};return this.widgets_list.forEach(function(t){var n=t.get_config(),r=n.docname?n.docname:n.name;e[r]=n}),{order:this.widget_order,widgets:e}}}function get_url_arg(e){return get_query_params()[e]||""}function get_query_string(e){return e.includes("?")?e.slice(e.indexOf("?")+1):""}function get_query_params(e){var t={};e||(e=location.search.substring(1));for(var n=e.split("&"),r=0,i=n.length;r<i;r++){var a=n[r].split(/=(.+)/),o=a[0];if(o){var s=a[1];if("string"==typeof s){s=s.replace(/\+/g,"%20");try{s=decodeURIComponent(s)}catch(e){}}o in t?(void 0===t[o]?t[o]=[]:"string"==typeof t[o]&&(t[o]=[t[o]]),t[o].push(s)):t[o]=s}}return t}function make_query_string(e,t){void 0===t&&(t=!0);var n=[];for(var r in e){var i=e[r];void 0!==i&&""!==i&&null!==i&&("object"==typeof i&&(i=JSON.stringify(i)),t&&(r=encodeURIComponent(r),i=encodeURIComponent(i)),n.push(r+"="+i))}return"?"+n.join("&")}function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}function c(e,t,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}}(e,t)||d(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){return"string"==typeof e?(t||document).querySelector(e):e||null}function v(e){var t=e.getBoundingClientRect();return{top:t.top+(document.documentElement.scrollTop||document.body.scrollTop),left:t.left+(document.documentElement.scrollLeft||document.body.scrollLeft)}}function g(e){return null===e.offsetParent}function m(e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}frappe.widget.WidgetGroup=WidgetGroup,frappe.templates.sort_selector='<div class="sort-selector">  <div class="btn-group">   <button class="btn btn-default btn-sm btn-order"    data-value="{{ sort_order }}"    title="{{ sort_order==="desc" ? "descending" : "ascending" }}">    <span class="sort-order">     <svg class="icon icon-sm">      <use xlink:href="#icon-{{ sort_order==="desc" ? "sort-descending" : "sort-ascending" }}"></use>     </svg>    </span>   </button>   <button type="button" class="btn btn-default btn-sm sort-selector-button" data-toggle="dropdown">    <span class="dropdown-text">{{ __(sort_by_label) }}</span>    <ul class="dropdown-menu dropdown-menu-right">     {% for value in options %}     <li>      <a class="dropdown-item option" data-value="{{ value.fieldname }}">       {{ __(value.label) }}      </a>     </li>     {% endfor %}    </ul>   </button>  </div> </div> ',frappe.ui.SortSelector=Class.extend({init:function(e){$.extend(this,e),this.labels={},this.make()},make:function(){this.prepare_args(),this.parent.find(".sort-selector").remove(),this.wrapper=$(frappe.render_template("sort_selector",this.args)).appendTo(this.parent),this.bind_events()},bind_events:function(){var e=this;this.wrapper.find(".btn-order").on("click",function(){var t=$(this),n="desc"===$(this).attr("data-value")?"asc":"desc",r="desc"===$(this).attr("data-value")?"ascending":"descending";t.attr("data-value",n),t.attr("title",r),e.sort_order=n;var i="asc"===n?"sort-ascending":"sort-descending";t.find(".sort-order").html(frappe.utils.icon(i,"sm")),(e.onchange||e.change)(e.sort_by,e.sort_order)}),this.wrapper.find(".dropdown-menu a.option").on("click",function(){e.sort_by=$(this).attr("data-value"),e.wrapper.find(".dropdown-text").html($(this).html()),(e.onchange||e.change)(e.sort_by,e.sort_order)})},prepare_args:function(){var e=this;if(this.args||(this.args={}),this.args&&"string"==typeof this.args){var t=this.args;this.args={},t.includes("`.`")&&(t=t.split(".")[1]);var n=t.split(" ");if(2===n.length){var r=strip(n[0],"`");this.args.sort_by=r,this.args.sort_order=n[1]}}this.args.options&&this.args.options.forEach(function(t){e.labels[t.fieldname]=t.label}),this.setup_from_doctype(),this.args.sort_by&&!this.args.sort_by_label&&this.args.options.every(function(t){return t.fieldname!==e.args.sort_by||(e.args.sort_by_label=t.label,!1)})},setup_from_doctype:function(){var e=this,t=frappe.get_meta(this.doctype);if(t){var n=this.get_meta_sort_field(),r=n.meta_sort_field,i=n.meta_sort_order;if(this.args.sort_by||(r?(this.args.sort_by=r,this.args.sort_order=i):(this.args.sort_by="modified",this.args.sort_order="desc")),this.args.sort_by_label||(this.args.sort_by_label=this.get_label(this.args.sort_by)),!this.args.options){var a=[{fieldname:"modified"}];t.title_field&&a.push({fieldname:t.title_field}),t.fields.forEach(function(e){(e.mandatory||e.bold)&&a.push({fieldname:e.fieldname,label:e.label})}),r&&a.push({fieldname:r}),a.push({fieldname:"name"},{fieldname:"creation"},{fieldname:"idx"}),this.args.options=a.uniqBy(function(e){return e.fieldname}),this.args.options.forEach(function(t){t.label||(t.label=e.get_label(t.fieldname))})}this.sort_by=this.args.sort_by,this.sort_order=this.args.sort_order}},get_meta_sort_field:function(){var e=frappe.get_meta(this.doctype);if(!e)return{meta_sort_field:null,meta_sort_order:null};if(e.sort_field&&e.sort_field.includes(",")){var t=e.sort_field.split(",")[0].split(" ");return{meta_sort_field:t[0],meta_sort_order:t[1]}}return{meta_sort_field:e.sort_field||"modified",meta_sort_order:e.sort_order?e.sort_order.toLowerCase():""}},get_label:function(e){return"idx"===e?__("Most Used"):this.labels[e]||frappe.meta.get_label(this.doctype,e)},get_sql_string:function(){return"`tab"+this.doctype+"`.`"+this.sort_by+"` "+this.sort_order}}),frappe.templates.change_log='{% for (var i=0, l=change_log.length; i < l; i++) {     var app_info = change_log[i]; %}  {% if (i > 0) { %} <hr> {% } %}  <div class="text-left app-change-log">   <h2 style="margin-top: 10px;">             {{ app_info.title }}    <small>{{ __("updated to {0}", [app_info.version]) }}</small>   </h2>   <div class="app-change-log-body">   {% for (var x=0, y=app_info.change_log.length; x < y; x++) {             var version_info = app_info.change_log[x];             if(version_info) { %}        <p>{{ frappe.markdown(version_info[1]) }}</p>       {% }         } %}      </div>  </div> {% } %} ',frappe.templates.workspace_loading_skeleton='<div class="workspace-skeleton">  <div class="widget-group">   <div class="widget-group-head skeleton-header">    <div class="widget-group-title skeleton-card"></div>   </div>   <div class="widget-group-body grid-col-3">    <div class="widget shortcut-widget-box skeleton-card"></div>    <div class="widget shortcut-widget-box skeleton-card"></div>    <div class="widget shortcut-widget-box skeleton-card"></div>   </div>  </div>  <div class="widget-group skeleton-body">   <div class="widget-group-head skeleton-header">    <div class="widget-group-title skeleton-card"></div>   </div>   <div class="widget-group-body grid-col-3">    <div class="widget links-widget-box skeleton-card"></div>    <div class="widget links-widget-box skeleton-card"></div>    <div class="widget links-widget-box skeleton-card"></div>    <div class="widget links-widget-box skeleton-card"></div>    <div class="widget links-widget-box skeleton-card"></div>   </div>  </div> </div> ',frappe.start_app=function(){frappe.Application&&(frappe.assets.check(),frappe.provide("frappe.app"),frappe.provide("frappe.desk"),frappe.app=new frappe.Application)},$(document).ready(function(){frappe.utils.supportsES6||frappe.msgprint({indicator:"red",title:__("Browser not supported"),message:__("Some of the features might not work in your browser. Please update your browser to the latest version.")}),frappe.start_app()}),frappe.Application=Class.extend({init:function(){this.startup()},startup:function(){var e=this;if(frappe.socketio.init(),frappe.model.init(),"failed"===frappe.boot.status)throw frappe.msgprint({message:frappe.boot.error,title:__("Session Start Failed"),indicator:"red"}),"boot failed";if(this.setup_frappe_vue(),this.load_bootinfo(),this.load_user_permissions(),this.make_nav_bar(),this.set_favicon(),this.setup_analytics(),this.set_fullwidth_if_enabled(),this.add_browser_class(),this.setup_energy_point_listeners(),this.setup_copy_doc_listener(),frappe.ui.keys.setup(),frappe.ui.keys.add_shortcut({shortcut:"shift+ctrl+g",description:__("Switch Theme"),action:function(){frappe.theme_switcher=new frappe.ui.ThemeSwitcher,frappe.theme_switcher.show()}}),this.make_page_container(),this.set_route(),$(document).trigger("startup"),$(document).trigger("app_ready"),frappe.boot.messages&&frappe.msgprint(frappe.boot.messages),frappe.user_roles.includes("System Manager")&&setTimeout(function(){e.show_change_log(),e.show_update_available()},1e3),!frappe.boot.developer_mode){var t=__("Using this console may allow attackers to impersonate you and steal your information. Do not enter or paste code that you do not understand.");console.log("%c"+t,"font-size: large")}if(this.show_notes(),frappe.ui.startup_setup_dialog&&!frappe.boot.setup_complete&&(frappe.ui.startup_setup_dialog.pre_show(),frappe.ui.startup_setup_dialog.show()),frappe.realtime.on("version-update",function(){var e=frappe.msgprint({message:__("The application has been updated to a new version, please refresh this page"),indicator:"green",title:__("Version Updated")});e.set_primary_action(__("Refresh"),function(){location.reload(!0)}),e.get_close_btn().toggle(!1)}),this.setup_build_error_listener(),frappe.sys_defaults.email_user_password){var n=frappe.sys_defaults.email_user_password.split(",");for(var r in n)n[r]===frappe.user.name&&this.set_password(n[r])}this.link_preview=new frappe.ui.LinkPreview,frappe.boot.developer_mode||(setInterval(function(){frappe.call({method:"frappe.core.page.background_jobs.background_jobs.get_scheduler_status",callback:function(e){e.message[0]==__("Inactive")&&frappe.call("frappe.utils.scheduler.activate_scheduler")}})},3e5),frappe.user.has_role("System Manager")&&setInterval(function(){frappe.call({method:"frappe.core.doctype.log_settings.log_settings.has_unseen_error_log",args:{user:frappe.session.user},callback:function(e){e.message.show_alert&&frappe.show_alert({indicator:"red",message:e.message.message})}})},6e5))},set_route:function(){frappe.flags.setting_original_route=!0,frappe.boot&&localStorage.getItem("session_last_route")?(frappe.set_route(localStorage.getItem("session_last_route")),localStorage.removeItem("session_last_route")):frappe.router.route(),frappe.after_ajax(function(){return frappe.flags.setting_original_route=!1}),frappe.router.on("change",function(){$(".tooltip").hide()})},setup_frappe_vue:function(){Vue.prototype.__=window.__,Vue.prototype.frappe=window.frappe},set_password:function(e){var t=this;frappe.call({method:"frappe.core.doctype.user.user.get_email_awaiting",args:{user:e},callback:function(n){if(n=n.message){0<n.length&&t.email_password_prompt(n,e,0)}}})},email_password_prompt:function(e,t,n){var r=this,i=new frappe.ui.Dialog({title:__("Password missing in Email Account"),fields:[{fieldname:"password",fieldtype:"Password",label:__("Please enter the password for: <b>{0}</b>",[e[n].email_id]),reqd:1},{fieldname:"submit",fieldtype:"Button",label:__("Submit")}]});i.get_input("submit").on("click",function(){i.hide();var a=new frappe.ui.Dialog({title:__("Checking one moment"),fields:[{fieldtype:"HTML",fieldname:"checking"}]});a.fields_dict.checking.$wrapper.html('<i class="fa fa-spinner fa-spin fa-4x"></i>'),a.show(),frappe.call({method:"frappe.email.doctype.email_account.email_account.set_email_password",args:{email_account:e[n].email_account,user:t,password:i.get_value("password")},callback:function(o){a.hide(),i.hide(),o.message?n+1<e.length&&(n+=1,r.email_password_prompt(e,t,n)):(frappe.show_alert({message:__("Login Failed please try again"),indicator:"error"},5),r.email_password_prompt(e,t,n))}})}),i.show()},load_bootinfo:function(){frappe.boot?(this.setup_workspaces(),frappe.model.sync(frappe.boot.docs),this.check_metadata_cache_status(),this.set_globals(),this.sync_pages(),frappe.router.setup(),moment.locale("en"),moment.user_utc_offset=moment().utcOffset(),frappe.boot.timezone_info&&moment.tz.add(frappe.boot.timezone_info),frappe.boot.print_css&&frappe.dom.set_style(frappe.boot.print_css,"print-style"),frappe.user.name=frappe.boot.user.name,frappe.router.setup()):this.set_as_guest()},setup_workspaces:function(){frappe.modules={},frappe.workspaces={};for(var e=0,t=frappe.boot.allowed_workspaces||[];e<t.length;e+=1){var n=t[e];frappe.modules[n.module]=n,frappe.workspaces[frappe.router.slug(n.name)]=n}frappe.workspaces.home||(frappe.workspaces.home=frappe.workspaces[Object.keys(frappe.workspaces)[0]])},load_user_permissions:function(){frappe.defaults.update_user_permissions(),frappe.realtime.on("update_user_permissions",frappe.utils.debounce(function(){frappe.defaults.update_user_permissions()},500))},check_metadata_cache_status:function(){frappe.boot.metadata_version!=localStorage.metadata_version&&(frappe.assets.clear_local_storage(),frappe.assets.init_local_storage())},set_globals:function(){frappe.session.user=frappe.boot.user.name,frappe.session.logged_in_user=frappe.boot.user.name,frappe.session.user_email=frappe.boot.user.email,frappe.session.user_fullname=frappe.user_info().fullname,frappe.user_defaults=frappe.boot.user.defaults,frappe.user_roles=frappe.boot.user.roles,frappe.sys_defaults=frappe.boot.sysdefaults,frappe.ui.py_date_format=frappe.boot.sysdefaults.date_format.replace("dd","%d").replace("mm","%m").replace("yyyy","%Y"),frappe.boot.user.last_selected_values={},Object.defineProperties(window,{user:{get:function(){return console.warn("Please use `frappe.session.user` instead of `user`. It will be deprecated soon."),frappe.session.user}},user_fullname:{get:function(){return console.warn("Please use `frappe.session.user_fullname` instead of `user_fullname`. It will be deprecated soon."),frappe.session.user}},user_email:{get:function(){return console.warn("Please use `frappe.session.user_email` instead of `user_email`. It will be deprecated soon."),frappe.session.user_email}},user_defaults:{get:function(){return console.warn("Please use `frappe.user_defaults` instead of `user_defaults`. It will be deprecated soon."),frappe.user_defaults}},roles:{get:function(){return console.warn("Please use `frappe.user_roles` instead of `roles`. It will be deprecated soon."),frappe.user_roles}},sys_defaults:{get:function(){return console.warn("Please use `frappe.sys_defaults` instead of `sys_defaults`. It will be deprecated soon."),frappe.user_roles}}})},sync_pages:function(){if(localStorage.page_info){frappe.boot.allowed_pages=[];var e=JSON.parse(localStorage.page_info);$.each(frappe.boot.page_info,function(t,n){e[t]&&e[t].modified==n.modified||delete localStorage["_page:"+t],frappe.boot.allowed_pages.push(t)})}else frappe.boot.allowed_pages=Object.keys(frappe.boot.page_info);localStorage.page_info=JSON.stringify(frappe.boot.page_info)},set_as_guest:function(){frappe.session.user="Guest",frappe.session.user_email="",frappe.session.user_fullname="Guest",frappe.user_defaults={},frappe.user_roles=["Guest"],frappe.sys_defaults={}},make_page_container:function(){$("#body").length&&($(".splash").remove(),frappe.temp_container=$("<div id='temp-container' style='display: none;'>").appendTo("body"),frappe.container=new frappe.views.Container)},make_nav_bar:function(){frappe.boot&&"setup-wizard"!==frappe.boot.home_page&&(frappe.frappe_toolbar=new frappe.ui.toolbar.Toolbar)},logout:function(){var e=this;return e.logged_out=!0,frappe.call({method:"logout",callback:function(t){t.exc||e.redirect_to_login()}})},handle_session_expired:function(){if(!frappe.app.session_expired_dialog){var e=new frappe.ui.Dialog({title:__("Session Expired"),keep_open:!0,fields:[{fieldtype:"Password",fieldname:"password",label:__("Please Enter Your Password to Continue")}],onhide:function(){e.logged_in||frappe.app.redirect_to_login()}});e.set_primary_action(__("Login"),function(){e.set_message(__("Authenticating...")),frappe.call({method:"login",args:{usr:frappe.session.user,pwd:e.get_values().password},callback:function(t){"Logged In"===t.message&&(e.logged_in=!0,$(".modal-backdrop").css({opacity:"","background-color":"#334143"})),e.hide()},statusCode:function(){e.hide()}})}),frappe.app.session_expired_dialog=e}frappe.app.session_expired_dialog.display||(frappe.app.session_expired_dialog.show(),$(".modal-backdrop").css({opacity:1,"background-color":"#4B4C9D"}))},redirect_to_login:function(){window.location.href="/"},set_favicon:function(){var e=$('link[type="image/x-icon"]').remove().attr("href");$('<link rel="shortcut icon" href="'+e+'" type="image/x-icon">').appendTo("head"),$('<link rel="icon" href="'+e+'" type="image/x-icon">').appendTo("head")},trigger_primary_action:function(){$(document.activeElement).blur(),setTimeout(function(){window.cur_dialog&&cur_dialog.display?cur_dialog.get_primary_btn().trigger("click"):cur_frm&&cur_frm.page.btn_primary.is(":visible")?cur_frm.page.btn_primary.trigger("click"):frappe.container.page.save_action&&frappe.container.page.save_action()},100)},show_change_log:function(){var e=this,t=frappe.boot.change_log;if(Array.isArray(t)&&t.length&&!window.Cypress){var n=frappe.msgprint({message:frappe.render_template("change_log",{change_log:t}),title:__("Updated To A New Version 🎉"),wide:!0});n.keep_open=!0,n.custom_onhide=function(){frappe.call({method:"frappe.utils.change_log.update_last_known_versions"}),e.show_notes()}}},show_update_available:function(){frappe.boot.sysdefaults.disable_system_update_notification||frappe.call({method:"frappe.utils.change_log.show_update_popup"})},setup_analytics:function(){window.mixpanel&&(window.mixpanel.identify(frappe.session.user),window.mixpanel.people.set({$first_name:frappe.boot.user.first_name,$last_name:frappe.boot.user.last_name,$created:frappe.boot.user.creation,$email:frappe.session.user}))},add_browser_class:function(){$("html").addClass(frappe.utils.get_browser().name.toLowerCase())},set_fullwidth_if_enabled:function(){frappe.ui.toolbar.set_fullwidth_if_enabled()},show_notes:function(){var e=this;frappe.boot.notes.length&&frappe.boot.notes.forEach(function(t){if(!t.seen||t.notify_on_every_login){var n=frappe.msgprint({message:t.content,title:t.title});n.keep_open=!0,n.custom_onhide=function(){t.seen=!0,t.notify_on_every_login||frappe.call({method:"frappe.desk.doctype.note.note.mark_as_seen",args:{note:t.name}}),e.show_notes()}}})},setup_build_error_listener:function(){frappe.boot.developer_mode&&frappe.realtime.on("build_error",function(e){console.log(e)})},setup_energy_point_listeners:function(){frappe.realtime.on("energy_point_alert",function(e){frappe.show_alert(e)})},setup_copy_doc_listener:function(){$("body").on("paste",function(e){try{var t=frappe.utils.get_clipboard_data(e),n=JSON.parse(t);if(n.doctype){e.preventDefault();frappe.dom.freeze(__("Creating {0}",[n.doctype])+"..."),(r=500,new Promise(function(e){return setTimeout(e,r)})).then(function(){var e=frappe.model.with_doctype(n.doctype,function(){var e=frappe.model.copy_doc(n);e.__newname=n.name,delete n.name,e.idx=null,e.__run_link_triggers=!1,frappe.set_route("Form",e.doctype,e.name),frappe.dom.unfreeze()});e&&e.fail(frappe.dom.unfreeze)})}}catch(e){}var r})}}),frappe.get_module=function(e,t){var n=frappe.modules[e]||t;if(n)return n._setup?n:(n.label||(n.label=e),n._label||(n._label=__(n.label)),n._setup=!0,n)},frappe.provide("frappe.utils"),Object.assign(frappe.utils,{get_url_arg:get_url_arg,get_query_string:get_query_string,get_query_params:get_query_params,make_query_string:make_query_string}),frappe.provide("frappe.energy_points"),Object.assign(frappe.energy_points,{get_points:function(e){return'<span class="bold" style="color: '+(e>=0?"#45A163":"#e42121")+'">\n\t\t\t'+(e>0?"+":"")+e+"\n\t\t</span>"},format_form_log:function(e){return"<span>\n\t\t\t\x3c!--"+this.get_points(e.points)+'&nbsp;--\x3e\n\t\t\t<a href="/app/energy-point-log/'+e.name+'">'+this.get_form_log_message(e)+"</a>\n\t\t\t"+(e.reason?"<span>&nbsp;-&nbsp;</span>"+e.reason:"")+"\n\t\t</span>"},format_history_log:function(e){var t=frappe.utils.get_form_link(e.reference_doctype,e.reference_name);return'<div class="flex">\n\t\t\t<span class="'+(e.points>=0?"green":"red")+' mr-2">\n\t\t\t\t'+this.get_points(e.points)+'\n\t\t\t</span>\n\t\t\t<a href="'+t+'" class="text-muted">'+this.get_history_log_message(e)+"</a>\n\t\t\t"+(e.reason?"<span>&nbsp;-&nbsp;</span>"+e.reason:"")+"\n\t\t\t<span>&nbsp;-&nbsp;</span>"+frappe.datetime.comment_when(e.creation)+"\n\t\t</div>"},get_history_log_message:function(e){var t=frappe.user.full_name(e.owner).bold(),n=e.reference_name;return"Appreciation"===e.type?__("{0} appreciated on {1}",[t,n]):"Criticism"===e.type?__("{0} criticized on {1}",[t,n]):"Revert"===e.type?__("{0} reverted {1}",[t,e.revert_of]):__("via automatic rule {0} on {1}",[e.rule.bold(),n])},get_form_log_message:function(e){var t=frappe.user.full_name(e.owner).bold(),n=frappe.user.full_name(e.user).bold();return"Appreciation"===e.type?__("{0} appreciated {1}",[t,n]):"Criticism"===e.type?__("{0} criticized {1}",[t,n]):"Revert"===e.type?__("{0} reverted {1}",[t,e.revert_of]):__("gained by {0} via automatic rule {1}",[n,e.rule.bold()])}}),frappe.dashboard_utils={render_chart_filters:function(e,t,n,r){e.forEach(function(e){var i="",a="";e.icon&&(i=frappe.utils.icon(e.icon)),e.class&&(a=e.class);var o,s='<div class="'+t+" "+a+' btn-group dropdown pull-right">\n\t\t\t\t\t<a data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n\t\t\t\t\t\t<button class="btn btn-secondary btn-xs">\n\t\t\t \t\t\t\t'+i+'\n\t\t\t\t\t\t\t<span class="filter-label">'+e.label+"</span>\n\t\t\t\t\t\t\t"+frappe.utils.icon("select","xs")+"\n\t\t\t\t\t\t</button>\n\t\t\t\t</a>";o=e.fieldnames?e.options.map(function(t,n){return'<li>\n\t\t\t\t\t\t<a class="dropdown-item" data-fieldname="'+e.fieldnames[n]+'">'+t+"</a>\n\t\t\t\t\t</li>"}).join(""):e.options.map(function(e){return'<li><a class="dropdown-item">'+e+"</a></li>"}).join("");var l=$(s+'<ul class="dropdown-menu">'+o+"</ul></div>");r?l.prependTo(n):l.appendTo(n),l.find(".dropdown-menu").on("click","li a",function(n){var r,i=$(n.currentTarget);i.attr("data-fieldname")&&(r=i.attr("data-fieldname"));var a=i.text();i.parents("."+t).find(".filter-label").text(a),e.action(a,r)})})},get_filters_for_chart_type:function(e){if("Custom"===e.chart_type&&e.source){return frappe.xcall("frappe.desk.doctype.dashboard_chart_source.dashboard_chart_source.get_config",{name:e.source}).then(function(t){return frappe.dom.eval(t),frappe.dashboards.chart_sources[e.source].filters})}return"Report"===e.chart_type&&e.report_name?frappe.report_utils.get_report_filters(e.report_name).then(function(e){return e}):Promise.resolve()},get_dashboard_settings:function(){var e=this;return frappe.db.get_list("Dashboard Settings",{filters:{name:frappe.session.user},fields:["*"]}).then(function(t){return t.length?t[0]:e.create_dashboard_settings().then(function(e){return e})})},create_dashboard_settings:function(){return frappe.xcall("frappe.desk.doctype.dashboard_settings.dashboard_settings.create_dashboard_settings",{user:frappe.session.user}).then(function(e){return e})},get_years_since_creation:function(e){for(var t=this.get_year(e),n=[],r=this.get_year(frappe.datetime.now_date());r>=t;r--)n.push(r);return n},get_year:function(e){return e.substring(0,e.indexOf("-"))},remove_common_static_filter_values:function(e,t){if(t)if($.isArray(e))e=e.filter(function(e){for(var n=0,r=t;n<r.length;n+=1){var i=r[n];if(e[0]==i[0]&&e[1]==i[1])return!1}return!0});else for(var n=0,r=Object.keys(t);n<r.length;n+=1){delete e[r[n]]}return e},get_fields_for_dynamic_filter_dialog:function(e,t,n){var r=[{fieldtype:"HTML",fieldname:"description",options:'<div>\n\t\t\t\t\t\t<p>Set dynamic filter values in JavaScript for the required fields here.\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<p>Ex:\n\t\t\t\t\t\t\t<code>frappe.defaults.get_user_default("Company")</code>\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>'}];if(e)n&&(t=t.concat(n)),t.forEach(function(e){for(var t=0,n=r;t<n.length;t+=1){if(n[t].fieldname==e[0]+":"+e[1])return}"="==e[2]&&r.push({label:e[1]+" ("+e[0]+")",fieldname:e[0]+":"+e[1],fieldtype:"Data"})});else{t=Object.assign({},n,t);for(var i=0,a=Object.keys(t);i<a.length;i+=1){var o=a[i];r.push({label:o,fieldname:o,fieldtype:"Data"})}}return r},get_all_filters:function get_all_filters(doc){var filters=JSON.parse(doc.filters_json||"null"),dynamic_filters=JSON.parse(doc.dynamic_filters_json||"null");if(!dynamic_filters)return filters;if($.isArray(dynamic_filters))dynamic_filters.forEach(function(f){try{f[3]=eval(f[3])}catch(e){frappe.throw(__("Invalid expression set in filter {0} ({1})",[f[1],f[0]]))}}),filters=filters.concat(dynamic_filters);else{for(var i=0,list=Object.keys(dynamic_filters);i<list.length;i+=1){var key=list[i];try{var val=eval(dynamic_filters[key]);dynamic_filters[key]=val}catch(e){frappe.throw(__("Invalid expression set in filter {0}",[key]))}}Object.assign(filters,dynamic_filters)}return filters},get_dashboard_link_field:function(){var e={label:__("Select Dashboard"),fieldtype:"Link",fieldname:"dashboard",options:"Dashboard"};return frappe.boot.developer_mode||(e.get_query=function(){return{filters:{is_standard:0}}}),e},get_add_to_dashboard_dialog:function(e,t,n){var r=this.get_dashboard_link_field(),i=new frappe.ui.Dialog({title:__("Add to Dashboard"),fields:[r],primary_action:function(r){r.name=e,r.set_standard=frappe.boot.developer_mode,frappe.xcall(n,{args:r}).then(function(){var e='<a href = "#dashboard/'+r.dashboard+'">'+r.dashboard+"</a>",n=__("{0} {1} added to Dashboard {2}",[t,r.name,e]);frappe.msgprint(n)}),i.hide()}});return i}},function(e,t){void 0===t&&(t={});var n=t.insertAt;if("undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}(':root {\n  --charts-label-color: #313b44;\n  --charts-axis-line-color: #f4f5f6;\n  --charts-tooltip-title: var(--charts-label-color);\n  --charts-tooltip-label: var(--charts-label-color);\n  --charts-tooltip-value: #192734;\n  --charts-tooltip-bg: #ffffff;\n  --charts-stroke-width: 2px;\n  --charts-dataset-circle-stroke: #ffffff;\n  --charts-dataset-circle-stroke-width: var(--charts-stroke-width);\n  --charts-legend-label: var(--charts-label-color);\n  --charts-legend-value: var(--charts-label-color); }\n\n.chart-container {\n  position: relative;\n  /* for absolutely positioned tooltip */\n  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif; }\n  .chart-container .axis,\n  .chart-container .chart-label {\n    fill: var(--charts-label-color); }\n    .chart-container .axis line,\n    .chart-container .chart-label line {\n      stroke: var(--charts-axis-line-color); }\n  .chart-container .dataset-units circle {\n    stroke: var(--charts-dataset-circle-stroke);\n    stroke-width: var(--charts-dataset-circle-stroke-width); }\n  .chart-container .dataset-units path {\n    fill: none;\n    stroke-opacity: 1;\n    stroke-width: var(--charts-stroke-width); }\n  .chart-container .dataset-path {\n    stroke-width: var(--charts-stroke-width); }\n  .chart-container .path-group path {\n    fill: none;\n    stroke-opacity: 1;\n    stroke-width: var(--charts-stroke-width); }\n  .chart-container line.dashed {\n    stroke-dasharray: 5, 3; }\n  .chart-container .axis-line .specific-value {\n    text-anchor: start; }\n  .chart-container .axis-line .y-line {\n    text-anchor: end; }\n  .chart-container .axis-line .x-line {\n    text-anchor: middle; }\n  .chart-container .legend-dataset-label {\n    fill: var(--charts-legend-label);\n    font-weight: 600; }\n  .chart-container .legend-dataset-value {\n    fill: var(--charts-legend-value); }\n\n.graph-svg-tip {\n  position: absolute;\n  z-index: 99999;\n  padding: 10px;\n  font-size: 12px;\n  text-align: center;\n  background: var(--charts-tooltip-bg);\n  box-shadow: 0px 1px 4px rgba(17, 43, 66, 0.1), 0px 2px 6px rgba(17, 43, 66, 0.08), 0px 40px 30px -30px rgba(17, 43, 66, 0.1);\n  border-radius: 6px; }\n  .graph-svg-tip ul {\n    padding-left: 0;\n    display: flex; }\n  .graph-svg-tip ol {\n    padding-left: 0;\n    display: flex; }\n  .graph-svg-tip ul.data-point-list li {\n    min-width: 90px;\n    font-weight: 600; }\n  .graph-svg-tip .svg-pointer {\n    position: absolute;\n    height: 12px;\n    width: 12px;\n    border-radius: 2px;\n    background: var(--charts-tooltip-bg);\n    transform: rotate(45deg);\n    margin-top: -7px;\n    margin-left: -6px; }\n  .graph-svg-tip.comparison {\n    text-align: left;\n    padding: 0px;\n    pointer-events: none; }\n    .graph-svg-tip.comparison .title {\n      display: block;\n      padding: 16px;\n      margin: 0;\n      color: var(--charts-tooltip-title);\n      font-weight: 600;\n      line-height: 1;\n      pointer-events: none;\n      text-transform: uppercase; }\n      .graph-svg-tip.comparison .title strong {\n        color: var(--charts-tooltip-value); }\n    .graph-svg-tip.comparison ul {\n      margin: 0;\n      white-space: nowrap;\n      list-style: none; }\n      .graph-svg-tip.comparison ul.tooltip-grid {\n        display: grid;\n        grid-template-columns: repeat(4, minmax(0, 1fr));\n        gap: 5px; }\n    .graph-svg-tip.comparison li {\n      display: inline-block;\n      display: flex;\n      flex-direction: row;\n      font-weight: 600;\n      line-height: 1;\n      padding: 5px 15px 15px 15px; }\n      .graph-svg-tip.comparison li .tooltip-legend {\n        height: 12px;\n        width: 12px;\n        margin-right: 8px;\n        border-radius: 2px; }\n      .graph-svg-tip.comparison li .tooltip-label {\n        margin-top: 4px;\n        font-size: 11px;\n        line-height: 1.25;\n        max-width: 150px;\n        white-space: normal;\n        color: var(--charts-tooltip-label); }\n      .graph-svg-tip.comparison li .tooltip-value {\n        color: var(--charts-tooltip-value); }\n'),f.create=function(e,n){var r=document.createElement(e);for(var i in n){var a=n[i];if("inside"===i)f(a).appendChild(r);else if("around"===i){var o=f(a);o.parentNode.insertBefore(r,o),r.appendChild(o)}else"styles"===i?"object"===t(a)&&Object.keys(a).map(function(e){r.style[e]=a[e]}):i in r?r[i]=a:r.setAttribute(i,a)}return r};var y={margins:{top:10,bottom:10,left:20,right:20},paddings:{top:20,bottom:40,left:30,right:10},baseHeight:240,titleHeight:20,legendHeight:30,titleFontSize:12};function b(e){return e.titleHeight+e.margins.top+e.paddings.top}function x(e){return e.margins.left+e.paddings.left}function k(e){return e.margins.top+e.margins.bottom+e.paddings.top+e.paddings.bottom+e.titleHeight+e.legendHeight}function w(e){return e.margins.left+e.margins.right+e.paddings.left+e.paddings.right}var A=["pink","blue","green","grey","red","yellow","purple","teal","cyan","orange"],D={bar:A,line:A,pie:A,percentage:A,heatmap:["#ebedf0","#c6e48b","#7bc96f","#239a3b","#196127"],donut:A},L=Math.PI/180,M=function(){function t(n){var r=n.parent,i=void 0===r?null:r,a=n.colors,o=void 0===a?[]:a;e(this,t),this.parent=i,this.colors=o,this.titleName="",this.titleValue="",this.listValues=[],this.titleValueFirst=0,this.x=0,this.y=0,this.top=0,this.left=0,this.setup()}return i(t,[{key:"setup",value:function(){this.makeTooltip()}},{key:"refresh",value:function(){this.fill(),this.calcPosition()}},{key:"makeTooltip",value:function(){var e=this;this.container=f.create("div",{inside:this.parent,className:"graph-svg-tip comparison",innerHTML:'<span class="title"></span>\n\t\t\t\t<ul class="data-point-list"></ul>\n\t\t\t\t<div class="svg-pointer"></div>'}),this.hideTip(),this.title=this.container.querySelector(".title"),this.list=this.container.querySelector(".data-point-list"),this.dataPointList=this.container.querySelector(".data-point-list"),this.parent.addEventListener("mouseleave",function(){e.hideTip()})}},{key:"fill",value:function(){var e,t=this;this.index&&this.container.setAttribute("data-point-index",this.index),e=this.titleValueFirst?"<strong>".concat(this.titleValue,"</strong>").concat(this.titleName):"".concat(this.titleName,"<strong>").concat(this.titleValue,"</strong>"),this.listValues.length>4?this.list.classList.add("tooltip-grid"):this.list.classList.remove("tooltip-grid"),this.title.innerHTML=e,this.dataPointList.innerHTML="",this.listValues.map(function(e,n){var r=t.colors[n]||"black",i=0===e.formatted||e.formatted?e.formatted:e.value,a=f.create("li",{innerHTML:'<div class="tooltip-legend" style="background: '.concat(r,';"></div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div class="tooltip-value">').concat(0===i||i?i:"",'</div>\n\t\t\t\t\t\t<div class="tooltip-label">').concat(e.title?e.title:"","</div>\n\t\t\t\t\t</div>")});t.dataPointList.appendChild(a)})}},{key:"calcPosition",value:function(){var e=this.container.offsetWidth;this.top=this.y-this.container.offsetHeight-7.48,this.left=this.x-e/2;var t=this.parent.offsetWidth-e,n=this.container.querySelector(".svg-pointer");if(this.left<0)n.style.left="calc(50% - ".concat(-1*this.left,"px)"),this.left=0;else if(this.left>t){var r=this.left-t,i="calc(50% + ".concat(r,"px)");n.style.left=i,this.left=t}else n.style.left="50%"}},{key:"setValues",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1;this.titleName=n.name,this.titleValue=n.value,this.listValues=r,this.x=e,this.y=t,this.titleValueFirst=n.valueFirst||0,this.index=i,this.refresh()}},{key:"hideTip",value:function(){this.container.style.top="0px",this.container.style.left="0px",this.container.style.opacity="0"}},{key:"showTip",value:function(){this.container.style.top=this.top+"px",this.container.style.left=this.left+"px",this.container.style.opacity="1"}}]),t}();function T(e){return parseFloat(e.toFixed(2))}function C(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n||(n=r?e[0]:e[e.length-1]);var i=new Array(Math.abs(t)).fill(n);return r?i.concat(e):e.concat(i)}function P(e,t){return(e+"").length*t}function N(e,t){return{x:Math.sin(e*L)*t,y:Math.cos(e*L)*t}}function E(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!(Number.isNaN(e)||void 0===e||!Number.isFinite(e)||t&&e<0)}function O(e){return Number(Math.round(e+"e4")+"e-4")}function S(e){var n,r,i;if(e instanceof Date)return new Date(e.getTime());if("object"!==t(e)||null===e)return e;for(i in n=Array.isArray(e)?[]:{},e)r=e[i],n[i]=S(r);return n}function F(e,t){var n,r;return e<=t?(n=t-e,r=e):(n=e-t,r=t),[n,r]}function z(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.length-e.length;return n>0?e=C(e,n):t=C(t,n),[e,t]}function H(e,t){if(e)return e.length>t?e.slice(0,t-3)+"...":e}function R(e){var t;if("number"==typeof e)t=e;else if("string"==typeof e&&(t=Number(e),Number.isNaN(t)))return e;var n=Math.floor(Math.log10(Math.abs(t)));if(n<=2)return t;var r=Math.floor(n/3),i=Math.pow(10,n-3*r)*+(t/Math.pow(10,n)).toFixed(1);return Math.round(100*i)/100+" "+["","K","M","B","T"][r]}function W(e,t){for(var n=[],r=0;r<e.length;r++)n.push([e[r],t[r]]);var i=function(e,t,n,r){var i,a,o,s,l=(i=t||e,o=(a=n||e)[0]-i[0],s=a[1]-i[1],{length:Math.sqrt(Math.pow(o,2)+Math.pow(s,2)),angle:Math.atan2(s,o)}),c=l.angle+(r?Math.PI:0),d=.2*l.length;return[e[0]+Math.cos(c)*d,e[1]+Math.sin(c)*d]};return function(e,t){return n.reduce(function(e,n,r,i){return 0===r?"".concat(n[0],",").concat(n[1]):"".concat(e," ").concat(t(n,r,i))},"")}(0,function(e,t,n){var r=i(n[t-1],n[t-2],e),a=i(e,n[t-1],n[t+1],!0);return"C ".concat(r[0],",").concat(r[1]," ").concat(a[0],",").concat(a[1]," ").concat(e[0],",").concat(e[1])})}function j(e,t){return"string"==typeof e?(t||document).querySelector(e):e||null}function I(e,n){var r=document.createElementNS("http://www.w3.org/2000/svg",e);for(var i in n){var a=n[i];if("inside"===i)j(a).appendChild(r);else if("around"===i){var o=j(a);o.parentNode.insertBefore(r,o),r.appendChild(o)}else"styles"===i?"object"===t(a)&&Object.keys(a).map(function(e){r.style[e]=a[e]}):("className"===i&&(i="class"),"innerHTML"===i?r.textContent=a:r.setAttribute(i,a))}return r}function B(e,t){return I("linearGradient",{inside:e,id:t,x1:0,x2:0,y1:0,y2:1})}function Y(e,t,n,r){return I("stop",{inside:e,style:"stop-color: ".concat(n),offset:t,"stop-opacity":r})}function V(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r={className:e,transform:t};return n&&(r.inside=n),I("g",r)}function U(e){return I("path",{className:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",d:e,styles:{stroke:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"none",fill:arguments.length>3&&void 0!==arguments[3]?arguments[3]:"none","stroke-width":arguments.length>4&&void 0!==arguments[4]?arguments[4]:2}})}function q(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=n.x+e.x,s=n.y+e.y,l=n.x+t.x,c=n.y+t.y;return"M".concat(n.x," ").concat(n.y,"\n\t\tL").concat(o," ").concat(s,"\n\t\tA ").concat(r," ").concat(r," 0 ").concat(a," ").concat(i?1:0,"\n\t\t").concat(l," ").concat(c," z")}function G(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=n.x+e.x,s=n.y+e.y,l=n.x+t.x,c=2*n.y,d=n.y+t.y;return"M".concat(n.x," ").concat(n.y,"\n\t\tL").concat(o," ").concat(s,"\n\t\tA ").concat(r," ").concat(r," 0 ").concat(a," ").concat(i?1:0,"\n\t\t").concat(l," ").concat(c," z\n\t\tL").concat(o," ").concat(c,"\n\t\tA ").concat(r," ").concat(r," 0 ").concat(a," ").concat(i?1:0,"\n\t\t").concat(l," ").concat(d," z")}function _(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=n.x+e.x,s=n.y+e.y,l=n.x+t.x,c=n.y+t.y;return"M".concat(o," ").concat(s,"\n\t\tA ").concat(r," ").concat(r," 0 ").concat(a," ").concat(i?1:0,"\n\t\t").concat(l," ").concat(c)}function X(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=n.x+e.x,s=n.y+e.y,l=n.x+t.x,c=2*r+s,d=n.y+e.y;return"M".concat(o," ").concat(s,"\n\t\tA ").concat(r," ").concat(r," 0 ").concat(a," ").concat(i?1:0,"\n\t\t").concat(l," ").concat(c,"\n\t\tM").concat(o," ").concat(c,"\n\t\tA ").concat(r," ").concat(r," 0 ").concat(a," ").concat(i?1:0,"\n\t\t").concat(l," ").concat(d)}function J(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="path-fill-gradient-"+t+"-"+(n?"lighter":"default"),i=B(e,r),a=[1,.6,.2];return n&&(a=[.4,.05,0]),Y(i,"0%",t,a[0]),Y(i,"50%",t,a[1]),Y(i,"100%",t,a[2]),r}function K(e,t,n){var r=n/2,i=t-r;return"M".concat(e,",0 h").concat(i," q").concat(r,",0 ").concat(r,",").concat(r," q0,").concat(r," -").concat(r,",").concat(r," h-").concat(i," v").concat(n,"z")}function $$1(e,t,n){var r=n/2,i=t-r;return"M".concat(e+r,",0 h").concat(i," v").concat(n," h-").concat(i," q-").concat(r,", 0 -").concat(r,",-").concat(r," q0,-").concat(r," ").concat(r,",-").concat(r,"z")}function Q(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"none",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},s={className:e,x:t,y:n,width:r,height:r,rx:i,fill:a};return Object.keys(o).map(function(e){s[e]=o[e]}),I("rect",s)}function Z(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"none",a=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;s||(s=10);var l={className:"legend-dot",x:0,y:4-n,height:n,width:n,rx:r,fill:i},c=I("text",{className:"legend-dataset-label",x:n,y:0,dx:s+"px",dy:s/3+"px","font-size":1.6*s+"px","text-anchor":"start",innerHTML:a=arguments.length>8&&void 0!==arguments[8]&&arguments[8]?H(a,18):a}),d=null;o&&(d=I("text",{className:"legend-dataset-value",x:n,y:20,dx:"10px",dy:10/3+"px","font-size":"12px","text-anchor":"start",innerHTML:o}));var u=I("g",{transform:"translate(".concat(e,", ").concat(t,")")});return u.appendChild(I("rect",l)),u.appendChild(c),o&&d&&u.appendChild(d),u}function tt(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=i.fontSize||10;return I("text",{className:e,x:t,y:n,dy:(void 0!==i.dy?i.dy:a/2)+"px","font-size":a+"px",fill:i.fill||"var(--charts-label-color)","text-anchor":i.textAnchor||"start",innerHTML:r})}function et(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=I("line",{className:"line-vertical "+i.className,x1:0,x2:0,y1:n,y2:r,styles:{stroke:i.stroke}}),o=I("text",{x:0,y:n>r?n+4:n-4-10,dy:"10px","font-size":"10px","text-anchor":"middle",innerHTML:t+""}),s=I("g",{transform:"translate(".concat(e,", 0)")});return s.appendChild(a),s.appendChild(o),s}function nt(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};i.lineType||(i.lineType=""),i.shortenNumbers&&(t=R(t));var a=I("line",{className:"line-horizontal "+i.className+("dashed"===i.lineType?"dashed":""),x1:n,x2:r,y1:0,y2:0,styles:{stroke:i.stroke}}),o=I("text",{x:n<r?n-4:n+4,y:0,dy:"3px","font-size":"10px","text-anchor":n<r?"end":"start",innerHTML:t+""}),s=I("g",{transform:"translate(0, ".concat(e,")"),"stroke-opacity":1});return 0!==o&&"0"!==o||(s.style.stroke="rgba(27, 31, 35, 0.6)"),s.appendChild(a),s.appendChild(o),s}var it={bar:function(e){var t;"rect"!==e.nodeName&&(t=e.getAttribute("transform"),e=e.childNodes[0]);var n=e.cloneNode();return n.style.fill="#000000",n.style.opacity="0.4",t&&n.setAttribute("transform",t),n},dot:function(e){var t;"circle"!==e.nodeName&&(t=e.getAttribute("transform"),e=e.childNodes[0]);var n=e.cloneNode(),r=e.getAttribute("r"),i=e.getAttribute("fill");return n.setAttribute("r",parseInt(r)+4),n.setAttribute("fill",i),n.style.opacity="0.6",t&&n.setAttribute("transform",t),n},heat_square:function(e){var t;"circle"!==e.nodeName&&(t=e.getAttribute("transform"),e=e.childNodes[0]);var n=e.cloneNode(),r=e.getAttribute("r"),i=e.getAttribute("fill");return n.setAttribute("r",parseInt(r)+4),n.setAttribute("fill",i),n.style.opacity="0.6",t&&n.setAttribute("transform",t),n}},at={bar:function(e,t){var n;"rect"!==e.nodeName&&(n=e.getAttribute("transform"),e=e.childNodes[0]);var r=["x","y","width","height"];Object.values(e.attributes).filter(function(e){return r.includes(e.name)&&e.specified}).map(function(e){t.setAttribute(e.name,e.nodeValue)}),n&&t.setAttribute("transform",n)},dot:function(e,t){var n;"circle"!==e.nodeName&&(n=e.getAttribute("transform"),e=e.childNodes[0]);var r=["cx","cy"];Object.values(e.attributes).filter(function(e){return r.includes(e.name)&&e.specified}).map(function(e){t.setAttribute(e.name,e.nodeValue)}),n&&t.setAttribute("transform",n)},heat_square:function(e,t){var n;"circle"!==e.nodeName&&(n=e.getAttribute("transform"),e=e.childNodes[0]);var r=["cx","cy"];Object.values(e.attributes).filter(function(e){return r.includes(e.name)&&e.specified}).map(function(e){t.setAttribute(e.name,e.nodeValue)}),n&&t.setAttribute("transform",n)}},st={pink:"#F683AE",blue:"#318AD8",green:"#48BB74",grey:"#A6B1B9",red:"#F56B6B",yellow:"#FACF7A",purple:"#44427B",teal:"#5FD8C4",cyan:"#15CCEF",orange:"#F8814F","light-pink":"#FED7E5","light-blue":"#BFDDF7","light-green":"#48BB74","light-grey":"#F4F5F6","light-red":"#F6DFDF","light-yellow":"#FEE9BF","light-purple":"#E8E8F7","light-teal":"#D3FDF6","light-cyan":"#DDF8FD","light-orange":"#FECDB8"};function rt(e,t,n,r){var i="string"==typeof t?t:t.join(", ");return[e,{transform:n.join(", ")},r,"easein","translate",{transform:i}]}function ot(e,t,n){return rt(e,[0,n],[0,t],350)}function lt(e,t){return[e,{d:t},350,"easein"]}var ct={ease:"0.25 0.1 0.25 1",linear:"0 0 1 1",easein:"0.1 0.8 0.2 1",easeout:"0 0 0.58 1",easeinout:"0.42 0 0.58 1"};function ut(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"linear",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.cloneNode(!0),s=e.cloneNode(!0);for(var l in t){var c=void 0;c="transform"===l?document.createElementNS("http://www.w3.org/2000/svg","animateTransform"):document.createElementNS("http://www.w3.org/2000/svg","animate");var d=a[l]||e.getAttribute(l),u=t[l],p={attributeName:l,from:d,to:u,begin:"0s",dur:n/1e3+"s",values:d+";"+u,keySplines:ct[r],keyTimes:"0;1",calcMode:"spline",fill:"freeze"};for(var f in i&&(p.type=i),p)c.setAttribute(f,p[f]);o.appendChild(c),i?s.setAttribute(l,"translate(".concat(u,")")):s.setAttribute(l,u)}return[o,s]}function ht(e,t){e.style.transform=t,e.style.webkitTransform=t,e.style.msTransform=t,e.style.mozTransform=t,e.style.oTransform=t}function dt(e,t){var n=[],r=[];t.map(function(e){var t,i,a=e[0],o=a.parentNode;e[0]=a;var s=u(ut.apply(void 0,h(e)),2);t=s[0],i=s[1],n.push(i),r.push([t,o]),o.replaceChild(t,a)});var i=e.cloneNode(!0);return r.map(function(e,r){e[1].replaceChild(n[r],e[0]),t[r][0]=n[r]}),i}function pt(e,t,n){if(0!==n.length){var r=dt(t,n);t.parentNode==e&&(e.removeChild(t),e.appendChild(r)),setTimeout(function(){r.parentNode==e&&(e.removeChild(r),e.appendChild(t))},250)}}var ft=function(){function t(n,r){if(e(this,t),r=S(r),this.parent="string"==typeof n?document.querySelector(n):n,!(this.parent instanceof HTMLElement))throw new Error("No `parent` element to render on was provided.");this.rawChartArgs=r,this.title=r.title||"",this.type=r.type||"",this.realData=this.prepareData(r.data),this.data=this.prepareFirstData(this.realData),this.colors=this.validateColors(r.colors,this.type),this.config={showTooltip:1,showLegend:void 0!==r.showLegend?r.showLegend:1,isNavigable:r.isNavigable||0,animate:void 0!==r.animate?r.animate:1,truncateLegends:r.truncateLegends||1},this.measures=JSON.parse(JSON.stringify(y));var i=this.measures;this.setMeasures(r),this.title.length||(i.titleHeight=0),this.config.showLegend||(i.legendHeight=0),this.argHeight=r.height||i.baseHeight,this.state={},this.options={},this.initTimeout=700,this.config.isNavigable&&(this.overlays=[]),this.configure(r)}return i(t,[{key:"prepareData",value:function(e){return e}},{key:"prepareFirstData",value:function(e){return e}},{key:"validateColors",value:function(e,t){var n=[];return(e=(e||[]).concat(D[t])).forEach(function(e){var t=function(e){return/rgb[a]{0,1}\([\d, ]+\)/gim.test(e)?/\D+(\d*)\D+(\d*)\D+(\d*)/gim.exec(e).map(function(e,t){return 0!==t?Number(e).toString(16):"#"}).reduce(function(e,t){return"".concat(e).concat(t)}):st[e]||e}(e);!function(e){return/(^\s*)(#)((?:[A-Fa-f0-9]{3}){1,2})$/i.test(e)||/(^\s*)(rgb|hsl)(a?)[(]\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*(?:,\s*([\d.]+)\s*)?[)]$/i.test(e)}(t)?console.warn('"'+e+'" is not a valid color.'):n.push(t)}),n}},{key:"setMeasures",value:function(){}},{key:"configure",value:function(){var e=this,t=this.argHeight;this.baseHeight=t,this.height=t-k(this.measures),this.boundDrawFn=function(){return e.draw(!0)},ResizeObserver&&(this.resizeObserver=new ResizeObserver(this.boundDrawFn),this.resizeObserver.observe(this.parent)),window.addEventListener("resize",this.boundDrawFn),window.addEventListener("orientationchange",this.boundDrawFn)}},{key:"destroy",value:function(){this.resizeObserver&&this.resizeObserver.disconnect(),window.removeEventListener("resize",this.boundDrawFn),window.removeEventListener("orientationchange",this.boundDrawFn)}},{key:"setup",value:function(){this.makeContainer(),this.updateWidth(),this.makeTooltip(),this.draw(!1,!0)}},{key:"makeContainer",value:function(){this.parent.innerHTML="";var e={inside:this.parent,className:"chart-container"};this.independentWidth&&(e.styles={width:this.independentWidth+"px"}),this.container=f.create("div",e)}},{key:"makeTooltip",value:function(){this.tip=new M({parent:this.container,colors:this.colors}),this.bindTooltip()}},{key:"bindTooltip",value:function(){}},{key:"draw",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t&&g(this.parent)||(this.updateWidth(),this.calc(t),this.makeChartArea(),this.setupComponents(),this.components.forEach(function(t){return t.setup(e.drawArea)}),this.render(this.components,!1),n&&(this.data=this.realData,setTimeout(function(){e.update(e.data,!0)},this.initTimeout)),this.config.showLegend&&this.renderLegend(),this.setupNavigation(n))}},{key:"calc",value:function(){}},{key:"updateWidth",value:function(){var e,t,n;this.baseWidth=(e=this.parent,t=window.getComputedStyle(e),n=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),e.clientWidth-n),this.width=this.baseWidth-w(this.measures)}},{key:"makeChartArea",value:function(){this.svg&&this.container.removeChild(this.svg);var e=this.measures;this.svg=("frappe-chart chart",I("svg",{className:"frappe-chart chart",inside:this.container,width:this.baseWidth,height:this.baseHeight})),this.svgDefs=I("defs",{inside:this.svg}),this.title.length&&(this.titleEL=tt("title",e.margins.left,e.margins.top,this.title,{fontSize:e.titleFontSize,fill:"#666666",dy:e.titleFontSize}));var t=b(e);this.drawArea=V(this.type+"-chart chart-draw-area","translate(".concat(x(e),", ").concat(t,")")),this.config.showLegend&&(t+=this.height+e.paddings.bottom,this.legendArea=V("chart-legend","translate(".concat(x(e),", ").concat(t,")"))),this.title.length&&this.svg.appendChild(this.titleEL),this.svg.appendChild(this.drawArea),this.config.showLegend&&this.svg.appendChild(this.legendArea),this.updateTipOffset(x(e),b(e))}},{key:"updateTipOffset",value:function(e,t){this.tip.offset={x:e,y:t}}},{key:"setupComponents",value:function(){this.components=new Map}},{key:"update",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e||console.error("No data to update."),t||(e=S(e)),this.data=this.prepareData(e),this.calc(),this.render(this.components,this.config.animate)}},{key:"render",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.components,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.config.isNavigable&&this.overlays.map(function(e){return e.parentNode.removeChild(e)});var r=[];t.forEach(function(e){r=r.concat(e.update(n))}),r.length>0?(pt(this.container,this.svg,r),setTimeout(function(){t.forEach(function(e){return e.make()}),e.updateNav()},400)):(t.forEach(function(e){return e.make()}),this.updateNav())}},{key:"updateNav",value:function(){this.config.isNavigable&&(this.makeOverlay(),this.bindUnits())}},{key:"renderLegend",value:function(e){var t=this;this.legendArea.textContent="";var n=0,r=0;e.map(function(e,i){var a=Math.floor(t.width/150);n>a&&(n=0,r+=t.config.legendRowHeight);var o=150*n,s=t.makeLegend(e,i,o,r);t.legendArea.appendChild(s),n++})}},{key:"makeLegend",value:function(){}},{key:"setupNavigation",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.config.isNavigable&&t&&(this.bindOverlay(),this.keyActions={13:this.onEnterKey.bind(this),37:this.onLeftArrow.bind(this),38:this.onUpArrow.bind(this),39:this.onRightArrow.bind(this),40:this.onDownArrow.bind(this)},document.addEventListener("keydown",function(t){m(e.container)&&(t=t||window.event,e.keyActions[t.keyCode]&&e.keyActions[t.keyCode]())}))}},{key:"makeOverlay",value:function(){}},{key:"updateOverlay",value:function(){}},{key:"bindOverlay",value:function(){}},{key:"bindUnits",value:function(){}},{key:"onLeftArrow",value:function(){}},{key:"onRightArrow",value:function(){}},{key:"onUpArrow",value:function(){}},{key:"onDownArrow",value:function(){}},{key:"onEnterKey",value:function(){}},{key:"addDataPoint",value:function(){}},{key:"removeDataPoint",value:function(){}},{key:"getDataPoint",value:function(){}},{key:"setCurrentDataPoint",value:function(){}},{key:"updateDataset",value:function(){}},{key:"export",value:function(){var e=function(e){var t=e.cloneNode(!0);t.classList.add("chart-container"),t.setAttribute("xmlns","http://www.w3.org/2000/svg"),t.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");var n=f.create("style",{innerHTML:".chart-container{position:relative;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif}.chart-container .axis,.chart-container .chart-label{fill:#555b51}.chart-container .axis line,.chart-container .chart-label line{stroke:#dadada}.chart-container .dataset-units circle{stroke:#fff;stroke-width:2}.chart-container .dataset-units path{fill:none;stroke-opacity:1;stroke-width:2px}.chart-container .dataset-path{stroke-width:2px}.chart-container .path-group path{fill:none;stroke-opacity:1;stroke-width:2px}.chart-container line.dashed{stroke-dasharray:5,3}.chart-container .axis-line .specific-value{text-anchor:start}.chart-container .axis-line .y-line{text-anchor:end}.chart-container .axis-line .x-line{text-anchor:middle}.chart-container .legend-dataset-text{fill:#6c7680;font-weight:600}.graph-svg-tip{position:absolute;z-index:99999;padding:10px;font-size:12px;color:#959da5;text-align:center;background:rgba(0,0,0,.8);border-radius:3px}.graph-svg-tip ul{padding-left:0;display:flex}.graph-svg-tip ol{padding-left:0;display:flex}.graph-svg-tip ul.data-point-list li{min-width:90px;flex:1;font-weight:600}.graph-svg-tip strong{color:#dfe2e5;font-weight:600}.graph-svg-tip .svg-pointer{position:absolute;height:5px;margin:0 0 0 -5px;content:' ';border:5px solid transparent;}.graph-svg-tip.comparison{padding:0;text-align:left;pointer-events:none}.graph-svg-tip.comparison .title{display:block;padding:10px;margin:0;font-weight:600;line-height:1;pointer-events:none}.graph-svg-tip.comparison ul{margin:0;white-space:nowrap;list-style:none}.graph-svg-tip.comparison li{display:inline-block;padding:5px 10px}"});t.insertBefore(n,t.firstChild);var r=f.create("div");return r.appendChild(t),r.innerHTML}(this.svg);!function(e,t){var n=document.createElement("a");n.style="display: none";var r=new Blob(t,{type:"image/svg+xml; charset=utf-8"}),i=window.URL.createObjectURL(r);n.href=i,n.download=e,document.body.appendChild(n),n.click(),setTimeout(function(){document.body.removeChild(n),window.URL.revokeObjectURL(i)},300)}(this.title||"Chart",[e])}}]),t}(),vt=function(t){a(r,ft);var n=l(r);function r(t,i){return e(this,r),n.call(this,t,i)}return i(r,[{key:"configure",value:function(e){c(s(r.prototype),"configure",this).call(this,e),this.config.formatTooltipY=(e.tooltipOptions||{}).formatTooltipY,this.config.maxSlices=e.maxSlices||20,this.config.maxLegendPoints=e.maxLegendPoints||20,this.config.legendRowHeight=60}},{key:"calc",value:function(){var e=this,t=this.state,n=this.config.maxSlices;t.sliceTotals=[];var r=this.data.labels.map(function(t,n){var r=0;return e.data.datasets.map(function(e){r+=e.values[n]}),[r,t]}).filter(function(e){return e[0]>=0}),i=r;if(r.length>n){r.sort(function(e,t){return t[0]-e[0]}),i=r.slice(0,n-1);var a=r.slice(n-1),o=0;a.map(function(e){o+=e[0]}),i.push([o,"Rest"]),this.colors[n-1]="grey"}t.labels=[],i.map(function(e){t.sliceTotals.push(O(e[0])),t.labels.push(e[1])}),t.grandTotal=t.sliceTotals.reduce(function(e,t){return e+t},0),this.center={x:this.width/2,y:this.height/2}}},{key:"renderLegend",value:function(){var e=this.state;this.legendArea.textContent="",this.legendTotals=e.sliceTotals.slice(0,this.config.maxLegendPoints),c(s(r.prototype),"renderLegend",this).call(this,this.legendTotals)}},{key:"makeLegend",value:function(e,t,n,r){var i=this.config.formatTooltipY?this.config.formatTooltipY(e):e;return Z(n,r,12,3,this.colors[t],this.state.labels[t],i,null,this.config.truncateLegends)}}]),r}(),gt=["January","February","March","April","May","June","July","August","September","October","November","December"],mt=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function yt(e){var t=new Date(e);return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t}function bt(e){var t=e.getDate(),n=e.getMonth()+1;return[e.getFullYear(),(n>9?"":"0")+n,(t>9?"":"0")+t].join("-")}function xt(e){return new Date(e.getTime())}function kt(e,t){var n=Lt(e);return Math.ceil(function(e,t){return(yt(t)-yt(e))/864e5}(n,t)/7)}function wt(e,t){return e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}function At(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=gt[e];return t?n.slice(0,3):n}function Dt(e,t){return new Date(t,e+1,0)}function Lt(e){var t=xt(e),n=t.getDay();return 0!==n&&Mt(t,-1*n),t}function Mt(e,t){e.setDate(e.getDate()+t)}var Tt=function(){function t(n){var r=n.layerClass,i=void 0===r?"":r,a=n.layerTransform,o=void 0===a?"":a,s=n.constants,l=n.getData,c=n.makeElements,d=n.animateElements;e(this,t),this.layerTransform=o,this.constants=s,this.makeElements=c,this.getData=l,this.animateElements=d,this.store=[],this.labels=[],this.layerClass=i,this.layerClass="function"==typeof this.layerClass?this.layerClass():this.layerClass,this.refresh()}return i(t,[{key:"refresh",value:function(e){this.data=e||this.getData()}},{key:"setup",value:function(e){this.layer=V(this.layerClass,this.layerTransform,e)}},{key:"make",value:function(){this.render(this.data),this.oldData=this.data}},{key:"render",value:function(e){var t=this;this.store=this.makeElements(e),this.layer.textContent="",this.store.forEach(function(e){t.layer.appendChild(e)}),this.labels.forEach(function(e){t.layer.appendChild(e)})}},{key:"update",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.refresh();var t=[];return e&&(t=this.animateElements(this.data)||[]),t}}]),t}(),Ct={donutSlices:{layerClass:"donut-slices",makeElements:function(e){return e.sliceStrings.map(function(t,n){var r=U(t,"donut-path",e.colors[n],"none",e.strokeWidth);return r.style.transition="transform .3s;",r})},animateElements:function(e){return this.store.map(function(t,n){return lt(t,e.sliceStrings[n])})}},pieSlices:{layerClass:"pie-slices",makeElements:function(e){return e.sliceStrings.map(function(t,n){var r=U(t,"pie-path","none",e.colors[n]);return r.style.transition="transform .3s;",r})},animateElements:function(e){return this.store.map(function(t,n){return lt(t,e.sliceStrings[n])})}},percentageBars:{layerClass:"percentage-bars",makeElements:function(e){var t=this,n=e.xPositions.length;return e.xPositions.map(function(r,i){var a=i==n-1,o=0==i;return function(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"none";return a?U(K(e,n,r),"percentage-bar",null,o):i?U($$1(e,n,r),"percentage-bar",null,o):I("rect",{className:"percentage-bar",x:e,y:0,width:n,height:r,fill:o})}(r,0,e.widths[i],t.constants.barHeight,o,a,e.colors[i])})},animateElements:function(e){if(e)return[]}},yAxis:{layerClass:"y axis",makeElements:function(e){var t=this;return e.positions.map(function(n,r){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};E(e)||(e=0),r.pos||(r.pos="left"),r.offset||(r.offset=0),r.mode||(r.mode="span"),r.stroke||(r.stroke="#E2E6E9"),r.className||(r.className="");var i=-6,a="span"===r.mode?n+6:0;return"tick"===r.mode&&"right"===r.pos&&(i=n+6,a=n),i+=r.offset,a+=r.offset,"number"==typeof t&&(t=O(t)),nt(e,t,i,a,{className:r.className,lineType:r.lineType,shortenNumbers:r.shortenNumbers})}(n,e.labels[r],t.constants.width,{mode:t.constants.mode,pos:t.constants.pos,shortenNumbers:t.constants.shortenNumbers})})},animateElements:function(e){var t=e.positions,n=e.labels,r=this.oldData.positions,i=this.oldData.labels,a=u(z(r,t),2);r=a[0],t=a[1];var o=u(z(i,n),2);return i=o[0],n=o[1],this.render({positions:r,labels:n}),this.store.map(function(e,n){return ot(e,t[n],r[n])})}},xAxis:{layerClass:"x axis",makeElements:function(e){var t=this;return e.positions.map(function(n,r){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};E(e)||(e=0),r.pos||(r.pos="bottom"),r.offset||(r.offset=0),r.mode||(r.mode="span"),r.className||(r.className="");var i=n+6,a="span"===r.mode?-6:n;return"tick"===r.mode&&"top"===r.pos&&(i=-6,a=0),et(e,t,i,a,{className:r.className,lineType:r.lineType})}(n,e.calcLabels[r],t.constants.height,{mode:t.constants.mode,pos:t.constants.pos})})},animateElements:function(e){var t=e.positions,n=e.calcLabels,r=this.oldData.positions,i=this.oldData.calcLabels,a=u(z(r,t),2);r=a[0],t=a[1];var o=u(z(i,n),2);return i=o[0],n=o[1],this.render({positions:r,calcLabels:n}),this.store.map(function(e,n){return function(e,t,n){return rt(e,[n,0],[t,0],350)}(e,t[n],r[n])})}},yMarkers:{layerClass:"y-markers",makeElements:function(e){var t=this;return e.map(function(e){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};E(e)||(e=0),r.labelPos||(r.labelPos="right"),r.lineType||(r.lineType="dashed");var i=I("text",{className:"chart-label",x:"left"===r.labelPos?4:n-P(t,5)-4,y:0,dy:"-5px","font-size":"10px","text-anchor":"start",innerHTML:t+""}),a=nt(e,"",0,n,{stroke:r.stroke||"#E2E6E9",className:r.className||"",lineType:r.lineType});return a.appendChild(i),a}(e.position,e.label,t.constants.width,{labelPos:e.options.labelPos,stroke:e.options.stroke,mode:"span",lineType:e.options.lineType})})},animateElements:function(e){var t=u(z(this.oldData,e),2);this.oldData=t[0];var n=(e=t[1]).map(function(e){return e.position}),r=e.map(function(e){return e.label}),i=e.map(function(e){return e.options}),a=this.oldData.map(function(e){return e.position});return this.render(a.map(function(e,t){return{position:a[t],label:r[t],options:i[t]}})),this.store.map(function(e,t){return ot(e,n[t],a[t])})}},yRegions:{layerClass:"y-regions",makeElements:function(e){var t=this;return e.map(function(e){return function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=e-t,o=I("rect",{className:"bar mini",styles:{fill:i.fill||"rgba(228, 234, 239, 0.49)",stroke:i.stroke||"#E2E6E9","stroke-dasharray":"".concat(n,", ").concat(a)},x:0,y:0,width:n,height:a});i.labelPos||(i.labelPos="right");var s=I("text",{className:"chart-label",x:"left"===i.labelPos?4:n-P(r+"",4.5)-4,y:0,dy:"-5px","font-size":"10px","text-anchor":"start",innerHTML:r+""}),l=I("g",{transform:"translate(0, ".concat(t,")")});return l.appendChild(o),l.appendChild(s),l}(e.startPos,e.endPos,t.constants.width,e.label,{labelPos:e.options.labelPos,stroke:e.options.stroke,fill:e.options.fill})})},animateElements:function(e){var t=u(z(this.oldData,e),2);this.oldData=t[0];var n=(e=t[1]).map(function(e){return e.endPos}),r=e.map(function(e){return e.label}),i=e.map(function(e){return e.startPos}),a=e.map(function(e){return e.options}),o=this.oldData.map(function(e){return e.endPos}),s=this.oldData.map(function(e){return e.startPos});this.render(o.map(function(e,t){return{startPos:s[t],endPos:o[t],label:r[t],options:a[t]}}));var l=[];return this.store.map(function(e,t){l=l.concat(function(e,t,n,r){var i=t-n,a=e.childNodes[0],o=a.getAttribute("width");return[[a,{height:i,"stroke-dasharray":"".concat(o,", ").concat(i)},350,"easein"],rt(e,[0,r],[0,n],350)]}(e,i[t],n[t],o[t]))}),l}},heatDomain:{layerClass:function(){return"heat-domain domain-"+this.constants.index},makeElements:function(e){var t=this,n=this.constants,r=n.index,i=n.colWidth,a=n.rowHeight,o=n.squareSize,s=n.radius,l=n.xTranslate,c=0;return this.serializedSubDomains=[],e.cols.map(function(e,n){1===n&&t.labels.push(tt("domain-name",l,-12,At(r,!0).toUpperCase(),{fontSize:9})),e.map(function(e,n){if(e.fill){var r={"data-date":e.yyyyMmDd,"data-value":e.dataValue,"data-day":n},i=Q("day",l,c,o,s,e.fill,r);t.serializedSubDomains.push(i)}c+=a}),c=0,l+=i}),this.serializedSubDomains},animateElements:function(e){if(e)return[]}},barGraph:{layerClass:function(){return"dataset-units dataset-bars dataset-"+this.constants.index},makeElements:function(e){var t=this.constants;return this.unitType="bar",this.units=e.yPositions.map(function(n,r){return function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},l=u(F(t,s.zeroLine),2),c=l[0],d=l[1];d-=o,0===c&&(c=s.minHeight,d-=s.minHeight),E(e)||(e=0),E(d)||(d=0),E(c,!0)||(c=0),E(n,!0)||(n=0);var p=I("rect",{className:"bar mini",style:"fill: ".concat(r),"data-point-index":a,x:e,y:d,width:n,height:c});if((i+="")||i.length){p.setAttribute("y",0),p.setAttribute("x",0);var f=I("text",{className:"data-point-value",x:n/2,y:0,dy:"-5px","font-size":"10px","text-anchor":"middle",innerHTML:i}),h=I("g",{"data-point-index":a,transform:"translate(".concat(e,", ").concat(d,")")});return h.appendChild(p),h.appendChild(f),h}return p}(e.xPositions[r],n,e.barWidth,t.color,e.labels[r],r,e.offsets[r],{zeroLine:e.zeroLine,barsWidth:e.barsWidth,minHeight:t.minHeight})}),this.units},animateElements:function(e){var t=e.xPositions,n=e.yPositions,r=e.offsets,i=e.labels,a=this.oldData.xPositions,o=this.oldData.yPositions,s=this.oldData.offsets,l=this.oldData.labels,c=u(z(a,t),2);a=c[0],t=c[1];var d=u(z(o,n),2);o=d[0],n=d[1];var p=u(z(s,r),2);s=p[0],r=p[1];var f=u(z(l,i),2);l=f[0],i=f[1],this.render({xPositions:a,yPositions:o,offsets:s,labels:i,zeroLine:this.oldData.zeroLine,barsWidth:this.oldData.barsWidth,barWidth:this.oldData.barWidth});var h=[];return this.store.map(function(i,a){h=h.concat(function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=u(F(n,(arguments.length>5&&void 0!==arguments[5]?arguments[5]:{}).zeroLine),2),o=a[0],s=a[1];if(s-=i,"rect"!==e.nodeName){var l=[e.childNodes[0],{width:r,height:o},350,"easein"],c=e.getAttribute("transform").split("(")[1].slice(0,-1);return[l,rt(e,c,[t,s],350)]}return[[e,{width:r,height:o,x:t,y:s},350,"easein"]]}(i,t[a],n[a],e.barWidth,r[a],{zeroLine:e.zeroLine}))}),h}},lineGraph:{layerClass:function(){return"dataset-units dataset-line dataset-"+this.constants.index},makeElements:function(e){var t=this.constants;return this.unitType="dot",this.paths={},t.hideLine||(this.paths=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=t.map(function(t,n){return e[n]+","+t}).join("L");r.spline&&(a=W(e,t));var o=U("M"+a,"line-graph-path",n);if(r.heatline){var s=J(i.svgDefs,n);o.style.stroke="url(#".concat(s,")")}var l={path:o};if(r.regionFill){var c=J(i.svgDefs,n,!0),d="M"+"".concat(e[0],",").concat(i.zeroLine,"L")+a+"L".concat(e.slice(-1)[0],",").concat(i.zeroLine);l.region=U(d,"region-fill","none","url(#".concat(c,")"))}return l}(e.xPositions,e.yPositions,t.color,{heatline:t.heatline,regionFill:t.regionFill,spline:t.spline},{svgDefs:t.svgDefs,zeroLine:e.zeroLine})),this.units=[],t.showDots&&(this.units=e.yPositions.map(function(n,r){return function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=I("circle",{style:"fill: ".concat(r),"data-point-index":a,cx:e,cy:t,r:n});if((i+="")||i.length){o.setAttribute("cy",0),o.setAttribute("cx",0);var s=I("text",{className:"data-point-value",x:0,y:0,dy:-5-n+"px","font-size":"10px","text-anchor":"middle",innerHTML:i}),l=I("g",{"data-point-index":a,transform:"translate(".concat(e,", ").concat(t,")")});return l.appendChild(o),l.appendChild(s),l}return o}(e.xPositions[r],n,e.radius,t.color,t.valuesOverPoints?e.values[r]:"",r)})),Object.values(this.paths).concat(this.units)},animateElements:function(e){var t=e.xPositions,n=e.yPositions,r=e.values,i=this.oldData.xPositions,a=this.oldData.yPositions,o=this.oldData.values,s=u(z(i,t),2);i=s[0],t=s[1];var l=u(z(a,n),2);a=l[0],n=l[1];var c=u(z(o,r),2);o=c[0],r=c[1],this.render({xPositions:i,yPositions:a,values:r,zeroLine:this.oldData.zeroLine,radius:this.oldData.radius});var d=[];return Object.keys(this.paths).length&&(d=d.concat(function(e,t,n,r,i){var a=[],o=n.map(function(e,n){return t[n]+","+e}).join("L");i&&(o=W(t,n));var s=[e.path,{d:"M"+o},350,"easein"];if(a.push(s),e.region){var l="".concat(t[0],",").concat(r,"L"),c="L".concat(t.slice(-1)[0],", ").concat(r),d=[e.region,{d:"M"+l+o+c},350,"easein"];a.push(d)}return a}(this.paths,t,n,e.zeroLine,this.constants.spline))),this.units.length&&this.units.map(function(e,r){d=d.concat(function(e,t,n){if("circle"!==e.nodeName){var r=e.getAttribute("transform").split("(")[1].slice(0,-1);return[rt(e,r,[t,n],350)]}return[[e,{cx:t,cy:n},350,"easein"]]}(e,t[r],n[r]))}),d}}};function Pt(e,t,n){var r=Object.keys(Ct).filter(function(t){return e.includes(t)}),i=Ct[r[0]];return Object.assign(i,{constants:t,getData:n}),new Tt(i)}var Nt=function(t){a(r,vt);var n=l(r);function r(t,i){var a;return e(this,r),(a=n.call(this,t,i)).type="percentage",a.setup(),a}return i(r,[{key:"setMeasures",value:function(e){var t=this.measures;this.barOptions=e.barOptions||{};var n=this.barOptions;n.height=n.height||16,t.paddings.right=30,t.paddings.top=60,t.paddings.bottom=0,t.legendHeight=80,t.baseHeight=8*n.height+k(t)}},{key:"setupComponents",value:function(){var e=this.state,t=[["percentageBars",{barHeight:this.barOptions.height},function(){return{xPositions:e.xPositions,widths:e.widths,colors:this.colors}}.bind(this)]];this.components=new Map(t.map(function(e){var t=Pt.apply(void 0,h(e));return[e[0],t]}))}},{key:"calc",value:function(){var e=this;c(s(r.prototype),"calc",this).call(this);var t=this.state;t.xPositions=[],t.widths=[];var n=0;t.sliceTotals.map(function(r){var i=e.width*r/t.grandTotal;t.widths.push(i),t.xPositions.push(n),n+=i})}},{key:"makeDataByIndex",value:function(){}},{key:"bindTooltip",value:function(){var e=this,t=this.state;this.container.addEventListener("mousemove",function(n){var r=e.components.get("percentageBars").store,i=n.target;if(r.includes(i)){var a=r.indexOf(i),o=v(e.container),s=v(i),l=i.getAttribute("width")||i.getBoundingClientRect().width,c=s.left-o.left+parseInt(l)/2,d=s.top-o.top,u=(e.formattedLabels&&e.formattedLabels.length>0?e.formattedLabels[a]:e.state.labels[a])+": ",p=t.sliceTotals[a]/t.grandTotal;e.tip.setValues(c,d,{name:u,value:(100*p).toFixed(1)+"%"}),e.tip.showTip()}})}}]),r}(),Et=function(t){a(r,vt);var n=l(r);function r(t,i){var a;return e(this,r),(a=n.call(this,t,i)).initTimeout=0,a.init=1,a.setup(),a}return i(r,[{key:"configure",value:function(e){c(s(r.prototype),"configure",this).call(this,e),this.mouseMove=this.mouseMove.bind(this),this.mouseLeave=this.mouseLeave.bind(this),this.hoverRadio=e.hoverRadio||.1,this.config.startAngle=e.startAngle||0,this.type="pie",this.sliceName="pieSlices",this.arcFunc=q,this.shapeFunc=G,this.clockWise=e.clockWise||!1}},{key:"getRadius",value:function(){return this.height>this.width?this.center.x:this.center.y}},{key:"calc",value:function(){var e=this;c(s(r.prototype),"calc",this).call(this);var t=this.state;this.radius=this.getRadius();var n=this.radius,i=this.clockWise,a=t.slicesProperties||[];t.sliceStrings=[],t.slicesProperties=[];var o=180-this.config.startAngle;t.sliceTotals.map(function(r,s){var l,c,d=o,u=r/t.grandTotal*360,p=u>180?1:0,f=i?-u:u,h=o+=f,_=N(d,n),m=N(h,n),g=e.init&&a[s];e.init?(l=g?g.startPosition:_,c=g?g.endPosition:_):(l=_,c=m);var v=360===u?e.shapeFunc(l,c,e.center,e.radius,i,p):e.arcFunc(l,c,e.center,e.radius,i,p);t.sliceStrings.push(v),t.slicesProperties.push({startPosition:_,endPosition:m,value:r,total:t.grandTotal,startAngle:d,endAngle:h,angle:f})}),this.init=0}},{key:"setupComponents",value:function(){var e=this.state,t=[["pieSlices",{},function(){return{sliceStrings:e.sliceStrings,colors:this.colors}}.bind(this)]];this.components=new Map(t.map(function(e){var t=Pt.apply(void 0,h(e));return[e[0],t]}))}},{key:"calTranslateByAngle",value:function(e){var t=this.radius,n=this.hoverRadio,r=N(e.startAngle+e.angle/2,t);return"translate3d(".concat(r.x*n,"px,").concat(r.y*n,"px,0)")}},{key:"hoverSlice",value:function(e,t,n,r){if(e){var i=this.colors[t];if(n){ht(e,this.calTranslateByAngle(this.state.slicesProperties[t]));var a=v(this.svg),o=r.pageX-a.left+10,s=r.pageY-a.top-10,l=(this.formatted_labels&&this.formatted_labels.length>0?this.formatted_labels[t]:this.state.labels[t])+": ",c=(100*this.state.sliceTotals[t]/this.state.grandTotal).toFixed(1);this.tip.setValues(o,s,{name:l,value:c+"%"}),this.tip.showTip()}else this.resetHover(e,i)}}},{key:"resetHover",value:function(e,t){ht(e,"translate3d(0,0,0)"),this.tip.hideTip(),e.style.fill=t}},{key:"bindTooltip",value:function(){this.container.addEventListener("mousemove",this.mouseMove),this.container.addEventListener("mouseleave",this.mouseLeave)}},{key:"mouseMove",value:function(e){var t=e.target,n=this.components.get(this.sliceName).store,r=this.curActiveSliceIndex,i=this.curActiveSlice;if(n.includes(t)){var a=n.indexOf(t);this.hoverSlice(i,r,!1),this.curActiveSlice=t,this.curActiveSliceIndex=a,this.hoverSlice(t,a,!0,e)}else this.mouseLeave()}},{key:"mouseLeave",value:function(){this.hoverSlice(this.curActiveSlice,this.curActiveSliceIndex,!1)}}]),r}();function Ot(e){if(0===e)return[0,0];if(isNaN(e))return{mantissa:-6755399441055744,exponent:972};var t=e>0?1:-1;if(!isFinite(e))return{mantissa:4503599627370496*t,exponent:972};e=Math.abs(e);var n=Math.floor(Math.log10(e));return[t*(e/Math.pow(10,n)),n]}function St(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Math.ceil(e),r=Math.floor(t),i=n-r,a=i,o=1;i>5&&(i%2!=0&&(i=++n-r),a=i/2,o=2),i<=2&&(o=i/(a=4)),0===i&&(a=5,o=1);for(var s=[],l=0;l<=a;l++)s.push(r+o*l);return s}function Ft(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=u(Ot(e),2),r=n[0],i=n[1],a=t?t/Math.pow(10,i):0,o=St(r=r.toFixed(6),a);return o.map(function(e){return e*Math.pow(10,i)})}function zt(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Math.max.apply(Math,h(e)),r=Math.min.apply(Math,h(e)),i=[];function a(e,t){for(var n=Ft(e),r=n[1]-n[0],i=0,a=1;i<t;a++)i+=r,n.unshift(-1*i);return n}if(n>=0&&r>=0)Ot(n)[1],i=t?Ft(n,r):Ft(n);else if(n>0&&r<0){var o=Math.abs(r);if(n>=o)Ot(n)[1],i=a(n,o);else Ot(o)[1],i=a(o,n).reverse().map(function(e){return-1*e})}else if(n<=0&&r<=0){var s=Math.abs(r),l=Math.abs(n);Ot(s)[1],i=(i=t?Ft(s,l):Ft(s)).reverse().map(function(e){return-1*e})}return i}function Ht(e){var t=Rt(e);return e.indexOf(0)>=0?e.indexOf(0):e[0]>0?-1*e[0]/t:-1*e[e.length-1]/t+(e.length-1)}function Rt(e){return e[1]-e[0]}function Wt(e){return e[e.length-1]-e[0]}function jt(e,t){return T(t.zeroLine-e*t.scaleMultiplier)}var It=function(t){a(r,ft);var n=l(r);function r(t,i){var a;e(this,r),(a=n.call(this,t,i)).type="heatmap",a.countLabel=i.countLabel||"";var o=["Sunday","Monday"],s=o.includes(i.startSubDomain)?i.startSubDomain:"Sunday";return a.startSubDomainIndex=o.indexOf(s),a.setup(),a}return i(r,[{key:"setMeasures",value:function(e){var t=this.measures;this.discreteDomains=0===e.discreteDomains?0:1,t.paddings.top=36,t.paddings.bottom=0,t.legendHeight=24,t.baseHeight=84+k(t);var n=this.data,r=this.discreteDomains?12:0;this.independentWidth=12*(kt(n.start,n.end)+r)+w(t)}},{key:"updateWidth",value:function(){var e=this.discreteDomains?12:0,t=this.state.noOfWeeks?this.state.noOfWeeks:52;this.baseWidth=12*(t+e)+w(this.measures)}},{key:"prepareData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.data;if(e.start&&e.end&&e.start>e.end)throw new Error("Start date cannot be greater than end date.");if(e.start||(e.start=new Date,e.start.setFullYear(e.start.getFullYear()-1)),e.end||(e.end=new Date),e.dataPoints=e.dataPoints||{},parseInt(Object.keys(e.dataPoints)[0])>1e5){var t={};Object.keys(e.dataPoints).forEach(function(n){var r=new Date(1e3*n);t[bt(r)]=e.dataPoints[n]}),e.dataPoints=t}return e}},{key:"calc",value:function(){var e=this.state;e.start=xt(this.data.start),e.end=xt(this.data.end),e.firstWeekStart=xt(e.start),e.noOfWeeks=kt(e.start,e.end),e.distribution=function(e,t){for(var n=Math.max.apply(Math,h(e)),r=[],i=0;i<5;i++){var a=n*(.25*i);r.push(a)}return r}(Object.values(this.data.dataPoints)),e.domainConfigs=this.getDomains()}},{key:"setupComponents",value:function(){var e=this,t=this.state,n=this.discreteDomains?0:1,r=t.domainConfigs.map(function(r,i){return["heatDomain",{index:r.index,colWidth:12,rowHeight:12,squareSize:10,radius:e.rawChartArgs.radius||0,xTranslate:12*t.domainConfigs.filter(function(e,t){return t<i}).map(function(e){return e.cols.length-n}).reduce(function(e,t){return e+t},0)},function(){return t.domainConfigs[i]}.bind(e)]});this.components=new Map(r.map(function(e,t){var n=Pt.apply(void 0,h(e));return[e[0]+"-"+t,n]}));var i=0;mt.forEach(function(t,n){if([1,3,5].includes(n)){var r=tt("subdomain-name",-6,i,t,{fontSize:10,dy:8,textAnchor:"end"});e.drawArea.appendChild(r)}i+=12})}},{key:"update",value:function(e){e||console.error("No data to update."),this.data=this.prepareData(e),this.draw(),this.bindTooltip()}},{key:"bindTooltip",value:function(){var e=this;this.container.addEventListener("mousemove",function(t){e.components.forEach(function(n){var r=n.store,i=t.target;if(r.includes(i)){var a=i.getAttribute("data-value"),o=i.getAttribute("data-date").split("-"),s=At(parseInt(o[1])-1,!0),l=e.container.getBoundingClientRect(),c=i.getBoundingClientRect(),d=parseInt(t.target.getAttribute("width")),u=c.left-l.left+d/2,p=c.top-l.top,f=a+" "+e.countLabel,h=" on "+s+" "+o[0]+", "+o[2];e.tip.setValues(u,p,{name:h,value:f,valueFirst:1},[]),e.tip.showTip()}})})}},{key:"renderLegend",value:function(){var e=this;this.legendArea.textContent="";var t=0,n=this.rawChartArgs.radius||0,r=tt("subdomain-name",t,12,"Less",{fontSize:11,dy:9});t=30,this.legendArea.appendChild(r),this.colors.slice(0,5).map(function(r,i){var a=Q("heatmap-legend-unit",t+15*i,12,10,n,r);e.legendArea.appendChild(a)});var i=tt("subdomain-name",t+75+3,12,"More",{fontSize:11,dy:9});this.legendArea.appendChild(i)}},{key:"getDomains",value:function(){for(var e=this.state,t=[e.start.getMonth(),e.start.getFullYear()],n=t[0],r=t[1],i=[e.end.getMonth(),e.end.getFullYear()],a=i[0]-n+1+12*(i[1]-r),o=[],s=xt(e.start),l=0;l<a;l++){var c=e.end;if(!wt(s,e.end)){var d=[s.getMonth(),s.getFullYear()];c=Dt(d[0],d[1])}o.push(this.getDomainConfig(s,c)),Mt(c,1),s=c}return o}},{key:"getDomainConfig",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=[e.getMonth(),e.getFullYear()],r=n[0],i=n[1],a=Lt(e),o={index:r,cols:[]};Mt(t=xt(t)||Dt(r,i),1);for(var s,l=kt(a,t),c=[],d=0;d<l;d++)s=this.getCol(a,r),c.push(s),Mt(a=new Date(s[6].yyyyMmDd),1);return void 0!==s[6].dataValue&&(Mt(a,1),c.push(this.getCol(a,r,!0))),o.cols=c,o}},{key:"getCol",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.state,i=xt(e),a=[],o=0;o<7;o++,Mt(i,1)){var s={},l=i>=r.start&&i<=r.end;n||i.getMonth()!==t||!l?s.yyyyMmDd=bt(i):s=this.getSubDomainConfig(i),a.push(s)}return a}},{key:"getSubDomainConfig",value:function(e){var t,n,r=bt(e),i=this.data.dataPoints[r];return{yyyyMmDd:r,dataValue:i||0,fill:this.colors[(t=i,n=this.state.distribution,n.filter(function(e){return e<t}).length)]}}}]),r}();function Bt(e,t){e.labels=e.labels||[];var n=e.labels.length,r=e.datasets,i=new Array(n).fill(0);return r||(r=[{values:i}]),r.map(function(e){if(e.values){var r=e.values;r=(r=r.map(function(e){return isNaN(e)?0:e})).length>n?r.slice(0,n):C(r,n-r.length,0)}else e.values=i;e.chartType||(e.chartType=t)}),e.yRegions&&e.yRegions.map(function(e){if(e.end<e.start){var t=[e.end,e.start];e.start=t[0],e.end=t[1]}}),e}function Yt(e){var t=e.labels.length,n=new Array(t).fill(0),r={labels:e.labels.slice(0,-1),datasets:e.datasets.map(function(e){return{name:"",values:n.slice(0,-1),chartType:e.chartType}})};return e.yMarkers&&(r.yMarkers=[{value:0,label:""}]),e.yRegions&&(r.yRegions=[{start:0,end:0,label:""}]),r}var Vt=function(t){a(r,ft);var n=l(r);function r(t,i){var a;return e(this,r),(a=n.call(this,t,i)).barOptions=i.barOptions||{},a.lineOptions=i.lineOptions||{},a.type=i.type||"line",a.init=1,a.setup(),a}return i(r,[{key:"setMeasures",value:function(){this.data.datasets.length<=1&&(this.config.showLegend=0,this.measures.paddings.bottom=30)}},{key:"configure",value:function(e){c(s(r.prototype),"configure",this).call(this,e),e.axisOptions=e.axisOptions||{},e.tooltipOptions=e.tooltipOptions||{},this.config.xAxisMode=e.axisOptions.xAxisMode||"span",this.config.yAxisMode=e.axisOptions.yAxisMode||"span",this.config.xIsSeries=e.axisOptions.xIsSeries||0,this.config.shortenYAxisNumbers=e.axisOptions.shortenYAxisNumbers||0,this.config.formatTooltipX=e.tooltipOptions.formatTooltipX,this.config.formatTooltipY=e.tooltipOptions.formatTooltipY,this.config.valuesOverPoints=e.valuesOverPoints,this.config.legendRowHeight=30}},{key:"prepareData",value:function(){return Bt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.data,this.type)}},{key:"prepareFirstData",value:function(){return Yt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.data)}},{key:"calc",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.calcXPositions(),e||this.calcYAxisParameters(this.getAllYValues(),"line"===this.type),this.makeDataByIndex()}},{key:"calcXPositions",value:function(){var e=this.state,t=this.data.labels;e.datasetLength=t.length,e.unitWidth=this.width/e.datasetLength,e.xOffset=e.unitWidth/2,e.xAxis={labels:t,positions:t.map(function(t,n){return T(e.xOffset+n*e.unitWidth)})}}},{key:"calcYAxisParameters",value:function(e){var t=zt(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"false"),n=this.height/Wt(t),r=Rt(t)*n,i=this.height-Ht(t)*r;this.state.yAxis={labels:t,positions:t.map(function(e){return i-e*n}),scaleMultiplier:n,zeroLine:i},this.calcDatasetPoints(),this.calcYExtremes(),this.calcYRegions()}},{key:"calcDatasetPoints",value:function(){var e=this.state,t=function(t){return t.map(function(t){return jt(t,e.yAxis)})};e.datasets=this.data.datasets.map(function(e,n){var r=e.values,i=e.cumulativeYs||[];return{name:e.name&&e.name.replace(/<|>|&/g,function(e){return"&"==e?"&amp;":"<"==e?"&lt;":"&gt;"}),index:n,chartType:e.chartType,values:r,yPositions:t(r),cumulativeYs:i,cumulativeYPos:t(i)}})}},{key:"calcYExtremes",value:function(){var e=this.state;this.barOptions.stacked?e.yExtremes=e.datasets[e.datasets.length-1].cumulativeYPos:(e.yExtremes=new Array(e.datasetLength).fill(9999),e.datasets.map(function(t){t.yPositions.map(function(t,n){t<e.yExtremes[n]&&(e.yExtremes[n]=t)})}))}},{key:"calcYRegions",value:function(){var e=this.state;this.data.yMarkers&&(this.state.yMarkers=this.data.yMarkers.map(function(t){return t.position=jt(t.value,e.yAxis),t.options||(t.options={}),t})),this.data.yRegions&&(this.state.yRegions=this.data.yRegions.map(function(t){return t.startPos=jt(t.start,e.yAxis),t.endPos=jt(t.end,e.yAxis),t.options||(t.options={}),t}))}},{key:"getAllYValues",value:function(){var e,t=this,n="values";if(this.barOptions.stacked){n="cumulativeYs";var r=new Array(this.state.datasetLength).fill(0);this.data.datasets.map(function(e,i){var a=t.data.datasets[i].values;e[n]=r=r.map(function(e,t){return e+a[t]})})}var i=this.data.datasets.map(function(e){return e[n]});return this.data.yMarkers&&i.push(this.data.yMarkers.map(function(e){return e.value})),this.data.yRegions&&this.data.yRegions.map(function(e){i.push([e.end,e.start])}),(e=[]).concat.apply(e,h(i))}},{key:"setupComponents",value:function(){var e=this,t=[["yAxis",{mode:this.config.yAxisMode,width:this.width,shortenNumbers:this.config.shortenYAxisNumbers},function(){return this.state.yAxis}.bind(this)],["xAxis",{mode:this.config.xAxisMode,height:this.height},function(){var e=this.state;return e.xAxis.calcLabels=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e/t.length*.6;r<=0&&(r=1);var i,a=r/7;if(n){var o=Math.max.apply(Math,h(t.map(function(e){return e.length})));i=Math.ceil(o/a)}return t.map(function(e,r){return(e+="").length>a&&(n?r%i!=0&&r!==t.length-1&&(e=""):e=a-3>0?e.slice(0,a-3)+" ...":e.slice(0,a)+".."),e})}(this.width,e.xAxis.labels,this.config.xIsSeries),e.xAxis}.bind(this)],["yRegions",{width:this.width,pos:"right"},function(){return this.state.yRegions}.bind(this)]],n=this.state.datasets.filter(function(e){return"bar"===e.chartType}),r=this.state.datasets.filter(function(e){return"line"===e.chartType}),i=n.map(function(t){var r=t.index;return["barGraph-"+t.index,{index:r,color:e.colors[r],stacked:e.barOptions.stacked,valuesOverPoints:e.config.valuesOverPoints,minHeight:0*e.height},function(){var e=this.state,t=e.datasets[r],i=this.barOptions.stacked,a=this.barOptions.spaceRatio||.5,o=e.unitWidth*(1-a),s=o/(i?1:n.length),l=e.xAxis.positions.map(function(e){return e-o/2});i||(l=l.map(function(e){return e+s*r}));var c=new Array(e.datasetLength).fill("");this.config.valuesOverPoints&&(c=i&&t.index===e.datasets.length-1?t.cumulativeYs:t.values);var d=new Array(e.datasetLength).fill(0);return i&&(d=t.yPositions.map(function(e,n){return e-t.cumulativeYPos[n]})),{xPositions:l,yPositions:t.yPositions,offsets:d,labels:c,zeroLine:e.yAxis.zeroLine,barsWidth:o,barWidth:s}}.bind(e)]}),a=r.map(function(t){var n=t.index;return["lineGraph-"+t.index,{index:n,color:e.colors[n],svgDefs:e.svgDefs,heatline:e.lineOptions.heatline,regionFill:e.lineOptions.regionFill,spline:e.lineOptions.spline,showDots:e.lineOptions.showDots,hideLine:e.lineOptions.hideLine,valuesOverPoints:e.config.valuesOverPoints},function(){var e=this.state,t=e.datasets[n],r=e.yAxis.positions[0]<e.yAxis.zeroLine?e.yAxis.positions[0]:e.yAxis.zeroLine;return{xPositions:e.xAxis.positions,yPositions:t.yPositions,values:t.values,zeroLine:r,radius:this.lineOptions.dotSize||4}}.bind(e)]}),o=[["yMarkers",{width:this.width,pos:"right"},function(){return this.state.yMarkers}.bind(this)]];t=t.concat(i,a,o);var s=["yMarkers","yRegions"];this.dataUnitComponents=[],this.components=new Map(t.filter(function(t){return!s.includes(t[0])||e.state[t[0]]}).map(function(t){var n=Pt.apply(void 0,h(t));return(t[0].includes("lineGraph")||t[0].includes("barGraph"))&&e.dataUnitComponents.push(n),[t[0],n]}))}},{key:"makeDataByIndex",value:function(){var e=this;this.dataByIndex={};var t=this.state,n=this.config.formatTooltipX,r=this.config.formatTooltipY;t.xAxis.labels.map(function(i,a){var o=e.state.datasets.map(function(t,n){var i=t.values[a];return{title:t.name,value:i,yPos:t.yPositions[a],color:e.colors[n],formatted:r?r(i):i}});e.dataByIndex[a]={label:i,formattedLabel:n?n(i):i,xPos:t.xAxis.positions[a],values:o,yExtreme:t.yExtremes[a]}})}},{key:"bindTooltip",value:function(){var e=this;this.container.addEventListener("mousemove",function(t){var n=e.measures,r=v(e.container),i=t.pageX-r.left-x(n),a=t.pageY-r.top;a<e.height+b(n)&&a>b(n)?e.mapTooltipXPosition(i):e.tip.hideTip()})}},{key:"mapTooltipXPosition",value:function(e){var t=this.state;if(t.yExtremes){var n=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t.reduce(function(t,n){return Math.abs(n-e)<Math.abs(t-e)?n:t},[]);return n?t.indexOf(r):r}(e,t.xAxis.positions,!0);if(n>=0){var r=this.dataByIndex[n];this.tip.setValues(r.xPos+this.tip.offset.x,r.yExtreme+this.tip.offset.y,{name:r.formattedLabel,value:""},r.values,n),this.tip.showTip()}}}},{key:"renderLegend",value:function(){var e=this.data;e.datasets.length>1&&c(s(r.prototype),"renderLegend",this).call(this,e.datasets)}},{key:"makeLegend",value:function(e,t,n,r){return Z(n,r+5,12,3,this.colors[t],e.name,null,8.75,this.config.truncateLegends)}},{key:"makeOverlay",value:function(){var e=this;this.init?this.init=0:(this.overlayGuides&&this.overlayGuides.forEach(function(e){var t=e.overlay;t.parentNode.removeChild(t)}),this.overlayGuides=this.dataUnitComponents.map(function(e){return{type:e.unitType,overlay:void 0,units:e.units}}),void 0===this.state.currentIndex&&(this.state.currentIndex=this.state.datasetLength-1),this.overlayGuides.map(function(t){var n=t.units[e.state.currentIndex];t.overlay=it[t.type](n),e.drawArea.appendChild(t.overlay)}))}},{key:"updateOverlayGuides",value:function(){this.overlayGuides&&this.overlayGuides.forEach(function(e){var t=e.overlay;t.parentNode.removeChild(t)})}},{key:"bindOverlay",value:function(){var e=this;this.parent.addEventListener("data-select",function(){e.updateOverlay()})}},{key:"bindUnits",value:function(){var e=this;this.dataUnitComponents.map(function(t){t.units.map(function(t){t.addEventListener("click",function(){var n=t.getAttribute("data-point-index");e.setCurrentDataPoint(n)})})}),this.tip.container.addEventListener("click",function(){var t=e.tip.container.getAttribute("data-point-index");e.setCurrentDataPoint(t)})}},{key:"updateOverlay",value:function(){var e=this;this.overlayGuides.map(function(t){var n=t.units[e.state.currentIndex];at[t.type](n,t.overlay)})}},{key:"onLeftArrow",value:function(){this.setCurrentDataPoint(this.state.currentIndex-1)}},{key:"onRightArrow",value:function(){this.setCurrentDataPoint(this.state.currentIndex+1)}},{key:"getDataPoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.currentIndex,t=this.state;return{index:e,label:t.xAxis.labels[e],values:t.datasets.map(function(t){return t.values[e]})}}},{key:"setCurrentDataPoint",value:function(e){var t=this.state;(e=parseInt(e))<0&&(e=0),e>=t.xAxis.labels.length&&(e=t.xAxis.labels.length-1),e!==t.currentIndex&&(t.currentIndex=e,function(e,t,n){var r=document.createEvent("HTMLEvents");for(var i in r.initEvent("data-select",!0,!0),n)r[i]=n[i];e.dispatchEvent(r)}(this.parent,0,this.getDataPoint()))}},{key:"addDataPoint",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.state.datasetLength;c(s(r.prototype),"addDataPoint",this).call(this,e,t,n),this.data.labels.splice(n,0,e),this.data.datasets.map(function(e,r){e.values.splice(n,0,t[r])}),this.update(this.data)}},{key:"removeDataPoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.datasetLength-1;this.data.labels.length<=1||(c(s(r.prototype),"removeDataPoint",this).call(this,e),this.data.labels.splice(e,1),this.data.datasets.map(function(t){t.values.splice(e,1)}),this.update(this.data))}},{key:"updateDataset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.data.datasets[t].values=e,this.update(this.data)}},{key:"updateDatasets",value:function(e){this.data.datasets.map(function(t,n){e[n]&&(t.values=e[n])}),this.update(this.data)}}]),r}(),Ut={bar:Vt,line:Vt,percentage:Nt,heatmap:It,pie:Et,donut:function(t){a(r,Et);var n=l(r);function r(t,i){return e(this,r),n.call(this,t,i)}return i(r,[{key:"configure",value:function(e){c(s(r.prototype),"configure",this).call(this,e),this.type="donut",this.sliceName="donutSlices",this.arcFunc=_,this.shapeFunc=X,this.strokeWidth=e.strokeWidth||30}},{key:"getRadius",value:function(){return this.height>this.width?this.center.x-this.strokeWidth/2:this.center.y-this.strokeWidth/2}},{key:"resetHover",value:function(e,t){transform(e,"translate3d(0,0,0)"),this.tip.hideTip(),e.style.stroke=t}},{key:"setupComponents",value:function(){var e=this.state,t=[[this.sliceName,{},function(){return{sliceStrings:e.sliceStrings,colors:this.colors,strokeWidth:this.strokeWidth}}.bind(this)]];this.components=new Map(t.map(function(e){var t=Pt.apply(void 0,h(e));return[e[0],t]}))}}]),r}()},qt=function t(n,r){return e(this,t),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"line",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return"axis-mixed"===e?(n.type="line",new Vt(t,n)):Ut[e]?new Ut[e](t,n):void console.error("Undefined chart type: "+e)}(r.type,n,r)};frappe.Chart=qt;var Sortable$1=createCommonjsModule(function(e){var t;t=function(){if("undefined"==typeof window||!window.document)return function(){throw new Error("Sortable.js requires a window with a document")};var e,t,n,r,i,a,o,s,l,c,d,u,p,f,h,_,m,g,v,b,y,w,k,x,C,S=[],E=!1,$=!1,T=!1,A=[],P=!1,O=!1,R=/\s+/g,I="Sortable"+(new Date).getTime(),L=window,j=L.document,N=L.parseInt,D=L.setTimeout,M=L.jQuery||L.Zepto,H=L.Polymer,F={capture:!1,passive:!1},z=!!navigator.userAgent.match(/(?:Trident.*rv[ :]?11\.|msie|iemobile)/i),U=!!navigator.userAgent.match(/Edge/i),B=U||z?"cssFloat":"float",q="draggable"in j.createElement("div"),W=function(){if(z)return!1;var e=j.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}(),G=!1,V=!1,Y=Math.abs,K=Math.min,X=[],J=function(e,t){var n=_e(e),r=N(n.width),i=ke(e,0,t),a=ke(e,1,t),o=i&&_e(i),s=a&&_e(a),l=o&&N(o.marginLeft)+N(o.marginRight)+Re(i).width,c=s&&N(s.marginLeft)+N(s.marginRight)+Re(a).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if(i&&"none"!==o.float){var d="left"===o.float?"left":"right";return!a||"both"!==s.clear&&s.clear!==d?"horizontal":"vertical"}return i&&("block"===o.display||"flex"===o.display||"table"===o.display||"grid"===o.display||l>=r&&"none"===n[B]||a&&"none"===n[B]&&l+c>r)?"vertical":"horizontal"},Q=function(e,t){if(!e||!e.getBoundingClientRect)return L;var n=e,r=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var i=_e(n);if(n.clientWidth<n.scrollWidth&&("auto"==i.overflowX||"scroll"==i.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==i.overflowY||"scroll"==i.overflowY)){if(!n||!n.getBoundingClientRect||n===j.body)return L;if(r||t)return n;r=!0}}}while(n=n.parentNode);return L},Z=$e(function(e,t,n,r){if(t.scroll){var i=n?n[I]:window,a=t.scrollSensitivity,o=t.scrollSpeed,d=e.clientX,u=e.clientY,p=(window.innerWidth,window.innerHeight,!1);l!==n&&(ee(),s=t.scroll,c=t.scrollFn,!0===s&&(s=Q(n,!0),l=s));var f=0,h=s;do{var _,m,g,b,y,w,k,x,C,$=h,T=Re($),A=T.top,P=T.bottom,O=T.left,R=T.right,N=T.width,D=T.height;if($!==L?(_=$.scrollWidth,m=$.scrollHeight,g=_e($),w=N<_&&("auto"===g.overflowX||"scroll"===g.overflowX),k=D<m&&("auto"===g.overflowY||"scroll"===g.overflowY),x=$.scrollLeft,C=$.scrollTop):(_=j.documentElement.scrollWidth,m=j.documentElement.scrollHeight,g=_e(j.documentElement),w=N<_&&("auto"===g.overflowX||"scroll"===g.overflowX||"visible"===g.overflowX),k=D<m&&("auto"===g.overflowY||"scroll"===g.overflowY||"visible"===g.overflowY),x=j.documentElement.scrollLeft,C=j.documentElement.scrollTop),b=w&&(Y(R-d)<=a&&x+N<_)-(Y(O-d)<=a&&!!x),y=k&&(Y(P-u)<=a&&C+D<m)-(Y(A-u)<=a&&!!C),!S[f])for(var M=0;M<=f;M++)S[M]||(S[M]={});S[f].vx==b&&S[f].vy==y&&S[f].el===$||(S[f].el=$,S[f].vx=b,S[f].vy=y,clearInterval(S[f].pid),!$||0==b&&0==y||(p=!0,S[f].pid=setInterval(function(){r&&0===this.layer&&ce.active._emulateDragOver(!0);var t=S[this.layer].vy?S[this.layer].vy*o:0,n=S[this.layer].vx?S[this.layer].vx*o:0;"function"==typeof c&&"continue"!==c.call(i,n,t,e,v,S[this.layer].el)||(S[this.layer].el===L?L.scrollTo(L.pageXOffset+n,L.pageYOffset+t):(S[this.layer].el.scrollTop+=t,S[this.layer].el.scrollLeft+=n))}.bind({layer:f}),24))),f++}while(t.bubbleScroll&&h!==L&&(h=Q(h,!1)));E=p}},30),ee=function(){S.forEach(function(e){clearInterval(e.pid)}),S=[]},te=function(e){function t(e,n){return function(r,i,a,o){var s=r.options.group.name&&i.options.group.name&&r.options.group.name===i.options.group.name;if(null==e&&(n||s))return!0;if(null==e||!1===e)return!1;if(n&&"clone"===e)return e;if("function"==typeof e)return t(e(r,i,a,o),n)(r,i,a,o);var l=(n?r:i).options.group.name;return!0===e||"string"==typeof e&&e===l||e.join&&e.indexOf(l)>-1}}var n={},r=e.group;r&&"object"==typeof r||(r={name:r}),n.name=r.name,n.checkPull=t(r.pull,!0),n.checkPut=t(r.put),n.revertClone=r.revertClone,e.group=n},ne=function(t){e&&e.parentNode&&e.parentNode[I]&&e.parentNode[I]._computeIsAligned(t)},re=function(e,t){for(var n=t;!n[I];)n=n.parentNode;return e===n},ie=function(e,t,n){for(var r=e.parentNode;r&&!r[I];)r=r.parentNode;r&&r[I][n](Te(t,{artificialBubble:!0}))},ae=function(){!W&&n&&_e(n,"display","none")},oe=function(){!W&&n&&_e(n,"display","")};j.addEventListener("click",function(e){if(T)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),T=!1,!1},!0);var se,le=function(t){if(t=t.touches?t.touches[0]:t,e){var n=function(e,t){for(var n=0;n<A.length;n++)if(!A[n].children.length){var r=Re(A[n]),i=A[n][I].options.emptyInsertThreshold,a=e>=r.left-i&&e<=r.right+i,o=t>=r.top-i&&t<=r.bottom+i;if(a&&o)return A[n]}}(t.clientX,t.clientY);n&&n[I]._onDragOver({clientX:t.clientX,clientY:t.clientY,target:n,rootEl:n})}};function ce(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be HTMLElement, not "+{}.toString.call(e);this.el=e,this.options=t=Te({},t),e[I]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0,draggable:/[uo]l/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return J(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,touchStartThreshold:N(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==ce.supportPointer&&("PointerEvent"in window||window.navigator&&"msPointerEnabled"in window.navigator),emptyInsertThreshold:5};for(var r in n)!(r in t)&&(t[r]=n[r]);for(var i in te(t),this)"_"===i.charAt(0)&&"function"==typeof this[i]&&(this[i]=this[i].bind(this));this.nativeDraggable=!t.forceFallback&&q,t.supportPointer?pe(e,"pointerdown",this._onTapStart):(pe(e,"mousedown",this._onTapStart),pe(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(pe(e,"dragover",this),pe(e,"dragenter",this)),A.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[])}function de(e,t,n,r){if(e){n=n||j;do{if(null!=t&&(">"===t[0]&&e.parentNode===n&&Ee(e,t.substring(1))||Ee(e,t))||r&&e===n)return e;if(e===n)break}while(e=ue(e))}return null}function ue(e){return e.host&&e!==j&&e.host.nodeType?e.host:e.parentNode}function pe(e,t,n){e.addEventListener(t,n,F)}function fe(e,t,n){e.removeEventListener(t,n,F)}function he(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var r=(" "+e.className+" ").replace(R," ").replace(" "+t+" "," ");e.className=(r+(n?" "+t:"")).replace(R," ")}}function _e(e,t,n){var r=e&&e.style;if(r){if(void 0===n)return j.defaultView&&j.defaultView.getComputedStyle?n=j.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),void 0===t?n:n[t];t in r||-1!==t.indexOf("webkit")||(t="-webkit-"+t),r[t]=n+("string"==typeof n?"":"px")}}function me(e){var t="";do{var n=_e(e,"transform");n&&"none"!==n&&(t=n+" "+t)}while(e=e.parentNode);return window.DOMMatrix?new DOMMatrix(t):window.WebKitCSSMatrix?new WebKitCSSMatrix(t):window.CSSMatrix?new CSSMatrix(t):void 0}function ge(e,t,n){if(e){var r=e.getElementsByTagName(t),i=0,a=r.length;if(n)for(;i<a;i++)n(r[i],i);return r}return[]}function ve(e,t,n,i,a,o,s,l,c){var d,u=(e=e||t[I]).options,p="on"+n.charAt(0).toUpperCase()+n.substr(1);!window.CustomEvent||z||U?(d=j.createEvent("Event")).initEvent(n,!0,!0):d=new CustomEvent(n,{bubbles:!0,cancelable:!0}),d.to=a||t,d.from=o||t,d.item=i||t,d.clone=r,d.oldIndex=s,d.newIndex=l,d.originalEvent=c,t&&t.dispatchEvent(d),u[p]&&u[p].call(e,d)}function be(e,t,n,r,i,a,o,s){var l,c,d=e[I],u=d.options.onMove;return!window.CustomEvent||z||U?(l=j.createEvent("Event")).initEvent("move",!0,!0):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=t,l.from=e,l.dragged=n,l.draggedRect=r,l.related=i||t,l.relatedRect=a||Re(t),l.willInsertAfter=s,l.originalEvent=o,e.dispatchEvent(l),u&&(c=u.call(d,l,o)),c}function ye(e){e.draggable=!1}function we(){G=!1}function ke(t,r,i){for(var a=0,o=0,s=t.children;o<s.length;){if("none"!==s[o].style.display&&s[o]!==n&&s[o]!==e&&de(s[o],i.draggable,t,!1)){if(a===r)return s[o];a++}o++}return null}function xe(e){for(var t=e.lastElementChild;(t===n||"none"===t.style.display)&&(t=t.previousElementSibling););return t||null}function Ce(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,r=0;n--;)r+=t.charCodeAt(n);return r.toString(36)}function Se(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e&&(e=e.previousElementSibling);)"TEMPLATE"!==e.nodeName.toUpperCase()&&e!==r&&n++;return n}function Ee(e,t){if(e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return!1}return!1}function $e(e,t){return function(){if(!se){var n=arguments,r=this;se=D(function(){1===n.length?e.call(r,n[0]):e.apply(r,n),se=void 0},t)}}}function Te(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function Ae(e){return H&&H.dom?H.dom(e).cloneNode(!0):M?M(e).clone(!0)[0]:e.cloneNode(!0)}function Pe(e){return D(e,0)}function Oe(e){return clearTimeout(e)}function Re(e,t,n){if(e.getBoundingClientRect||e===L){var r,i,a,o,s,l,c;if(e!==L?(i=(r=e.getBoundingClientRect()).top,a=r.left,o=r.bottom,s=r.right,l=r.height,c=r.width):(i=0,a=0,o=window.innerHeight,s=window.innerWidth,l=window.innerHeight,c=window.innerWidth),n&&e!==L){if(t=t||e.parentNode,!z)do{if(t&&t.getBoundingClientRect&&"none"!==_e(t,"transform")){var d=t.getBoundingClientRect();i-=d.top+N(_e(t,"border-top-width")),a-=d.left+N(_e(t,"border-left-width")),o=i+r.height,s=a+r.width;break}}while(t=t.parentNode);var u=me(e),p=u&&u.a,f=u&&u.d;u&&(o=(i/=f)+(l/=f),s=(a/=p)+(c/=p))}return{top:i,left:a,bottom:o,right:s,width:c,height:l}}}return pe(j,"dragover",le),pe(j,"mousemove",le),pe(j,"touchmove",le),ce.prototype={constructor:ce,_computeIsAligned:function(t){var r;if(n&&!W?(ae(),r=j.elementFromPoint(t.clientX,t.clientY),oe()):r=t.target,r=de(r,this.options.draggable,this.el,!1),!V&&e&&e.parentNode===this.el){for(var i,a,o,s,l,c,d,u,p=this.el.children,f=0;f<p.length;f++)de(p[f],this.options.draggable,this.el,!1)&&p[f]!==r&&(p[f].sortableMouseAligned=(i=t.clientX,a=t.clientY,o=p[f],s=this._getDirection(t,null),this.options,l=void 0,c=void 0,d=void 0,u=void 0,l=Re(o),c="vertical"===s?l.left:l.top,d="vertical"===s?l.right:l.bottom,c<(u="vertical"===s?i:a)&&u<d));de(r,this.options.draggable,this.el,!0)||(y=null),V=!0,D(function(){V=!1},30)}},_getDirection:function(t,n){return"function"==typeof this.options.direction?this.options.direction.call(this,t,n,e):this.options.direction},_onTapStart:function(t){if(t.cancelable){var n,r=this,i=this.el,a=this.options,s=a.preventOnFilter,l=t.type,c=t.touches&&t.touches[0],d=(c||t).target,u=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||d,p=a.filter;if(function(e){X.length=0;var t=e.getElementsByTagName("input"),n=t.length;for(;n--;){var r=t[n];r.checked&&X.push(r)}}(i),(!z||t.artificialBubble||re(i,d))&&!e&&!(/mousedown|pointerdown/.test(l)&&0!==t.button||a.disabled||u.isContentEditable))if(d=de(d,a.draggable,i,!1)){if(o!==d){if(n=Se(d,a.draggable),"function"==typeof p){if(p.call(this,t,d,this))return ve(r,u,"filter",d,i,i,n),void(s&&t.cancelable&&t.preventDefault())}else if(p&&(p=p.split(",").some(function(e){if(e=de(u,e.trim(),i,!1))return ve(r,e,"filter",d,i,i,n),!0})))return void(s&&t.cancelable&&t.preventDefault());a.handle&&!de(u,a.handle,i,!1)||this._prepareDragStart(t,c,d,n)}}else z&&ie(i,t,"_onTapStart")}},_handleAutoScroll:function(t,n){if(e&&this.options.scroll){var r=t.clientX,i=t.clientY,a=j.elementFromPoint(r,i),o=this;if(n||U||z){Z(t,o.options,a,n);var s=Q(a,!0);!E||h&&r===_&&i===m||(h&&clearInterval(h),h=setInterval(function(){if(e){var a=Q(j.elementFromPoint(r,i),!0);a!==s&&(s=a,ee(),Z(t,o.options,s,n))}},10),_=r,m=i)}else{if(!o.options.bubbleScroll||Q(a,!0)===window)return void ee();Z(t,o.options,Q(a,!1),!1)}}},_prepareDragStart:function(n,r,s,l){var c,u=this,f=u.el,h=u.options,_=f.ownerDocument;s&&!e&&s.parentNode===f&&(i=f,t=(e=s).parentNode,a=e.nextSibling,o=s,p=h.group,d=l,g={target:e,clientX:(r||n).clientX,clientY:(r||n).clientY},this._lastX=(r||n).clientX,this._lastY=(r||n).clientY,e.style["will-change"]="all",e.style.transition="",e.style.transform="",c=function(){u._disableDelayedDrag(),e.draggable=u.nativeDraggable,u._triggerDragStart(n,r),ve(u,i,"choose",e,i,i,d),he(e,h.chosenClass,!0)},h.ignore.split(",").forEach(function(t){ge(e,t.trim(),ye)}),h.supportPointer?pe(_,"pointerup",u._onDrop):(pe(_,"mouseup",u._onDrop),pe(_,"touchend",u._onDrop),pe(_,"touchcancel",u._onDrop)),h.delay?(pe(_,"mouseup",u._disableDelayedDrag),pe(_,"touchend",u._disableDelayedDrag),pe(_,"touchcancel",u._disableDelayedDrag),pe(_,"mousemove",u._delayedDragTouchMoveHandler),pe(_,"touchmove",u._delayedDragTouchMoveHandler),h.supportPointer&&pe(_,"pointermove",u._delayedDragTouchMoveHandler),u._dragStartTimer=D(c,h.delay)):c())},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;K(Y(t.clientX-this._lastX),Y(t.clientY-this._lastY))>=this.options.touchStartThreshold&&this._disableDelayedDrag()},_disableDelayedDrag:function(){var e=this.el.ownerDocument;clearTimeout(this._dragStartTimer),fe(e,"mouseup",this._disableDelayedDrag),fe(e,"touchend",this._disableDelayedDrag),fe(e,"touchcancel",this._disableDelayedDrag),fe(e,"mousemove",this._delayedDragTouchMoveHandler),fe(e,"touchmove",this._delayedDragTouchMoveHandler),fe(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,n){n=n||("touch"==t.pointerType?t:null),!this.nativeDraggable||n?this.options.supportPointer?pe(j,"pointermove",this._onTouchMove):pe(j,n?"touchmove":"mousemove",this._onTouchMove):(pe(e,"dragend",this),pe(i,"dragstart",this._onDragStart));try{j.selection?Pe(function(){j.selection.empty()}):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(t){if($=!1,i&&e){this.nativeDraggable&&(pe(j,"dragover",this._handleAutoScroll),pe(j,"dragover",ne));var n=this.options;!t&&he(e,n.dragClass,!1),he(e,n.ghostClass,!0),_e(e,"transform",""),ce.active=this,t&&this._appendGhost(),ve(this,i,"start",e,i,i,d)}else this._nulling()},_emulateDragOver:function(t){if(v){if(this._lastX===v.clientX&&this._lastY===v.clientY&&!t)return;this._lastX=v.clientX,this._lastY=v.clientY,ae();for(var n=j.elementFromPoint(v.clientX,v.clientY),r=n;n&&n.shadowRoot;)r=n=n.shadowRoot.elementFromPoint(v.clientX,v.clientY);if(r)do{if(r[I])if(r[I]._onDragOver({clientX:v.clientX,clientY:v.clientY,target:n,rootEl:r})&&!this.options.dragoverBubble)break;n=r}while(r=r.parentNode);e.parentNode[I]._computeIsAligned(v),oe()}},_onTouchMove:function(e){if(g){var t=this.options,r=t.fallbackTolerance,i=t.fallbackOffset,a=e.touches?e.touches[0]:e,o=n&&me(n),s=n&&o&&o.a,l=n&&o&&o.d,c=(a.clientX-g.clientX+i.x)/(s||1),d=(a.clientY-g.clientY+i.y)/(l||1),u=e.touches?"translate3d("+c+"px,"+d+"px,0)":"translate("+c+"px,"+d+"px)";if(!ce.active&&!$){if(r&&K(Y(a.clientX-this._lastX),Y(a.clientY-this._lastY))<r)return;this._onDragStart(e,!0)}this._handleAutoScroll(a,!0),b=!0,v=a,_e(n,"webkitTransform",u),_e(n,"mozTransform",u),_e(n,"msTransform",u),_e(n,"transform",u),e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!n){var t=Re(e,this.options.fallbackOnBody?j.body:i,!0),r=(_e(e),this.options);he(n=e.cloneNode(!0),r.ghostClass,!1),he(n,r.fallbackClass,!0),he(n,r.dragClass,!0),_e(n,"box-sizing","border-box"),_e(n,"margin",0),_e(n,"top",t.top),_e(n,"left",t.left),_e(n,"width",t.width),_e(n,"height",t.height),_e(n,"opacity","0.8"),_e(n,"position","fixed"),_e(n,"zIndex","100000"),_e(n,"pointerEvents","none"),r.fallbackOnBody&&j.body.appendChild(n)||i.appendChild(n)}},_onDragStart:function(t,n){var a=this,o=t.dataTransfer,s=a.options;(r=Ae(e)).draggable=!1,r.style["will-change"]="",this._hideClone(),he(r,a.options.chosenClass,!1),a._cloneId=Pe(function(){a.options.removeCloneOnHide||i.insertBefore(r,e),ve(a,i,"clone",e)}),!n&&he(e,s.dragClass,!0),n?(T=!0,a._loopId=setInterval(a._emulateDragOver,50)):(fe(j,"mouseup",a._onDrop),fe(j,"touchend",a._onDrop),fe(j,"touchcancel",a._onDrop),o&&(o.effectAllowed="move",s.setData&&s.setData.call(a,o,e)),pe(j,"drop",a),_e(e,"transform","translateZ(0)")),$=!0,a._dragStartId=Pe(a._dragStarted.bind(a,n)),pe(j,"selectstart",a)},_onDragOver:function(r){var o,s,l,c=this.el,u=r.target,h=this.options,_=h.group,m=ce.active,g=p===_,v=h.sort,S=this;if(!G&&(!z||r.rootEl||r.artificialBubble||re(c,u))){if(void 0!==r.preventDefault&&r.cancelable&&r.preventDefault(),b=!0,u=de(u,h.draggable,c,!0),de(r.target,null,e,!0)||u.animated)return q();if(u!==e&&(T=!1),m&&!h.disabled&&(g?v||(l=!i.contains(e)):f===this||(this.lastPutMode=p.checkPull(this,m,e,r))&&_.checkPut(this,m,e,r))){var $=this._getDirection(r,u);if(o=Re(e),l)return this._hideClone(),t=i,a?i.insertBefore(e,a):i.appendChild(e),q();if(0===c.children.length||c.children[0]===n||function(e,t,n){var r=Re(xe(n)),i="vertical"===t?e.clientY:e.clientX,a="vertical"===t?e.clientX:e.clientY,o="vertical"===t?r.bottom:r.right,s="vertical"===t?r.left:r.top,l="vertical"===t?r.right:r.bottom;return"vertical"===t?a>l+10||a<=l&&i>o&&a>=s:i>o&&a>s||i<=o&&a>l+10}(r,$,c)&&!e.animated){if(0!==c.children.length&&c.children[0]!==n&&c===r.target&&(u=xe(c)),u&&(s=Re(u)),g?m._hideClone():m._showClone(this),!1!==be(i,c,e,o,u,s,r,!!u))return c.appendChild(e),t=c,C=null,W(),this._animate(o,e),u&&this._animate(s,u),q()}else if(u&&u!==e&&u.parentNode===c){var A,R=0,N=u.sortableMouseAligned,M=e.parentNode!==c,H=function(e,t){var n=Q(n,!0),r=Re(e)[t];for(;n;){var i=Re(n)[t];if(!("top"===t||"left"===t?r>=i:r<=i))return!0;if(n===L)break;n=Q(n,!1)}return!1}(u,"vertical"===$?"top":"left");if(y!==u&&(k=null,A=Re(u)["vertical"===$?"top":"left"],P=!1),function(t,n,r){var i=t===e&&C||Re(t),a=n===e&&C||Re(n),o="vertical"===r?i.left:i.top,s="vertical"===r?i.right:i.bottom,l="vertical"===r?i.width:i.height,c="vertical"===r?a.left:a.top,d="vertical"===r?a.right:a.bottom,u="vertical"===r?a.width:a.height;return o===c||s===d||o+l/2===c+u/2}(e,u,$)&&N||M||H||h.invertSwap||"insert"===k||"swap"===k?("swap"!==k&&(O=h.invertSwap||M||E||H),R=function(t,n,r,i,a,o,s){var l=Re(n),c="vertical"===r?t.clientY:t.clientX,d="vertical"===r?l.height:l.width,u="vertical"===r?l.top:l.left,p="vertical"===r?l.bottom:l.right,f=Re(e),h=!1;if(!o)if(s&&x<d*i)if(!P&&(1===w?c>u+d*a/2:c<p-d*a/2)&&(P=!0),P)h=!0;else{"vertical"===r?f.top:f.left,"vertical"===r?f.bottom:f.right;if(1===w?c<u+x:c>p-x)return-1*w}else if(c>u+d*(1-i)/2&&c<p-d*(1-i)/2)return c>u+d/2?-1:1;if((h=h||o)&&(c<u+d*a/2||c>p-d*a/2))return c>u+d/2?1:-1;return 0}(r,u,$,h.swapThreshold,null==h.invertedSwapThreshold?h.swapThreshold:h.invertedSwapThreshold,O,y===u),k="swap"):(R=function(t,n){var r=Se(e,n.draggable),i=Se(t,n.draggable);return r<i?1:-1}(u,h),k="insert"),0===R)return q();C=null,y=u,w=R,s=Re(u);var F=u.nextElementSibling,U=!1,B=be(i,c,e,o,u,s,r,U=1===R);if(!1!==B)return 1!==B&&-1!==B||(U=1===B),G=!0,D(we,30),g?m._hideClone():m._showClone(this),U&&!F?c.appendChild(e):u.parentNode.insertBefore(e,U?F:u),t=e.parentNode,void 0===A||O||(x=Y(A-Re(u)["vertical"===$?"top":"left"])),W(),!M&&this._animate(s,u),this._animate(o,e),q()}if(c.contains(e))return q()}return z&&!r.rootEl&&ie(c,r,"_onDragOver"),!1}function q(){return m&&(he(e,f?f.options.ghostClass:m.options.ghostClass,!1),he(e,h.ghostClass,!0)),f!==S&&S!==ce.active?f=S:S===ce.active&&(f=null),(u===e&&!e.animated||u===c&&!u.animated)&&(y=null),h.dragoverBubble||r.rootEl||u===j||(S._handleAutoScroll(r),e.parentNode[I]._computeIsAligned(r)),!h.dragoverBubble&&r.stopPropagation&&r.stopPropagation(),!0}function W(){ve(S,i,"change",u,c,i,d,Se(e,h.draggable),r)}},_animate:function(t,n){var r=this.options.animation;if(r){var i=Re(n);if(n===e&&(C=i),1===t.nodeType&&(t=Re(t)),t.left+t.width/2!==i.left+i.width/2||t.top+t.height/2!==i.top+i.height/2){var a=me(this.el),o=a&&a.a,s=a&&a.d;_e(n,"transition","none"),_e(n,"transform","translate3d("+(t.left-i.left)/(o||1)+"px,"+(t.top-i.top)/(s||1)+"px,0)"),n.offsetWidth,_e(n,"transition","transform "+r+"ms"+(this.options.easing?" "+this.options.easing:"")),_e(n,"transform","translate3d(0,0,0)")}"number"==typeof n.animated&&clearTimeout(n.animated),n.animated=D(function(){_e(n,"transition",""),_e(n,"transform",""),n.animated=!1},r)}},_offUpEvents:function(){var e=this.el.ownerDocument;fe(j,"touchmove",this._onTouchMove),fe(j,"pointermove",this._onTouchMove),fe(e,"mouseup",this._onDrop),fe(e,"touchend",this._onDrop),fe(e,"pointerup",this._onDrop),fe(e,"touchcancel",this._onDrop),fe(j,"selectstart",this)},_onDrop:function(o){var s=this.el,l=this.options;$=!1,E=!1,O=!1,P=!1,clearInterval(this._loopId),clearInterval(h),ee(),clearTimeout(se),se=void 0,clearTimeout(this._dragStartTimer),Oe(this._cloneId),Oe(this._dragStartId),fe(j,"mousemove",this._onTouchMove),this.nativeDraggable&&(fe(j,"drop",this),fe(s,"dragstart",this._onDragStart),fe(j,"dragover",this._handleAutoScroll),fe(j,"dragover",ne)),this._offUpEvents(),o&&(b&&(o.cancelable&&o.preventDefault(),!l.dropBubble&&o.stopPropagation()),n&&n.parentNode&&n.parentNode.removeChild(n),(i===t||f&&"clone"!==f.lastPutMode)&&r&&r.parentNode&&r.parentNode.removeChild(r),e&&(this.nativeDraggable&&fe(e,"dragend",this),ye(e),e.style["will-change"]="",he(e,f?f.options.ghostClass:this.options.ghostClass,!1),he(e,this.options.chosenClass,!1),ve(this,i,"unchoose",e,t,i,d,null,o),i!==t?((u=Se(e,l.draggable))>=0&&(ve(null,t,"add",e,t,i,d,u,o),ve(this,i,"remove",e,t,i,d,u,o),ve(null,t,"sort",e,t,i,d,u,o),ve(this,i,"sort",e,t,i,d,u,o)),f&&f.save()):e.nextSibling!==a&&(u=Se(e,l.draggable))>=0&&(ve(this,i,"update",e,t,i,d,u,o),ve(this,i,"sort",e,t,i,d,u,o)),ce.active&&(null!=u&&-1!==u||(u=d),ve(this,i,"end",e,t,i,d,u,o),this.save()))),this._nulling()},_nulling:function(){i=e=t=n=a=r=o=s=l=S.length=h=_=m=g=v=b=u=d=y=w=C=f=p=ce.active=null,X.forEach(function(e){e.checked=!0}),X.length=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":e&&(this._onDragOver(t),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move");e.cancelable&&e.preventDefault()}(t));break;case"selectstart":t.preventDefault()}},toArray:function(){for(var e,t=[],n=this.el.children,r=0,i=n.length,a=this.options;r<i;r++)de(e=n[r],a.draggable,this.el,!1)&&t.push(e.getAttribute(a.dataIdAttr)||Ce(e));return t},sort:function(e){var t={},n=this.el;this.toArray().forEach(function(e,r){var i=n.children[r];de(i,this.options.draggable,n,!1)&&(t[e]=i)},this),e.forEach(function(e){t[e]&&(n.removeChild(t[e]),n.appendChild(t[e]))})},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return de(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var n=this.options;if(void 0===t)return n[e];n[e]=t,"group"===e&&te(n)},destroy:function(){var e=this.el;e[I]=null,fe(e,"mousedown",this._onTapStart),fe(e,"touchstart",this._onTapStart),fe(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(fe(e,"dragover",this),fe(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),A.splice(A.indexOf(this.el),1),this.el=e=null},_hideClone:function(){r.cloneHidden||(_e(r,"display","none"),r.cloneHidden=!0,r.parentNode&&this.options.removeCloneOnHide&&r.parentNode.removeChild(r))},_showClone:function(t){"clone"===t.lastPutMode?r.cloneHidden&&(i.contains(e)&&!this.options.group.revertClone?i.insertBefore(r,e):a?i.insertBefore(r,a):i.appendChild(r),this.options.group.revertClone&&this._animate(e,r),_e(r,"display",""),r.cloneHidden=!1):this._hideClone()}},pe(j,"touchmove",function(e){(ce.active||$)&&e.cancelable&&e.preventDefault()}),ce.utils={on:pe,off:fe,css:_e,find:ge,is:function(e,t){return!!de(e,t,e,!1)},extend:Te,throttle:$e,closest:de,toggleClass:he,clone:Ae,index:Se,nextTick:Pe,cancelNextTick:Oe,detectDirection:J,getChild:ke},ce.create=function(e,t){return new ce(e,t)},ce.version="1.8.3",ce},e.exports=t()}),Sortable$2=Object.freeze({default:Sortable$1,__moduleExports:Sortable$1}),require$$0=Sortable$2&&Sortable$1||Sortable$2,frappeDatatable_cjs=createCommonjsModule(function(e){var t,n=(t=require$$0)&&"object"==typeof t&&"default"in t?t.default:t;function r(e,t){return"string"==typeof e?(t||document).querySelector(e):e||null}r.each=function(e,t){return"string"==typeof e?Array.from((t||document).querySelectorAll(e)):e||null},r.create=function(e,t){var n=document.createElement(e),i=function(e){var i=t[e];if("inside"===e)r(i).appendChild(n);else if("around"===e){var a=r(i);a.parentNode.insertBefore(n,a),n.appendChild(a)}else"styles"===e?"object"==typeof i&&Object.keys(i).map(function(e){n.style[e]=i[e]}):e in n?n[e]=i:n.setAttribute(e,i)};for(var a in t)i(a);return n},r.on=function(e,t,n,i){i?r.delegate(e,t,n,i):(i=n,r.bind(e,t,i))},r.off=function(e,t,n){e.removeEventListener(t,n)},r.bind=function(e,t,n){t.split(/\s+/).forEach(function(t){e.addEventListener(t,n)})},r.delegate=function(e,t,n,r){e.addEventListener(t,function(e){var t=e.target.closest(n);t&&(e.delegatedTarget=t,r.call(this,e,t))})},r.unbind=function(e,t){if(e){var n=function(n){var r=t[n];n.split(/\s+/).forEach(function(t){e.removeEventListener(t,r)})};for(var r in t)n(r)}},r.fire=function(e,t,n){var r=document.createEvent("HTMLEvents");for(var i in r.initEvent(t,!0,!0),n)r[i]=n[i];return e.dispatchEvent(r)},r.data=function(e,t){if(!t)return e.dataset;for(var n in t)e.dataset[n]=t[n]},r.style=function(e,t){if("string"==typeof t)return r.getStyle(e,t);Array.isArray(e)||(e=[e]),e.map(function(e){for(var n in t)e.style[n]=t[n]})},r.removeStyle=function(e,t){Array.isArray(e)||(e=[e]),Array.isArray(t)||(t=[t]),e.map(function(e){for(var n=0,r=t;n<r.length;n+=1){var i=r[n];e.style[i]=""}})},r.getStyle=function(e,t){if(!t)return getComputedStyle(e);var n=getComputedStyle(e)[t];return["width","height"].includes(t)&&(n=parseFloat(n)),n},r.closest=function(e,t){return t?t.matches(e)?t:r.closest(e,t.parentNode):null},r.inViewport=function(e,t){var n=e.getBoundingClientRect(),r=n.top,i=n.left,a=n.bottom,o=n.right,s=t.getBoundingClientRect(),l=s.top,c=s.left,d=s.bottom,u=s.right;return r>=l&&i>=c&&a<=d&&o<=u},r.scrollTop=function(e,t){requestAnimationFrame(function(){e.scrollTop=t})},r.scrollbarSize=function(){return r.scrollBarSizeValue||(r.scrollBarSizeValue=function(){var e=document.createElement("div");r.style(e,{width:"100px",height:"100px",overflow:"scroll",position:"absolute",top:"-9999px"}),document.body.appendChild(e);var t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t}()),r.scrollBarSizeValue},r.hasVerticalOverflow=function(e){return e.scrollHeight>e.offsetHeight+10},r.hasHorizontalOverflow=function(e){return e.scrollWidth>e.offsetWidth+10},r.measureTextWidth=function(e){var t=document.createElement("div");return t.style.position="absolute",t.style.visibility="hidden",t.style.height="auto",t.style.width="auto",t.style.whiteSpace="nowrap",t.innerText=e,document.body.appendChild(t),t.clientWidth+1};var i=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},a="undefined"!=typeof window?window:void 0!==commonjsGlobal?commonjsGlobal:"undefined"!=typeof self?self:{};function o(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}var s="object"==typeof a&&a&&a.Object===Object&&a,l="object"==typeof self&&self&&self.Object===Object&&self,c=s||l||Function("return this")(),d=function(){return c.Date.now()},u=c.Symbol,p=Object.prototype,f=p.hasOwnProperty,h=p.toString,_=u?u.toStringTag:void 0;var m=function(e){var t=f.call(e,_),n=e[_];try{e[_]=void 0}catch(e){}var r=h.call(e);return t?e[_]=n:delete e[_],r},g=Object.prototype.toString;var v=function(e){return g.call(e)},b="[object Null]",y="[object Undefined]",w=u?u.toStringTag:void 0;var k=function(e){return null==e?void 0===e?y:b:w&&w in Object(e)?m(e):v(e)};var x=function(e){return null!=e&&"object"==typeof e},C="[object Symbol]";var S=function(e){return"symbol"==typeof e||x(e)&&k(e)==C},E=NaN,$=/^\s+|\s+$/g,T=/^[-+]0x[0-9a-f]+$/i,A=/^0b[01]+$/i,P=/^0o[0-7]+$/i,O=parseInt;var R=function(e){if("number"==typeof e)return e;if(S(e))return E;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace($,"");var n=A.test(e);return n||P.test(e)?O(e.slice(2),n?2:8):T.test(e)?E:+e},I="Expected a function",L=Math.max,j=Math.min;var N=function(e,t,n){var r,a,o,s,l,c,u=0,p=!1,f=!1,h=!0;if("function"!=typeof e)throw new TypeError(I);function _(t){var n=r,i=a;return r=a=void 0,u=t,s=e.apply(i,n)}function m(e){var n=e-c;return void 0===c||n>=t||n<0||f&&e-u>=o}function g(){var e=d();if(m(e))return v(e);l=setTimeout(g,function(e){var n=t-(e-c);return f?j(n,o-(e-u)):n}(e))}function v(e){return l=void 0,h&&r?_(e):(r=a=void 0,s)}function b(){var e=d(),n=m(e);if(r=arguments,a=this,c=e,n){if(void 0===l)return function(e){return u=e,l=setTimeout(g,t),p?_(e):s}(c);if(f)return l=setTimeout(g,t),_(c)}return void 0===l&&(l=setTimeout(g,t)),s}return t=R(t)||0,i(n)&&(p=!!n.leading,o=(f="maxWait"in n)?L(R(n.maxWait)||0,t):o,h="trailing"in n?!!n.trailing:h),b.cancel=function(){void 0!==l&&clearTimeout(l),u=0,r=c=a=l=void 0},b.flush=function(){return void 0===l?s:v(d())},b},D="Expected a function";var M=function(e,t,n){var r=!0,a=!0;if("function"!=typeof e)throw new TypeError(D);return i(n)&&(r="leading"in n?!!n.leading:r,a="trailing"in n?!!n.trailing:a),N(e,t,{leading:r,maxWait:t,trailing:a})},H="[object AsyncFunction]",F="[object Function]",z="[object GeneratorFunction]",U="[object Proxy]";var B,q=function(e){if(!i(e))return!1;var t=k(e);return t==F||t==z||t==H||t==U},W=c["__core-js_shared__"],G=(B=/[^.]+$/.exec(W&&W.keys&&W.keys.IE_PROTO||""))?"Symbol(src)_1."+B:"";var V=function(e){return!!G&&G in e},Y=Function.prototype.toString;var K=function(e){if(null!=e){try{return Y.call(e)}catch(e){}try{return e+""}catch(e){}}return""},X=/^\[object .+?Constructor\]$/,J=Function.prototype,Q=Object.prototype,Z=J.toString,ee=Q.hasOwnProperty,te=RegExp("^"+Z.call(ee).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var ne=function(e){return!(!i(e)||V(e))&&(q(e)?te:X).test(K(e))};var re=function(e,t){return null==e?void 0:e[t]};var ie=function(e,t){var n=re(e,t);return ne(n)?n:void 0},ae=ie(Object,"create");var oe=function(){this.__data__=ae?ae(null):{},this.size=0};var se=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},le="__lodash_hash_undefined__",ce=Object.prototype.hasOwnProperty;var de=function(e){var t=this.__data__;if(ae){var n=t[e];return n===le?void 0:n}return ce.call(t,e)?t[e]:void 0},ue=Object.prototype.hasOwnProperty;var pe=function(e){var t=this.__data__;return ae?void 0!==t[e]:ue.call(t,e)},fe="__lodash_hash_undefined__";var he=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ae&&void 0===t?fe:t,this};function _e(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}_e.prototype.clear=oe,_e.prototype.delete=se,_e.prototype.get=de,_e.prototype.has=pe,_e.prototype.set=he;var me=_e;var ge=function(){this.__data__=[],this.size=0};var ve=function(e,t){return e===t||e!=e&&t!=t};var be=function(e,t){for(var n=e.length;n--;)if(ve(e[n][0],t))return n;return-1},ye=Array.prototype.splice;var we=function(e){var t=this.__data__,n=be(t,e);return!(n<0||(n==t.length-1?t.pop():ye.call(t,n,1),--this.size,0))};var ke=function(e){var t=this.__data__,n=be(t,e);return n<0?void 0:t[n][1]};var xe=function(e){return be(this.__data__,e)>-1};var Ce=function(e,t){var n=this.__data__,r=be(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};function Se(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Se.prototype.clear=ge,Se.prototype.delete=we,Se.prototype.get=ke,Se.prototype.has=xe,Se.prototype.set=Ce;var Ee=Se,$e=ie(c,"Map");var Te=function(){this.size=0,this.__data__={hash:new me,map:new($e||Ee),string:new me}};var Ae=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var Pe=function(e,t){var n=e.__data__;return Ae(t)?n["string"==typeof t?"string":"hash"]:n.map};var Oe=function(e){var t=Pe(this,e).delete(e);return this.size-=t?1:0,t};var Re=function(e){return Pe(this,e).get(e)};var Ie=function(e){return Pe(this,e).has(e)};var Le=function(e,t){var n=Pe(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function je(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}je.prototype.clear=Te,je.prototype.delete=Oe,je.prototype.get=Re,je.prototype.has=Ie,je.prototype.set=Le;var Ne=je,De="__lodash_hash_undefined__";var Me=function(e){return this.__data__.set(e,De),this};var He=function(e){return this.__data__.has(e)};function Fe(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Ne;++t<n;)this.add(e[t])}Fe.prototype.add=Fe.prototype.push=Me,Fe.prototype.has=He;var ze=Fe;var Ue=function(e,t,n,r){for(var i=e.length,a=n+(r?1:-1);r?a--:++a<i;)if(t(e[a],a,e))return a;return-1};var Be=function(e){return e!=e};var qe=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1};var We=function(e,t,n){return t==t?qe(e,t,n):Ue(e,Be,n)};var Ge=function(e,t){return!(null==e||!e.length)&&We(e,t,0)>-1};var Ve=function(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1};var Ye=function(e,t){return e.has(t)},Ke=ie(c,"Set");var Xe=function(){};var Je=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n},Qe=Ke&&1/Je(new Ke([,-0]))[1]==1/0?function(e){return new Ke(e)}:Xe,Ze=200;var et=function(e,t,n){var r=-1,i=Ge,a=e.length,o=!0,s=[],l=s;if(n)o=!1,i=Ve;else if(a>=Ze){var c=t?null:Qe(e);if(c)return Je(c);o=!1,i=Ye,l=new ze}else l=t?[]:s;e:for(;++r<a;){var d=e[r],u=t?t(d):d;if(d=n||0!==d?d:0,o&&u==u){for(var p=l.length;p--;)if(l[p]===u)continue e;t&&l.push(u),s.push(d)}else i(l,u,n)||(l!==s&&l.push(u),s.push(d))}return s};var tt=function(e){return e&&e.length?et(e):[]};function nt(e){return e.replace(/([A-Z])/g,function(e){return"-"+e[0].toLowerCase()})}function rt(e){return Object.keys(e).map(function(t){var n=nt(t),r=e[t];return void 0===r?"":"data-"+n+'="'+r+'" '}).join("").trim()}function it(e){var t=document.createElement("textarea");t.style.position="fixed",t.style.top=0,t.style.left=0,t.style.width="2em",t.style.height="2em",t.style.padding=0,t.style.border="none",t.style.outline="none",t.style.boxShadow="none",t.style.background="transparent",t.value=e,document.body.appendChild(t),t.select();try{document.execCommand("copy")}catch(e){console.log("Oops, unable to copy")}document.body.removeChild(t)}var at=M,ot=N;function st(e,t){return void 0===t&&(t=null),function(){for(var n=[],r=arguments.length;r--;)n[r]=arguments[r];return new Promise(function(r){setTimeout(function(){var i=e.apply(t,n);r(i)})})}}function lt(e,t,n){var r=n.reduce(function(e,n){return e[n]={get:function(){return t[n]}},e},{});Object.defineProperties(e,r)}function ct(e){return!isNaN(e)}function dt(e){return tt(e)}function ut(e,t){return e-t}class pt extends TypeError{}var ft={chevronDown:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg>',chevronRight:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline></svg>'};var ht,_t=function(e,t){return e(t={exports:{}},t.exports),t.exports}(function(e,t){e.exports=function e(t,n,r){function i(s,l){if(!n[s]){if(!t[s]){var c=o;if(!l&&c)return c(s,!0);if(a)return a(s,!0);var d=new Error("Cannot find module '"+s+"'");throw d.code="MODULE_NOT_FOUND",d}var u=n[s]={exports:{}};t[s][0].call(u.exports,function(e){var n=t[s][1][e];return i(n||e)},u,u.exports,e,t,n,r)}return n[s].exports}for(var a=o,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i={width:"100%",height:"100%"},a=function(e){return Number(e)==Number(e)},o=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._config={},this._lastRepaint=null,this._maxElementHeight=e.getMaxBrowserHeight(),this.refresh(t,n);var i=this._config;!function e(){var t=r._getScrollPosition(),n=r._lastRepaint;if(r._renderAnimationFrame=window.requestAnimationFrame(e),t!==n&&(!n||Math.abs(t-n)>r._averageHeight)){var a=r._renderChunk();r._lastRepaint=t,!1!==a&&"function"==typeof i.afterRender&&i.afterRender()}}()}return r(e,null,[{key:"create",value:function(t,n){return new e(t,n)}},{key:"mergeStyle",value:function(e,t){for(var n in t)e.style[n]!==t[n]&&(e.style[n]=t[n])}},{key:"getMaxBrowserHeight",value:function(){var t=document.createElement("div"),n=document.createElement("div");e.mergeStyle(t,{position:"absolute",height:"1px",opacity:0}),e.mergeStyle(n,{height:"1e7px"}),t.appendChild(n),document.body.appendChild(t);var r=n.offsetHeight;return document.body.removeChild(t),r}}]),r(e,[{key:"destroy",value:function(){window.cancelAnimationFrame(this._renderAnimationFrame)}},{key:"refresh",value:function(t,n){var r=this;if(Object.assign(this._config,i,n),!t||1!==t.nodeType)throw new Error("HyperList requires a valid DOM Node container");this._element=t;var o=this._config,s=this._scroller||o.scroller||document.createElement(o.scrollerTagName||"tr");if("boolean"!=typeof o.useFragment&&(this._config.useFragment=!0),!o.generate)throw new Error("Missing required `generate` function");if(!a(o.total))throw new Error("Invalid required `total` value, expected number");if(!Array.isArray(o.itemHeight)&&!a(o.itemHeight))throw new Error("\n        Invalid required `itemHeight` value, expected number or array\n      ".trim());a(o.itemHeight)?this._itemHeights=Array(o.total).fill(o.itemHeight):this._itemHeights=o.itemHeight,Object.keys(i).filter(function(e){return e in o}).forEach(function(e){var t=o[e],n=a(t),i=!n&&"%"===t.slice(-1);if(t&&"string"!=typeof t&&"number"!=typeof t){var s="Invalid optional `"+e+"`, expected string or number";throw new Error(s)}if(n&&(o[e]=t+"px"),"height"===e){var l=n?t:parseInt(t.replace(/px|%/,""),10);r._containerHeight=i?window.innerHeight*l/100:a(t)?t:l}});var l={width:""+o.width,height:""+o.height,overflow:"auto",position:"relative"};e.mergeStyle(t,l);var c=o.itemHeight*o.total,d=this._maxElementHeight;c>d&&console.warn(["HyperList: The maximum element height",d+"px has","been exceeded; please reduce your item height."].join(" "));var u={opacity:"0",position:"absolute",width:"1px",height:c+"px"};e.mergeStyle(s,u),this._scroller||t.appendChild(s),this._scroller=s,this._scrollHeight=this._computeScrollHeight(),this._itemPositions=this._itemPositions||Array(o.total).fill(0),this._computePositions(0),this._renderChunk(null!==this._lastRepaint),"function"==typeof o.afterRender&&o.afterRender()}},{key:"_getRow",value:function(t){var n=this._config,r=n.generate(t),i=r.height;if(void 0!==i&&a(i)?(r=r.element,i!==this._itemHeights&&(this._itemHeights[t]=i,this._computePositions(t),this._scrollHeight=this._computeScrollHeight(t))):i=this._itemHeights[t],!r||1!==r.nodeType)throw new Error("Generator did not return a DOM Node for index: "+t);var o=r.getAttribute("class")||"";r.setAttribute("class",o+" "+(n.rowClassName||"vrow"));var s=this._itemPositions[t];return e.mergeStyle(r,{position:"absolute",top:s+"px"}),r}},{key:"_getScrollPosition",value:function(){var e=this._config;return"function"==typeof e.overrideScrollPosition?e.overrideScrollPosition():this._element.scrollTop}},{key:"_renderChunk",value:function(e){var t=this._config,n=this._element,r=this._getScrollPosition(),i=t.total,a=t.reverse?this._getReverseFrom(r):this._getFrom(r)-1;if((a<0||a-this._screenItemsLen<0)&&(a=0),!e&&this._lastFrom===a)return!1;this._lastFrom=a;var o=a+this._cachedItemsLen;(o>i||o+this._cachedItemsLen>i)&&(o=i);var s=t.useFragment?document.createDocumentFragment():[],l=this._scroller;s[t.useFragment?"appendChild":"push"](l);for(var c=a;c<o;c++){var d=this._getRow(c);s[t.useFragment?"appendChild":"push"](d)}if(t.applyPatch)return t.applyPatch(n,s);n.innerHTML="",n.appendChild(s)}},{key:"_computePositions",value:function(){var e=arguments.length<=0||void 0===arguments[0]?1:arguments[0],t=this._config,n=t.total,r=t.reverse;e<1&&!r&&(e=1);for(var i=e;i<n;i++)r?0===i?this._itemPositions[0]=this._scrollHeight-this._itemHeights[0]:this._itemPositions[i]=this._itemPositions[i-1]-this._itemHeights[i]:this._itemPositions[i]=this._itemHeights[i-1]+this._itemPositions[i-1]}},{key:"_computeScrollHeight",value:function(){var t=this,n=this._config,r=n.total,i=this._itemHeights.reduce(function(e,t){return e+t},0);e.mergeStyle(this._scroller,{opacity:0,position:"absolute",width:"1px",height:i+"px"});var a=this._itemHeights.slice(0).sort(function(e,t){return e-t}),o=Math.floor(r/2),s=r%2==0?(a[o]+a[o-1])/2:a[o],l=this._element.clientHeight?this._element.clientHeight:this._containerHeight;return this._screenItemsLen=Math.ceil(l/s),this._containerHeight=l,this._cachedItemsLen=Math.max(this._cachedItemsLen||0,3*this._screenItemsLen),this._averageHeight=s,n.reverse&&window.requestAnimationFrame(function(){t._element.scrollTop=i}),i}},{key:"_getFrom",value:function(e){for(var t=0;this._itemPositions[t]<e;)t++;return t}},{key:"_getReverseFrom",value:function(e){for(var t=this._config.total-1;t>0&&this._itemPositions[t]<e+this._containerHeight;)t--;return t}}]),e}();n.default=o,t.exports=n.default},{}]},{},[1])(1)}),mt=(ht=_t)&&ht.__esModule&&Object.prototype.hasOwnProperty.call(ht,"default")?ht.default:ht;var gt={13:"enter",91:"meta",16:"shift",17:"ctrl",18:"alt",37:"left",38:"up",39:"right",40:"down",9:"tab",27:"esc",67:"c",70:"f",86:"v"};var vt={columns:[],data:[],dropdownButton:ft.chevronDown,headerDropdown:[{label:"Sort Ascending",action:function(e){this.sortColumn(e.colIndex,"asc")}},{label:"Sort Descending",action:function(e){this.sortColumn(e.colIndex,"desc")}},{label:"Reset sorting",action:function(e){this.sortColumn(e.colIndex,"none")}},{label:"Remove column",action:function(e){this.removeColumn(e.colIndex)}}],events:{onRemoveColumn:function(e){},onSwitchColumn:function(e,t){},onSortColumn:function(e){},onCheckRow:function(e){},onDestroy:function(){}},hooks:{columnTotal:null},sortIndicator:{asc:"↑",desc:"↓",none:""},overrideComponents:{},filterRows:function(e,t){var n=[];if(0===Object.keys(t).length)return e.map(function(e){return e.meta.rowIndex});var r=function(r){var i=t[r],a=(n.length?n.map(function(t){return e[t]}):e).map(function(e){return e[r]}),o=function(e){if(void 0===e&&(e=""),0===e.length)return{};var t=e;return[">","<","="].includes(t[0])?t=e.slice(1):t.startsWith("!=")&&(t=e.slice(2)),e.startsWith(">")&&t?{type:"greaterThan",text:t.trim()}:e.startsWith("<")&&t?{type:"lessThan",text:t.trim()}:e.startsWith("=")&&ct(t)?{type:"equals",text:Number(e.slice(1).trim())}:ct(t)?{type:"containsNumber",text:t}:e.startsWith("!=")&&ct(t)?{type:"notEquals",text:Number(e.slice(2).trim())}:2===e.split(":").length?{type:"range",text:(t=e.split(":")).map(function(e){return e.trim()})}:{type:"contains",text:t.toLowerCase()}}(i),s=function(e){var t=function(e){return String((t=e.html||"",t.replace(/<[^>]*>/g,"")||e.content||"")).toLowerCase();var t},n=function(e){return parseFloat(e.content)},r=function(e,r){if(e.column.compareValue){var i=e.column.compareValue(e,r);if(i&&Array.isArray(i))return i}var a=n(e);return isNaN(a)?[t(e),r]:[a,r]};return{contains:function(e,n){return n.filter(function(n){var r=t(n),i=(e||"").toLowerCase();return!i||r.includes(i)}).map(function(e){return e.rowIndex})},greaterThan:function(e,t){return t.filter(function(t){var n=r(t,e),i=n[0],a=n[1];return i>a}).map(function(e){return e.rowIndex})},lessThan:function(e,t){return t.filter(function(t){var n=r(t,e),i=n[0],a=n[1];return i<a}).map(function(e){return e.rowIndex})},equals:function(e,t){return t.filter(function(t){var n=parseFloat(t.content);return n===e}).map(function(e){return e.rowIndex})},notEquals:function(e,t){return t.filter(function(t){var n=parseFloat(t.content);return n!==e}).map(function(e){return e.rowIndex})},range:function(e,t){return t.filter(function(t){var n=r(t,e[0]),i=r(t,e[1]),a=n[0];return a>=n[1]&&a<=i[1]}).map(function(e){return e.rowIndex})},containsNumber:function(e,r){return r.filter(function(r){var i=parseFloat(e,10),a=e,o=n(r),s=t(r);return i===o||s.includes(a)}).map(function(e){return e.rowIndex})}}[e.type]}(o);n=s?s(o.text,a):a.map(function(e){return e.rowIndex})};for(var i in t)r(i);return n},freezeMessage:"",getEditor:null,serialNoColumn:!0,checkboxColumn:!1,clusterize:!0,logs:!1,layout:"fixed",noDataMessage:"No Data",cellHeight:40,minimumColumnWidth:30,inlineFilters:!1,treeView:!1,checkedRowStatus:!0,dynamicRowHeight:!1,pasteFromClipboard:!1,showTotalRow:!1,direction:"ltr",disableReorderColumn:!1},bt={DataManager:class{constructor(e){this.options=e,this.sortRows=st(this.sortRows,this),this.switchColumn=st(this.switchColumn,this),this.removeColumn=st(this.removeColumn,this),this.options.filterRows=st(this.options.filterRows,this)}init(e,t){e||(e=this.options.data),t&&(this.options.columns=t),this.data=e,this.rowCount=0,this.columns=[],this.rows=[],this.prepareColumns(),this.prepareRows(),this.prepareTreeRows(),this.prepareRowView(),this.prepareNumericColumns()}get currentSort(){return this.columns.find(function(e){return"none"!==e.sortOrder})||{colIndex:-1,sortOrder:"none"}}prepareColumns(){this.columns=[],this.validateColumns(),this.prepareDefaultColumns(),this.prepareHeader()}prepareDefaultColumns(){if(this.options.checkboxColumn&&!this.hasColumnById("_checkbox")){var e={id:"_checkbox",content:this.getCheckboxHTML(),editable:!1,resizable:!1,sortable:!1,focusable:!1,dropdown:!1,width:32};this.columns.push(e)}this.options.serialNoColumn&&!this.hasColumnById("_rowIndex")&&this.columns.push({id:"_rowIndex",content:"",align:"center",editable:!1,resizable:!1,focusable:!1,dropdown:!1})}prepareHeader(){var e=this,t=this.columns.concat(this.options.columns),n={isHeader:1,editable:!0,sortable:!0,resizable:!0,focusable:!0,dropdown:!0,width:null,format:function(e){return null==e?"":e+""}};this.columns=t.map(function(t,n){return e.prepareCell(t,n)}).map(function(e){return Object.assign({},n,e)}).map(function(e){return e.content=e.content||e.name||"",e.id=e.id||e.content,e})}prepareCell(e,t){var n={content:"",sortOrder:"none",colIndex:t,column:this.columns[t]};return null!==e&&"object"==typeof e?Object.assign(n,e):n.content=e,n}prepareNumericColumns(){var e=this.getRow(0);e&&(this.columns=this.columns.map(function(t,n){var r=e[n].content;return t.align||isNaN(r)||(t.align="right"),t}))}prepareRows(){var e=this;this.validateData(this.data),this.rows=this.data.map(function(t,n){var r=e._getNextRowCount(),i=[],a={rowIndex:r};if(Array.isArray(t))for(e.options.checkboxColumn&&i.push(e.getCheckboxHTML()),e.options.serialNoColumn&&i.push(r+1+""),i=i.concat(t);i.length<e.columns.length;)i.push("");else{for(var o=0,s=e.columns;o<s.length;o+=1){var l=s[o];"_checkbox"===l.id?i.push(e.getCheckboxHTML()):"_rowIndex"===l.id?i.push(r+1+""):i.push(t[l.id])}a.indent=t.indent||0}return e.prepareRow(i,a)})}prepareTreeRows(){var e=this;this.rows.forEach(function(t,n){if(ct(t.meta.indent)){var r=e.getRow(n+1);t.meta.isLeaf=!r||!function(e){return void 0!==e||null!==e}(r.meta.indent)||r.meta.indent<=t.meta.indent,t.meta.isTreeNodeClose=!1}})}prepareRowView(){this.rowViewOrder=this.rows.map(function(e){return e.meta.rowIndex})}prepareRow(e,t){var n=this,r={rowIndex:t.rowIndex,indent:t.indent};return(e=e.map(function(e,t){return n.prepareCell(e,t)}).map(function(e){return Object.assign({},r,e)})).meta=t,e}validateColumns(){var e=this.options.columns;if(!Array.isArray(e))throw new pt("`columns` must be an array");e.forEach(function(e,t){if("string"!=typeof e&&"object"!=typeof e)throw new pt('column "'+t+'" must be a string or an object')})}validateData(e){if(Array.isArray(e)&&(0===e.length||Array.isArray(e[0])||"object"==typeof e[0]))return!0;throw new pt("`data` must be an array of arrays or objects")}appendRows(e){var t;this.validateData(e),(t=this.rows).push.apply(t,this.prepareRows(e))}sortRows(e,t){void 0===t&&(t="none"),e=+e,this.getColumns().map(function(n){n.colIndex===e?n.sortOrder=t:n.sortOrder="none"}),this._sortRows(e,t)}_sortRows(e,t){var n=this;if(this.currentSort.colIndex===e&&("asc"===this.currentSort.sortOrder&&"desc"===t||"desc"===this.currentSort.sortOrder&&"asc"===t))return this.reverseArray(this.rowViewOrder),void(this.currentSort.sortOrder=t);if(this.rowViewOrder.sort(function(r,i){var a=r,o=i,s=n.getCell(e,r).content,l=n.getCell(e,i).content;if(s=null==s?"":s,l=null==l?"":l,"none"===t)return a-o;if("asc"===t){if(s<l)return-1;if(s>l)return 1;if(s===l)return 0}else if("desc"===t){if(s<l)return 1;if(s>l)return-1;if(s===l)return 0}return 0}),this.hasColumnById("_rowIndex")){var r=this.getColumnIndexById("_rowIndex");this.rows.forEach(function(e,t){var i=n.rowViewOrder.indexOf(t);e[r].content=i+1+""})}}reverseArray(e){var t=null,n=null;for(t=0,n=e.length-1;t<n;t+=1,n-=1){var r=e[t];e[t]=e[n],e[n]=r}}switchColumn(e,t){var n=this.columns[e];this.columns[e]=this.columns[t],this.columns[t]=n,this.columns[e].colIndex=e,this.columns[t].colIndex=t,this.rows.forEach(function(n){var r=Object.assign({},n[e],{colIndex:t}),i=Object.assign({},n[t],{colIndex:e});n[t]=r,n[e]=i})}removeColumn(e){e=+e,this.columns=this.columns.filter(function(t){return t.colIndex!==e}).map(function(e,t){return Object.assign({},e,{colIndex:t})}),this.rows.forEach(function(t){t.splice(e,1),t.forEach(function(e,t){e.colIndex=t})})}updateRow(e,t){e.length<this.columns.length&&(this.hasColumnById("_rowIndex")&&(e=[t+1+""].concat(e)),this.hasColumnById("_checkbox")&&(e=['<input type="checkbox" />'].concat(e)));var n=this.prepareRow(e,{rowIndex:t}),r=this.rows.findIndex(function(e){return e[0].rowIndex===t});return this.rows[r]=n,n}updateCell(e,t,n){var r;for(var i in"object"==typeof e&&(e=(r=e).colIndex,t=r.rowIndex,n=r),r=this.getCell(e,t),n){var a=n[i];void 0!==a&&(r[i]=a)}return r}updateColumn(e,t){var n=this.getColumn(e);for(var r in t){var i=t[r];void 0!==i&&(n[r]=i)}return n}filterRows(e){var t=this;return this.options.filterRows(this.rows,e).then(function(e){return e||(e=t.getAllRowIndices()),e.then||(e=Promise.resolve(e)),e.then(function(e){return t._filteredRows=e,{rowsToHide:t.getAllRowIndices().filter(function(t){return!e.includes(t)}),rowsToShow:e}})})}getFilteredRowIndices(){return this._filteredRows||this.getAllRowIndices()}getAllRowIndices(){return this.rows.map(function(e){return e.meta.rowIndex})}getRowCount(){return this.rowCount}_getNextRowCount(){var e=this.rowCount;return this.rowCount++,e}getRows(e,t){return this.rows.slice(e,t)}getRowsForView(e,t){var n=this;return this.rowViewOrder.map(function(e){return n.rows[e]}).slice(e,t)}getColumns(e){var t=this.columns;return e&&(t=t.slice(this.getStandardColumnCount())),t}getStandardColumnCount(){return this.options.checkboxColumn&&this.options.serialNoColumn?2:this.options.checkboxColumn||this.options.serialNoColumn?1:0}getColumnCount(e){var t=this.columns.length;return e&&(t-=this.getStandardColumnCount()),t}getColumn(e){return(e=+e)<0&&(e=this.columns.length+e),this.columns.find(function(t){return t.colIndex===e})}getColumnById(e){return this.columns.find(function(t){return t.id===e})}getRow(e){return e=+e,this.rows[e]}getCell(e,t){return t=+t,e=+e,this.getRow(t)[e]}getChildren(e){e=+e;for(var t=this.getRow(e).meta.indent,n=[],r=e+1;r<this.rowCount;r++){var i=this.getRow(r);if(!isNaN(i.meta.indent)&&(i.meta.indent>t&&n.push(r),i.meta.indent===t))break}return n}getImmediateChildren(e){e=+e;for(var t=this.getRow(e).meta.indent,n=[],r=t+1,i=e+1;i<this.rowCount;i++){var a=this.getRow(i);if(!(isNaN(a.meta.indent)||a.meta.indent>r)&&(a.meta.indent===r&&n.push(i),a.meta.indent===t))break}return n}get(){return{columns:this.columns,rows:this.rows}}getData(e){return this.data[e]}hasColumn(e){return Boolean(this.columns.find(function(t){return t.content===e}))}hasColumnById(e){return Boolean(this.columns.find(function(t){return t.id===e}))}getColumnIndex(e){return this.columns.findIndex(function(t){return t.content===e})}getColumnIndexById(e){return this.columns.findIndex(function(t){return t.id===e})}getCheckboxHTML(){return'<input type="checkbox" />'}},CellManager:class{constructor(e){this.instance=e,lt(this,this.instance,["wrapper","options","style","header","bodyScrollable","columnmanager","rowmanager","datamanager","keyboard"]),this.bindEvents()}bindEvents(){this.bindFocusCell(),this.bindEditCell(),this.bindKeyboardSelection(),this.bindCopyCellContents(),this.bindMouseEvents(),this.bindTreeEvents()}bindFocusCell(){this.bindKeyboardNav()}bindEditCell(){var e=this;this.$editingCell=null,r.on(this.bodyScrollable,"dblclick",".dt-cell",function(t,n){e.activateEditing(n)}),this.keyboard.on("enter",function(){e.$focusedCell&&!e.$editingCell?e.activateEditing(e.$focusedCell):e.$editingCell&&e.deactivateEditing()})}bindKeyboardNav(){var e=this;["left","right","up","down","tab","shift+tab"].map(function(t){return e.keyboard.on(t,function(){return e.focusCellInDirection(t)})}),["left","right","up","down"].map(function(t){return e.keyboard.on("ctrl+"+t,function(){return function(t){if(!e.$focusedCell||e.$editingCell)return!1;var n=e.$focusedCell,i=r.data(n),a=i.rowIndex,o=i.colIndex;return"left"===t?n=e.getLeftMostCell$(a):"right"===t?n=e.getRightMostCell$(a):"up"===t?n=e.getTopMostCell$(o):"down"===t&&(n=e.getBottomMostCell$(o)),e.focusCell(n),!0}(t)})}),this.keyboard.on("esc",function(){e.deactivateEditing(!1),e.columnmanager.toggleFilter(!1)}),this.options.inlineFilters&&(this.keyboard.on("ctrl+f",function(t){var n=r.closest(".dt-cell",t.target),i=r.data(n).colIndex;return e.activateFilter(i),!0}),r.on(this.header,"focusin",".dt-filter",function(){e.unfocusCell(e.$focusedCell)}))}bindKeyboardSelection(){var e=this;["left","right","up","down"].map(function(t){return e.keyboard.on("shift+"+t,function(){return e.selectArea(function(t){var n=e.getSelectionCursor();return"left"===t?n=e.getLeftCell$(n):"right"===t?n=e.getRightCell$(n):"up"===t?n=e.getAboveCell$(n):"down"===t&&(n=e.getBelowCell$(n)),n}(t))})})}bindCopyCellContents(){var e=this;this.keyboard.on("ctrl+c",function(){var t=e.copyCellContents(e.$focusedCell,e.$selectionCursor),n=t+" cell"+(t>1?"s":"")+" copied";t&&e.instance.showToastMessage(n,2)}),this.options.pasteFromClipboard&&this.keyboard.on("ctrl+v",function(t){return e.instance.pasteTarget.focus(),setTimeout(function(){var t=e.instance.pasteTarget.value;e.instance.pasteTarget.value="",e.pasteContentInCell(t)},10),!1})}bindMouseEvents(){var e=this,t=null;r.on(this.bodyScrollable,"mousedown",".dt-cell",function(n){t=!0,e.focusCell(r(n.delegatedTarget))}),r.on(this.bodyScrollable,"mouseup",function(){t=!1}),r.on(this.bodyScrollable,"mousemove",".dt-cell",at(function(n){t&&e.selectArea(r(n.delegatedTarget))},50))}bindTreeEvents(){var e=this;r.on(this.bodyScrollable,"click",".dt-tree-node__toggle",function(t,n){var i=r.closest(".dt-cell",n),a=r.data(i).rowIndex;i.classList.contains("dt-cell--tree-close")?e.rowmanager.openSingleNode(a):e.rowmanager.closeSingleNode(a)})}focusCell(e,t){void 0===t&&(t={});var n=t.skipClearSelection;void 0===n&&(n=0);var i=t.skipDOMFocus;void 0===i&&(i=0);var a=t.skipScrollToCell;if(void 0===a&&(a=0),e&&e!==this.$editingCell){var o=r.data(e),s=o.colIndex;o.isHeader||!1!==this.columnmanager.getColumn(s).focusable&&(a||this.scrollToCell(e),this.deactivateEditing(),n||this.clearSelection(),this.$focusedCell&&this.$focusedCell.classList.remove("dt-cell--focus"),this.$focusedCell=e,e.classList.add("dt-cell--focus"),i||e.focus(),this.highlightRowColumnHeader(e))}}unfocusCell(e){e&&(e.classList.remove("dt-cell--focus"),this.$focusedCell=null,this.lastHeaders&&this.lastHeaders.forEach(function(e){return e&&e.classList.remove("dt-cell--highlight")}))}highlightRowColumnHeader(e){var t=r.data(e),n=t.colIndex,i=t.rowIndex,a=".dt-cell--header-"+n,o=".dt-cell--"+this.datamanager.getColumnIndexById("_rowIndex")+"-"+i;this.lastHeaders&&this.lastHeaders.forEach(function(e){return e&&e.classList.remove("dt-cell--highlight")});var s=r(a,this.wrapper),l=r(o,this.wrapper);this.lastHeaders=[s,l],this.lastHeaders.forEach(function(e){return e&&e.classList.add("dt-cell--highlight")})}selectAreaOnClusterChanged(){if(this.$focusedCell&&this.$selectionCursor){var e=r.data(this.$selectionCursor),t=e.colIndex,n=e.rowIndex,i=this.getCell$(t,n);if(i&&i!==this.$selectionCursor){var a=r.data(this.$focusedCell);this.$focusedCell=this.getCell$(a.colIndex,a.rowIndex),this.selectArea(i)}}}focusCellOnClusterChanged(){if(this.$focusedCell){var e=r.data(this.$focusedCell),t=e.colIndex,n=e.rowIndex,i=this.getCell$(t,n);i&&this.focusCell(i,{skipClearSelection:1,skipDOMFocus:1,skipScrollToCell:1})}}selectArea(e){this.$focusedCell&&this._selectArea(this.$focusedCell,e)&&(this.$selectionCursor=e)}_selectArea(e,t){var n=this;if(e===t)return!1;var r=this.getCellsInRange(e,t);return!!r&&(this.clearSelection(),this._selectedCells=r.map(function(e){var t;return(t=n).getCell$.apply(t,e)}),requestAnimationFrame(function(){n._selectedCells.map(function(e){return e.classList.add("dt-cell--highlight")})}),!0)}getCellsInRange(e,t){var n,i,a,o,s,l,c;if("number"==typeof e)o=(n=arguments)[0],s=n[1],l=n[2],c=n[3];else if("object"==typeof e){if(!e||!t)return!1;var d=r.data(e),u=r.data(t);o=+d.colIndex,s=+d.rowIndex,l=+u.colIndex,c=+u.rowIndex}if(s>c&&(s=(i=[c,s])[0],c=i[1]),o>l&&(o=(a=[l,o])[0],l=a[1]),this.isStandardCell(o)||this.isStandardCell(l))return!1;for(var p=[],f=o,h=s,_=[];h<=c;)_.push(h),h+=1;return _.map(function(e){for(;f<=l;)p.push([f,e]),f++;f=o}),p}clearSelection(){(this._selectedCells||[]).forEach(function(e){return e.classList.remove("dt-cell--highlight")}),this._selectedCells=[],this.$selectionCursor=null}getSelectionCursor(){return this.$selectionCursor||this.$focusedCell}activateEditing(e){this.focusCell(e);var t=r.data(e),n=t.rowIndex,i=t.colIndex,a=this.columnmanager.getColumn(i);if(!a||!1!==a.editable&&!1!==a.focusable){var o=this.getCell(i,n);if(!o||!1!==o.editable){if(this.$editingCell){var s=r.data(this.$editingCell),l=s._rowIndex,c=s._colIndex;if(n===l&&i===c)return}this.$editingCell=e,e.classList.add("dt-cell--editing");var d=r(".dt-cell__edit",e);d.innerHTML="";var u=this.getEditor(i,n,o.content,d);u&&(this.currentCellEditor=u,u.initValue(o.content,n,a))}}}deactivateEditing(e){void 0===e&&(e=!0),e&&this.submitEditing(),this.$focusedCell&&this.$focusedCell.focus(),this.$editingCell&&(this.$editingCell.classList.remove("dt-cell--editing"),this.$editingCell=null)}getEditor(e,t,n,r){var i=this.datamanager.getColumn(e),a=this.datamanager.getRow(t),o=this.datamanager.getData(t),s=this.options.getEditor?this.options.getEditor(e,t,n,r,i,a,o):this.getDefaultEditor(r);return!1!==s&&(void 0===s&&(s=this.getDefaultEditor(r)),s)}getDefaultEditor(e){var t=r.create("input",{class:"dt-input",type:"text",inside:e});return{initValue:function(e){t.focus(),t.value=e},getValue:function(){return t.value},setValue:function(e){t.value=e}}}submitEditing(){var e=this,t=Promise.resolve();if(!this.$editingCell)return t;var n=this.$editingCell,i=r.data(n),a=i.rowIndex,o=i.colIndex,s=this.datamanager.getColumn(o);if(n){var l=this.currentCellEditor;if(l){var c=l.getValue();c.then||(c=Promise.resolve(c)),t=c.then(function(t){var r=l.setValue(t,a,s),i=e.getCell(o,a).content;return e.updateCell(o,a,t),n.focus(),r&&r.then&&r.catch(function(t){console.log(t),e.updateCell(o,a,i)}),r})}}return this.currentCellEditor=null,t}copyCellContents(e,t){var n=this;if(!t&&e){var i=r.data(e),a=i.colIndex,o=i.rowIndex;return it(this.getCell(a,o).content),1}var s=this.getCellsInRange(e,t);if(!s)return 0;var l=s.map(function(e){var t;return(t=n).getCell.apply(t,e)}).reduce(function(e,t){var n=t.rowIndex;return e[n]=e[n]||[],e[n].push(t.content),e},[]);return it(l.map(function(e){return e.join("\t")}).join("\n")),l.reduce(function(e,t){return e+t.length},0)}pasteContentInCell(e){var t=this;if(this.$focusedCell){var n=e.split("\n").map(function(e){return e.split("\t")}).filter(function(e){return e.length&&e.every(function(e){return e})}),i=r.data(this.$focusedCell),a=i.colIndex,o=i.rowIndex,s=+a,l=+o;n.forEach(function(e,n){var r=n+l;e.forEach(function(e,n){var i=n+s;t.updateCell(i,r,e)})})}}activateFilter(e){this.columnmanager.toggleFilter(),this.columnmanager.focusFilter(e),this.columnmanager.isFilterShown||this.$focusedCell&&this.$focusedCell.focus()}updateCell(e,t,n){var r=this.datamanager.updateCell(e,t,{content:n});this.refreshCell(r)}refreshCell(e){r(this.selector(e.colIndex,e.rowIndex),this.bodyScrollable).innerHTML=this.getCellContent(e)}toggleTreeButton(e,t){var n=this.columnmanager.getFirstColumnIndex(),r=this.getCell$(n,e);r&&r.classList[t?"remove":"add"]("dt-cell--tree-close")}isStandardCell(e){return e<this.columnmanager.getFirstColumnIndex()}focusCellInDirection(e){if(!this.$focusedCell)return!1;this.$editingCell&&["tab","shift+tab"].includes(e)&&this.deactivateEditing();var t=this.$focusedCell;if("left"===e||"shift+tab"===e?t=this.getLeftCell$(t):"right"===e||"tab"===e?t=this.getRightCell$(t):"up"===e?t=this.getAboveCell$(t):"down"===e&&(t=this.getBelowCell$(t)),!t)return!1;var n=r.data(t).colIndex;if(!this.columnmanager.getColumn(n).focusable){var i=this.$focusedCell;this.unfocusCell(i),this.$focusedCell=t;var a=this.focusCellInDirection(e);return a||this.focusCell(i),a}return this.focusCell(t),!0}getCell$(e,t){return r(this.selector(e,t),this.bodyScrollable)}getAboveCell$(e){for(var t=r.data(e).colIndex,n=e.parentElement.previousElementSibling;n&&n.classList.contains("dt-row--hide");)n=n.previousElementSibling;return n?r(".dt-cell--col-"+t,n):e}getBelowCell$(e){for(var t=r.data(e).colIndex,n=e.parentElement.nextElementSibling;n&&n.classList.contains("dt-row--hide");)n=n.nextElementSibling;return n?r(".dt-cell--col-"+t,n):e}getLeftCell$(e){return e.previousElementSibling}getRightCell$(e){return e.nextElementSibling}getLeftMostCell$(e){return this.getCell$(this.columnmanager.getFirstColumnIndex(),e)}getRightMostCell$(e){return this.getCell$(this.columnmanager.getLastColumnIndex(),e)}getTopMostCell$(e){return this.getCell$(e,this.rowmanager.getFirstRowIndex())}getBottomMostCell$(e){return this.getCell$(e,this.rowmanager.getLastRowIndex())}getCell(e,t){return this.instance.datamanager.getCell(e,t)}getRowHeight(){return r.style(r(".dt-row",this.bodyScrollable),"height")}scrollToCell(e){if(r.inViewport(e,this.bodyScrollable))return!1;var t=r.data(e).rowIndex;return this.rowmanager.scrollToRow(t),!1}getRowCountPerPage(){return Math.ceil(this.instance.getViewportHeight()/this.getRowHeight())}getCellHTML(e){var t=e.rowIndex,n=e.colIndex,r=e.isHeader,i=e.isFilter,a=e.isTotalRow,o=rt({rowIndex:t,colIndex:n,isHeader:r,isFilter:i,isTotalRow:a}),s=this.datamanager.getRow(t),l=!(r||i||a);return'\n            <div class="'+["dt-cell","dt-cell--col-"+n,l?"dt-cell--"+n+"-"+t:"",l?"dt-cell--row-"+t:"",r?"dt-cell--header":"",r?"dt-cell--header-"+n:"",i?"dt-cell--filter":"",l&&s&&s.meta.isTreeNodeClose?"dt-cell--tree-close":""].join(" ")+'" '+o+' tabindex="0">\n                '+this.getCellContent(e)+"\n            </div>\n        "}getCellContent(e){var t,n=e.isHeader,r=e.isFilter,i=e.colIndex,a=n||!1===e.editable?"":this.getEditCellHTML(i),o=n&&!1!==e.sortable?'<span class="sort-indicator">\n                '+this.options.sortIndicator[e.sortOrder]+"\n            </span>":"",s=n&&!1!==e.resizable?'<span class="dt-cell__resize-handle"></span>':"",l=n&&!1!==e.dropdown?this.columnmanager.getDropdownHTML():"",c=e.format||e.column&&e.column.format||null;if(n||r||!c)t=e.content;else{var d=this.datamanager.getRow(e.rowIndex),u=this.datamanager.getData(e.rowIndex);t=c(e.content,d,e.column,u)}if(e.html=t,this.options.treeView&&!n&&!r&&void 0!==e.indent){var p=this.datamanager.getRow(e.rowIndex+1),f=p&&p.meta.indent>e.indent;if(this.datamanager.getColumnIndexById("_rowIndex")+1===e.colIndex){var h=20*(e.indent||0);t='<span class="dt-tree-node" style="padding-left: '+h+'px">\n                    '+(f?'<span class="dt-tree-node__toggle" style="left: '+(h-20)+'px">\n                        <span class="icon-open">'+ft.chevronDown+'</span>\n                        <span class="icon-close">'+ft.chevronRight+"</span>\n                    </span>":"")+"\n                    <span>"+t+"</span>\n                </span>"}}return'\n            <div class="'+["dt-cell__content",n?"dt-cell__content--header-"+i:"dt-cell__content--col-"+i].join(" ")+'">\n                '+t+"\n                "+o+"\n                "+s+"\n                "+l+"\n            </div>\n            "+a+"\n        "}getEditCellHTML(e){return'<div class="dt-cell__edit dt-cell__edit--col-'+e+'"></div>'}selector(e,t){return".dt-cell--"+e+"-"+t}},ColumnManager:class{constructor(e){this.instance=e,lt(this,this.instance,["options","fireEvent","header","datamanager","cellmanager","style","wrapper","rowmanager","bodyScrollable","bodyRenderer"]),this.bindEvents()}renderHeader(){this.header.innerHTML="<div></div>",this.refreshHeader()}refreshHeader(){var e=this.datamanager.getColumns();r("div",this.header).innerHTML=this.getHeaderHTML(e),this.$filterRow=r(".dt-row-filter",this.header),this.$filterRow&&r.style(this.$filterRow,{display:"none"}),this.$columnMap=[],this.bindMoveColumn()}getHeaderHTML(e){var t=this.rowmanager.getRowHTML(e,{isHeader:1});return this.options.inlineFilters&&(t+=this.rowmanager.getRowHTML(e,{isFilter:1})),t}bindEvents(){this.bindDropdown(),this.bindResizeColumn(),this.bindPerfectColumnWidth(),this.bindFilter()}bindDropdown(){var e=this,t=".dt-dropdown__toggle",n=".dt-dropdown__list";this.instance.dropdownContainer.innerHTML=this.getDropdownListHTML(),this.$dropdownList=this.instance.dropdownContainer.firstElementChild,r.on(this.header,"click",t,function(t){e.openDropdown(t)});var i=function(e){var r=[t,t+" *",n,n+" *"].join(",");e.target.matches(r)||o()};r.on(document.body,"click",i),document.addEventListener("scroll",o,!0),this.instance.on("onDestroy",function(){r.off(document.body,"click",i),r.off(document,"scroll",o)}),r.on(this.$dropdownList,"click",".dt-dropdown__list-item",function(t,n){if(e._dropdownActiveColIndex){var i=e.options.headerDropdown,a=r.data(n).index,o=e._dropdownActiveColIndex,s=i[a].action;s&&s.call(e.instance,e.getColumn(o)),e.hideDropdown()}});var a=this;function o(e){a.hideDropdown()}this.hideDropdown()}openDropdown(e){this._dropdownWidth||(r.style(this.$dropdownList,{display:""}),this._dropdownWidth=r.style(this.$dropdownList,"width")),r.style(this.$dropdownList,{display:"",left:e.clientX-this._dropdownWidth+4+"px",top:e.clientY+4+"px"});var t=r.closest(".dt-cell",e.target),n=r.data(t).colIndex;this._dropdownActiveColIndex=n}hideDropdown(){r.style(this.$dropdownList,{display:"none"}),this._dropdownActiveColIndex=null}bindResizeColumn(){var e,t,n,i=this,a=!1;r.on(this.header,"mousedown",".dt-cell .dt-cell__resize-handle",function(o,s){document.body.classList.add("dt-resize");var l=s.parentNode.parentNode;e=l;var c=r.data(e).colIndex,d=i.getColumn(c);d&&!1===d.resizable||(a=!0,t=r.style(r(".dt-cell__content",e),"width"),n=o.pageX)});var o=function(t){if(document.body.classList.remove("dt-resize"),e){a=!1;var n=r.data(e).colIndex;i.setColumnWidth(n),i.style.setBodyStyle(),e=null}};r.on(document.body,"mouseup",o),this.instance.on("onDestroy",function(){r.off(document.body,"mouseup",o)});var s=function(o){if(a){var s=t+(o.pageX-n),l=r.data(e).colIndex;i.options.minimumColumnWidth>s||(i.datamanager.updateColumn(l,{width:s}),i.setColumnHeaderWidth(l))}};r.on(document.body,"mousemove",s),this.instance.on("onDestroy",function(){r.off(document.body,"mousemove",s)})}bindPerfectColumnWidth(){var e=this;r.on(this.header,"dblclick",".dt-cell .dt-cell__resize-handle",function(t,n){var i=n.parentNode.parentNode,a=r.data(i).colIndex,o=e.bodyRenderer.visibleRows.map(function(e){return e[a]}).reduce(function(e,t){return e.content.length>t.content.length?e:t}),s=e.cellmanager.getCellHTML(o),l=document.createElement("div");l.innerHTML=s;var c=l.querySelector(".dt-cell__content").textContent,d=r.getStyle(e.bodyScrollable.querySelector(".dt-cell__content")),u=[d.borderLeftWidth,d.borderRightWidth,d.paddingLeft,d.paddingRight].map(parseFloat).reduce(function(e,t){return e+t}),p=r.measureTextWidth(c)+u;e.datamanager.updateColumn(a,{width:p}),e.setColumnHeaderWidth(a),e.setColumnWidth(a)})}bindMoveColumn(){var e=this;if(!this.options.disableReorderColumn){var t=r(".dt-row",this.header);this.sortable=n.create(t,{onEnd:function(t){var n=t.oldIndex,i=t.newIndex,a=t.item;+r.data(a).colIndex!==i&&e.switchColumn(n,i)},preventOnFilter:!1,filter:".dt-cell__resize-handle, .dt-dropdown",chosenClass:"dt-cell--dragging",animation:150})}}sortColumn(e,t){var n=this;this.instance.freeze(),this.sortRows(e,t).then(function(){return n.refreshHeader(),n.rowmanager.refreshRows()}).then(function(){return n.instance.unfreeze()}).then(function(){n.fireEvent("onSortColumn",n.getColumn(e))})}removeColumn(e){var t=this,n=this.getColumn(e);this.instance.freeze(),this.datamanager.removeColumn(e).then(function(){return t.refreshHeader(),t.rowmanager.refreshRows()}).then(function(){return t.instance.unfreeze()}).then(function(){t.fireEvent("onRemoveColumn",n)})}switchColumn(e,t){var n=this;this.instance.freeze(),this.datamanager.switchColumn(e,t).then(function(){return n.refreshHeader(),n.rowmanager.refreshRows()}).then(function(){n.setColumnWidth(e),n.setColumnWidth(t),n.instance.unfreeze()}).then(function(){n.fireEvent("onSwitchColumn",n.getColumn(e),n.getColumn(t))})}toggleFilter(e){var t;this.options.inlineFilters&&((t=void 0===e?!this.isFilterShown:e)?r.style(this.$filterRow,{display:""}):r.style(this.$filterRow,{display:"none"}),this.isFilterShown=t,this.style.setBodyStyle())}focusFilter(e){this.isFilterShown&&r(".dt-cell--col-"+e+" .dt-filter",this.$filterRow).focus()}bindFilter(){var e=this;this.options.inlineFilters&&r.on(this.header,"keydown",".dt-filter",ot(function(t){e.applyFilter(e.getAppliedFilters())},300))}applyFilter(e){var t=this;this.datamanager.filterRows(e).then(function(e){var n=e.rowsToShow;t.rowmanager.showRows(n)})}getAppliedFilters(){var e={};return r.each(".dt-filter",this.header).map(function(t){var n=t.value;n&&(e[t.dataset.colIndex]=n)}),e}applyDefaultSortOrder(){var e=this.getColumns().filter(function(e){return"none"!==e.sortOrder});if(1===e.length){var t=e[0];this.sortColumn(t.colIndex,t.sortOrder)}}sortRows(e,t){return this.datamanager.sortRows(e,t)}getColumn(e){return this.datamanager.getColumn(e)}getColumns(){return this.datamanager.getColumns()}setColumnWidth(e,t){e=+e;var n=t||this.getColumn(e).width,r=[".dt-cell__content--col-"+e,".dt-cell__edit--col-"+e].join(", "),i={width:n+"px"};this.style.setStyle(r,i)}setColumnHeaderWidth(e){e=+e,this.$columnMap=this.$columnMap||[];var t=".dt-cell__content--header-"+e,n=this.getColumn(e).width,r=this.$columnMap[e];r||(r=this.header.querySelector(t),this.$columnMap[e]=r),r.style.width=n+"px"}getColumnMinWidth(e){return e=+e,this.getColumn(e).minWidth||24}getFirstColumnIndex(){return this.datamanager.getColumnIndexById("_rowIndex")+1}getHeaderCell$(e){return r(".dt-cell--header-"+e,this.header)}getLastColumnIndex(){return this.datamanager.getColumnCount()-1}getDropdownHTML(){return'\n            <div class="dt-dropdown">\n                <div class="dt-dropdown__toggle">'+this.options.dropdownButton+"</div>\n            </div>\n      "}getDropdownListHTML(){return'\n            <div class="dt-dropdown__list">\n            '+this.options.headerDropdown.map(function(e,t){return'\n                <div class="dt-dropdown__list-item" data-index="'+t+'">'+e.label+"</div>\n            "}).join("")+"\n            </div>\n        "}},RowManager:class{constructor(e){this.instance=e,lt(this,this.instance,["options","fireEvent","wrapper","bodyScrollable","bodyRenderer","style"]),this.bindEvents(),this.refreshRows=st(this.refreshRows,this)}get datamanager(){return this.instance.datamanager}get cellmanager(){return this.instance.cellmanager}bindEvents(){this.bindCheckbox()}bindCheckbox(){var e=this;this.options.checkboxColumn&&(this.checkMap=[],r.on(this.wrapper,"click",'.dt-cell--col-0 [type="checkbox"]',function(t,n){var i=n.closest(".dt-cell"),a=r.data(i),o=a.rowIndex,s=a.isHeader,l=n.checked;s?e.checkAll(l):e.checkRow(o,l)}))}refreshRows(){this.instance.renderBody(),this.instance.setDimensions()}refreshRow(e,t){var n=this;this.datamanager.updateRow(e,t).forEach(function(e){n.cellmanager.refreshCell(e)})}getCheckedRows(){if(!this.checkMap)return[];var e=[];for(var t in this.checkMap)1===this.checkMap[t]&&e.push(t);return e}highlightCheckedRows(){var e=this;this.getCheckedRows().map(function(t){return e.checkRow(t,!0)})}checkRow(e,t){var n=t?1:0;this.checkMap[e]=n,r.each(function(e){return".dt-cell--0-"+e+' [type="checkbox"]'}(e),this.bodyScrollable).map(function(e){e.checked=t}),this.highlightRow(e,t),this.showCheckStatus(),this.fireEvent("onCheckRow",this.datamanager.getRow(e))}checkAll(e){var t=e?1:0;this.checkMap=e?Array.from(Array(this.getTotalRows())).map(function(e){return t}):[],r.each('.dt-cell--col-0 [type="checkbox"]',this.bodyScrollable).map(function(t){t.checked=e}),this.highlightAll(e),this.showCheckStatus(),this.fireEvent("onCheckRow")}showCheckStatus(){if(this.options.checkedRowStatus){var e=this.getCheckedRows().length;e>0?this.bodyRenderer.showToastMessage(e+" row"+(e>1?"s":"")+" selected"):this.bodyRenderer.clearToastMessage()}}highlightRow(e,t){void 0===t&&(t=!0);var n=this.getRow$(e);n&&(t||!this.bodyScrollable.classList.contains("dt-scrollable--highlight-all")?(t&&n.classList.contains("dt-row--unhighlight")&&n.classList.remove("dt-row--unhighlight"),this._highlightedRows=this._highlightedRows||{},t?(n.classList.add("dt-row--highlight"),this._highlightedRows[e]=n):(n.classList.remove("dt-row--highlight"),delete this._highlightedRows[e])):n.classList.add("dt-row--unhighlight"))}highlightAll(e){if(void 0===e&&(e=!0),e)this.bodyScrollable.classList.add("dt-scrollable--highlight-all");else{for(var t in this.bodyScrollable.classList.remove("dt-scrollable--highlight-all"),this._highlightedRows)this._highlightedRows[t].classList.remove("dt-row--highlight");this._highlightedRows={}}}showRows(e){var t,n=this;t=e;var r=(e=Array.isArray(t)?t:[t]).map(function(e){return n.datamanager.getRow(e)});this.bodyRenderer.renderRows(r)}showAllRows(){var e=this.datamanager.getAllRowIndices();this.showRows(e)}getChildrenToShowForNode(e){return this.datamanager.getRow(e).meta.isTreeNodeClose=!1,this.datamanager.getImmediateChildren(e)}openSingleNode(e){var t=this.getChildrenToShowForNode(e),n=this.bodyRenderer.visibleRowIndices,r=dt(t.concat(n)).sort(ut);this.showRows(r)}getChildrenToHideForNode(e){var t=this;this.datamanager.getRow(e).meta.isTreeNodeClose=!0;var n=this.datamanager.getChildren(e);return n.forEach(function(e){var n=t.datamanager.getRow(e);n.meta.isLeaf||(n.meta.isTreeNodeClose=!0)}),n}closeSingleNode(e){var t=this.getChildrenToHideForNode(e),n=this.bodyRenderer.visibleRowIndices.filter(function(e){return!t.includes(e)}).sort(ut);this.showRows(n)}expandAllNodes(){var e=this,t=this.datamanager.getRows().filter(function(e){return!e.meta.isLeaf}).map(function(t){return e.getChildrenToShowForNode(t.meta.rowIndex)}).flat(),n=this.bodyRenderer.visibleRowIndices,r=dt(t.concat(n)).sort(ut);this.showRows(r)}collapseAllNodes(){var e=this,t=this.datamanager.getRows().filter(function(e){return 0===e.meta.indent}).map(function(t){return e.getChildrenToHideForNode(t.meta.rowIndex)}).flat(),n=this.bodyRenderer.visibleRowIndices.filter(function(e){return!t.includes(e)}).sort(ut);this.showRows(n)}setTreeDepth(e){var t=this.datamanager.getRows(),n=t.filter(function(t){return t.meta.indent<e}),r=t.filter(function(t){return t.meta.indent>=e}),i=r.filter(function(t){return t.meta.indent>e});r.forEach(function(e){e.meta.isLeaf||(e.meta.isTreeNodeClose=!0)}),n.forEach(function(e){e.meta.isLeaf||(e.meta.isTreeNodeClose=!1)});var a=t.filter(function(e){return!i.includes(e)}).map(function(e){return e.meta.rowIndex}).sort(ut);this.showRows(a)}getRow$(e){return r(this.selector(e),this.bodyScrollable)}getTotalRows(){return this.datamanager.getRowCount()}getFirstRowIndex(){return 0}getLastRowIndex(){return this.datamanager.getRowCount()-1}scrollToRow(e){e=+e,this._lastScrollTo=this._lastScrollTo||0;var t=this.getRow$(e);if(!r.inViewport(t,this.bodyScrollable)){var n=t.getBoundingClientRect().height,i=this.bodyScrollable.getBoundingClientRect(),a=i.top,o=i.bottom,s=Math.floor((o-a)/n),l=0;l=e>this._lastScrollTo?n*(e+1-s):n*(e+1-1),this._lastScrollTo=e,r.scrollTop(this.bodyScrollable,l)}}getRowHTML(e,t){var n=this,r=rt(t),i=t.rowIndex;return t.isFilter&&(e=e.map(function(e){return Object.assign({},e,{content:n.getFilterInput({colIndex:e.colIndex}),isFilter:1,isHeader:void 0,editable:!1})}),i="filter"),t.isHeader&&(i="header"),'\n            <div class="dt-row dt-row-'+i+'" '+r+">\n                "+e.map(function(e){return n.cellmanager.getCellHTML(e)}).join("")+"\n            </div>\n        "}getFilterInput(e){return'<input class="dt-filter dt-input" type="text" '+rt(e)+' tabindex="1" />'}selector(e){return".dt-row-"+e}},BodyRenderer:class{constructor(e){this.instance=e,this.options=e.options,this.datamanager=e.datamanager,this.rowmanager=e.rowmanager,this.cellmanager=e.cellmanager,this.bodyScrollable=e.bodyScrollable,this.footer=this.instance.footer,this.log=e.log}renderRows(e){var t=this;if(this.visibleRows=e,this.visibleRowIndices=e.map(function(e){return e.meta.rowIndex}),0!==e.length){var n=this.datamanager.rowViewOrder.map(function(e){return t.visibleRowIndices.includes(e)?e:null}).filter(function(e){return null!==e}),r=getComputedStyle(this.bodyScrollable),i={width:r.width,height:r.height,itemHeight:this.options.cellHeight,total:e.length,generate:function(e){var r=document.createElement("div"),i=n[e],a=t.datamanager.getRow(i),o=t.rowmanager.getRowHTML(a,a.meta);return r.innerHTML=o,r.children[0]},afterRender:function(){t.restoreState()}};this.hyperlist?this.hyperlist.refresh(this.bodyScrollable,i):this.hyperlist=new mt(this.bodyScrollable,i),this.renderFooter()}else this.bodyScrollable.innerHTML=this.getNoDataHTML()}render(){var e=this.datamanager.getRowsForView();this.renderRows(e),this.instance.setDimensions()}renderFooter(){if(this.options.showTotalRow){var e=this.getTotalRow(),t=this.rowmanager.getRowHTML(e,{isTotalRow:1,rowIndex:"totalRow"});this.footer.innerHTML=t}}getTotalRow(){var e=this;return this.datamanager.getColumns().map(function(e){var t=null;return["_rowIndex","_checkbox"].includes(e.id)&&(t=""),{content:t,isTotalRow:1,colIndex:e.colIndex,column:e}}).map(function(t,n){if(""===t.content)return t;if(e.options.hooks.columnTotal){var r=e.visibleRows.map(function(e){return e[n].content}),i=e.options.hooks.columnTotal.call(e.instance,r,t);if(null!=i)return t.content=i,t}return t.content=e.visibleRows.reduce(function(e,t){var r=t[n];return"number"==typeof r.content?(null==e&&(e=0),e+r.content):e},t.content),t})}restoreState(){this.rowmanager.highlightCheckedRows(),this.cellmanager.selectAreaOnClusterChanged(),this.cellmanager.focusCellOnClusterChanged()}showToastMessage(e,t){var n=this;this.instance.toastMessage.innerHTML=this.getToastMessageHTML(e),t&&setTimeout(function(){n.clearToastMessage()},1e3*t)}clearToastMessage(){this.instance.toastMessage.innerHTML=""}getNoDataHTML(){return'<div class="dt-scrollable__no-data">'+this.options.noDataMessage+"</div>"}getToastMessageHTML(e){return'<span class="dt-toast__message">'+e+"</span>"}},Style:class{constructor(e){this.instance=e,lt(this,this.instance,["options","datamanager","columnmanager","header","footer","bodyScrollable","datatableWrapper","getColumn","bodyRenderer"]),this.scopeClass="dt-instance-"+e.constructor.instances,e.datatableWrapper.classList.add(this.scopeClass);var t=document.createElement("style");e.wrapper.insertBefore(t,e.datatableWrapper),this.styleEl=t,this.bindResizeWindow(),this.bindScrollHeader()}get stylesheet(){return this.styleEl.sheet}bindResizeWindow(){this.onWindowResize=this.onWindowResize.bind(this),this.onWindowResize=at(this.onWindowResize,300),"fluid"===this.options.layout&&r.on(window,"resize",this.onWindowResize)}bindScrollHeader(){var e=this;this._settingHeaderPosition=!1,r.on(this.bodyScrollable,"scroll",function(t){e._settingHeaderPosition||(e._settingHeaderPosition=!0,requestAnimationFrame(function(){var n=-t.target.scrollLeft;r.style(e.header,{transform:"translateX("+n+"px)"}),r.style(e.footer,{transform:"translateX("+n+"px)"}),e._settingHeaderPosition=!1}))})}onWindowResize(){this.distributeRemainingWidth(),this.refreshColumnWidth(),this.setBodyStyle()}destroy(){this.styleEl.remove(),r.off(window,"resize",this.onWindowResize)}setStyle(e,t){var n=this;if(e.includes(","))e.split(",").map(function(e){return e.trim()}).forEach(function(e){n.setStyle(e,t)});else if(e=e.trim()){this._styleRulesMap=this._styleRulesMap||{};var r=this._getPrefixedSelector(e);this._styleRulesMap[r]&&(this.removeStyle(e),t=Object.assign({},this._styleRulesMap[r],t));var i=r+" { "+this._getRuleString(t)+" }";this._styleRulesMap[r]=t,this.stylesheet.insertRule(i)}}removeStyle(e){var t=this;if(e.includes(","))e.split(",").map(function(e){return e.trim()}).forEach(function(e){t.removeStyle(e)});else if(e=e.trim()){var n=this._getPrefixedSelector(e),r=Array.from(this.stylesheet.cssRules).findIndex(function(e){return e.selectorText===n});-1!==r&&this.stylesheet.deleteRule(r)}}_getPrefixedSelector(e){return"."+this.scopeClass+" "+e}_getRuleString(e){return Object.keys(e).map(function(t){var n=t;return t.includes("-")||(n=nt(t)),n+":"+e[t]+";"}).join("")}setDimensions(){this.setCellHeight(),this.setupMinWidth(),this.setupNaturalColumnWidth(),this.setupColumnWidth(),this.distributeRemainingWidth(),this.setColumnStyle(),this.setBodyStyle()}setCellHeight(){this.setStyle(".dt-cell",{height:this.options.cellHeight+"px"})}setupMinWidth(){var e=this;r.each(".dt-cell--header",this.header).map(function(t){var n=r.data(t).colIndex,i=e.getColumn(n);if(!i.minWidth){var a=r.style(r(".dt-cell__content",t),"width");i.minWidth=a}})}setupNaturalColumnWidth(){var e=this;r(".dt-row")&&(r.each(".dt-row-header .dt-cell",this.header).map(function(t){var n=r.data(t).colIndex,i=e.datamanager.getColumn(n),a=r.style(r(".dt-cell__content",t),"width");"number"==typeof a&&a>=e.options.minimumColumnWidth?i.naturalWidth=a:i.naturalWidth=e.options.minimumColumnWidth}),r.each(".dt-row-0 .dt-cell",this.bodyScrollable).map(function(t){var n=r.data(t).colIndex,i=e.datamanager.getColumn(n),a=r.style(r(".dt-cell__content",t),"width");"number"==typeof a&&a>=i.naturalWidth?i.naturalWidth=a:i.naturalWidth=i.naturalWidth}))}setupColumnWidth(){var e=this;if("ratio"===this.options.layout){var t=r.style(this.datatableWrapper,"width");this.options.serialNoColumn&&(t=t-this.datamanager.getColumnById("_rowIndex").width-1),this.options.checkboxColumn&&(t=t-this.datamanager.getColumnById("_checkbox").width-1);var n=t/this.datamanager.getColumns().map(function(e){return"_rowIndex"===e.id||"_checkbox"===e.id?0:(e.width||(e.width=1),e.ratioWidth=parseInt(e.width,10),e.ratioWidth)}).reduce(function(e,t){return e+t});this.datamanager.getColumns().map(function(e){"_rowIndex"!==e.id&&"_checkbox"!==e.id&&(e.width=Math.floor(n*e.ratioWidth)-1)})}else this.datamanager.getColumns().map(function(t){t.width||(t.width=t.naturalWidth),"_rowIndex"===t.id&&(t.width=e.getRowIndexColumnWidth()),t.width<e.options.minimumColumnWidth&&(t.width=e.options.minimumColumnWidth)})}distributeRemainingWidth(){var e=this;if("fluid"===this.options.layout){var t=r.style(this.instance.datatableWrapper,"width"),n=r(".dt-row",this.bodyScrollable),i=t;if(n)i=r.style(n,"width");else{var a=r(".dt-row",this.instance.header);i=Array.from(a.children).map(function(e){return e.offsetWidth}).reduce(function(e,t){return e+t},0)}var o=this.datamanager.getColumns().filter(function(e){return e.resizable}),s=(t-i)/o.length;o.map(function(t){var n=r.style(e.getColumnHeaderElement(t.colIndex),"width"),i=Math.floor(n+s)-2;e.datamanager.updateColumn(t.colIndex,{width:i})})}}setColumnStyle(){var e=this;this.datamanager.getColumns().map(function(t){t.align||(t.align="left"),["left","center","right"].includes(t.align)||(t.align="left"),e.setStyle(".dt-cell--col-"+t.colIndex,{"text-align":t.align}),e.columnmanager.setColumnHeaderWidth(t.colIndex),e.columnmanager.setColumnWidth(t.colIndex)})}refreshColumnWidth(){var e=this;this.datamanager.getColumns().map(function(t){e.columnmanager.setColumnHeaderWidth(t.colIndex),e.columnmanager.setColumnWidth(t.colIndex)})}setBodyStyle(){var e=r.style(this.datatableWrapper,"width"),t=r(".dt-row",this.bodyScrollable);if(t){var n=r.style(t,"width"),i=e>n?n:e;r.style(this.bodyScrollable,{width:i+"px"}),r.removeStyle(this.bodyScrollable,"height");var a,o=r.getStyle(this.bodyScrollable,"height"),s=(this.bodyRenderer.hyperlist||{})._scrollHeight||1/0,l=r.hasHorizontalOverflow(this.bodyScrollable);s<o&&(a=s,l&&(a+=r.scrollbarSize()),r.style(this.bodyScrollable,{height:a+"px"})),this.bodyScrollable.scrollHeight-this.bodyScrollable.offsetHeight<r.scrollbarSize()&&r.style(this.bodyScrollable,{overflowY:"hidden"}),"fluid"===this.options.layout&&r.style(this.bodyScrollable,{overflowX:"hidden"})}}getColumnHeaderElement(e){return(e=+e)<0?null:r(".dt-cell--col-"+e,this.header)}getRowIndexColumnWidth(){var e=this.datamanager.getRowCount();return r.measureTextWidth(e+"")+22}},Keyboard:class{constructor(e){this.listeners={},r.on(e,"keydown",this.handler.bind(this))}handler(e){var t=gt[e.keyCode];e.shiftKey&&"shift"!==t&&(t="shift+"+t),(e.ctrlKey&&"ctrl"!==t||e.metaKey&&"meta"!==t)&&(t="ctrl+"+t);var n=this.listeners[t];if(n&&n.length>0)for(var r=0,i=n;r<i.length;r+=1){var a=(0,i[r])(e);void 0!==a&&!0!==a||e.preventDefault()}}on(e,t){var n=this;e.split(",").map(function(e){return e.trim()}).map(function(e){n.listeners[e]=n.listeners[e]||[],n.listeners[e].push(t)})}}};class yt{constructor(e,t){if(yt.instances++,"string"==typeof e&&(e=document.querySelector(e)),this.wrapper=e,!(this.wrapper instanceof HTMLElement))throw new Error("Invalid argument given for `wrapper`");this.buildOptions(t),this.prepare(),this.initializeComponents(),this.options.data&&(this.refresh(),this.columnmanager.applyDefaultSortOrder())}buildOptions(e){this.options=this.options||{},this.options=Object.assign({},vt,this.options||{},e),e.headerDropdown=e.headerDropdown||[],this.options.headerDropdown=vt.headerDropdown.concat(e.headerDropdown),this.events=Object.assign({},vt.events,this.options.events||{},e.events||{}),this.fireEvent=this.fireEvent.bind(this)}prepare(){this.prepareDom(),this.unfreeze()}initializeComponents(){var e=Object.assign({},bt,this.options.overrideComponents),t=e.Style,n=e.Keyboard,r=e.DataManager,i=e.RowManager,a=e.ColumnManager,o=e.CellManager,s=e.BodyRenderer;this.style=new t(this),this.keyboard=new n(this.wrapper),this.datamanager=new r(this.options),this.rowmanager=new i(this),this.columnmanager=new a(this),this.cellmanager=new o(this),this.bodyRenderer=new s(this)}prepareDom(){this.wrapper.innerHTML='\n            <div class="datatable" dir="'+this.options.direction+'">\n                <div class="dt-header"></div>\n                <div class="dt-scrollable"></div>\n                <div class="dt-footer"></div>\n                <div class="dt-freeze">\n                    <span class="dt-freeze__message">\n                        '+this.options.freezeMessage+'\n                    </span>\n                </div>\n                <div class="dt-toast"></div>\n                <div class="dt-dropdown-container"></div>\n                <textarea class="dt-paste-target"></textarea>\n            </div>\n        ',this.datatableWrapper=r(".datatable",this.wrapper),this.header=r(".dt-header",this.wrapper),this.footer=r(".dt-footer",this.wrapper),this.bodyScrollable=r(".dt-scrollable",this.wrapper),this.freezeContainer=r(".dt-freeze",this.wrapper),this.toastMessage=r(".dt-toast",this.wrapper),this.pasteTarget=r(".dt-paste-target",this.wrapper),this.dropdownContainer=r(".dt-dropdown-container",this.wrapper)}refresh(e,t){this.datamanager.init(e,t),this.render(),this.setDimensions()}destroy(){this.wrapper.innerHTML="",this.style.destroy(),this.fireEvent("onDestroy")}appendRows(e){this.datamanager.appendRows(e),this.rowmanager.refreshRows()}refreshRow(e,t){this.rowmanager.refreshRow(e,t)}render(){this.renderHeader(),this.renderBody()}renderHeader(){this.columnmanager.renderHeader()}renderBody(){this.bodyRenderer.render()}setDimensions(){this.style.setDimensions()}showToastMessage(e,t){this.bodyRenderer.showToastMessage(e,t)}clearToastMessage(){this.bodyRenderer.clearToastMessage()}getColumn(e){return this.datamanager.getColumn(e)}getColumns(){return this.datamanager.getColumns()}getRows(){return this.datamanager.getRows()}getCell(e,t){return this.datamanager.getCell(e,t)}getColumnHeaderElement(e){return this.columnmanager.getColumnHeaderElement(e)}getViewportHeight(){return this.viewportHeight||(this.viewportHeight=r.style(this.bodyScrollable,"height")),this.viewportHeight}sortColumn(e,t){this.columnmanager.sortColumn(e,t)}removeColumn(e){this.columnmanager.removeColumn(e)}scrollToLastColumn(){this.datatableWrapper.scrollLeft=9999}freeze(){r.style(this.freezeContainer,{display:""})}unfreeze(){r.style(this.freezeContainer,{display:"none"})}updateOptions(e){this.buildOptions(e)}fireEvent(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];for(var r=0,i=(this._internalEventHandlers[e]||[]).concat([this.events[e]]).filter(Boolean);r<i.length;r+=1){i[r].apply(this,t)}}on(e,t){this._internalEventHandlers=this._internalEventHandlers||{},this._internalEventHandlers[e]=this._internalEventHandlers[e]||[],this._internalEventHandlers[e].push(t)}log(){this.options.logs&&console.log.apply(console,arguments)}}yt.instances=0;var wt="0.0.0-development";yt.__version__=wt,e.exports=yt}),DataTable=unwrapExports(frappeDatatable_cjs);frappe.DataTable=DataTable;var driver_min=createCommonjsModule(function(e,t){window,e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist/",n(n.s=57)}([function(e,t,n){var r=n(2),i=n(11),a=n(4),o=n(13),s=n(22),l=function(e,t,n){var c,d,u,p,f=e&l.F,h=e&l.G,_=e&l.S,m=e&l.P,g=e&l.B,v=h?r:_?r[t]||(r[t]={}):(r[t]||{}).prototype,b=h?i:i[t]||(i[t]={}),y=b.prototype||(b.prototype={});for(c in h&&(n=t),n)u=((d=!f&&v&&void 0!==v[c])?v:n)[c],p=g&&d?s(u,r):m&&"function"==typeof u?s(Function.call,u):u,v&&o(v,c,u,e&l.U),b[c]!=u&&a(b,c,p),m&&y[c]!=u&&(y[c]=u)};r.core=i,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,n){var r=n(17)("wks"),i=n(14),a=n(2).Symbol,o="function"==typeof a;(e.exports=function(e){return r[e]||(r[e]=o&&a[e]||(o?a:i)("Symbol."+e))}).store=r},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){var r=n(5),i=n(16);e.exports=n(6)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(12),i=n(35),a=n(21),o=Object.defineProperty;t.f=n(6)?Object.defineProperty:function(e,t,n){if(r(e),t=a(t,!0),r(n),i)try{return o(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){e.exports=!n(7)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(39),i=n(24);e.exports=function(e){return r(i(e))}},function(e,t,n){var r=n(0);r(r.S+r.F*!n(6),"Object",{defineProperty:n(5).f})},function(e,t){var n=e.exports={version:"2.6.9"};"number"==typeof __e&&(__e=n)},function(e,t,n){var r=n(3);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){var r=n(2),i=n(4),a=n(8),o=n(14)("src"),s=n(59),l=(""+s).split("toString");n(11).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var c="function"==typeof n;c&&(a(n,"name")||i(n,"name",t)),e[t]!==n&&(c&&(a(n,o)||i(n,o,e[t]?""+e[t]:l.join(String(t)))),e===r?e[t]=n:s?e[t]?e[t]=n:i(e,t,n):(delete e[t],i(e,t,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[o]||s.call(this)})},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t,n){var r=n(45),i=n(28);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(11),i=n(2),a=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(18)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports=!1},function(e,t,n){var r=n(24);e.exports=function(e){return Object(r(e))}},function(e,t,n){var r=n(2),i=n(8),a=n(6),o=n(0),s=n(13),l=n(62).KEY,c=n(7),d=n(17),u=n(26),p=n(14),f=n(1),h=n(43),_=n(44),m=n(63),g=n(42),v=n(12),b=n(3),y=n(19),w=n(9),k=n(21),x=n(16),C=n(30),S=n(67),E=n(49),$=n(47),T=n(5),A=n(15),P=E.f,O=T.f,R=S.f,I=r.Symbol,L=r.JSON,j=L&&L.stringify,N=f("_hidden"),D=f("toPrimitive"),M={}.propertyIsEnumerable,H=d("symbol-registry"),F=d("symbols"),z=d("op-symbols"),U=Object.prototype,B="function"==typeof I&&!!$.f,q=r.QObject,W=!q||!q.prototype||!q.prototype.findChild,G=a&&c(function(){return 7!=C(O({},"a",{get:function(){return O(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=P(U,t);r&&delete U[t],O(e,t,n),r&&e!==U&&O(U,t,r)}:O,V=function(e){var t=F[e]=C(I.prototype);return t._k=e,t},Y=B&&"symbol"==typeof I.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof I},K=function(e,t,n){return e===U&&K(z,t,n),v(e),t=k(t,!0),v(n),i(F,t)?(n.enumerable?(i(e,N)&&e[N][t]&&(e[N][t]=!1),n=C(n,{enumerable:x(0,!1)})):(i(e,N)||O(e,N,x(1,{})),e[N][t]=!0),G(e,t,n)):O(e,t,n)},X=function(e,t){v(e);for(var n,r=m(t=w(t)),i=0,a=r.length;a>i;)K(e,n=r[i++],t[n]);return e},J=function(e){var t=M.call(this,e=k(e,!0));return!(this===U&&i(F,e)&&!i(z,e))&&(!(t||!i(this,e)||!i(F,e)||i(this,N)&&this[N][e])||t)},Q=function(e,t){if(e=w(e),t=k(t,!0),e!==U||!i(F,t)||i(z,t)){var n=P(e,t);return!n||!i(F,t)||i(e,N)&&e[N][t]||(n.enumerable=!0),n}},Z=function(e){for(var t,n=R(w(e)),r=[],a=0;n.length>a;)i(F,t=n[a++])||t==N||t==l||r.push(t);return r},ee=function(e){for(var t,n=e===U,r=R(n?z:w(e)),a=[],o=0;r.length>o;)!i(F,t=r[o++])||n&&!i(U,t)||a.push(F[t]);return a};B||(s((I=function(){if(this instanceof I)throw TypeError("Symbol is not a constructor!");var e=p(arguments.length>0?arguments[0]:void 0),t=function(n){this===U&&t.call(z,n),i(this,N)&&i(this[N],e)&&(this[N][e]=!1),G(this,e,x(1,n))};return a&&W&&G(U,e,{configurable:!0,set:t}),V(e)}).prototype,"toString",function(){return this._k}),E.f=Q,T.f=K,n(48).f=S.f=Z,n(29).f=J,$.f=ee,a&&!n(18)&&s(U,"propertyIsEnumerable",J,!0),h.f=function(e){return V(f(e))}),o(o.G+o.W+o.F*!B,{Symbol:I});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;te.length>ne;)f(te[ne++]);for(var re=A(f.store),ie=0;re.length>ie;)_(re[ie++]);o(o.S+o.F*!B,"Symbol",{for:function(e){return i(H,e+="")?H[e]:H[e]=I(e)},keyFor:function(e){if(!Y(e))throw TypeError(e+" is not a symbol!");for(var t in H)if(H[t]===e)return t},useSetter:function(){W=!0},useSimple:function(){W=!1}}),o(o.S+o.F*!B,"Object",{create:function(e,t){return void 0===t?C(e):X(C(e),t)},defineProperty:K,defineProperties:X,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:ee});var ae=c(function(){$.f(1)});o(o.S+o.F*ae,"Object",{getOwnPropertySymbols:function(e){return $.f(y(e))}}),L&&o(o.S+o.F*(!B||c(function(){var e=I();return"[null]"!=j([e])||"{}"!=j({a:e})||"{}"!=j(Object(e))})),"JSON",{stringify:function(e){for(var t,n,r=arguments,i=[e],a=1;arguments.length>a;)i.push(r[a++]);if(n=t=i[1],(b(t)||void 0!==e)&&!Y(e))return g(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!Y(t))return t}),i[1]=t,j.apply(L,i)}}),I.prototype[D]||n(4)(I.prototype,D,I.prototype.valueOf),u(I,"Symbol"),u(Math,"Math",!0),u(r.JSON,"JSON",!0)},function(e,t,n){var r=n(3);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var r=n(37);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(7);e.exports=function(e,t){return!!e&&r(function(){t?e.call(null,function(){},1):e.call(null)})}},function(e,t,n){var r=n(5).f,i=n(8),a=n(1)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,a)&&r(e,a,{configurable:!0,value:t})}},function(e,t,n){var r=n(17)("keys"),i=n(14);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){var r=n(12),i=n(65),a=n(28),o=n(27)("IE_PROTO"),s=function(){},l=function(){var e,t=n(36)("iframe"),r=a.length;for(t.style.display="none",n(66).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;r--;)delete l.prototype[a[r]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=r(e),n=new s,s.prototype=null,n[o]=e):n=l(),void 0===t?n:i(n,t)}},function(e,t,n){var r=n(68),i=n(69),a=n(32),o=n(9);e.exports=n(70)(Array,"Array",function(e,t){this._t=o(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),a.Arguments=a.Array,r("keys"),r("values"),r("entries")},function(e,t){e.exports={}},function(e,t,n){n(44)("asyncIterator")},function(e,t,n){var r=n(0),i=n(38)(0),a=n(25)([].forEach,!0);r(r.P+r.F*!a,"Array",{forEach:function(e){return i(this,e,arguments[1])}})},function(e,t,n){e.exports=!n(6)&&!n(7)(function(){return 7!=Object.defineProperty(n(36)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(3),i=n(2).document,a=r(i)&&r(i.createElement);e.exports=function(e){return a?i.createElement(e):{}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(22),i=n(39),a=n(19),o=n(40),s=n(60);e.exports=function(e,t){var n=1==e,l=2==e,c=3==e,d=4==e,u=6==e,p=5==e||u,f=t||s;return function(t,s,h){for(var _,m,g=a(t),v=i(g),b=r(s,h,3),y=o(v.length),w=0,k=n?f(t,y):l?f(t,0):void 0;y>w;w++)if((p||w in v)&&(m=b(_=v[w],w,g),e))if(n)k[w]=m;else if(m)switch(e){case 3:return!0;case 5:return _;case 6:return w;case 2:k.push(_)}else if(d)return!1;return u?-1:c||d?d:k}}},function(e,t,n){var r=n(23);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){var r=n(41),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(23);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){t.f=n(1)},function(e,t,n){var r=n(2),i=n(11),a=n(18),o=n(43),s=n(5).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=a?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:o.f(e)})}},function(e,t,n){var r=n(8),i=n(9),a=n(46)(!1),o=n(27)("IE_PROTO");e.exports=function(e,t){var n,s=i(e),l=0,c=[];for(n in s)n!=o&&r(s,n)&&c.push(n);for(;t.length>l;)r(s,n=t[l++])&&(~a(c,n)||c.push(n));return c}},function(e,t,n){var r=n(9),i=n(40),a=n(64);e.exports=function(e){return function(t,n,o){var s,l=r(t),c=i(l.length),d=a(o,c);if(e&&n!=n){for(;c>d;)if((s=l[d++])!=s)return!0}else for(;c>d;d++)if((e||d in l)&&l[d]===n)return e||d||0;return!e&&-1}}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(45),i=n(28).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){var r=n(29),i=n(16),a=n(9),o=n(21),s=n(8),l=n(35),c=Object.getOwnPropertyDescriptor;t.f=n(6)?c:function(e,t){if(e=a(e),t=o(t,!0),l)try{return c(e,t)}catch(e){}if(s(e,t))return i(!r.f.call(e,t),e[t])}},function(e,t,n){for(var r=n(31),i=n(15),a=n(13),o=n(2),s=n(4),l=n(32),c=n(1),d=c("iterator"),u=c("toStringTag"),p=l.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=i(f),_=0;_<h.length;_++){var m,g=h[_],v=f[g],b=o[g],y=b&&b.prototype;if(y&&(y[d]||s(y,d,p),y[u]||s(y,u,g),l[g]=p,v))for(m in r)y[m]||a(y,m,r[m],!0)}},function(e,t,n){var r=n(73),i={};i[n(1)("toStringTag")]="z",i+""!="[object z]"&&n(13)(Object.prototype,"toString",function(){return"[object "+r(this)+"]"},!0)},function(e,t,n){var r=n(19),i=n(15);n(74)("keys",function(){return function(e){return i(r(e))}})},function(e,t,n){var r=n(0),i=n(38)(2);r(r.P+r.F*!n(25)([].filter,!0),"Array",{filter:function(e){return i(this,e,arguments[1])}})},function(e,t,n){var r=n(0);r(r.P,"Function",{bind:n(75)})},function(e,t,n){var r=n(0);r(r.S,"Object",{create:n(30)})},function(e,t,n){var r=n(0);r(r.S,"Object",{setPrototypeOf:n(81).set})},function(e,t,n){n(58),e.exports=n(82)},function(e,t){},function(e,t,n){e.exports=n(17)("native-function-to-string",Function.toString)},function(e,t,n){var r=n(61);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){var r=n(3),i=n(42),a=n(1)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),r(t)&&null===(t=t[a])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){var r=n(14)("meta"),i=n(3),a=n(8),o=n(5).f,s=0,l=Object.isExtensible||function(){return!0},c=!n(7)(function(){return l(Object.preventExtensions({}))}),d=function(e){o(e,r,{value:{i:"O"+ ++s,w:{}}})},u=e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,r)){if(!l(e))return"F";if(!t)return"E";d(e)}return e[r].i},getWeak:function(e,t){if(!a(e,r)){if(!l(e))return!0;if(!t)return!1;d(e)}return e[r].w},onFreeze:function(e){return c&&u.NEED&&l(e)&&!a(e,r)&&d(e),e}}},function(e,t,n){var r=n(15),i=n(47),a=n(29);e.exports=function(e){var t=r(e),n=i.f;if(n)for(var o,s=n(e),l=a.f,c=0;s.length>c;)l.call(e,o=s[c++])&&t.push(o);return t}},function(e,t,n){var r=n(41),i=Math.max,a=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):a(e,t)}},function(e,t,n){var r=n(5),i=n(12),a=n(15);e.exports=n(6)?Object.defineProperties:function(e,t){i(e);for(var n,o=a(t),s=o.length,l=0;s>l;)r.f(e,n=o[l++],t[n]);return e}},function(e,t,n){var r=n(2).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(9),i=n(48).f,a={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return o&&"[object Window]"==a.call(e)?function(e){try{return i(e)}catch(e){return o.slice()}}(e):i(r(e))}},function(e,t,n){var r=n(1)("unscopables"),i=Array.prototype;null==i[r]&&n(4)(i,r,{}),e.exports=function(e){i[r][e]=!0}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){var r=n(18),i=n(0),a=n(13),o=n(4),s=n(32),l=n(71),c=n(26),d=n(72),u=n(1)("iterator"),p=!([].keys&&"next"in[].keys()),f=function(){return this};e.exports=function(e,t,n,h,_,m,g){l(n,t,h);var v,b,y,w=function(e){if(!p&&e in S)return S[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},k=t+" Iterator",x="values"==_,C=!1,S=e.prototype,E=S[u]||S["@@iterator"]||_&&S[_],$=E||w(_),T=_?x?w("entries"):$:void 0,A="Array"==t&&S.entries||E;if(A&&(y=d(A.call(new e)))!==Object.prototype&&y.next&&(c(y,k,!0),r||"function"==typeof y[u]||o(y,u,f)),x&&E&&"values"!==E.name&&(C=!0,$=function(){return E.call(this)}),r&&!g||!p&&!C&&S[u]||o(S,u,$),s[t]=$,s[k]=f,_)if(v={values:x?$:w("values"),keys:m?$:w("keys"),entries:T},g)for(b in v)b in S||a(S,b,v[b]);else i(i.P+i.F*(p||C),t,v);return v}},function(e,t,n){var r=n(30),i=n(16),a=n(26),o={};n(4)(o,n(1)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=r(o,{next:i(1,n)}),a(e,t+" Iterator")}},function(e,t,n){var r=n(8),i=n(19),a=n(27)("IE_PROTO"),o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},function(e,t,n){var r=n(23),i=n(1)("toStringTag"),a="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?n:a?r(t):"Object"==(o=r(t))&&"function"==typeof t.callee?"Arguments":o}},function(e,t,n){var r=n(0),i=n(11),a=n(7);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],o={};o[e]=t(n),r(r.S+r.F*a(function(){n(1)}),"Object",o)}},function(e,t,n){var r=n(37),i=n(3),a=n(76),o=[].slice,s={};e.exports=Function.bind||function(e){var t=r(this),n=o.call(arguments,1),l=function(){var r=n.concat(o.call(arguments));return this instanceof l?function(e,t,n){if(!(t in s)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";s[t]=Function("F,a","return new F("+r.join(",")+")")}return s[t](e,n)}(t,r.length,r):a(t,r,e)};return i(t.prototype)&&(l.prototype=t.prototype),l}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){n(78)("trim",function(e){return function(){return e(this,3)}})},function(e,t,n){var r=n(0),i=n(24),a=n(7),o=n(79),s="["+o+"]",l=RegExp("^"+s+s+"*"),c=RegExp(s+s+"*$"),d=function(e,t,n){var i={},s=a(function(){return!!o[e]()||"​"!="​"[e]()}),l=i[e]=s?t(u):o[e];n&&(i[n]=l),r(r.P+r.F*s,"String",i)},u=d.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(l,"")),2&t&&(e=e.replace(c,"")),e};e.exports=d},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t,n){var r=n(0),i=n(46)(!1),a=[].indexOf,o=!!a&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(o||!n(25)(a)),"Array",{indexOf:function(e){return o?a.apply(this,arguments)||0:i(this,e,arguments[1])}})},function(e,t,n){var r=n(3),i=n(12),a=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=n(22)(Function.call,n(49).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return a(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:a}},function(e,t,n){n.r(t),n(34),n(20),n(50),n(31),n(51),n(52),n(10),n(53),n(54);var r=.75,i=10,a=!0,o=!0,s=!0,l=!1,c="driver-highlighted-element-stage",d='<div id="'.concat("driver-page-overlay",'"></div>'),u='<div id="'.concat(c,'"></div>');function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(33),n(77);var f=function(e){var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild},h=function e(t,n){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]){for(var r=["","-webkit-","-ms-","moz-","-o-"],i=0;i<r.length;i++){var a=e(t,r[i]+n);if(a)return a}return""}var o="";return t.currentStyle?o=t.currentStyle[n]:document.defaultView&&document.defaultView.getComputedStyle&&(o=document.defaultView.getComputedStyle(t,null).getPropertyValue(n)),o&&o.toLowerCase?o.toLowerCase():o},_=function(e){return e&&"object"===p(e)&&"nodeType"in e},m=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.highlightedElement=null,this.lastHighlightedElement=null,this.hideTimer=null,this.window=n,this.document=r,this.removeNode=this.removeNode.bind(this)}var t,n;return t=e,(n=[{key:"attachNode",value:function(){var e=this.document.getElementById("driver-page-overlay");e||(e=f(d),document.body.appendChild(e)),this.node=e,this.node.style.opacity="0",this.options.animate||this.node.parentElement&&this.node.parentElement.removeChild(this.node)}},{key:"highlight",value:function(e){e&&e.node?e.isSame(this.highlightedElement)||(this.window.clearTimeout(this.hideTimer),e.onHighlightStarted(),this.highlightedElement&&!this.highlightedElement.isSame(this.lastHighlightedElement)&&this.highlightedElement.onDeselected(),e.getCalculatedPosition().canHighlight()&&(this.lastHighlightedElement=this.highlightedElement,this.highlightedElement=e,this.show(),this.highlightedElement.onHighlighted())):console.warn("Invalid element to highlight. Must be an instance of `Element`")}},{key:"show",value:function(){var e=this;this.node&&this.node.parentElement||(this.attachNode(),window.setTimeout(function(){e.node.style.opacity="".concat(e.options.opacity),e.node.style.position="fixed",e.node.style.left="0",e.node.style.top="0",e.node.style.bottom="0",e.node.style.right="0"}))}},{key:"getHighlightedElement",value:function(){return this.highlightedElement}},{key:"getLastHighlightedElement",value:function(){return this.lastHighlightedElement}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.options.onReset&&this.options.onReset(this.highlightedElement),this.highlightedElement&&this.highlightedElement.onDeselected(!0),this.highlightedElement=null,this.lastHighlightedElement=null,this.node&&(this.window.clearTimeout(this.hideTimer),this.options.animate&&!e?(this.node.style.opacity="0",this.hideTimer=this.window.setTimeout(this.removeNode,300)):this.removeNode())}},{key:"removeNode",value:function(){this.node&&this.node.parentElement&&this.node.parentElement.removeChild(this.node)}},{key:"refresh",value:function(){this.highlightedElement&&(this.highlightedElement.showPopover(),this.highlightedElement.showStage())}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,n),e}();n(80);var g=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.left,r=void 0===n?0:n,i=t.top,a=void 0===i?0:i,o=t.right,s=void 0===o?0:o,l=t.bottom,c=void 0===l?0:l;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.left=r,this.right=s,this.top=a,this.bottom=c}var t,n;return t=e,(n=[{key:"canHighlight",value:function(){return this.left<this.right&&this.top<this.bottom}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,n),e}(),v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.node,r=t.options,i=t.popover,a=t.stage,o=t.overlay,s=t.window,l=t.document;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.node=n,this.document=l,this.window=s,this.options=r,this.overlay=o,this.popover=i,this.stage=a,this.animationTimeout=null}var t,n;return t=e,(n=[{key:"isInView",value:function(){for(var e=this.node.offsetTop,t=this.node.offsetLeft,n=this.node.offsetWidth,r=this.node.offsetHeight,i=this.node;i.offsetParent;)e+=(i=i.offsetParent).offsetTop,t+=i.offsetLeft;return e>=this.window.pageYOffset&&t>=this.window.pageXOffset&&e+r<=this.window.pageYOffset+this.window.innerHeight&&t+n<=this.window.pageXOffset+this.window.innerWidth}},{key:"scrollManually",value:function(){var e=this.node.getBoundingClientRect().top+this.window.pageYOffset-this.window.innerHeight/2;this.window.scrollTo(0,e)}},{key:"bringInView",value:function(){if(this.node&&!this.isInView())if(this.node.scrollIntoView)try{this.node.scrollIntoView(this.options.scrollIntoViewOptions||{behavior:"instant",block:"center"})}catch(e){this.scrollManually()}else this.scrollManually()}},{key:"getCalculatedPosition",value:function(){var e=this.document.body,t=this.document.documentElement,n=this.window,r=this.window.pageYOffset||t.scrollTop||e.scrollTop,i=n.pageXOffset||t.scrollLeft||e.scrollLeft,a=this.node.getBoundingClientRect();return new g({top:a.top+r,left:a.left+i,right:a.left+i+a.width,bottom:a.top+r+a.height})}},{key:"getPopover",value:function(){return this.popover}},{key:"onDeselected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.hidePopover(),e&&this.hideStage(),this.removeHighlightClasses(),this.window.clearTimeout(this.animationTimeout),this.options.onDeselected&&this.options.onDeselected(this)}},{key:"isSame",value:function(e){return!(!e||!e.node)&&e.node===this.node}},{key:"onHighlightStarted",value:function(){this.options.onHighlightStarted&&this.options.onHighlightStarted(this)}},{key:"onHighlighted",value:function(){this.isInView()||this.bringInView(),this.showPopover(),this.showStage(),this.addHighlightClasses(),this.options.onHighlighted&&this.options.onHighlighted(this)}},{key:"removeHighlightClasses",value:function(){this.node.classList.remove("driver-highlighted-element"),this.node.classList.remove("driver-position-relative");for(var e=this.document.querySelectorAll(".".concat("driver-fix-stacking")),t=0;t<e.length;t++)e[t].classList.remove("driver-fix-stacking")}},{key:"addHighlightClasses",value:function(){this.node.classList.add("driver-highlighted-element"),this.canMakeRelative()&&this.node.classList.add("driver-position-relative"),this.fixStackingContext()}},{key:"fixStackingContext",value:function(){for(var e=this.node.parentNode;e&&e.tagName&&"body"!==e.tagName.toLowerCase();){var t=h(e,"z-index"),n=parseFloat(h(e,"opacity")),r=h(e,"transform",!0),i=h(e,"transform-style",!0),a=h(e,"transform-box",!0),o=h(e,"filter",!0),s=h(e,"perspective",!0);(/[0-9]+/.test(t)||n<1||r&&"none"!==r||i&&"flat"!==i||a&&"border-box"!==a||o&&"none"!==o||s&&"none"!==s)&&e.classList.add("driver-fix-stacking"),e=e.parentNode}}},{key:"canMakeRelative",value:function(){var e=this.getStyleProperty("position");return-1===["absolute","fixed","relative"].indexOf(e)}},{key:"getStyleProperty",value:function(e){return h(this.node,e)}},{key:"showStage",value:function(){this.stage.show(this.getCalculatedPosition())}},{key:"getNode",value:function(){return this.node}},{key:"hideStage",value:function(){this.stage.hide()}},{key:"hidePopover",value:function(){this.popover&&this.popover.hide()}},{key:"showPopover",value:function(){var e=this;if(this.popover){var t=this.getCalculatedPosition(),n=300;this.options.animate&&this.overlay.lastHighlightedElement||(n=0),this.animationTimeout=this.window.setTimeout(function(){e.popover.show(t)},n)}}},{key:"getFullPageSize",value:function(){var e=this.document.body,t=this.document.documentElement;return{height:Math.max(e.scrollHeight,e.offsetHeight,t.scrollHeight,t.offsetHeight),width:Math.max(e.scrollWidth,e.offsetWidth,t.scrollWidth,t.offsetWidth)}}},{key:"getSize",value:function(){return{height:Math.max(this.node.scrollHeight,this.node.offsetHeight),width:Math.max(this.node.scrollWidth,this.node.offsetWidth)}}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,n),e}();function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function k(e,t){return(k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n(55),n(56);var x=function(e){function t(e,n,r){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=function(e,t){return!t||"object"!==b(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,w(t).call(this))).options=function(e){for(var t=arguments,n=1;n<arguments.length;n++){var r=null!=t[n]?t[n]:{},i=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),i.forEach(function(t){y(e,t,r[t])})}return e}({isFirst:!0,isLast:!0,totalCount:1,currentIndex:0,offset:0,showButtons:!0,closeBtnText:"Close",doneBtnText:"Done",startBtnText:"Next &rarr;",nextBtnText:"Next &rarr;",prevBtnText:"&larr; Previous"},e),i.window=n,i.document=r,i}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}(t,v),n=t,(r=[{key:"attachNode",value:function(){var e=this.document.getElementById("driver-popover-item");e&&e.parentElement.removeChild(e),e=f(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return'\n  <div id="'.concat("driver-popover-item",'" class="').concat(e,'">\n    <div class="').concat("driver-popover-tip",'"></div>\n    <div class="').concat("driver-popover-title",'">Popover Title</div>\n    <div class="').concat("driver-popover-description",'">Popover Description</div>\n    <div class="driver-clearfix ').concat("driver-popover-footer",'">\n      <button class="').concat("driver-close-btn",'">Close</button>\n      <span class="driver-btn-group ').concat("driver-navigation-btns",'">\n        <button class="').concat("driver-prev-btn",'">&larr; Previous</button>\n        <button class="').concat("driver-next-btn",'">Next &rarr;</button>\n      </span>\n    </div>\n  </div>')}(this.options.className)),document.body.appendChild(e),this.node=e,this.tipNode=e.querySelector(".".concat("driver-popover-tip")),this.titleNode=e.querySelector(".".concat("driver-popover-title")),this.descriptionNode=e.querySelector(".".concat("driver-popover-description")),this.footerNode=e.querySelector(".".concat("driver-popover-footer")),this.nextBtnNode=e.querySelector(".".concat("driver-next-btn")),this.prevBtnNode=e.querySelector(".".concat("driver-prev-btn")),this.closeBtnNode=e.querySelector(".".concat("driver-close-btn"))}},{key:"getTitleNode",value:function(){return this.titleNode}},{key:"getDescriptionNode",value:function(){return this.descriptionNode}},{key:"hide",value:function(){this.node&&(this.node.style.display="none")}},{key:"setInitialState",value:function(){this.node.style.display="block",this.node.style.left="0",this.node.style.top="0",this.node.style.bottom="",this.node.style.right="",this.node.querySelector(".".concat("driver-popover-tip")).className="driver-popover-tip"}},{key:"show",value:function(e){switch(this.attachNode(),this.setInitialState(),this.titleNode.innerHTML=this.options.title,this.descriptionNode.innerHTML=this.options.description||"",this.renderFooter(),this.options.position){case"left":case"left-top":this.positionOnLeft(e);break;case"left-center":this.positionOnLeftCenter(e);break;case"left-bottom":this.positionOnLeftBottom(e);break;case"right":case"right-top":this.positionOnRight(e);break;case"right-center":this.positionOnRightCenter(e);break;case"right-bottom":this.positionOnRightBottom(e);break;case"top":case"top-left":this.positionOnTop(e);break;case"top-center":this.positionOnTopCenter(e);break;case"top-right":this.positionOnTopRight(e);break;case"bottom":case"bottom-left":this.positionOnBottom(e);break;case"bottom-center":this.positionOnBottomCenter(e);break;case"bottom-right":this.positionOnBottomRight(e);break;case"mid-center":this.positionOnMidCenter(e);break;case"auto":default:this.autoPosition(e)}this.bringInView()}},{key:"renderFooter",value:function(){this.nextBtnNode.innerHTML=this.options.nextBtnText,this.prevBtnNode.innerHTML=this.options.prevBtnText,this.closeBtnNode.innerHTML=this.options.closeBtnText;var e=this.options.totalCount&&1!==this.options.totalCount;this.options.showButtons?(e?(this.nextBtnNode.style.display="inline-block",this.prevBtnNode.style.display="inline-block",this.closeBtnNode.classList.remove("driver-close-only-btn")):(this.nextBtnNode.style.display="none",this.prevBtnNode.style.display="none",this.closeBtnNode.classList.add("driver-close-only-btn")),this.footerNode.style.display="block",this.options.isFirst?(this.prevBtnNode.classList.add("driver-disabled"),this.nextBtnNode.innerHTML=this.options.startBtnText):this.prevBtnNode.classList.remove("driver-disabled"),this.options.isLast?this.nextBtnNode.innerHTML=this.options.doneBtnText:this.nextBtnNode.innerHTML=this.options.nextBtnText):this.footerNode.style.display="none"}},{key:"positionOnLeft",value:function(e){var t=this.getSize().width,n=this.options.padding+10;this.node.style.left="".concat(e.left-t-n,"px"),this.node.style.top="".concat(e.top+this.options.offset-this.options.padding,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("right")}},{key:"positionOnLeftBottom",value:function(e){var t=this.getSize(),n=t.width,r=this.options.padding+10;this.node.style.left="".concat(e.left-n-r,"px"),this.node.style.top="".concat(e.bottom+this.options.padding+this.options.offset-t.height,"px"),this.node.style.bottom="",this.node.style.right="",this.tipNode.classList.add("right","position-bottom")}},{key:"positionOnLeftCenter",value:function(e){var t=this.getSize(),n=t.width,r=t.height/2,i=this.options.padding+10,a=(e.bottom-e.top)/2,o=e.top-r+a+this.options.offset;this.node.style.left="".concat(e.left-n-i,"px"),this.node.style.top="".concat(o,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("right","position-center")}},{key:"positionOnRight",value:function(e){var t=this.options.padding+10;this.node.style.left="".concat(e.right+t,"px"),this.node.style.top="".concat(e.top+this.options.offset-this.options.padding,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("left")}},{key:"positionOnRightCenter",value:function(e){var t=this.getSize(),n=this.options.padding+10,r=t.height/2,i=(e.bottom-e.top)/2,a=e.top-r+i+this.options.offset;this.node.style.left="".concat(e.right+n,"px"),this.node.style.top="".concat(a,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("left","position-center")}},{key:"positionOnRightBottom",value:function(e){var t=this.options.padding+10,n=this.getSize();this.node.style.left="".concat(e.right+t,"px"),this.node.style.top="".concat(e.bottom+this.options.padding+this.options.offset-n.height,"px"),this.node.style.bottom="",this.node.style.right="",this.tipNode.classList.add("left","position-bottom")}},{key:"positionOnTop",value:function(e){var t=this.getSize().height,n=this.options.padding+10;this.node.style.top="".concat(e.top-t-n,"px"),this.node.style.left="".concat(e.left-this.options.padding+this.options.offset,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("bottom")}},{key:"positionOnTopCenter",value:function(e){var t=this.getSize(),n=t.height,r=t.width/2,i=this.options.padding+10,a=this.options.offset+e.left+(e.right-e.left)/2;this.node.style.top="".concat(e.top-n-i,"px"),this.node.style.left="".concat(a-r-this.options.padding,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("bottom","position-center")}},{key:"positionOnTopRight",value:function(e){var t=this.getSize(),n=t.height,r=this.options.padding+10;this.node.style.top="".concat(e.top-n-r,"px"),this.node.style.left="".concat(e.right+this.options.padding+this.options.offset-t.width,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("bottom","position-right")}},{key:"positionOnBottom",value:function(e){var t=this.options.padding+10;this.node.style.top="".concat(e.bottom+t,"px"),this.node.style.left="".concat(e.left-this.options.padding+this.options.offset,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("top")}},{key:"positionOnBottomCenter",value:function(e){var t=this.getSize().width/2,n=this.options.padding+10,r=this.options.offset+e.left+(e.right-e.left)/2;this.node.style.top="".concat(e.bottom+n,"px"),this.node.style.left="".concat(r-t-this.options.padding,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("top","position-center")}},{key:"positionOnBottomRight",value:function(e){var t=this.getSize(),n=this.options.padding+10;this.node.style.top="".concat(e.bottom+n,"px"),this.node.style.left="".concat(e.right+this.options.padding+this.options.offset-t.width,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("top","position-right")}},{key:"positionOnMidCenter",value:function(e){var t=this.getSize(),n=t.height,r=t.width/2,i=n/2,a=(e.bottom-e.top)/2,o=e.top-i+a+this.options.offset,s=this.options.offset+e.left+(e.right-e.left)/2;this.node.style.top="".concat(o,"px"),this.node.style.left="".concat(s-r-this.options.padding,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("mid-center")}},{key:"autoPosition",value:function(e){var t=this.getFullPageSize(),n=this.getSize(),r=t.height,i=n.height,a=this.options.padding+10;e.bottom+i+a>=r?this.positionOnTop(e):this.positionOnBottom(e)}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(n.prototype,r),t}();function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $=function(e){function t(e,n,r){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=function(e,t){return!t||"object"!==C(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,S(t).call(this))).options=e,i.window=n,i.document=r,i}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(t,v),n=t,(r=[{key:"attachNode",value:function(){var e=this.document.getElementById(c);e||(e=f(u),document.body.appendChild(e)),this.node=e,this.options.animate?this.node.classList.remove("driver-stage-no-animation"):this.node.classList.add("driver-stage-no-animation")}},{key:"hide",value:function(){this.node&&this.node.parentElement&&this.node.parentElement.removeChild(this.node)}},{key:"setInitialStyle",value:function(){this.node.style.display="block",this.node.style.left="0",this.node.style.top="0",this.node.style.bottom="",this.node.style.right=""}},{key:"show",value:function(e){this.attachNode(),this.setInitialStyle();var t=2*this.options.padding,n=e.right-e.left+t,r=e.bottom-e.top+t;this.node.style.display="block",this.node.style.position="absolute",this.node.style.width="".concat(n,"px"),this.node.style.height="".concat(r,"px"),this.node.style.top="".concat(e.top-t/2,"px"),this.node.style.left="".concat(e.left-t/2,"px"),this.node.style.backgroundColor=this.options.stageBackground}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(n.prototype,r),t}();function T(e){for(var t=arguments,n=1;n<arguments.length;n++){var r=null!=t[n]?t[n]:{},i=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),i.forEach(function(t){A(e,t,r[t])})}return e}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"default",function(){return P});var P=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=T({animate:a,opacity:r,padding:i,scrollIntoViewOptions:null,allowClose:o,keyboardControl:s,overlayClickNext:l,stageBackground:"#ffffff",onHighlightStarted:function(){return null},onHighlighted:function(){return null},onDeselected:function(){return null},onReset:function(){return null},onNext:function(){return null},onPrevious:function(){return null}},t),this.document=document,this.window=window,this.isActivated=!1,this.steps=[],this.currentStep=0,this.currentMovePrevented=!1,this.overlay=new m(this.options,window,document),this.onResize=this.onResize.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.onClick=this.onClick.bind(this),this.moveNext=this.moveNext.bind(this),this.movePrevious=this.movePrevious.bind(this),this.preventMove=this.preventMove.bind(this),this.bind()}var t,n;return t=e,(n=[{key:"getSteps",value:function(){return this.steps}},{key:"setSteps",value:function(e){this.steps=e}},{key:"bind",value:function(){this.window.addEventListener("resize",this.onResize,!1),this.window.addEventListener("keyup",this.onKeyUp,!1),"ontouchstart"in document.documentElement?this.window.addEventListener("touchstart",this.onClick,!1):this.window.addEventListener("click",this.onClick,!1)}},{key:"onClick",value:function(e){if(this.isActivated&&this.hasHighlightedElement()){e.stopPropagation();var t=this.overlay.getHighlightedElement(),n=this.document.getElementById("driver-popover-item"),r=t.node.contains(e.target),i=n&&n.contains(e.target);if(r||i||!this.options.overlayClickNext)if(r||i||!this.options.allowClose){var a=e.target.classList.contains("driver-next-btn"),o=e.target.classList.contains("driver-prev-btn");e.target.classList.contains("driver-close-btn")?this.reset():a?this.handleNext():o&&this.handlePrevious()}else this.reset();else this.handleNext()}}},{key:"onResize",value:function(){this.isActivated&&this.refresh()}},{key:"refresh",value:function(){this.overlay.refresh()}},{key:"onKeyUp",value:function(e){if(this.isActivated&&this.options.keyboardControl)if(27!==e.keyCode){var t=this.getHighlightedElement();t&&t.popover&&(39===e.keyCode?this.handleNext():37===e.keyCode&&this.handlePrevious())}else this.reset()}},{key:"movePrevious",value:function(){var e=this.steps[this.currentStep-1];e?(this.overlay.highlight(e),this.currentStep-=1):this.reset()}},{key:"preventMove",value:function(){this.currentMovePrevented=!0}},{key:"handleNext",value:function(){this.currentMovePrevented=!1;var e=this.steps[this.currentStep];e&&e.options&&e.options.onNext&&e.options.onNext(this.overlay.highlightedElement),this.currentMovePrevented||this.moveNext()}},{key:"handlePrevious",value:function(){this.currentMovePrevented=!1;var e=this.steps[this.currentStep];e&&e.options&&e.options.onPrevious&&e.options.onPrevious(this.overlay.highlightedElement),this.currentMovePrevented||this.movePrevious()}},{key:"moveNext",value:function(){var e=this.steps[this.currentStep+1];e?(this.overlay.highlight(e),this.currentStep+=1):this.reset()}},{key:"hasNextStep",value:function(){return!!this.steps[this.currentStep+1]}},{key:"hasPreviousStep",value:function(){return!!this.steps[this.currentStep-1]}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.currentStep=0,this.isActivated=!1,this.overlay.clear(e)}},{key:"hasHighlightedElement",value:function(){var e=this.overlay.getHighlightedElement();return e&&e.node}},{key:"getHighlightedElement",value:function(){return this.overlay.getHighlightedElement()}},{key:"getLastHighlightedElement",value:function(){return this.overlay.getLastHighlightedElement()}},{key:"defineSteps",value:function(e){this.steps=[];for(var t=0;t<e.length;t++){var n=this.prepareElementFromStep(e[t],e,t);n&&this.steps.push(n)}}},{key:"prepareElementFromStep",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=T({},this.options),i=e,a="string"!=typeof e&&!_(e);if(!e||a&&!e.element)throw new Error("Element is required in step ".concat(n));a&&(i=e.element,r=T({},this.options,e));var o=_(i)?i:this.document.querySelector(i);if(!o)return console.warn("Element to highlight ".concat(i," not found")),null;var s=null;if(r.popover&&r.popover.title){var l=[this.options.className,r.popover.className].filter(function(e){return e}).join(" "),c=T({},r,r.popover,{className:l,totalCount:t.length,currentIndex:n,isFirst:0===n,isLast:0===t.length||n===t.length-1});s=new x(c,this.window,this.document)}var d=T({},r),u=new $(d,this.window,this.document);return new v({node:o,options:r,popover:s,stage:u,overlay:this.overlay,window:this.window,document:this.document})}},{key:"start",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!this.steps||0===this.steps.length)throw new Error("There are no steps defined to iterate");this.isActivated=!0,this.currentStep=e,this.overlay.highlight(this.steps[e])}},{key:"highlight",value:function(e){this.isActivated=!0;var t=this.prepareElementFromStep(e);t&&this.overlay.highlight(t)}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,n),e}()}]).default}),Driver=unwrapExports(driver_min),driver_min_1=driver_min.Driver;frappe.Driver=Driver,"object"==typeof navigator&&function(){if("undefined"!=typeof window)try{var e=new window.CustomEvent("test",{cancelable:!0});if(e.preventDefault(),!0!==e.defaultPrevented)throw new Error("Could not prevent default")}catch(e){var t=function(e,t){var n,r;return(t=t||{}).bubbles=!!t.bubbles,t.cancelable=!!t.cancelable,(n=document.createEvent("CustomEvent")).initCustomEvent(e,t.bubbles,t.cancelable,t.detail),r=n.preventDefault,n.preventDefault=function(){r.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}catch(e){this.defaultPrevented=!0}},n};t.prototype=window.Event.prototype,window.CustomEvent=t}}();var commonjsGlobal$1="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule$1(e,t){return e(t={exports:{}},t.exports),t.exports}var check=function(e){return e&&e.Math==Math&&e},global_1=check("object"==typeof globalThis&&globalThis)||check("object"==typeof window&&window)||check("object"==typeof self&&self)||check("object"==typeof commonjsGlobal$1&&commonjsGlobal$1)||Function("return this")(),fails=function(e){try{return!!e()}catch(e){return!0}},descriptors=!fails(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),nativePropertyIsEnumerable={}.propertyIsEnumerable,getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,NASHORN_BUG=getOwnPropertyDescriptor&&!nativePropertyIsEnumerable.call({1:2},1),f$1=NASHORN_BUG?function(e){var t=getOwnPropertyDescriptor(this,e);return!!t&&t.enumerable}:nativePropertyIsEnumerable,objectPropertyIsEnumerable={f:f$1},createPropertyDescriptor=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},toString={}.toString,classofRaw=function(e){return toString.call(e).slice(8,-1)},split="".split,indexedObject=fails(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return"String"==classofRaw(e)?split.call(e,""):Object(e)}:Object,requireObjectCoercible=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},toIndexedObject=function(e){return indexedObject(requireObjectCoercible(e))},isObject=function(e){return"object"==typeof e?null!==e:"function"==typeof e},toPrimitive=function(e,t){if(!isObject(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!isObject(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!isObject(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!isObject(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},hasOwnProperty={}.hasOwnProperty,has=function(e,t){return hasOwnProperty.call(e,t)},document$1=global_1.document,EXISTS=isObject(document$1)&&isObject(document$1.createElement),documentCreateElement=function(e){return EXISTS?document$1.createElement(e):{}},ie8DomDefine=!descriptors&&!fails(function(){return 7!=Object.defineProperty(documentCreateElement("div"),"a",{get:function(){return 7}}).a}),nativeGetOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,f$1$1=descriptors?nativeGetOwnPropertyDescriptor:function(e,t){if(e=toIndexedObject(e),t=toPrimitive(t,!0),ie8DomDefine)try{return nativeGetOwnPropertyDescriptor(e,t)}catch(e){}if(has(e,t))return createPropertyDescriptor(!objectPropertyIsEnumerable.f.call(e,t),e[t])},objectGetOwnPropertyDescriptor={f:f$1$1},anObject=function(e){if(!isObject(e))throw TypeError(String(e)+" is not an object");return e},nativeDefineProperty=Object.defineProperty,f$2=descriptors?nativeDefineProperty:function(e,t,n){if(anObject(e),t=toPrimitive(t,!0),anObject(n),ie8DomDefine)try{return nativeDefineProperty(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e},objectDefineProperty={f:f$2},createNonEnumerableProperty=descriptors?function(e,t,n){return objectDefineProperty.f(e,t,createPropertyDescriptor(1,n))}:function(e,t,n){return e[t]=n,e},setGlobal=function(e,t){try{createNonEnumerableProperty(global_1,e,t)}catch(n){global_1[e]=t}return t},SHARED="__core-js_shared__",store=global_1[SHARED]||setGlobal(SHARED,{}),sharedStore=store,functionToString=Function.toString;"function"!=typeof sharedStore.inspectSource&&(sharedStore.inspectSource=function(e){return functionToString.call(e)});var inspectSource=sharedStore.inspectSource,WeakMap$1=global_1.WeakMap,nativeWeakMap="function"==typeof WeakMap$1&&/native code/.test(inspectSource(WeakMap$1)),shared=createCommonjsModule$1(function(e){(e.exports=function(e,t){return sharedStore[e]||(sharedStore[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.6.5",mode:"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})}),id=0,postfix=Math.random(),uid=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++id+postfix).toString(36)},keys=shared("keys"),sharedKey=function(e){return keys[e]||(keys[e]=uid(e))},hiddenKeys={},WeakMap$2=global_1.WeakMap,set,get,has$1,enforce=function(e){return has$1(e)?get(e):set(e,{})},getterFor=function(e){return function(t){var n;if(!isObject(t)||(n=get(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}};if(nativeWeakMap){var store$1=new WeakMap$2,wmget=store$1.get,wmhas=store$1.has,wmset=store$1.set;set=function(e,t){return wmset.call(store$1,e,t),t},get=function(e){return wmget.call(store$1,e)||{}},has$1=function(e){return wmhas.call(store$1,e)}}else{var STATE=sharedKey("state");hiddenKeys[STATE]=!0,set=function(e,t){return createNonEnumerableProperty(e,STATE,t),t},get=function(e){return has(e,STATE)?e[STATE]:{}},has$1=function(e){return has(e,STATE)}}var internalState={set:set,get:get,has:has$1,enforce:enforce,getterFor:getterFor},redefine=createCommonjsModule$1(function(e){var t=internalState.get,n=internalState.enforce,r=String(String).split("String");(e.exports=function(e,t,i,a){var o=!!a&&!!a.unsafe,s=!!a&&!!a.enumerable,l=!!a&&!!a.noTargetGet;"function"==typeof i&&("string"!=typeof t||has(i,"name")||createNonEnumerableProperty(i,"name",t),n(i).source=r.join("string"==typeof t?t:"")),e!==global_1?(o?!l&&e[t]&&(s=!0):delete e[t],s?e[t]=i:createNonEnumerableProperty(e,t,i)):s?e[t]=i:setGlobal(t,i)})(Function.prototype,"toString",function(){return"function"==typeof this&&t(this).source||inspectSource(this)})}),path=global_1,aFunction=function(e){return"function"==typeof e?e:void 0},getBuiltIn=function(e,t){return arguments.length<2?aFunction(path[e])||aFunction(global_1[e]):path[e]&&path[e][t]||global_1[e]&&global_1[e][t]},ceil=Math.ceil,floor=Math.floor,toInteger=function(e){return isNaN(e=+e)?0:(e>0?floor:ceil)(e)},min=Math.min,toLength=function(e){return e>0?min(toInteger(e),9007199254740991):0},max=Math.max,min$1=Math.min,toAbsoluteIndex=function(e,t){var n=toInteger(e);return n<0?max(n+t,0):min$1(n,t)},createMethod=function(e){return function(t,n,r){var i,a=toIndexedObject(t),o=toLength(a.length),s=toAbsoluteIndex(r,o);if(e&&n!=n){for(;o>s;)if((i=a[s++])!=i)return!0}else for(;o>s;s++)if((e||s in a)&&a[s]===n)return e||s||0;return!e&&-1}},arrayIncludes={includes:createMethod(!0),indexOf:createMethod(!1)},indexOf=arrayIncludes.indexOf,objectKeysInternal=function(e,t){var n,r=toIndexedObject(e),i=0,a=[];for(n in r)!has(hiddenKeys,n)&&has(r,n)&&a.push(n);for(;t.length>i;)has(r,n=t[i++])&&(~indexOf(a,n)||a.push(n));return a},enumBugKeys=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],hiddenKeys$1=enumBugKeys.concat("length","prototype"),f$3=Object.getOwnPropertyNames||function(e){return objectKeysInternal(e,hiddenKeys$1)},objectGetOwnPropertyNames={f:f$3},f$4=Object.getOwnPropertySymbols,objectGetOwnPropertySymbols={f:f$4},ownKeys=getBuiltIn("Reflect","ownKeys")||function(e){var t=objectGetOwnPropertyNames.f(anObject(e)),n=objectGetOwnPropertySymbols.f;return n?t.concat(n(e)):t},copyConstructorProperties=function(e,t){for(var n=ownKeys(t),r=objectDefineProperty.f,i=objectGetOwnPropertyDescriptor.f,a=0;a<n.length;a++){var o=n[a];has(e,o)||r(e,o,i(t,o))}},replacement=/#|\.prototype\./,isForced=function(e,t){var n=data[normalize(e)];return n==POLYFILL||n!=NATIVE&&("function"==typeof t?fails(t):!!t)},normalize=isForced.normalize=function(e){return String(e).replace(replacement,".").toLowerCase()},data=isForced.data={},NATIVE=isForced.NATIVE="N",POLYFILL=isForced.POLYFILL="P",isForced_1=isForced,getOwnPropertyDescriptor$1=objectGetOwnPropertyDescriptor.f,_export=function(e,t){var n,r,i,a,o,s=e.target,l=e.global,c=e.stat;if(n=l?global_1:c?global_1[s]||setGlobal(s,{}):(global_1[s]||{}).prototype)for(r in t){if(a=t[r],i=e.noTargetGet?(o=getOwnPropertyDescriptor$1(n,r))&&o.value:n[r],!isForced_1(l?r:s+(c?".":"#")+r,e.forced)&&void 0!==i){if(typeof a==typeof i)continue;copyConstructorProperties(a,i)}(e.sham||i&&i.sham)&&createNonEnumerableProperty(a,"sham",!0),redefine(n,r,a,e)}},nativeSymbol=!!Object.getOwnPropertySymbols&&!fails(function(){return!String(Symbol())}),useSymbolAsUid=nativeSymbol&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,isArray$1=Array.isArray||function(e){return"Array"==classofRaw(e)},toObject=function(e){return Object(requireObjectCoercible(e))},objectKeys=Object.keys||function(e){return objectKeysInternal(e,enumBugKeys)},objectDefineProperties=descriptors?Object.defineProperties:function(e,t){anObject(e);for(var n,r=objectKeys(t),i=r.length,a=0;i>a;)objectDefineProperty.f(e,n=r[a++],t[n]);return e},html=getBuiltIn("document","documentElement"),GT=">",LT="<",PROTOTYPE="prototype",SCRIPT="script",IE_PROTO=sharedKey("IE_PROTO"),EmptyConstructor=function(){},scriptTag=function(e){return LT+SCRIPT+GT+e+LT+"/"+SCRIPT+GT},NullProtoObjectViaActiveX=function(e){e.write(scriptTag("")),e.close();var t=e.parentWindow.Object;return e=null,t},NullProtoObjectViaIFrame=function(){var e,t=documentCreateElement("iframe"),n="java"+SCRIPT+":";return t.style.display="none",html.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(scriptTag("document.F=Object")),e.close(),e.F},activeXDocument,NullProtoObject=function(){try{activeXDocument=document.domain&&new ActiveXObject("htmlfile")}catch(e){}NullProtoObject=activeXDocument?NullProtoObjectViaActiveX(activeXDocument):NullProtoObjectViaIFrame();for(var e=enumBugKeys.length;e--;)delete NullProtoObject[PROTOTYPE][enumBugKeys[e]];return NullProtoObject()};hiddenKeys[IE_PROTO]=!0;var objectCreate=Object.create||function(e,t){var n;return null!==e?(EmptyConstructor[PROTOTYPE]=anObject(e),n=new EmptyConstructor,EmptyConstructor[PROTOTYPE]=null,n[IE_PROTO]=e):n=NullProtoObject(),void 0===t?n:objectDefineProperties(n,t)},nativeGetOwnPropertyNames=objectGetOwnPropertyNames.f,toString$1={}.toString,windowNames="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],getWindowNames=function(e){try{return nativeGetOwnPropertyNames(e)}catch(e){return windowNames.slice()}},f$5=function(e){return windowNames&&"[object Window]"==toString$1.call(e)?getWindowNames(e):nativeGetOwnPropertyNames(toIndexedObject(e))},objectGetOwnPropertyNamesExternal={f:f$5},WellKnownSymbolsStore=shared("wks"),Symbol$1=global_1.Symbol,createWellKnownSymbol=useSymbolAsUid?Symbol$1:Symbol$1&&Symbol$1.withoutSetter||uid,wellKnownSymbol=function(e){return has(WellKnownSymbolsStore,e)||(nativeSymbol&&has(Symbol$1,e)?WellKnownSymbolsStore[e]=Symbol$1[e]:WellKnownSymbolsStore[e]=createWellKnownSymbol("Symbol."+e)),WellKnownSymbolsStore[e]},f$6=wellKnownSymbol,wellKnownSymbolWrapped={f:f$6},defineProperty=objectDefineProperty.f,defineWellKnownSymbol=function(e){var t=path.Symbol||(path.Symbol={});has(t,e)||defineProperty(t,e,{value:wellKnownSymbolWrapped.f(e)})},defineProperty$1=objectDefineProperty.f,TO_STRING_TAG=wellKnownSymbol("toStringTag"),setToStringTag=function(e,t,n){e&&!has(e=n?e:e.prototype,TO_STRING_TAG)&&defineProperty$1(e,TO_STRING_TAG,{configurable:!0,value:t})},aFunction$1=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},functionBindContext=function(e,t,n){if(aFunction$1(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}},SPECIES=wellKnownSymbol("species"),arraySpeciesCreate=function(e,t){var n;return isArray$1(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!isArray$1(n.prototype)?isObject(n)&&null===(n=n[SPECIES])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)},push=[].push,createMethod$1=function(e){var t=1==e,n=2==e,r=3==e,i=4==e,a=6==e,o=5==e||a;return function(s,l,c,d){for(var u,p,f=toObject(s),h=indexedObject(f),_=functionBindContext(l,c,3),m=toLength(h.length),g=0,v=d||arraySpeciesCreate,b=t?v(s,m):n?v(s,0):void 0;m>g;g++)if((o||g in h)&&(p=_(u=h[g],g,f),e))if(t)b[g]=p;else if(p)switch(e){case 3:return!0;case 5:return u;case 6:return g;case 2:push.call(b,u)}else if(i)return!1;return a?-1:r||i?i:b}},arrayIteration={forEach:createMethod$1(0),map:createMethod$1(1),filter:createMethod$1(2),some:createMethod$1(3),every:createMethod$1(4),find:createMethod$1(5),findIndex:createMethod$1(6)},$forEach=arrayIteration.forEach,HIDDEN=sharedKey("hidden"),SYMBOL="Symbol",PROTOTYPE$1="prototype",TO_PRIMITIVE=wellKnownSymbol("toPrimitive"),setInternalState=internalState.set,getInternalState=internalState.getterFor(SYMBOL),ObjectPrototype=Object[PROTOTYPE$1],$Symbol=global_1.Symbol,$stringify=getBuiltIn("JSON","stringify"),nativeGetOwnPropertyDescriptor$1=objectGetOwnPropertyDescriptor.f,nativeDefineProperty$1=objectDefineProperty.f,nativeGetOwnPropertyNames$1=objectGetOwnPropertyNamesExternal.f,nativePropertyIsEnumerable$1=objectPropertyIsEnumerable.f,AllSymbols=shared("symbols"),ObjectPrototypeSymbols=shared("op-symbols"),StringToSymbolRegistry=shared("string-to-symbol-registry"),SymbolToStringRegistry=shared("symbol-to-string-registry"),WellKnownSymbolsStore$1=shared("wks"),QObject=global_1.QObject,USE_SETTER=!QObject||!QObject[PROTOTYPE$1]||!QObject[PROTOTYPE$1].findChild,setSymbolDescriptor=descriptors&&fails(function(){return 7!=objectCreate(nativeDefineProperty$1({},"a",{get:function(){return nativeDefineProperty$1(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=nativeGetOwnPropertyDescriptor$1(ObjectPrototype,t);r&&delete ObjectPrototype[t],nativeDefineProperty$1(e,t,n),r&&e!==ObjectPrototype&&nativeDefineProperty$1(ObjectPrototype,t,r)}:nativeDefineProperty$1,wrap=function(e,t){var n=AllSymbols[e]=objectCreate($Symbol[PROTOTYPE$1]);return setInternalState(n,{type:SYMBOL,tag:e,description:t}),descriptors||(n.description=t),n},isSymbol=useSymbolAsUid?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof $Symbol},$defineProperty=function(e,t,n){e===ObjectPrototype&&$defineProperty(ObjectPrototypeSymbols,t,n),anObject(e);var r=toPrimitive(t,!0);return anObject(n),has(AllSymbols,r)?(n.enumerable?(has(e,HIDDEN)&&e[HIDDEN][r]&&(e[HIDDEN][r]=!1),n=objectCreate(n,{enumerable:createPropertyDescriptor(0,!1)})):(has(e,HIDDEN)||nativeDefineProperty$1(e,HIDDEN,createPropertyDescriptor(1,{})),e[HIDDEN][r]=!0),setSymbolDescriptor(e,r,n)):nativeDefineProperty$1(e,r,n)},$defineProperties=function(e,t){anObject(e);var n=toIndexedObject(t),r=objectKeys(n).concat($getOwnPropertySymbols(n));return $forEach(r,function(t){descriptors&&!$propertyIsEnumerable.call(n,t)||$defineProperty(e,t,n[t])}),e},$create=function(e,t){return void 0===t?objectCreate(e):$defineProperties(objectCreate(e),t)},$propertyIsEnumerable=function(e){var t=toPrimitive(e,!0),n=nativePropertyIsEnumerable$1.call(this,t);return!(this===ObjectPrototype&&has(AllSymbols,t)&&!has(ObjectPrototypeSymbols,t))&&(!(n||!has(this,t)||!has(AllSymbols,t)||has(this,HIDDEN)&&this[HIDDEN][t])||n)},$getOwnPropertyDescriptor=function(e,t){var n=toIndexedObject(e),r=toPrimitive(t,!0);if(n!==ObjectPrototype||!has(AllSymbols,r)||has(ObjectPrototypeSymbols,r)){var i=nativeGetOwnPropertyDescriptor$1(n,r);return!i||!has(AllSymbols,r)||has(n,HIDDEN)&&n[HIDDEN][r]||(i.enumerable=!0),i}},$getOwnPropertyNames=function(e){var t=nativeGetOwnPropertyNames$1(toIndexedObject(e)),n=[];return $forEach(t,function(e){has(AllSymbols,e)||has(hiddenKeys,e)||n.push(e)}),n},$getOwnPropertySymbols=function(e){var t=e===ObjectPrototype,n=nativeGetOwnPropertyNames$1(t?ObjectPrototypeSymbols:toIndexedObject(e)),r=[];return $forEach(n,function(e){!has(AllSymbols,e)||t&&!has(ObjectPrototype,e)||r.push(AllSymbols[e])}),r};if(nativeSymbol||($Symbol=function(){if(this instanceof $Symbol)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=uid(e),n=function(e){this===ObjectPrototype&&n.call(ObjectPrototypeSymbols,e),has(this,HIDDEN)&&has(this[HIDDEN],t)&&(this[HIDDEN][t]=!1),setSymbolDescriptor(this,t,createPropertyDescriptor(1,e))};return descriptors&&USE_SETTER&&setSymbolDescriptor(ObjectPrototype,t,{configurable:!0,set:n}),wrap(t,e)},redefine($Symbol[PROTOTYPE$1],"toString",function(){return getInternalState(this).tag}),redefine($Symbol,"withoutSetter",function(e){return wrap(uid(e),e)}),objectPropertyIsEnumerable.f=$propertyIsEnumerable,objectDefineProperty.f=$defineProperty,objectGetOwnPropertyDescriptor.f=$getOwnPropertyDescriptor,objectGetOwnPropertyNames.f=objectGetOwnPropertyNamesExternal.f=$getOwnPropertyNames,objectGetOwnPropertySymbols.f=$getOwnPropertySymbols,wellKnownSymbolWrapped.f=function(e){return wrap(wellKnownSymbol(e),e)},descriptors&&(nativeDefineProperty$1($Symbol[PROTOTYPE$1],"description",{configurable:!0,get:function(){return getInternalState(this).description}}),redefine(ObjectPrototype,"propertyIsEnumerable",$propertyIsEnumerable,{unsafe:!0}))),_export({global:!0,wrap:!0,forced:!nativeSymbol,sham:!nativeSymbol},{Symbol:$Symbol}),$forEach(objectKeys(WellKnownSymbolsStore$1),function(e){defineWellKnownSymbol(e)}),_export({target:SYMBOL,stat:!0,forced:!nativeSymbol},{for:function(e){var t=String(e);if(has(StringToSymbolRegistry,t))return StringToSymbolRegistry[t];var n=$Symbol(t);return StringToSymbolRegistry[t]=n,SymbolToStringRegistry[n]=t,n},keyFor:function(e){if(!isSymbol(e))throw TypeError(e+" is not a symbol");if(has(SymbolToStringRegistry,e))return SymbolToStringRegistry[e]},useSetter:function(){USE_SETTER=!0},useSimple:function(){USE_SETTER=!1}}),_export({target:"Object",stat:!0,forced:!nativeSymbol,sham:!descriptors},{create:$create,defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor}),_export({target:"Object",stat:!0,forced:!nativeSymbol},{getOwnPropertyNames:$getOwnPropertyNames,getOwnPropertySymbols:$getOwnPropertySymbols}),_export({target:"Object",stat:!0,forced:fails(function(){objectGetOwnPropertySymbols.f(1)})},{getOwnPropertySymbols:function(e){return objectGetOwnPropertySymbols.f(toObject(e))}}),$stringify){var FORCED_JSON_STRINGIFY=!nativeSymbol||fails(function(){var e=$Symbol();return"[null]"!=$stringify([e])||"{}"!=$stringify({a:e})||"{}"!=$stringify(Object(e))});_export({target:"JSON",stat:!0,forced:FORCED_JSON_STRINGIFY},{stringify:function(e,t,n){for(var r,i=arguments,a=[e],o=1;arguments.length>o;)a.push(i[o++]);if(r=t,(isObject(t)||void 0!==e)&&!isSymbol(e))return isArray$1(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!isSymbol(t))return t}),a[1]=t,$stringify.apply(null,a)}})}$Symbol[PROTOTYPE$1][TO_PRIMITIVE]||createNonEnumerableProperty($Symbol[PROTOTYPE$1],TO_PRIMITIVE,$Symbol[PROTOTYPE$1].valueOf),setToStringTag($Symbol,SYMBOL),hiddenKeys[HIDDEN]=!0;var defineProperty$2=objectDefineProperty.f,NativeSymbol=global_1.Symbol;if(descriptors&&"function"==typeof NativeSymbol&&(!("description"in NativeSymbol.prototype)||void 0!==NativeSymbol().description)){var EmptyStringDescriptionStore={},SymbolWrapper=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof SymbolWrapper?new NativeSymbol(e):void 0===e?NativeSymbol():NativeSymbol(e);return""===e&&(EmptyStringDescriptionStore[t]=!0),t};copyConstructorProperties(SymbolWrapper,NativeSymbol);var symbolPrototype=SymbolWrapper.prototype=NativeSymbol.prototype;symbolPrototype.constructor=SymbolWrapper;var symbolToString=symbolPrototype.toString,native="Symbol(test)"==String(NativeSymbol("test")),regexp=/^Symbol\((.*)\)[^)]+$/;defineProperty$2(symbolPrototype,"description",{configurable:!0,get:function(){var e=isObject(this)?this.valueOf():this,t=symbolToString.call(e);if(has(EmptyStringDescriptionStore,e))return"";var n=native?t.slice(7,-1):t.replace(regexp,"$1");return""===n?void 0:n}}),_export({global:!0,forced:!0},{Symbol:SymbolWrapper})}defineWellKnownSymbol("iterator");var arrayMethodIsStrict=function(e,t){var n=[][e];return!!n&&fails(function(){n.call(null,t||function(){throw 1},1)})},defineProperty$3=Object.defineProperty,cache={},thrower=function(e){throw e},arrayMethodUsesToLength=function(e,t){if(has(cache,e))return cache[e];t||(t={});var n=[][e],r=!!has(t,"ACCESSORS")&&t.ACCESSORS,i=has(t,0)?t[0]:thrower,a=has(t,1)?t[1]:void 0;return cache[e]=!!n&&!fails(function(){if(r&&!descriptors)return!0;var e={length:-1};r?defineProperty$3(e,1,{enumerable:!0,get:thrower}):e[1]=1,n.call(e,i,a)})},$forEach$1=arrayIteration.forEach,STRICT_METHOD=arrayMethodIsStrict("forEach"),USES_TO_LENGTH=arrayMethodUsesToLength("forEach"),arrayForEach=STRICT_METHOD&&USES_TO_LENGTH?[].forEach:function(e){return $forEach$1(this,e,arguments.length>1?arguments[1]:void 0)};_export({target:"Array",proto:!0,forced:[].forEach!=arrayForEach},{forEach:arrayForEach});var $indexOf=arrayIncludes.indexOf,nativeIndexOf=[].indexOf,NEGATIVE_ZERO=!!nativeIndexOf&&1/[1].indexOf(1,-0)<0,STRICT_METHOD$1=arrayMethodIsStrict("indexOf"),USES_TO_LENGTH$1=arrayMethodUsesToLength("indexOf",{ACCESSORS:!0,1:0});_export({target:"Array",proto:!0,forced:NEGATIVE_ZERO||!STRICT_METHOD$1||!USES_TO_LENGTH$1},{indexOf:function(e){return NEGATIVE_ZERO?nativeIndexOf.apply(this,arguments)||0:$indexOf(this,e,arguments.length>1?arguments[1]:void 0)}});var UNSCOPABLES=wellKnownSymbol("unscopables"),ArrayPrototype=Array.prototype;null==ArrayPrototype[UNSCOPABLES]&&objectDefineProperty.f(ArrayPrototype,UNSCOPABLES,{configurable:!0,value:objectCreate(null)});var addToUnscopables=function(e){ArrayPrototype[UNSCOPABLES][e]=!0},iterators={},correctPrototypeGetter=!fails(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),IE_PROTO$1=sharedKey("IE_PROTO"),ObjectPrototype$1=Object.prototype,objectGetPrototypeOf=correctPrototypeGetter?Object.getPrototypeOf:function(e){return e=toObject(e),has(e,IE_PROTO$1)?e[IE_PROTO$1]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?ObjectPrototype$1:null},ITERATOR=wellKnownSymbol("iterator"),BUGGY_SAFARI_ITERATORS=!1,returnThis=function(){return this},IteratorPrototype,PrototypeOfArrayIteratorPrototype,arrayIterator;[].keys&&(arrayIterator=[].keys(),"next"in arrayIterator?(PrototypeOfArrayIteratorPrototype=objectGetPrototypeOf(objectGetPrototypeOf(arrayIterator)),PrototypeOfArrayIteratorPrototype!==Object.prototype&&(IteratorPrototype=PrototypeOfArrayIteratorPrototype)):BUGGY_SAFARI_ITERATORS=!0),null==IteratorPrototype&&(IteratorPrototype={}),has(IteratorPrototype,ITERATOR)||createNonEnumerableProperty(IteratorPrototype,ITERATOR,returnThis);var iteratorsCore={IteratorPrototype:IteratorPrototype,BUGGY_SAFARI_ITERATORS:BUGGY_SAFARI_ITERATORS},IteratorPrototype$1=iteratorsCore.IteratorPrototype,returnThis$1=function(){return this},createIteratorConstructor=function(e,t,n){var r=t+" Iterator";return e.prototype=objectCreate(IteratorPrototype$1,{next:createPropertyDescriptor(1,n)}),setToStringTag(e,r,!1),iterators[r]=returnThis$1,e},aPossiblePrototype=function(e){if(!isObject(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e},objectSetPrototypeOf=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return anObject(n),aPossiblePrototype(r),t?e.call(n,r):n.__proto__=r,n}}():void 0),IteratorPrototype$2=iteratorsCore.IteratorPrototype,BUGGY_SAFARI_ITERATORS$1=iteratorsCore.BUGGY_SAFARI_ITERATORS,ITERATOR$1=wellKnownSymbol("iterator"),KEYS="keys",VALUES="values",ENTRIES="entries",returnThis$2=function(){return this},defineIterator=function(e,t,n,r,i,a,o){createIteratorConstructor(n,t,r);var s,l,c,d=function(e){if(e===i&&_)return _;if(!BUGGY_SAFARI_ITERATORS$1&&e in f)return f[e];switch(e){case KEYS:case VALUES:case ENTRIES:return function(){return new n(this,e)}}return function(){return new n(this)}},u=t+" Iterator",p=!1,f=e.prototype,h=f[ITERATOR$1]||f["@@iterator"]||i&&f[i],_=!BUGGY_SAFARI_ITERATORS$1&&h||d(i),m="Array"==t&&f.entries||h;if(m&&(s=objectGetPrototypeOf(m.call(new e)),IteratorPrototype$2!==Object.prototype&&s.next&&(objectGetPrototypeOf(s)!==IteratorPrototype$2&&(objectSetPrototypeOf?objectSetPrototypeOf(s,IteratorPrototype$2):"function"!=typeof s[ITERATOR$1]&&createNonEnumerableProperty(s,ITERATOR$1,returnThis$2)),setToStringTag(s,u,!0))),i==VALUES&&h&&h.name!==VALUES&&(p=!0,_=function(){return h.call(this)}),f[ITERATOR$1]!==_&&createNonEnumerableProperty(f,ITERATOR$1,_),iterators[t]=_,i)if(l={values:d(VALUES),keys:a?_:d(KEYS),entries:d(ENTRIES)},o)for(c in l)!BUGGY_SAFARI_ITERATORS$1&&!p&&c in f||redefine(f,c,l[c]);else _export({target:t,proto:!0,forced:BUGGY_SAFARI_ITERATORS$1||p},l);return l},ARRAY_ITERATOR="Array Iterator",setInternalState$1=internalState.set,getInternalState$1=internalState.getterFor(ARRAY_ITERATOR),es_array_iterator=defineIterator(Array,"Array",function(e,t){setInternalState$1(this,{type:ARRAY_ITERATOR,target:toIndexedObject(e),index:0,kind:t})},function(){var e=getInternalState$1(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}},"values");iterators.Arguments=iterators.Array,addToUnscopables("keys"),addToUnscopables("values"),addToUnscopables("entries");var nativeJoin=[].join,ES3_STRINGS=indexedObject!=Object,STRICT_METHOD$2=arrayMethodIsStrict("join",",");_export({target:"Array",proto:!0,forced:ES3_STRINGS||!STRICT_METHOD$2},{join:function(e){return nativeJoin.call(toIndexedObject(this),void 0===e?",":e)}});var createProperty=function(e,t,n){var r=toPrimitive(t);r in e?objectDefineProperty.f(e,r,createPropertyDescriptor(0,n)):e[r]=n},engineUserAgent=getBuiltIn("navigator","userAgent")||"",process=global_1.process,versions=process&&process.versions,v8=versions&&versions.v8,match,version;v8?(match=v8.split("."),version=match[0]+match[1]):engineUserAgent&&(match=engineUserAgent.match(/Edge\/(\d+)/),(!match||match[1]>=74)&&(match=engineUserAgent.match(/Chrome\/(\d+)/),match&&(version=match[1])));var engineV8Version=version&&+version,SPECIES$1=wellKnownSymbol("species"),arrayMethodHasSpeciesSupport=function(e){return engineV8Version>=51||!fails(function(){var t=[];return(t.constructor={})[SPECIES$1]=function(){return{foo:1}},1!==t[e](Boolean).foo})},HAS_SPECIES_SUPPORT=arrayMethodHasSpeciesSupport("slice"),USES_TO_LENGTH$2=arrayMethodUsesToLength("slice",{ACCESSORS:!0,0:0,1:2}),SPECIES$2=wellKnownSymbol("species"),nativeSlice=[].slice,max$1=Math.max;_export({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT||!USES_TO_LENGTH$2},{slice:function(e,t){var n,r,i,a=toIndexedObject(this),o=toLength(a.length),s=toAbsoluteIndex(e,o),l=toAbsoluteIndex(void 0===t?o:t,o);if(isArray$1(a)&&("function"!=typeof(n=a.constructor)||n!==Array&&!isArray$1(n.prototype)?isObject(n)&&null===(n=n[SPECIES$2])&&(n=void 0):n=void 0,n===Array||void 0===n))return nativeSlice.call(a,s,l);for(r=new(void 0===n?Array:n)(max$1(l-s,0)),i=0;s<l;s++,i++)s in a&&createProperty(r,i,a[s]);return r.length=i,r}});var TO_STRING_TAG$1=wellKnownSymbol("toStringTag"),test={};test[TO_STRING_TAG$1]="z";var toStringTagSupport="[object z]"===String(test),TO_STRING_TAG$2=wellKnownSymbol("toStringTag"),CORRECT_ARGUMENTS="Arguments"==classofRaw(function(){return arguments}()),tryGet=function(e,t){try{return e[t]}catch(e){}},classof=toStringTagSupport?classofRaw:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=tryGet(t=Object(e),TO_STRING_TAG$2))?n:CORRECT_ARGUMENTS?classofRaw(t):"Object"==(r=classofRaw(t))&&"function"==typeof t.callee?"Arguments":r},objectToString=toStringTagSupport?{}.toString:function(){return"[object "+classof(this)+"]"};toStringTagSupport||redefine(Object.prototype,"toString",objectToString,{unsafe:!0});var regexpFlags=function(){var e=anObject(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t};function RE(e,t){return RegExp(e,t)}var UNSUPPORTED_Y=fails(function(){var e=RE("a","y");return e.lastIndex=2,null!=e.exec("abcd")}),BROKEN_CARET=fails(function(){var e=RE("^r","gy");return e.lastIndex=2,null!=e.exec("str")}),regexpStickyHelpers={UNSUPPORTED_Y:UNSUPPORTED_Y,BROKEN_CARET:BROKEN_CARET},nativeExec=RegExp.prototype.exec,nativeReplace=String.prototype.replace,patchedExec=nativeExec,UPDATES_LAST_INDEX_WRONG=function(){var e=/a/,t=/b*/g;return nativeExec.call(e,"a"),nativeExec.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),UNSUPPORTED_Y$1=regexpStickyHelpers.UNSUPPORTED_Y||regexpStickyHelpers.BROKEN_CARET,NPCG_INCLUDED=void 0!==/()??/.exec("")[1],PATCH=UPDATES_LAST_INDEX_WRONG||NPCG_INCLUDED||UNSUPPORTED_Y$1;PATCH&&(patchedExec=function(e){var t,n,r,i,a=this,o=UNSUPPORTED_Y$1&&a.sticky,s=regexpFlags.call(a),l=a.source,c=0,d=e;return o&&(-1===(s=s.replace("y","")).indexOf("g")&&(s+="g"),d=String(e).slice(a.lastIndex),a.lastIndex>0&&(!a.multiline||a.multiline&&"\n"!==e[a.lastIndex-1])&&(l="(?: "+l+")",d=" "+d,c++),n=new RegExp("^(?:"+l+")",s)),NPCG_INCLUDED&&(n=new RegExp("^"+l+"$(?!\\s)",s)),UPDATES_LAST_INDEX_WRONG&&(t=a.lastIndex),r=nativeExec.call(o?n:a,d),o?r?(r.input=r.input.slice(c),r[0]=r[0].slice(c),r.index=a.lastIndex,a.lastIndex+=r[0].length):a.lastIndex=0:UPDATES_LAST_INDEX_WRONG&&r&&(a.lastIndex=a.global?r.index+r[0].length:t),NPCG_INCLUDED&&r&&r.length>1&&nativeReplace.call(r[0],n,function(){var e=arguments;for(i=1;i<arguments.length-2;i++)void 0===e[i]&&(r[i]=void 0)}),r});var regexpExec=patchedExec;_export({target:"RegExp",proto:!0,forced:/./.exec!==regexpExec},{exec:regexpExec});var TO_STRING="toString",RegExpPrototype=RegExp.prototype,nativeToString=RegExpPrototype[TO_STRING],NOT_GENERIC=fails(function(){return"/a/b"!=nativeToString.call({source:"a",flags:"b"})}),INCORRECT_NAME=nativeToString.name!=TO_STRING;(NOT_GENERIC||INCORRECT_NAME)&&redefine(RegExp.prototype,TO_STRING,function(){var e=anObject(this),t=String(e.source),n=e.flags;return"/"+t+"/"+String(void 0===n&&e instanceof RegExp&&!("flags"in RegExpPrototype)?regexpFlags.call(e):n)},{unsafe:!0});var createMethod$2=function(e){return function(t,n){var r,i,a=String(requireObjectCoercible(t)),o=toInteger(n),s=a.length;return o<0||o>=s?e?"":void 0:(r=a.charCodeAt(o))<55296||r>56319||o+1===s||(i=a.charCodeAt(o+1))<56320||i>57343?e?a.charAt(o):r:e?a.slice(o,o+2):i-56320+(r-55296<<10)+65536}},stringMultibyte={codeAt:createMethod$2(!1),charAt:createMethod$2(!0)},charAt=stringMultibyte.charAt,STRING_ITERATOR="String Iterator",setInternalState$2=internalState.set,getInternalState$2=internalState.getterFor(STRING_ITERATOR);defineIterator(String,"String",function(e){setInternalState$2(this,{type:STRING_ITERATOR,string:String(e),index:0})},function(){var e,t=getInternalState$2(this),n=t.string,r=t.index;return r>=n.length?{value:void 0,done:!0}:(e=charAt(n,r),t.index+=e.length,{value:e,done:!1})});var SPECIES$3=wellKnownSymbol("species"),REPLACE_SUPPORTS_NAMED_GROUPS=!fails(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}),REPLACE_KEEPS_$0="$0"==="a".replace(/./,"$0"),REPLACE=wellKnownSymbol("replace"),REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE=!!/./[REPLACE]&&""===/./[REPLACE]("a","$0"),SPLIT_WORKS_WITH_OVERWRITTEN_EXEC=!fails(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}),fixRegexpWellKnownSymbolLogic=function(e,t,n,r){var i=wellKnownSymbol(e),a=!fails(function(){var t={};return t[i]=function(){return 7},7!=""[e](t)}),o=a&&!fails(function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[SPECIES$3]=function(){return n},n.flags="",n[i]=/./[i]),n.exec=function(){return t=!0,null},n[i](""),!t});if(!a||!o||"replace"===e&&(!REPLACE_SUPPORTS_NAMED_GROUPS||!REPLACE_KEEPS_$0||REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE)||"split"===e&&!SPLIT_WORKS_WITH_OVERWRITTEN_EXEC){var s=/./[i],l=n(i,""[e],function(e,t,n,r,i){return t.exec===regexpExec?a&&!i?{done:!0,value:s.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}},{REPLACE_KEEPS_$0:REPLACE_KEEPS_$0,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE}),c=l[0],d=l[1];redefine(String.prototype,e,c),redefine(RegExp.prototype,i,2==t?function(e,t){return d.call(e,this,t)}:function(e){return d.call(e,this)})}r&&createNonEnumerableProperty(RegExp.prototype[i],"sham",!0)},charAt$1=stringMultibyte.charAt,advanceStringIndex=function(e,t,n){return t+(n?charAt$1(e,t).length:1)},regexpExecAbstract=function(e,t){var n=e.exec;if("function"==typeof n){var r=n.call(e,t);if("object"!=typeof r)throw TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==classofRaw(e))throw TypeError("RegExp#exec called on incompatible receiver");return regexpExec.call(e,t)},max$2=Math.max,min$2=Math.min,floor$1=Math.floor,SUBSTITUTION_SYMBOLS=/\$([$&'`]|\d\d?|<[^>]*>)/g,SUBSTITUTION_SYMBOLS_NO_NAMED=/\$([$&'`]|\d\d?)/g,maybeToString=function(e){return void 0===e?e:String(e)};fixRegexpWellKnownSymbolLogic("replace",2,function(e,t,n,r){var i=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,a=r.REPLACE_KEEPS_$0,o=i?"$":"$0";return[function(n,r){var i=requireObjectCoercible(this),a=null==n?void 0:n[e];return void 0!==a?a.call(n,i,r):t.call(String(i),n,r)},function(e,r){if(!i&&a||"string"==typeof r&&-1===r.indexOf(o)){var l=n(t,e,this,r);if(l.done)return l.value}var c=anObject(e),d=String(this),u="function"==typeof r;u||(r=String(r));var p=c.global;if(p){var f=c.unicode;c.lastIndex=0}for(var h=[];;){var _=regexpExecAbstract(c,d);if(null===_)break;if(h.push(_),!p)break;""===String(_[0])&&(c.lastIndex=advanceStringIndex(d,toLength(c.lastIndex),f))}for(var m="",g=0,v=0;v<h.length;v++){_=h[v];for(var b=String(_[0]),y=max$2(min$2(toInteger(_.index),d.length),0),w=[],k=1;k<_.length;k++)w.push(maybeToString(_[k]));var x=_.groups;if(u){var C=[b].concat(w,y,d);void 0!==x&&C.push(x);var S=String(r.apply(void 0,C))}else S=s(b,d,y,w,x,r);y>=g&&(m+=d.slice(g,y)+S,g=y+b.length)}return m+d.slice(g)}];function s(e,n,r,i,a,o){var s=r+e.length,l=i.length,c=SUBSTITUTION_SYMBOLS_NO_NAMED;return void 0!==a&&(a=toObject(a),c=SUBSTITUTION_SYMBOLS),t.call(o,c,function(t,o){var c;switch(o.charAt(0)){case"$":return"$";case"&":return e;case"`":return n.slice(0,r);case"'":return n.slice(s);case"<":c=a[o.slice(1,-1)];break;default:var d=+o;if(0===d)return t;if(d>l){var u=floor$1(d/10);return 0===u?t:u<=l?void 0===i[u-1]?o.charAt(1):i[u-1]+o.charAt(1):t}c=i[d-1]}return void 0===c?"":c})}});var sameValue=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t};fixRegexpWellKnownSymbolLogic("search",1,function(e,t,n){return[function(t){var n=requireObjectCoercible(this),r=null==t?void 0:t[e];return void 0!==r?r.call(t,n):new RegExp(t)[e](String(n))},function(e){var r=n(t,e,this);if(r.done)return r.value;var i=anObject(e),a=String(this),o=i.lastIndex;sameValue(o,0)||(i.lastIndex=0);var s=regexpExecAbstract(i,a);return sameValue(i.lastIndex,o)||(i.lastIndex=o),null===s?-1:s.index}]});var MATCH=wellKnownSymbol("match"),isRegexp=function(e){var t;return isObject(e)&&(void 0!==(t=e[MATCH])?!!t:"RegExp"==classofRaw(e))},SPECIES$4=wellKnownSymbol("species"),speciesConstructor=function(e,t){var n,r=anObject(e).constructor;return void 0===r||null==(n=anObject(r)[SPECIES$4])?t:aFunction$1(n)},arrayPush=[].push,min$3=Math.min,MAX_UINT32=4294967295,SUPPORTS_Y=!fails(function(){return!RegExp(MAX_UINT32,"y")});fixRegexpWellKnownSymbolLogic("split",2,function(e,t,n){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var r=String(requireObjectCoercible(this)),i=void 0===n?MAX_UINT32:n>>>0;if(0===i)return[];if(void 0===e)return[r];if(!isRegexp(e))return t.call(r,e,i);for(var a,o,s,l=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,u=new RegExp(e.source,c+"g");(a=regexpExec.call(u,r))&&!((o=u.lastIndex)>d&&(l.push(r.slice(d,a.index)),a.length>1&&a.index<r.length&&arrayPush.apply(l,a.slice(1)),s=a[0].length,d=o,l.length>=i));)u.lastIndex===a.index&&u.lastIndex++;return d===r.length?!s&&u.test("")||l.push(""):l.push(r.slice(d)),l.length>i?l.slice(0,i):l}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:t.call(this,e,n)}:t,[function(t,n){var i=requireObjectCoercible(this),a=null==t?void 0:t[e];return void 0!==a?a.call(t,i,n):r.call(String(i),t,n)},function(e,i){var a=n(r,e,this,i,r!==t);if(a.done)return a.value;var o=anObject(e),s=String(this),l=speciesConstructor(o,RegExp),c=o.unicode,d=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(SUPPORTS_Y?"y":"g"),u=new l(SUPPORTS_Y?o:"^(?:"+o.source+")",d),p=void 0===i?MAX_UINT32:i>>>0;if(0===p)return[];if(0===s.length)return null===regexpExecAbstract(u,s)?[s]:[];for(var f=0,h=0,_=[];h<s.length;){u.lastIndex=SUPPORTS_Y?h:0;var m,g=regexpExecAbstract(u,SUPPORTS_Y?s:s.slice(h));if(null===g||(m=min$3(toLength(u.lastIndex+(SUPPORTS_Y?0:h)),s.length))===f)h=advanceStringIndex(s,h,c);else{if(_.push(s.slice(f,h)),_.length===p)return _;for(var v=1;v<=g.length-1;v++)if(_.push(g[v]),_.length===p)return _;h=f=m}}return _.push(s.slice(f)),_}]},!SUPPORTS_Y);var domIterables={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0};for(var COLLECTION_NAME in domIterables){var Collection=global_1[COLLECTION_NAME],CollectionPrototype=Collection&&Collection.prototype;if(CollectionPrototype&&CollectionPrototype.forEach!==arrayForEach)try{createNonEnumerableProperty(CollectionPrototype,"forEach",arrayForEach)}catch(e){CollectionPrototype.forEach=arrayForEach}}var ITERATOR$2=wellKnownSymbol("iterator"),TO_STRING_TAG$3=wellKnownSymbol("toStringTag"),ArrayValues=es_array_iterator.values;for(var COLLECTION_NAME$1 in domIterables){var Collection$1=global_1[COLLECTION_NAME$1],CollectionPrototype$1=Collection$1&&Collection$1.prototype;if(CollectionPrototype$1){if(CollectionPrototype$1[ITERATOR$2]!==ArrayValues)try{createNonEnumerableProperty(CollectionPrototype$1,ITERATOR$2,ArrayValues)}catch(e){CollectionPrototype$1[ITERATOR$2]=ArrayValues}if(CollectionPrototype$1[TO_STRING_TAG$3]||createNonEnumerableProperty(CollectionPrototype$1,TO_STRING_TAG$3,COLLECTION_NAME$1),domIterables[COLLECTION_NAME$1])for(var METHOD_NAME in es_array_iterator)if(CollectionPrototype$1[METHOD_NAME]!==es_array_iterator[METHOD_NAME])try{createNonEnumerableProperty(CollectionPrototype$1,METHOD_NAME,es_array_iterator[METHOD_NAME])}catch(e){CollectionPrototype$1[METHOD_NAME]=es_array_iterator[METHOD_NAME]}}}var ITERATOR$3=wellKnownSymbol("iterator"),nativeUrl=!fails(function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach(function(e,r){t.delete("b"),n+=r+e}),!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[ITERATOR$3]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host}),anInstance=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e},nativeAssign=Object.assign,defineProperty$4=Object.defineProperty,objectAssign=!nativeAssign||fails(function(){if(descriptors&&1!==nativeAssign({b:1},nativeAssign(defineProperty$4({},"a",{enumerable:!0,get:function(){defineProperty$4(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol();return e[n]=7,"abcdefghijklmnopqrst".split("").forEach(function(e){t[e]=e}),7!=nativeAssign({},e)[n]||"abcdefghijklmnopqrst"!=objectKeys(nativeAssign({},t)).join("")})?function(e,t){for(var n=arguments,r=toObject(e),i=arguments.length,a=1,o=objectGetOwnPropertySymbols.f,s=objectPropertyIsEnumerable.f;i>a;)for(var l,c=indexedObject(n[a++]),d=o?objectKeys(c).concat(o(c)):objectKeys(c),u=d.length,p=0;u>p;)l=d[p++],descriptors&&!s.call(c,l)||(r[l]=c[l]);return r}:nativeAssign,callWithSafeIterationClosing=function(e,t,n,r){try{return r?t(anObject(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&anObject(i.call(e)),t}},ITERATOR$4=wellKnownSymbol("iterator"),ArrayPrototype$1=Array.prototype,isArrayIteratorMethod=function(e){return void 0!==e&&(iterators.Array===e||ArrayPrototype$1[ITERATOR$4]===e)},ITERATOR$5=wellKnownSymbol("iterator"),getIteratorMethod=function(e){if(null!=e)return e[ITERATOR$5]||e["@@iterator"]||iterators[classof(e)]},arrayFrom=function(e){var t,n,r,i,a,o,s=toObject(e),l="function"==typeof this?this:Array,c=arguments.length,d=c>1?arguments[1]:void 0,u=void 0!==d,p=getIteratorMethod(s),f=0;if(u&&(d=functionBindContext(d,c>2?arguments[2]:void 0,2)),null==p||l==Array&&isArrayIteratorMethod(p))for(n=new l(t=toLength(s.length));t>f;f++)o=u?d(s[f],f):s[f],createProperty(n,f,o);else for(a=(i=p.call(s)).next,n=new l;!(r=a.call(i)).done;f++)o=u?callWithSafeIterationClosing(i,d,[r.value,f],!0):r.value,createProperty(n,f,o);return n.length=f,n},maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexNonASCII=/[^\0-\u007E]/,regexSeparators=/[.\u3002\uFF0E\uFF61]/g,OVERFLOW_ERROR="Overflow: input needs wider integers to process",baseMinusTMin=base-tMin,floor$2=Math.floor,stringFromCharCode=String.fromCharCode,ucs2decode=function(e){for(var t=[],n=0,r=e.length;n<r;){var i=e.charCodeAt(n++);if(i>=55296&&i<=56319&&n<r){var a=e.charCodeAt(n++);56320==(64512&a)?t.push(((1023&i)<<10)+(1023&a)+65536):(t.push(i),n--)}else t.push(i)}return t},digitToBasic=function(e){return e+22+75*(e<26)},adapt=function(e,t,n){var r=0;for(e=n?floor$2(e/damp):e>>1,e+=floor$2(e/t);e>baseMinusTMin*tMax>>1;r+=base)e=floor$2(e/baseMinusTMin);return floor$2(r+(baseMinusTMin+1)*e/(e+skew))},encode=function(e){var t,n,r=[],i=(e=ucs2decode(e)).length,a=initialN,o=0,s=initialBias;for(t=0;t<e.length;t++)(n=e[t])<128&&r.push(stringFromCharCode(n));var l=r.length,c=l;for(l&&r.push(delimiter);c<i;){var d=maxInt;for(t=0;t<e.length;t++)(n=e[t])>=a&&n<d&&(d=n);var u=c+1;if(d-a>floor$2((maxInt-o)/u))throw RangeError(OVERFLOW_ERROR);for(o+=(d-a)*u,a=d,t=0;t<e.length;t++){if((n=e[t])<a&&++o>maxInt)throw RangeError(OVERFLOW_ERROR);if(n==a){for(var p=o,f=base;;f+=base){var h=f<=s?tMin:f>=s+tMax?tMax:f-s;if(p<h)break;var _=p-h,m=base-h;r.push(stringFromCharCode(digitToBasic(h+_%m))),p=floor$2(_/m)}r.push(stringFromCharCode(digitToBasic(p))),s=adapt(o,u,c==l),o=0,++c}}++o,++a}return r.join("")},stringPunycodeToAscii=function(e){var t,n,r=[],i=e.toLowerCase().replace(regexSeparators,".").split(".");for(t=0;t<i.length;t++)n=i[t],r.push(regexNonASCII.test(n)?"xn--"+encode(n):n);return r.join(".")},redefineAll=function(e,t,n){for(var r in t)redefine(e,r,t[r],n);return e},getIterator=function(e){var t=getIteratorMethod(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return anObject(t.call(e))},$fetch=getBuiltIn("fetch"),Headers=getBuiltIn("Headers"),ITERATOR$6=wellKnownSymbol("iterator"),URL_SEARCH_PARAMS="URLSearchParams",URL_SEARCH_PARAMS_ITERATOR=URL_SEARCH_PARAMS+"Iterator",setInternalState$3=internalState.set,getInternalParamsState=internalState.getterFor(URL_SEARCH_PARAMS),getInternalIteratorState=internalState.getterFor(URL_SEARCH_PARAMS_ITERATOR),plus=/\+/g,sequences=Array(4),percentSequence=function(e){return sequences[e-1]||(sequences[e-1]=RegExp("((?:%[\\da-f]{2}){"+e+"})","gi"))},percentDecode=function(e){try{return decodeURIComponent(e)}catch(t){return e}},deserialize=function(e){var t=e.replace(plus," "),n=4;try{return decodeURIComponent(t)}catch(e){for(;n;)t=t.replace(percentSequence(n--),percentDecode);return t}},find=/[!'()~]|%20/g,replace={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},replacer=function(e){return replace[e]},serialize=function(e){return encodeURIComponent(e).replace(find,replacer)},parseSearchParams=function(e,t){if(t)for(var n,r,i=t.split("&"),a=0;a<i.length;)(n=i[a++]).length&&(r=n.split("="),e.push({key:deserialize(r.shift()),value:deserialize(r.join("="))}))},updateSearchParams=function(e){this.entries.length=0,parseSearchParams(this.entries,e)},validateArgumentsLength=function(e,t){if(e<t)throw TypeError("Not enough arguments")},URLSearchParamsIterator=createIteratorConstructor(function(e,t){setInternalState$3(this,{type:URL_SEARCH_PARAMS_ITERATOR,iterator:getIterator(getInternalParamsState(e).entries),kind:t})},"Iterator",function(){var e=getInternalIteratorState(this),t=e.kind,n=e.iterator.next(),r=n.value;return n.done||(n.value="keys"===t?r.key:"values"===t?r.value:[r.key,r.value]),n}),URLSearchParamsConstructor=function(){anInstance(this,URLSearchParamsConstructor,URL_SEARCH_PARAMS);var e,t,n,r,i,a,o,s,l,c=arguments.length>0?arguments[0]:void 0,d=[];if(setInternalState$3(this,{type:URL_SEARCH_PARAMS,entries:d,updateURL:function(){},updateSearchParams:updateSearchParams}),void 0!==c)if(isObject(c))if("function"==typeof(e=getIteratorMethod(c)))for(n=(t=e.call(c)).next;!(r=n.call(t)).done;){if((o=(a=(i=getIterator(anObject(r.value))).next).call(i)).done||(s=a.call(i)).done||!a.call(i).done)throw TypeError("Expected sequence with length 2");d.push({key:o.value+"",value:s.value+""})}else for(l in c)has(c,l)&&d.push({key:l,value:c[l]+""});else parseSearchParams(d,"string"==typeof c?"?"===c.charAt(0)?c.slice(1):c:c+"")},URLSearchParamsPrototype=URLSearchParamsConstructor.prototype;redefineAll(URLSearchParamsPrototype,{append:function(e,t){validateArgumentsLength(arguments.length,2);var n=getInternalParamsState(this);n.entries.push({key:e+"",value:t+""}),n.updateURL()},delete:function(e){validateArgumentsLength(arguments.length,1);for(var t=getInternalParamsState(this),n=t.entries,r=e+"",i=0;i<n.length;)n[i].key===r?n.splice(i,1):i++;t.updateURL()},get:function(e){validateArgumentsLength(arguments.length,1);for(var t=getInternalParamsState(this).entries,n=e+"",r=0;r<t.length;r++)if(t[r].key===n)return t[r].value;return null},getAll:function(e){validateArgumentsLength(arguments.length,1);for(var t=getInternalParamsState(this).entries,n=e+"",r=[],i=0;i<t.length;i++)t[i].key===n&&r.push(t[i].value);return r},has:function(e){validateArgumentsLength(arguments.length,1);for(var t=getInternalParamsState(this).entries,n=e+"",r=0;r<t.length;)if(t[r++].key===n)return!0;return!1},set:function(e,t){validateArgumentsLength(arguments.length,1);for(var n,r=getInternalParamsState(this),i=r.entries,a=!1,o=e+"",s=t+"",l=0;l<i.length;l++)(n=i[l]).key===o&&(a?i.splice(l--,1):(a=!0,n.value=s));a||i.push({key:o,value:s}),r.updateURL()},sort:function(){var e,t,n,r=getInternalParamsState(this),i=r.entries,a=i.slice();for(i.length=0,n=0;n<a.length;n++){for(e=a[n],t=0;t<n;t++)if(i[t].key>e.key){i.splice(t,0,e);break}t===n&&i.push(e)}r.updateURL()},forEach:function(e){for(var t,n=getInternalParamsState(this).entries,r=functionBindContext(e,arguments.length>1?arguments[1]:void 0,3),i=0;i<n.length;)r((t=n[i++]).value,t.key,this)},keys:function(){return new URLSearchParamsIterator(this,"keys")},values:function(){return new URLSearchParamsIterator(this,"values")},entries:function(){return new URLSearchParamsIterator(this,"entries")}},{enumerable:!0}),redefine(URLSearchParamsPrototype,ITERATOR$6,URLSearchParamsPrototype.entries),redefine(URLSearchParamsPrototype,"toString",function(){for(var e,t=getInternalParamsState(this).entries,n=[],r=0;r<t.length;)e=t[r++],n.push(serialize(e.key)+"="+serialize(e.value));return n.join("&")},{enumerable:!0}),setToStringTag(URLSearchParamsConstructor,URL_SEARCH_PARAMS),_export({global:!0,forced:!nativeUrl},{URLSearchParams:URLSearchParamsConstructor}),nativeUrl||"function"!=typeof $fetch||"function"!=typeof Headers||_export({global:!0,enumerable:!0,forced:!0},{fetch:function(e){var t,n,r,i=[e];return arguments.length>1&&(t=arguments[1],isObject(t)&&(n=t.body,classof(n)===URL_SEARCH_PARAMS&&((r=t.headers?new Headers(t.headers):new Headers).has("content-type")||r.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),t=objectCreate(t,{body:createPropertyDescriptor(0,String(n)),headers:createPropertyDescriptor(0,r)}))),i.push(t)),$fetch.apply(this,i)}});var web_urlSearchParams={URLSearchParams:URLSearchParamsConstructor,getState:getInternalParamsState},codeAt=stringMultibyte.codeAt,NativeURL=global_1.URL,URLSearchParams$1=web_urlSearchParams.URLSearchParams,getInternalSearchParamsState=web_urlSearchParams.getState,setInternalState$4=internalState.set,getInternalURLState=internalState.getterFor("URL"),floor$3=Math.floor,pow=Math.pow,INVALID_AUTHORITY="Invalid authority",INVALID_SCHEME="Invalid scheme",INVALID_HOST="Invalid host",INVALID_PORT="Invalid port",ALPHA=/[A-Za-z]/,ALPHANUMERIC=/[\d+-.A-Za-z]/,DIGIT=/\d/,HEX_START=/^(0x|0X)/,OCT=/^[0-7]+$/,DEC=/^\d+$/,HEX=/^[\dA-Fa-f]+$/,FORBIDDEN_HOST_CODE_POINT=/[\u0000\u0009\u000A\u000D #%\/:?@[\\]]/,FORBIDDEN_HOST_CODE_POINT_EXCLUDING_PERCENT=/[\u0000\u0009\u000A\u000D #\/:?@[\\]]/,LEADING_AND_TRAILING_C0_CONTROL_OR_SPACE=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,TAB_AND_NEW_LINE=/[\u0009\u000A\u000D]/g,EOF,parseHost=function(e,t){var n,r,i;if("["==t.charAt(0)){if("]"!=t.charAt(t.length-1))return INVALID_HOST;if(!(n=parseIPv6(t.slice(1,-1))))return INVALID_HOST;e.host=n}else if(isSpecial(e)){if(t=stringPunycodeToAscii(t),FORBIDDEN_HOST_CODE_POINT.test(t))return INVALID_HOST;if(null===(n=parseIPv4(t)))return INVALID_HOST;e.host=n}else{if(FORBIDDEN_HOST_CODE_POINT_EXCLUDING_PERCENT.test(t))return INVALID_HOST;for(n="",r=arrayFrom(t),i=0;i<r.length;i++)n+=percentEncode(r[i],C0ControlPercentEncodeSet);e.host=n}},parseIPv4=function(e){var t,n,r,i,a,o,s,l=e.split(".");if(l.length&&""==l[l.length-1]&&l.pop(),(t=l.length)>4)return e;for(n=[],r=0;r<t;r++){if(""==(i=l[r]))return e;if(a=10,i.length>1&&"0"==i.charAt(0)&&(a=HEX_START.test(i)?16:8,i=i.slice(8==a?1:2)),""===i)o=0;else{if(!(10==a?DEC:8==a?OCT:HEX).test(i))return e;o=parseInt(i,a)}n.push(o)}for(r=0;r<t;r++)if(o=n[r],r==t-1){if(o>=pow(256,5-t))return null}else if(o>255)return null;for(s=n.pop(),r=0;r<n.length;r++)s+=n[r]*pow(256,3-r);return s},parseIPv6=function(e){var t,n,r,i,a,o,s,l=[0,0,0,0,0,0,0,0],c=0,d=null,u=0,p=function(){return e.charAt(u)};if(":"==p()){if(":"!=e.charAt(1))return;u+=2,d=++c}for(;p();){if(8==c)return;if(":"!=p()){for(t=n=0;n<4&&HEX.test(p());)t=16*t+parseInt(p(),16),u++,n++;if("."==p()){if(0==n)return;if(u-=n,c>6)return;for(r=0;p();){if(i=null,r>0){if(!("."==p()&&r<4))return;u++}if(!DIGIT.test(p()))return;for(;DIGIT.test(p());){if(a=parseInt(p(),10),null===i)i=a;else{if(0==i)return;i=10*i+a}if(i>255)return;u++}l[c]=256*l[c]+i,2!=++r&&4!=r||c++}if(4!=r)return;break}if(":"==p()){if(u++,!p())return}else if(p())return;l[c++]=t}else{if(null!==d)return;u++,d=++c}}if(null!==d)for(o=c-d,c=7;0!=c&&o>0;)s=l[c],l[c--]=l[d+o-1],l[d+--o]=s;else if(8!=c)return;return l},findLongestZeroSequence=function(e){for(var t=null,n=1,r=null,i=0,a=0;a<8;a++)0!==e[a]?(i>n&&(t=r,n=i),r=null,i=0):(null===r&&(r=a),++i);return i>n&&(t=r,n=i),t},serializeHost=function(e){var t,n,r,i;if("number"==typeof e){for(t=[],n=0;n<4;n++)t.unshift(e%256),e=floor$3(e/256);return t.join(".")}if("object"==typeof e){for(t="",r=findLongestZeroSequence(e),n=0;n<8;n++)i&&0===e[n]||(i&&(i=!1),r===n?(t+=n?":":"::",i=!0):(t+=e[n].toString(16),n<7&&(t+=":")));return"["+t+"]"}return e},C0ControlPercentEncodeSet={},fragmentPercentEncodeSet=objectAssign({},C0ControlPercentEncodeSet,{" ":1,'"':1,"<":1,">":1,"`":1}),pathPercentEncodeSet=objectAssign({},fragmentPercentEncodeSet,{"#":1,"?":1,"{":1,"}":1}),userinfoPercentEncodeSet=objectAssign({},pathPercentEncodeSet,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),percentEncode=function(e,t){var n=codeAt(e,0);return n>32&&n<127&&!has(t,e)?e:encodeURIComponent(e)},specialSchemes={ftp:21,file:null,http:80,https:443,ws:80,wss:443},isSpecial=function(e){return has(specialSchemes,e.scheme)},includesCredentials=function(e){return""!=e.username||""!=e.password},cannotHaveUsernamePasswordPort=function(e){return!e.host||e.cannotBeABaseURL||"file"==e.scheme},isWindowsDriveLetter=function(e,t){var n;return 2==e.length&&ALPHA.test(e.charAt(0))&&(":"==(n=e.charAt(1))||!t&&"|"==n)},startsWithWindowsDriveLetter=function(e){var t;return e.length>1&&isWindowsDriveLetter(e.slice(0,2))&&(2==e.length||"/"===(t=e.charAt(2))||"\\"===t||"?"===t||"#"===t)},shortenURLsPath=function(e){var t=e.path,n=t.length;!n||"file"==e.scheme&&1==n&&isWindowsDriveLetter(t[0],!0)||t.pop()},isSingleDot=function(e){return"."===e||"%2e"===e.toLowerCase()},isDoubleDot=function(e){return".."===(e=e.toLowerCase())||"%2e."===e||".%2e"===e||"%2e%2e"===e},SCHEME_START={},SCHEME={},NO_SCHEME={},SPECIAL_RELATIVE_OR_AUTHORITY={},PATH_OR_AUTHORITY={},RELATIVE={},RELATIVE_SLASH={},SPECIAL_AUTHORITY_SLASHES={},SPECIAL_AUTHORITY_IGNORE_SLASHES={},AUTHORITY={},HOST={},HOSTNAME={},PORT={},FILE={},FILE_SLASH={},FILE_HOST={},PATH_START={},PATH={},CANNOT_BE_A_BASE_URL_PATH={},QUERY={},FRAGMENT={},parseURL=function(e,t,n,r){var i,a,o,s,l=n||SCHEME_START,c=0,d="",u=!1,p=!1,f=!1;for(n||(e.scheme="",e.username="",e.password="",e.host=null,e.port=null,e.path=[],e.query=null,e.fragment=null,e.cannotBeABaseURL=!1,t=t.replace(LEADING_AND_TRAILING_C0_CONTROL_OR_SPACE,"")),t=t.replace(TAB_AND_NEW_LINE,""),i=arrayFrom(t);c<=i.length;){switch(a=i[c],l){case SCHEME_START:if(!a||!ALPHA.test(a)){if(n)return INVALID_SCHEME;l=NO_SCHEME;continue}d+=a.toLowerCase(),l=SCHEME;break;case SCHEME:if(a&&(ALPHANUMERIC.test(a)||"+"==a||"-"==a||"."==a))d+=a.toLowerCase();else{if(":"!=a){if(n)return INVALID_SCHEME;d="",l=NO_SCHEME,c=0;continue}if(n&&(isSpecial(e)!=has(specialSchemes,d)||"file"==d&&(includesCredentials(e)||null!==e.port)||"file"==e.scheme&&!e.host))return;if(e.scheme=d,n)return void(isSpecial(e)&&specialSchemes[e.scheme]==e.port&&(e.port=null));d="","file"==e.scheme?l=FILE:isSpecial(e)&&r&&r.scheme==e.scheme?l=SPECIAL_RELATIVE_OR_AUTHORITY:isSpecial(e)?l=SPECIAL_AUTHORITY_SLASHES:"/"==i[c+1]?(l=PATH_OR_AUTHORITY,c++):(e.cannotBeABaseURL=!0,e.path.push(""),l=CANNOT_BE_A_BASE_URL_PATH)}break;case NO_SCHEME:if(!r||r.cannotBeABaseURL&&"#"!=a)return INVALID_SCHEME;if(r.cannotBeABaseURL&&"#"==a){e.scheme=r.scheme,e.path=r.path.slice(),e.query=r.query,e.fragment="",e.cannotBeABaseURL=!0,l=FRAGMENT;break}l="file"==r.scheme?FILE:RELATIVE;continue;case SPECIAL_RELATIVE_OR_AUTHORITY:if("/"!=a||"/"!=i[c+1]){l=RELATIVE;continue}l=SPECIAL_AUTHORITY_IGNORE_SLASHES,c++;break;case PATH_OR_AUTHORITY:if("/"==a){l=AUTHORITY;break}l=PATH;continue;case RELATIVE:if(e.scheme=r.scheme,a==EOF)e.username=r.username,e.password=r.password,e.host=r.host,e.port=r.port,e.path=r.path.slice(),e.query=r.query;else if("/"==a||"\\"==a&&isSpecial(e))l=RELATIVE_SLASH;else if("?"==a)e.username=r.username,e.password=r.password,e.host=r.host,e.port=r.port,e.path=r.path.slice(),e.query="",l=QUERY;else{if("#"!=a){e.username=r.username,e.password=r.password,e.host=r.host,e.port=r.port,e.path=r.path.slice(),e.path.pop(),l=PATH;continue}e.username=r.username,e.password=r.password,e.host=r.host,e.port=r.port,e.path=r.path.slice(),e.query=r.query,e.fragment="",l=FRAGMENT}break;case RELATIVE_SLASH:if(!isSpecial(e)||"/"!=a&&"\\"!=a){if("/"!=a){e.username=r.username,e.password=r.password,e.host=r.host,e.port=r.port,l=PATH;continue}l=AUTHORITY}else l=SPECIAL_AUTHORITY_IGNORE_SLASHES;break;case SPECIAL_AUTHORITY_SLASHES:if(l=SPECIAL_AUTHORITY_IGNORE_SLASHES,"/"!=a||"/"!=d.charAt(c+1))continue;c++;break;case SPECIAL_AUTHORITY_IGNORE_SLASHES:if("/"!=a&&"\\"!=a){l=AUTHORITY;continue}break;case AUTHORITY:if("@"==a){u&&(d="%40"+d),u=!0,o=arrayFrom(d);for(var h=0;h<o.length;h++){var _=o[h];if(":"!=_||f){var m=percentEncode(_,userinfoPercentEncodeSet);f?e.password+=m:e.username+=m}else f=!0}d=""}else if(a==EOF||"/"==a||"?"==a||"#"==a||"\\"==a&&isSpecial(e)){if(u&&""==d)return INVALID_AUTHORITY;c-=arrayFrom(d).length+1,d="",l=HOST}else d+=a;break;case HOST:case HOSTNAME:if(n&&"file"==e.scheme){l=FILE_HOST;continue}if(":"!=a||p){if(a==EOF||"/"==a||"?"==a||"#"==a||"\\"==a&&isSpecial(e)){if(isSpecial(e)&&""==d)return INVALID_HOST;if(n&&""==d&&(includesCredentials(e)||null!==e.port))return;if(s=parseHost(e,d))return s;if(d="",l=PATH_START,n)return;continue}"["==a?p=!0:"]"==a&&(p=!1),d+=a}else{if(""==d)return INVALID_HOST;if(s=parseHost(e,d))return s;if(d="",l=PORT,n==HOSTNAME)return}break;case PORT:if(!DIGIT.test(a)){if(a==EOF||"/"==a||"?"==a||"#"==a||"\\"==a&&isSpecial(e)||n){if(""!=d){var g=parseInt(d,10);if(g>65535)return INVALID_PORT;e.port=isSpecial(e)&&g===specialSchemes[e.scheme]?null:g,d=""}if(n)return;l=PATH_START;continue}return INVALID_PORT}d+=a;break;case FILE:if(e.scheme="file","/"==a||"\\"==a)l=FILE_SLASH;else{if(!r||"file"!=r.scheme){l=PATH;continue}if(a==EOF)e.host=r.host,e.path=r.path.slice(),e.query=r.query;else if("?"==a)e.host=r.host,e.path=r.path.slice(),e.query="",l=QUERY;else{if("#"!=a){startsWithWindowsDriveLetter(i.slice(c).join(""))||(e.host=r.host,e.path=r.path.slice(),shortenURLsPath(e)),l=PATH;continue}e.host=r.host,e.path=r.path.slice(),e.query=r.query,e.fragment="",l=FRAGMENT}}break;case FILE_SLASH:if("/"==a||"\\"==a){l=FILE_HOST;break}r&&"file"==r.scheme&&!startsWithWindowsDriveLetter(i.slice(c).join(""))&&(isWindowsDriveLetter(r.path[0],!0)?e.path.push(r.path[0]):e.host=r.host),l=PATH;continue;case FILE_HOST:if(a==EOF||"/"==a||"\\"==a||"?"==a||"#"==a){if(!n&&isWindowsDriveLetter(d))l=PATH;else if(""==d){if(e.host="",n)return;l=PATH_START}else{if(s=parseHost(e,d))return s;if("localhost"==e.host&&(e.host=""),n)return;d="",l=PATH_START}continue}d+=a;break;case PATH_START:if(isSpecial(e)){if(l=PATH,"/"!=a&&"\\"!=a)continue}else if(n||"?"!=a)if(n||"#"!=a){if(a!=EOF&&(l=PATH,"/"!=a))continue}else e.fragment="",l=FRAGMENT;else e.query="",l=QUERY;break;case PATH:if(a==EOF||"/"==a||"\\"==a&&isSpecial(e)||!n&&("?"==a||"#"==a)){if(isDoubleDot(d)?(shortenURLsPath(e),"/"==a||"\\"==a&&isSpecial(e)||e.path.push("")):isSingleDot(d)?"/"==a||"\\"==a&&isSpecial(e)||e.path.push(""):("file"==e.scheme&&!e.path.length&&isWindowsDriveLetter(d)&&(e.host&&(e.host=""),d=d.charAt(0)+":"),e.path.push(d)),d="","file"==e.scheme&&(a==EOF||"?"==a||"#"==a))for(;e.path.length>1&&""===e.path[0];)e.path.shift();"?"==a?(e.query="",l=QUERY):"#"==a&&(e.fragment="",l=FRAGMENT)}else d+=percentEncode(a,pathPercentEncodeSet);break;case CANNOT_BE_A_BASE_URL_PATH:"?"==a?(e.query="",l=QUERY):"#"==a?(e.fragment="",l=FRAGMENT):a!=EOF&&(e.path[0]+=percentEncode(a,C0ControlPercentEncodeSet));break;case QUERY:n||"#"!=a?a!=EOF&&("'"==a&&isSpecial(e)?e.query+="%27":e.query+="#"==a?"%23":percentEncode(a,C0ControlPercentEncodeSet)):(e.fragment="",l=FRAGMENT);break;case FRAGMENT:a!=EOF&&(e.fragment+=percentEncode(a,fragmentPercentEncodeSet))}c++}},URLConstructor=function(e){var t,n,r=anInstance(this,URLConstructor,"URL"),i=arguments.length>1?arguments[1]:void 0,a=String(e),o=setInternalState$4(r,{type:"URL"});if(void 0!==i)if(i instanceof URLConstructor)t=getInternalURLState(i);else if(n=parseURL(t={},String(i)))throw TypeError(n);if(n=parseURL(o,a,null,t))throw TypeError(n);var s=o.searchParams=new URLSearchParams$1,l=getInternalSearchParamsState(s);l.updateSearchParams(o.query),l.updateURL=function(){o.query=String(s)||null},descriptors||(r.href=serializeURL.call(r),r.origin=getOrigin.call(r),r.protocol=getProtocol.call(r),r.username=getUsername.call(r),r.password=getPassword.call(r),r.host=getHost.call(r),r.hostname=getHostname.call(r),r.port=getPort.call(r),r.pathname=getPathname.call(r),r.search=getSearch.call(r),r.searchParams=getSearchParams.call(r),r.hash=getHash.call(r))},URLPrototype=URLConstructor.prototype,serializeURL=function(){var e=getInternalURLState(this),t=e.scheme,n=e.username,r=e.password,i=e.host,a=e.port,o=e.path,s=e.query,l=e.fragment,c=t+":";return null!==i?(c+="//",includesCredentials(e)&&(c+=n+(r?":"+r:"")+"@"),c+=serializeHost(i),null!==a&&(c+=":"+a)):"file"==t&&(c+="//"),c+=e.cannotBeABaseURL?o[0]:o.length?"/"+o.join("/"):"",null!==s&&(c+="?"+s),null!==l&&(c+="#"+l),c},getOrigin=function(){var e=getInternalURLState(this),t=e.scheme,n=e.port;if("blob"==t)try{return new URL(t.path[0]).origin}catch(e){return"null"}return"file"!=t&&isSpecial(e)?t+"://"+serializeHost(e.host)+(null!==n?":"+n:""):"null"},getProtocol=function(){return getInternalURLState(this).scheme+":"},getUsername=function(){return getInternalURLState(this).username},getPassword=function(){return getInternalURLState(this).password},getHost=function(){var e=getInternalURLState(this),t=e.host,n=e.port;return null===t?"":null===n?serializeHost(t):serializeHost(t)+":"+n},getHostname=function(){var e=getInternalURLState(this).host;return null===e?"":serializeHost(e)},getPort=function(){var e=getInternalURLState(this).port;return null===e?"":String(e)},getPathname=function(){var e=getInternalURLState(this),t=e.path;return e.cannotBeABaseURL?t[0]:t.length?"/"+t.join("/"):""},getSearch=function(){var e=getInternalURLState(this).query;return e?"?"+e:""},getSearchParams=function(){return getInternalURLState(this).searchParams},getHash=function(){var e=getInternalURLState(this).fragment;return e?"#"+e:""},accessorDescriptor=function(e,t){return{get:e,set:t,configurable:!0,enumerable:!0}};if(descriptors&&objectDefineProperties(URLPrototype,{href:accessorDescriptor(serializeURL,function(e){var t=getInternalURLState(this),n=String(e),r=parseURL(t,n);if(r)throw TypeError(r);getInternalSearchParamsState(t.searchParams).updateSearchParams(t.query)}),origin:accessorDescriptor(getOrigin),protocol:accessorDescriptor(getProtocol,function(e){var t=getInternalURLState(this);parseURL(t,String(e)+":",SCHEME_START)}),username:accessorDescriptor(getUsername,function(e){var t=getInternalURLState(this),n=arrayFrom(String(e));if(!cannotHaveUsernamePasswordPort(t)){t.username="";for(var r=0;r<n.length;r++)t.username+=percentEncode(n[r],userinfoPercentEncodeSet)}}),password:accessorDescriptor(getPassword,function(e){var t=getInternalURLState(this),n=arrayFrom(String(e));if(!cannotHaveUsernamePasswordPort(t)){t.password="";for(var r=0;r<n.length;r++)t.password+=percentEncode(n[r],userinfoPercentEncodeSet)}}),host:accessorDescriptor(getHost,function(e){var t=getInternalURLState(this);t.cannotBeABaseURL||parseURL(t,String(e),HOST)}),hostname:accessorDescriptor(getHostname,function(e){var t=getInternalURLState(this);t.cannotBeABaseURL||parseURL(t,String(e),HOSTNAME)}),port:accessorDescriptor(getPort,function(e){var t=getInternalURLState(this);cannotHaveUsernamePasswordPort(t)||(""==(e=String(e))?t.port=null:parseURL(t,e,PORT))}),pathname:accessorDescriptor(getPathname,function(e){var t=getInternalURLState(this);t.cannotBeABaseURL||(t.path=[],parseURL(t,e+"",PATH_START))}),search:accessorDescriptor(getSearch,function(e){var t=getInternalURLState(this);""==(e=String(e))?t.query=null:("?"==e.charAt(0)&&(e=e.slice(1)),t.query="",parseURL(t,e,QUERY)),getInternalSearchParamsState(t.searchParams).updateSearchParams(t.query)}),searchParams:accessorDescriptor(getSearchParams),hash:accessorDescriptor(getHash,function(e){var t=getInternalURLState(this);""!=(e=String(e))?("#"==e.charAt(0)&&(e=e.slice(1)),t.fragment="",parseURL(t,e,FRAGMENT)):t.fragment=null})}),redefine(URLPrototype,"toJSON",function(){return serializeURL.call(this)},{enumerable:!0}),redefine(URLPrototype,"toString",function(){return serializeURL.call(this)},{enumerable:!0}),NativeURL){var nativeCreateObjectURL=NativeURL.createObjectURL,nativeRevokeObjectURL=NativeURL.revokeObjectURL;nativeCreateObjectURL&&redefine(URLConstructor,"createObjectURL",function(e){return nativeCreateObjectURL.apply(NativeURL,arguments)}),nativeRevokeObjectURL&&redefine(URLConstructor,"revokeObjectURL",function(e){return nativeRevokeObjectURL.apply(NativeURL,arguments)})}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ownKeys$1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _objectSpread2(e){for(var t=arguments,n=1;n<arguments.length;n++){var r=null!=t[n]?t[n]:{};n%2?ownKeys$1(Object(r),!0).forEach(function(t){_defineProperty(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$1(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}function _objectWithoutProperties(e,t){if(null==e)return{};var n,r,i=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}setToStringTag(URLConstructor,"URL"),_export({global:!0,forced:!nativeUrl,sham:!descriptors},{URL:URLConstructor}),function(e){var t=function(){try{return!!Symbol.iterator}catch(e){return!1}}(),n=function(e){var n={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t&&(n[Symbol.iterator]=function(){return n}),n},r=function(e){return encodeURIComponent(e).replace(/%20/g,"+")},i=function(e){return decodeURIComponent(String(e).replace(/\+/g," "))};(function(){try{var t=e.URLSearchParams;return"a=1"===new t("?a=1").toString()&&"function"==typeof t.prototype.set}catch(e){return!1}})()||function(){var i=function e(t){Object.defineProperty(this,"_entries",{writable:!0,value:{}});var n=_typeof(t);if("undefined"===n);else if("string"===n)""!==t&&this._fromString(t);else if(t instanceof e){var r=this;t.forEach(function(e,t){r.append(t,e)})}else{if(null===t||"object"!==n)throw new TypeError("Unsupported input's type for URLSearchParams");if("[object Array]"===Object.prototype.toString.call(t))for(var i=0;i<t.length;i++){var a=t[i];if("[object Array]"!==Object.prototype.toString.call(a)&&2===a.length)throw new TypeError("Expected [string, any] as entry at index "+i+" of URLSearchParams's input");this.append(a[0],a[1])}else for(var o in t)t.hasOwnProperty(o)&&this.append(o,t[o])}},a=i.prototype;a.append=function(e,t){e in this._entries?this._entries[e].push(String(t)):this._entries[e]=[String(t)]},a.delete=function(e){delete this._entries[e]},a.get=function(e){return e in this._entries?this._entries[e][0]:null},a.getAll=function(e){return e in this._entries?this._entries[e].slice(0):[]},a.has=function(e){return e in this._entries},a.set=function(e,t){this._entries[e]=[String(t)]},a.forEach=function(e,t){var n;for(var r in this._entries)if(this._entries.hasOwnProperty(r)){n=this._entries[r];for(var i=0;i<n.length;i++)e.call(t,n[i],r,this)}},a.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),n(e)},a.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),n(e)},a.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),n(e)},t&&(a[Symbol.iterator]=a.entries),a.toString=function(){var e=[];return this.forEach(function(t,n){e.push(r(n)+"="+r(t))}),e.join("&")},e.URLSearchParams=i}();var a=e.URLSearchParams.prototype;"function"!=typeof a.sort&&(a.sort=function(){var e=this,t=[];this.forEach(function(n,r){t.push([r,n]),e._entries||e.delete(r)}),t.sort(function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0}),e._entries&&(e._entries={});for(var n=0;n<t.length;n++)this.append(t[n][0],t[n][1])}),"function"!=typeof a._fromString&&Object.defineProperty(a,"_fromString",{enumerable:!1,configurable:!1,writable:!1,value:function(e){if(this._entries)this._entries={};else{var t=[];this.forEach(function(e,n){t.push(n)});for(var n=0;n<t.length;n++)this.delete(t[n])}var r,a=(e=e.replace(/^\?/,"")).split("&");for(n=0;n<a.length;n++)r=a[n].split("="),this.append(i(r[0]),r.length>1?i(r[1]):"")}})}(void 0!==commonjsGlobal$1?commonjsGlobal$1:"undefined"!=typeof window?window:"undefined"!=typeof self?self:commonjsGlobal$1),function(e){var t,n,r;if(function(){try{var t=new e.URL("b","http://a");return t.pathname="c d","http://a/c%20d"===t.href&&t.searchParams}catch(e){return!1}}()||(t=e.URL,r=(n=function(t,n){"string"!=typeof t&&(t=String(t));var r,i=document;if(n&&(void 0===e.location||n!==e.location.href)){(r=(i=document.implementation.createHTMLDocument("")).createElement("base")).href=n,i.head.appendChild(r);try{if(0!==r.href.indexOf(n))throw new Error(r.href)}catch(e){throw new Error("URL unable to set base "+n+" due to "+e)}}var a=i.createElement("a");if(a.href=t,r&&(i.body.appendChild(a),a.href=a.href),":"===a.protocol||!/:/.test(a.href))throw new TypeError("Invalid URL");Object.defineProperty(this,"_anchorElement",{value:a});var o=new e.URLSearchParams(this.search),s=!0,l=!0,c=this;["append","delete","set"].forEach(function(e){var t=o[e];o[e]=function(){t.apply(o,arguments),s&&(l=!1,c.search=o.toString(),l=!0)}}),Object.defineProperty(this,"searchParams",{value:o,enumerable:!0});var d=void 0;Object.defineProperty(this,"_updateSearchParams",{enumerable:!1,configurable:!1,writable:!1,value:function(){this.search!==d&&(d=this.search,l&&(s=!1,this.searchParams._fromString(this.search),s=!0))}})}).prototype,["hash","host","hostname","port","protocol"].forEach(function(e){!function(e){Object.defineProperty(r,e,{get:function(){return this._anchorElement[e]},set:function(t){this._anchorElement[e]=t},enumerable:!0})}(e)}),Object.defineProperty(r,"search",{get:function(){return this._anchorElement.search},set:function(e){this._anchorElement.search=e,this._updateSearchParams()},enumerable:!0}),Object.defineProperties(r,{toString:{get:function(){var e=this;return function(){return e.href}}},href:{get:function(){return this._anchorElement.href.replace(/\?$/,"")},set:function(e){this._anchorElement.href=e,this._updateSearchParams()},enumerable:!0},pathname:{get:function(){return this._anchorElement.pathname.replace(/(^\/?)/,"/")},set:function(e){this._anchorElement.pathname=e},enumerable:!0},origin:{get:function(){var e={"http:":80,"https:":443,"ftp:":21}[this._anchorElement.protocol],t=this._anchorElement.port!=e&&""!==this._anchorElement.port;return this._anchorElement.protocol+"//"+this._anchorElement.hostname+(t?":"+this._anchorElement.port:"")},enumerable:!0},password:{get:function(){return""},set:function(e){},enumerable:!0},username:{get:function(){return""},set:function(e){},enumerable:!0}}),n.createObjectURL=function(e){return t.createObjectURL.apply(t,arguments)},n.revokeObjectURL=function(e){return t.revokeObjectURL.apply(t,arguments)},e.URL=n),void 0!==e.location&&!("origin"in e.location)){var i=function(){return e.location.protocol+"//"+e.location.hostname+(e.location.port?":"+e.location.port:"")};try{Object.defineProperty(e.location,"origin",{get:i,enumerable:!0})}catch(t){setInterval(function(){e.location.origin=i()},100)}}}(void 0!==commonjsGlobal$1?commonjsGlobal$1:"undefined"!=typeof window?window:"undefined"!=typeof self?self:commonjsGlobal$1);var IS_CONCAT_SPREADABLE=wellKnownSymbol("isConcatSpreadable"),MAX_SAFE_INTEGER=9007199254740991,MAXIMUM_ALLOWED_INDEX_EXCEEDED="Maximum allowed index exceeded",IS_CONCAT_SPREADABLE_SUPPORT=engineV8Version>=51||!fails(function(){var e=[];return e[IS_CONCAT_SPREADABLE]=!1,e.concat()[0]!==e}),SPECIES_SUPPORT=arrayMethodHasSpeciesSupport("concat"),isConcatSpreadable=function(e){if(!isObject(e))return!1;var t=e[IS_CONCAT_SPREADABLE];return void 0!==t?!!t:isArray$1(e)},FORCED=!IS_CONCAT_SPREADABLE_SUPPORT||!SPECIES_SUPPORT;_export({target:"Array",proto:!0,forced:FORCED},{concat:function(e){var t,n,r,i,a,o=arguments,s=toObject(this),l=arraySpeciesCreate(s,0),c=0;for(t=-1,r=arguments.length;t<r;t++)if(a=-1===t?s:o[t],isConcatSpreadable(a)){if(c+(i=toLength(a.length))>MAX_SAFE_INTEGER)throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);for(n=0;n<i;n++,c++)n in a&&createProperty(l,c,a[n])}else{if(c>=MAX_SAFE_INTEGER)throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);createProperty(l,c++,a)}return l.length=c,l}});var $filter=arrayIteration.filter,HAS_SPECIES_SUPPORT$1=arrayMethodHasSpeciesSupport("filter"),USES_TO_LENGTH$3=arrayMethodUsesToLength("filter");_export({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT$1||!USES_TO_LENGTH$3},{filter:function(e){return $filter(this,e,arguments.length>1?arguments[1]:void 0)}});var $find=arrayIteration.find,FIND="find",SKIPS_HOLES=!0,USES_TO_LENGTH$4=arrayMethodUsesToLength(FIND);FIND in[]&&Array(1)[FIND](function(){SKIPS_HOLES=!1}),_export({target:"Array",proto:!0,forced:SKIPS_HOLES||!USES_TO_LENGTH$4},{find:function(e){return $find(this,e,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables(FIND);var ITERATOR$7=wellKnownSymbol("iterator"),SAFE_CLOSING=!1;try{var called=0,iteratorWithReturn={next:function(){return{done:!!called++}},return:function(){SAFE_CLOSING=!0}};iteratorWithReturn[ITERATOR$7]=function(){return this}}catch(e){}var checkCorrectnessOfIteration=function(e,t){if(!t&&!SAFE_CLOSING)return!1;var n=!1;try{var r={};r[ITERATOR$7]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n},INCORRECT_ITERATION=!checkCorrectnessOfIteration(function(e){});_export({target:"Array",stat:!0,forced:INCORRECT_ITERATION},{from:arrayFrom});var $includes=arrayIncludes.includes,USES_TO_LENGTH$5=arrayMethodUsesToLength("indexOf",{ACCESSORS:!0,1:0});_export({target:"Array",proto:!0,forced:!USES_TO_LENGTH$5},{includes:function(e){return $includes(this,e,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables("includes");var $map=arrayIteration.map,HAS_SPECIES_SUPPORT$2=arrayMethodHasSpeciesSupport("map"),USES_TO_LENGTH$6=arrayMethodUsesToLength("map");_export({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT$2||!USES_TO_LENGTH$6},{map:function(e){return $map(this,e,arguments.length>1?arguments[1]:void 0)}});var inheritIfRequired=function(e,t,n){var r,i;return objectSetPrototypeOf&&"function"==typeof(r=t.constructor)&&r!==n&&isObject(i=r.prototype)&&i!==n.prototype&&objectSetPrototypeOf(e,i),e},whitespaces="\t\n\v\f\r                　\u2028\u2029\ufeff",whitespace="["+whitespaces+"]",ltrim=RegExp("^"+whitespace+whitespace+"*"),rtrim=RegExp(whitespace+whitespace+"*$"),createMethod$3=function(e){return function(t){var n=String(requireObjectCoercible(t));return 1&e&&(n=n.replace(ltrim,"")),2&e&&(n=n.replace(rtrim,"")),n}},stringTrim={start:createMethod$3(1),end:createMethod$3(2),trim:createMethod$3(3)},getOwnPropertyNames=objectGetOwnPropertyNames.f,getOwnPropertyDescriptor$2=objectGetOwnPropertyDescriptor.f,defineProperty$5=objectDefineProperty.f,trim=stringTrim.trim,NUMBER="Number",NativeNumber=global_1[NUMBER],NumberPrototype=NativeNumber.prototype,BROKEN_CLASSOF=classofRaw(objectCreate(NumberPrototype))==NUMBER,toNumber=function(e){var t,n,r,i,a,o,s,l,c=toPrimitive(e,!1);if("string"==typeof c&&c.length>2)if(43===(t=(c=trim(c)).charCodeAt(0))||45===t){if(88===(n=c.charCodeAt(2))||120===n)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+c}for(o=(a=c.slice(2)).length,s=0;s<o;s++)if((l=a.charCodeAt(s))<48||l>i)return NaN;return parseInt(a,r)}return+c};if(isForced_1(NUMBER,!NativeNumber(" 0o1")||!NativeNumber("0b1")||NativeNumber("+0x1"))){for(var NumberWrapper=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof NumberWrapper&&(BROKEN_CLASSOF?fails(function(){NumberPrototype.valueOf.call(n)}):classofRaw(n)!=NUMBER)?inheritIfRequired(new NativeNumber(toNumber(t)),n,NumberWrapper):toNumber(t)},keys$1=descriptors?getOwnPropertyNames(NativeNumber):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),j$1=0,key;keys$1.length>j$1;j$1++)has(NativeNumber,key=keys$1[j$1])&&!has(NumberWrapper,key)&&defineProperty$5(NumberWrapper,key,getOwnPropertyDescriptor$2(NativeNumber,key));NumberWrapper.prototype=NumberPrototype,NumberPrototype.constructor=NumberWrapper,redefine(global_1,NUMBER,NumberWrapper)}var FAILS_ON_PRIMITIVES=fails(function(){objectKeys(1)});_export({target:"Object",stat:!0,forced:FAILS_ON_PRIMITIVES},{keys:function(e){return objectKeys(toObject(e))}});var notARegexp=function(e){if(isRegexp(e))throw TypeError("The method doesn't accept regular expressions");return e},MATCH$1=wellKnownSymbol("match"),correctIsRegexpLogic=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[MATCH$1]=!1,"/./"[e](t)}catch(e){}}return!1};_export({target:"String",proto:!0,forced:!correctIsRegexpLogic("includes")},{includes:function(e){return!!~String(requireObjectCoercible(this)).indexOf(notARegexp(e),arguments.length>1?arguments[1]:void 0)}});var freezing=!fails(function(){return Object.isExtensible(Object.preventExtensions({}))}),internalMetadata=createCommonjsModule$1(function(e){var t=objectDefineProperty.f,n=uid("meta"),r=0,i=Object.isExtensible||function(){return!0},a=function(e){t(e,n,{value:{objectID:"O"+ ++r,weakData:{}}})},o=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!isObject(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!has(e,n)){if(!i(e))return"F";if(!t)return"E";a(e)}return e[n].objectID},getWeakData:function(e,t){if(!has(e,n)){if(!i(e))return!0;if(!t)return!1;a(e)}return e[n].weakData},onFreeze:function(e){return freezing&&o.REQUIRED&&i(e)&&!has(e,n)&&a(e),e}};hiddenKeys[n]=!0}),internalMetadata_1=internalMetadata.REQUIRED,internalMetadata_2=internalMetadata.fastKey,internalMetadata_3=internalMetadata.getWeakData,internalMetadata_4=internalMetadata.onFreeze,iterate_1=createCommonjsModule$1(function(e){var t=function(e,t){this.stopped=e,this.result=t};(e.exports=function(e,n,r,i,a){var o,s,l,c,d,u,p,f=functionBindContext(n,r,i?2:1);if(a)o=e;else{if("function"!=typeof(s=getIteratorMethod(e)))throw TypeError("Target is not iterable");if(isArrayIteratorMethod(s)){for(l=0,c=toLength(e.length);c>l;l++)if((d=i?f(anObject(p=e[l])[0],p[1]):f(e[l]))&&d instanceof t)return d;return new t(!1)}o=s.call(e)}for(u=o.next;!(p=u.call(o)).done;)if("object"==typeof(d=callWithSafeIterationClosing(o,f,p.value,i))&&d&&d instanceof t)return d;return new t(!1)}).stop=function(e){return new t(!0,e)}}),collection=function(e,t,n){var r=-1!==e.indexOf("Map"),i=-1!==e.indexOf("Weak"),a=r?"set":"add",o=global_1[e],s=o&&o.prototype,l=o,c={},d=function(e){var t=s[e];redefine(s,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(i&&!isObject(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return i&&!isObject(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(i&&!isObject(e))&&t.call(this,0===e?0:e)}:function(e,n){return t.call(this,0===e?0:e,n),this})};if(isForced_1(e,"function"!=typeof o||!(i||s.forEach&&!fails(function(){(new o).entries().next()}))))l=n.getConstructor(t,e,r,a),internalMetadata.REQUIRED=!0;else if(isForced_1(e,!0)){var u=new l,p=u[a](i?{}:-0,1)!=u,f=fails(function(){u.has(1)}),h=checkCorrectnessOfIteration(function(e){new o(e)}),_=!i&&fails(function(){for(var e=new o,t=5;t--;)e[a](t,t);return!e.has(-0)});h||((l=t(function(t,n){anInstance(t,l,e);var i=inheritIfRequired(new o,t,l);return null!=n&&iterate_1(n,i[a],i,r),i})).prototype=s,s.constructor=l),(f||_)&&(d("delete"),d("has"),r&&d("get")),(_||p)&&d(a),i&&s.clear&&delete s.clear}return c[e]=l,_export({global:!0,forced:l!=o},c),setToStringTag(l,e),i||n.setStrong(l,e,r),l},getWeakData=internalMetadata.getWeakData,setInternalState$5=internalState.set,internalStateGetterFor=internalState.getterFor,find$1=arrayIteration.find,findIndex=arrayIteration.findIndex,id$1=0,uncaughtFrozenStore=function(e){return e.frozen||(e.frozen=new UncaughtFrozenStore)},UncaughtFrozenStore=function(){this.entries=[]},findUncaughtFrozen=function(e,t){return find$1(e.entries,function(e){return e[0]===t})};UncaughtFrozenStore.prototype={get:function(e){var t=findUncaughtFrozen(this,e);if(t)return t[1]},has:function(e){return!!findUncaughtFrozen(this,e)},set:function(e,t){var n=findUncaughtFrozen(this,e);n?n[1]=t:this.entries.push([e,t])},delete:function(e){var t=findIndex(this.entries,function(t){return t[0]===e});return~t&&this.entries.splice(t,1),!!~t}};var collectionWeak={getConstructor:function(e,t,n,r){var i=e(function(e,a){anInstance(e,i,t),setInternalState$5(e,{type:t,id:id$1++,frozen:void 0}),null!=a&&iterate_1(a,e[r],e,n)}),a=internalStateGetterFor(t),o=function(e,t,n){var r=a(e),i=getWeakData(anObject(t),!0);return!0===i?uncaughtFrozenStore(r).set(t,n):i[r.id]=n,e};return redefineAll(i.prototype,{delete:function(e){var t=a(this);if(!isObject(e))return!1;var n=getWeakData(e);return!0===n?uncaughtFrozenStore(t).delete(e):n&&has(n,t.id)&&delete n[t.id]},has:function(e){var t=a(this);if(!isObject(e))return!1;var n=getWeakData(e);return!0===n?uncaughtFrozenStore(t).has(e):n&&has(n,t.id)}}),redefineAll(i.prototype,n?{get:function(e){var t=a(this);if(isObject(e)){var n=getWeakData(e);return!0===n?uncaughtFrozenStore(t).get(e):n?n[t.id]:void 0}},set:function(e,t){return o(this,e,t)}}:{add:function(e){return o(this,e,!0)}}),i}},es_weakMap=createCommonjsModule$1(function(e){var t,n=internalState.enforce,r=!global_1.ActiveXObject&&"ActiveXObject"in global_1,i=Object.isExtensible,a=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},o=e.exports=collection("WeakMap",a,collectionWeak);if(nativeWeakMap&&r){t=collectionWeak.getConstructor(a,"WeakMap",!0),internalMetadata.REQUIRED=!0;var s=o.prototype,l=s.delete,c=s.has,d=s.get,u=s.set;redefineAll(s,{delete:function(e){if(isObject(e)&&!i(e)){var r=n(this);return r.frozen||(r.frozen=new t),l.call(this,e)||r.frozen.delete(e)}return l.call(this,e)},has:function(e){if(isObject(e)&&!i(e)){var r=n(this);return r.frozen||(r.frozen=new t),c.call(this,e)||r.frozen.has(e)}return c.call(this,e)},get:function(e){if(isObject(e)&&!i(e)){var r=n(this);return r.frozen||(r.frozen=new t),c.call(this,e)?d.call(this,e):r.frozen.get(e)}return d.call(this,e)},set:function(e,r){if(isObject(e)&&!i(e)){var a=n(this);a.frozen||(a.frozen=new t),c.call(this,e)?u.call(this,e,r):a.frozen.set(e,r)}else u.call(this,e,r);return this}})}}),$every=arrayIteration.every,STRICT_METHOD$3=arrayMethodIsStrict("every"),USES_TO_LENGTH$7=arrayMethodUsesToLength("every");_export({target:"Array",proto:!0,forced:!STRICT_METHOD$3||!USES_TO_LENGTH$7},{every:function(e){return $every(this,e,arguments.length>1?arguments[1]:void 0)}}),_export({target:"Object",stat:!0,forced:Object.assign!==objectAssign},{assign:objectAssign});var non="​᠎",stringTrimForced=function(e){return fails(function(){return!!whitespaces[e]()||non[e]()!=non||whitespaces[e].name!==e})},$trim=stringTrim.trim;_export({target:"String",proto:!0,forced:stringTrimForced("trim")},{trim:function(){return $trim(this)}});var $some=arrayIteration.some,STRICT_METHOD$4=arrayMethodIsStrict("some"),USES_TO_LENGTH$8=arrayMethodUsesToLength("some");_export({target:"Array",proto:!0,forced:!STRICT_METHOD$4||!USES_TO_LENGTH$8},{some:function(e){return $some(this,e,arguments.length>1?arguments[1]:void 0)}});var thisNumberValue=function(e){if("number"!=typeof e&&"Number"!=classofRaw(e))throw TypeError("Incorrect invocation");return+e},stringRepeat="".repeat||function(e){var t=String(requireObjectCoercible(this)),n="",r=toInteger(e);if(r<0||r==1/0)throw RangeError("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n},nativeToFixed=1..toFixed,floor$4=Math.floor,pow$1=function(e,t,n){return 0===t?n:t%2==1?pow$1(e,t-1,n*e):pow$1(e*e,t/2,n)},log=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t},FORCED$1=nativeToFixed&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!fails(function(){nativeToFixed.call({})});_export({target:"Number",proto:!0,forced:FORCED$1},{toFixed:function(e){var t,n,r,i,a=thisNumberValue(this),o=toInteger(e),s=[0,0,0,0,0,0],l="",c="0",d=function(e,t){for(var n=-1,r=t;++n<6;)r+=e*s[n],s[n]=r%1e7,r=floor$4(r/1e7)},u=function(e){for(var t=6,n=0;--t>=0;)n+=s[t],s[t]=floor$4(n/e),n=n%e*1e7},p=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==s[e]){var n=String(s[e]);t=""===t?n:t+stringRepeat.call("0",7-n.length)+n}return t};if(o<0||o>20)throw RangeError("Incorrect fraction digits");if(a!=a)return"NaN";if(a<=-1e21||a>=1e21)return String(a);if(a<0&&(l="-",a=-a),a>1e-21)if(n=(t=log(a*pow$1(2,69,1))-69)<0?a*pow$1(2,-t,1):a/pow$1(2,t,1),n*=4503599627370496,(t=52-t)>0){for(d(0,n),r=o;r>=7;)d(1e7,0),r-=7;for(d(pow$1(10,r,1),0),r=t-1;r>=23;)u(1<<23),r-=23;u(1<<r),d(1,1),u(2),c=p()}else d(0,n),d(1<<-t,0),c=p()+stringRepeat.call("0",o);return c=o>0?l+((i=c.length)<=o?"0."+stringRepeat.call("0",o-i)+c:c.slice(0,i-o)+"."+c.slice(i-o)):l+c}});var propertyIsEnumerable=objectPropertyIsEnumerable.f,createMethod$4=function(e){return function(t){for(var n,r=toIndexedObject(t),i=objectKeys(r),a=i.length,o=0,s=[];a>o;)n=i[o++],descriptors&&!propertyIsEnumerable.call(r,n)||s.push(e?[n,r[n]]:r[n]);return s}},objectToArray={entries:createMethod$4(!0),values:createMethod$4(!1)},$entries=objectToArray.entries;_export({target:"Object",stat:!0},{entries:function(e){return $entries(e)}});var $values=objectToArray.values;_export({target:"Object",stat:!0},{values:function(e){return $values(e)}}),_export({target:"Number",stat:!0},{isNaN:function(e){return e!=e}});var nativeGetOwnPropertyDescriptor$2=objectGetOwnPropertyDescriptor.f,FAILS_ON_PRIMITIVES$1=fails(function(){nativeGetOwnPropertyDescriptor$2(1)}),FORCED$2=!descriptors||FAILS_ON_PRIMITIVES$1;function _classCallCheck$1(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$1(e,t,n){return t&&_defineProperties$1(e.prototype,t),n&&_defineProperties$1(e,n),e}function _defineProperty$1(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ownKeys$2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _objectSpread2$1(e){for(var t=arguments,n=1;n<arguments.length;n++){var r=null!=t[n]?t[n]:{};n%2?ownKeys$2(Object(r),!0).forEach(function(t){_defineProperty$1(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$2(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}_export({target:"Object",stat:!0,forced:FORCED$2,sham:!descriptors},{getOwnPropertyDescriptor:function(e,t){return nativeGetOwnPropertyDescriptor$2(toIndexedObject(e),t)}}),_export({target:"Object",stat:!0,sham:!descriptors},{getOwnPropertyDescriptors:function(e){for(var t,n,r=toIndexedObject(e),i=objectGetOwnPropertyDescriptor.f,a=ownKeys(r),o={},s=0;a.length>s;)void 0!==(n=i(r,t=a[s++]))&&createProperty(o,t,n);return o}}),fixRegexpWellKnownSymbolLogic("match",1,function(e,t,n){return[function(t){var n=requireObjectCoercible(this),r=null==t?void 0:t[e];return void 0!==r?r.call(t,n):new RegExp(t)[e](String(n))},function(e){var r=n(t,e,this);if(r.done)return r.value;var i=anObject(e),a=String(this);if(!i.global)return regexpExecAbstract(i,a);var o=i.unicode;i.lastIndex=0;for(var s,l=[],c=0;null!==(s=regexpExecAbstract(i,a));){var d=String(s[0]);l[c]=d,""===d&&(i.lastIndex=advanceStringIndex(a,toLength(i.lastIndex),o)),c++}return 0===c?null:l}]});var defaults={addCSS:!0,thumbWidth:15,watch:!0};function matches(e,t){return function(){return Array.from(document.querySelectorAll(t)).includes(this)}.call(e,t)}function trigger(e,t){if(e&&t){var n=new Event(t,{bubbles:!0});e.dispatchEvent(n)}}var getConstructor=function(e){return null!=e?e.constructor:null},instanceOf=function(e,t){return!!(e&&t&&e instanceof t)},isNullOrUndefined=function(e){return null==e},isObject$1=function(e){return getConstructor(e)===Object},isNumber=function(e){return getConstructor(e)===Number&&!Number.isNaN(e)},isString=function(e){return getConstructor(e)===String},isBoolean=function(e){return getConstructor(e)===Boolean},isFunction=function(e){return getConstructor(e)===Function},isArray$1$1=function(e){return Array.isArray(e)},isNodeList=function(e){return instanceOf(e,NodeList)},isElement=function(e){return instanceOf(e,Element)},isEvent=function(e){return instanceOf(e,Event)},isEmpty=function(e){return isNullOrUndefined(e)||(isString(e)||isArray$1$1(e)||isNodeList(e))&&!e.length||isObject$1(e)&&!Object.keys(e).length},is={nullOrUndefined:isNullOrUndefined,object:isObject$1,number:isNumber,string:isString,boolean:isBoolean,function:isFunction,array:isArray$1$1,nodeList:isNodeList,element:isElement,event:isEvent,empty:isEmpty};function getDecimalPlaces(e){var t="".concat(e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0}function round(e,t){if(1>t){var n=getDecimalPlaces(t);return parseFloat(e.toFixed(n))}return Math.round(e/t)*t}var RangeTouch=function(){function e(t,n){_classCallCheck$1(this,e),is.element(t)?this.element=t:is.string(t)&&(this.element=document.querySelector(t)),is.element(this.element)&&is.empty(this.element.rangeTouch)&&(this.config=_objectSpread2$1({},defaults,{},n),this.init())}return _createClass$1(e,[{key:"init",value:function(){e.enabled&&(this.config.addCSS&&(this.element.style.userSelect="none",this.element.style.webKitUserSelect="none",this.element.style.touchAction="manipulation"),this.listeners(!0),this.element.rangeTouch=this)}},{key:"destroy",value:function(){e.enabled&&(this.config.addCSS&&(this.element.style.userSelect="",this.element.style.webKitUserSelect="",this.element.style.touchAction=""),this.listeners(!1),this.element.rangeTouch=null)}},{key:"listeners",value:function(e){var t=this,n=e?"addEventListener":"removeEventListener";["touchstart","touchmove","touchend"].forEach(function(e){t.element[n](e,function(e){return t.set(e)},!1)})}},{key:"get",value:function(t){if(!e.enabled||!is.event(t))return null;var n,r=t.target,i=t.changedTouches[0],a=parseFloat(r.getAttribute("min"))||0,o=parseFloat(r.getAttribute("max"))||100,s=parseFloat(r.getAttribute("step"))||1,l=r.getBoundingClientRect(),c=100/l.width*(this.config.thumbWidth/2)/100;return 0>(n=100/l.width*(i.clientX-l.left))?n=0:100<n&&(n=100),50>n?n-=(100-2*n)*c:50<n&&(n+=2*(n-50)*c),a+round(n/100*(o-a),s)}},{key:"set",value:function(t){e.enabled&&is.event(t)&&!t.target.disabled&&(t.preventDefault(),t.target.value=this.get(t),trigger(t.target,"touchend"===t.type?"change":"input"))}}],[{key:"setup",value:function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=null;if(is.empty(t)||is.string(t)?r=Array.from(document.querySelectorAll(is.string(t)?t:'input[type="range"]')):is.element(t)?r=[t]:is.nodeList(t)?r=Array.from(t):is.array(t)&&(r=t.filter(is.element)),is.empty(r))return null;var i=_objectSpread2$1({},defaults,{},n);is.string(t)&&i.watch&&new MutationObserver(function(n){Array.from(n).forEach(function(n){Array.from(n.addedNodes).forEach(function(n){is.element(n)&&matches(n,t)&&new e(n,i)})})}).observe(document.body,{childList:!0,subtree:!0});return r.map(function(t){return new e(t,n)})}},{key:"enabled",get:function(){return"ontouchstart"in document.documentElement}}]),e}(),nativePromiseConstructor=global_1.Promise,SPECIES$5=wellKnownSymbol("species"),setSpecies=function(e){var t=getBuiltIn(e),n=objectDefineProperty.f;descriptors&&t&&!t[SPECIES$5]&&n(t,SPECIES$5,{configurable:!0,get:function(){return this}})},engineIsIos=/(iphone|ipod|ipad).*applewebkit/i.test(engineUserAgent),location$1=global_1.location,set$1=global_1.setImmediate,clear=global_1.clearImmediate,process$1=global_1.process,MessageChannel=global_1.MessageChannel,Dispatch=global_1.Dispatch,counter=0,queue={},ONREADYSTATECHANGE="onreadystatechange",defer,channel,port,run=function(e){if(queue.hasOwnProperty(e)){var t=queue[e];delete queue[e],t()}},runner=function(e){return function(){run(e)}},listener=function(e){run(e.data)},post=function(e){global_1.postMessage(e+"",location$1.protocol+"//"+location$1.host)};set$1&&clear||(set$1=function(e){for(var t=arguments,n=[],r=1;arguments.length>r;)n.push(t[r++]);return queue[++counter]=function(){("function"==typeof e?e:Function(e)).apply(void 0,n)},defer(counter),counter},clear=function(e){delete queue[e]},"process"==classofRaw(process$1)?defer=function(e){process$1.nextTick(runner(e))}:Dispatch&&Dispatch.now?defer=function(e){Dispatch.now(runner(e))}:MessageChannel&&!engineIsIos?(channel=new MessageChannel,port=channel.port2,channel.port1.onmessage=listener,defer=functionBindContext(port.postMessage,port,1)):!global_1.addEventListener||"function"!=typeof postMessage||global_1.importScripts||fails(post)||"file:"===location$1.protocol?defer=ONREADYSTATECHANGE in documentCreateElement("script")?function(e){html.appendChild(documentCreateElement("script"))[ONREADYSTATECHANGE]=function(){html.removeChild(this),run(e)}}:function(e){setTimeout(runner(e),0)}:(defer=post,global_1.addEventListener("message",listener,!1)));var task={set:set$1,clear:clear},getOwnPropertyDescriptor$3=objectGetOwnPropertyDescriptor.f,macrotask=task.set,MutationObserver$1=global_1.MutationObserver||global_1.WebKitMutationObserver,process$2=global_1.process,Promise$1=global_1.Promise,IS_NODE="process"==classofRaw(process$2),queueMicrotaskDescriptor=getOwnPropertyDescriptor$3(global_1,"queueMicrotask"),queueMicrotask=queueMicrotaskDescriptor&&queueMicrotaskDescriptor.value,flush,head,last,notify,toggle,node,promise,then;queueMicrotask||(flush=function(){var e,t;for(IS_NODE&&(e=process$2.domain)&&e.exit();head;){t=head.fn,head=head.next;try{t()}catch(e){throw head?notify():last=void 0,e}}last=void 0,e&&e.enter()},IS_NODE?notify=function(){process$2.nextTick(flush)}:MutationObserver$1&&!engineIsIos?(toggle=!0,node=document.createTextNode(""),new MutationObserver$1(flush).observe(node,{characterData:!0}),notify=function(){node.data=toggle=!toggle}):Promise$1&&Promise$1.resolve?(promise=Promise$1.resolve(void 0),then=promise.then,notify=function(){then.call(promise,flush)}):notify=function(){macrotask.call(global_1,flush)});var microtask=queueMicrotask||function(e){var t={fn:e,next:void 0};last&&(last.next=t),head||(head=t,notify()),last=t},PromiseCapability=function(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r}),this.resolve=aFunction$1(t),this.reject=aFunction$1(n)},f$7=function(e){return new PromiseCapability(e)},newPromiseCapability={f:f$7},promiseResolve=function(e,t){if(anObject(e),isObject(t)&&t.constructor===e)return t;var n=newPromiseCapability.f(e);return(0,n.resolve)(t),n.promise},hostReportErrors=function(e,t){var n=global_1.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))},perform=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},task$1=task.set,SPECIES$6=wellKnownSymbol("species"),PROMISE="Promise",getInternalState$3=internalState.get,setInternalState$6=internalState.set,getInternalPromiseState=internalState.getterFor(PROMISE),PromiseConstructor=nativePromiseConstructor,TypeError$1=global_1.TypeError,document$2=global_1.document,process$3=global_1.process,$fetch$1=getBuiltIn("fetch"),newPromiseCapability$1=newPromiseCapability.f,newGenericPromiseCapability=newPromiseCapability$1,IS_NODE$1="process"==classofRaw(process$3),DISPATCH_EVENT=!!(document$2&&document$2.createEvent&&global_1.dispatchEvent),UNHANDLED_REJECTION="unhandledrejection",REJECTION_HANDLED="rejectionhandled",PENDING=0,FULFILLED=1,REJECTED=2,HANDLED=1,UNHANDLED=2,Internal,OwnPromiseCapability,PromiseWrapper,nativeThen,FORCED$3=isForced_1(PROMISE,function(){if(!(inspectSource(PromiseConstructor)!==String(PromiseConstructor))){if(66===engineV8Version)return!0;if(!IS_NODE$1&&"function"!=typeof PromiseRejectionEvent)return!0}if(engineV8Version>=51&&/native code/.test(PromiseConstructor))return!1;var e=PromiseConstructor.resolve(1),t=function(e){e(function(){},function(){})};return(e.constructor={})[SPECIES$6]=t,!(e.then(function(){})instanceof t)}),INCORRECT_ITERATION$1=FORCED$3||!checkCorrectnessOfIteration(function(e){PromiseConstructor.all(e).catch(function(){})}),isThenable=function(e){var t;return!(!isObject(e)||"function"!=typeof(t=e.then))&&t},notify$1=function(e,t,n){if(!t.notified){t.notified=!0;var r=t.reactions;microtask(function(){for(var i=t.value,a=t.state==FULFILLED,o=0;r.length>o;){var s,l,c,d=r[o++],u=a?d.ok:d.fail,p=d.resolve,f=d.reject,h=d.domain;try{u?(a||(t.rejection===UNHANDLED&&onHandleUnhandled(e,t),t.rejection=HANDLED),!0===u?s=i:(h&&h.enter(),s=u(i),h&&(h.exit(),c=!0)),s===d.promise?f(TypeError$1("Promise-chain cycle")):(l=isThenable(s))?l.call(s,p,f):p(s)):f(i)}catch(e){h&&!c&&h.exit(),f(e)}}t.reactions=[],t.notified=!1,n&&!t.rejection&&onUnhandled(e,t)})}},dispatchEvent=function(e,t,n){var r,i;DISPATCH_EVENT?((r=document$2.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),global_1.dispatchEvent(r)):r={promise:t,reason:n},(i=global_1["on"+e])?i(r):e===UNHANDLED_REJECTION&&hostReportErrors("Unhandled promise rejection",n)},onUnhandled=function(e,t){task$1.call(global_1,function(){var n,r=t.value;if(isUnhandled(t)&&(n=perform(function(){IS_NODE$1?process$3.emit("unhandledRejection",r,e):dispatchEvent(UNHANDLED_REJECTION,e,r)}),t.rejection=IS_NODE$1||isUnhandled(t)?UNHANDLED:HANDLED,n.error))throw n.value})},isUnhandled=function(e){return e.rejection!==HANDLED&&!e.parent},onHandleUnhandled=function(e,t){task$1.call(global_1,function(){IS_NODE$1?process$3.emit("rejectionHandled",e):dispatchEvent(REJECTION_HANDLED,e,t.value)})},bind=function(e,t,n,r){return function(i){e(t,n,i,r)}},internalReject=function(e,t,n,r){t.done||(t.done=!0,r&&(t=r),t.value=n,t.state=REJECTED,notify$1(e,t,!0))},internalResolve=function(e,t,n,r){if(!t.done){t.done=!0,r&&(t=r);try{if(e===n)throw TypeError$1("Promise can't be resolved itself");var i=isThenable(n);i?microtask(function(){var r={done:!1};try{i.call(n,bind(internalResolve,e,r,t),bind(internalReject,e,r,t))}catch(n){internalReject(e,r,n,t)}}):(t.value=n,t.state=FULFILLED,notify$1(e,t,!1))}catch(n){internalReject(e,{done:!1},n,t)}}};FORCED$3&&(PromiseConstructor=function(e){anInstance(this,PromiseConstructor,PROMISE),aFunction$1(e),Internal.call(this);var t=getInternalState$3(this);try{e(bind(internalResolve,this,t),bind(internalReject,this,t))}catch(e){internalReject(this,t,e)}},Internal=function(e){setInternalState$6(this,{type:PROMISE,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:PENDING,value:void 0})},Internal.prototype=redefineAll(PromiseConstructor.prototype,{then:function(e,t){var n=getInternalPromiseState(this),r=newPromiseCapability$1(speciesConstructor(this,PromiseConstructor));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=IS_NODE$1?process$3.domain:void 0,n.parent=!0,n.reactions.push(r),n.state!=PENDING&&notify$1(this,n,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),OwnPromiseCapability=function(){var e=new Internal,t=getInternalState$3(e);this.promise=e,this.resolve=bind(internalResolve,e,t),this.reject=bind(internalReject,e,t)},newPromiseCapability.f=newPromiseCapability$1=function(e){return e===PromiseConstructor||e===PromiseWrapper?new OwnPromiseCapability(e):newGenericPromiseCapability(e)},"function"==typeof nativePromiseConstructor&&(nativeThen=nativePromiseConstructor.prototype.then,redefine(nativePromiseConstructor.prototype,"then",function(e,t){var n=this;return new PromiseConstructor(function(e,t){nativeThen.call(n,e,t)}).then(e,t)},{unsafe:!0}),"function"==typeof $fetch$1&&_export({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return promiseResolve(PromiseConstructor,$fetch$1.apply(global_1,arguments))}}))),_export({global:!0,wrap:!0,forced:FORCED$3},{Promise:PromiseConstructor}),setToStringTag(PromiseConstructor,PROMISE,!1),setSpecies(PROMISE),PromiseWrapper=getBuiltIn(PROMISE),_export({target:PROMISE,stat:!0,forced:FORCED$3},{reject:function(e){var t=newPromiseCapability$1(this);return t.reject.call(void 0,e),t.promise}}),_export({target:PROMISE,stat:!0,forced:FORCED$3},{resolve:function(e){return promiseResolve(this,e)}}),_export({target:PROMISE,stat:!0,forced:INCORRECT_ITERATION$1},{all:function(e){var t=this,n=newPromiseCapability$1(t),r=n.resolve,i=n.reject,a=perform(function(){var n=aFunction$1(t.resolve),a=[],o=0,s=1;iterate_1(e,function(e){var l=o++,c=!1;a.push(void 0),s++,n.call(t,e).then(function(e){c||(c=!0,a[l]=e,--s||r(a))},i)}),--s||r(a)});return a.error&&i(a.value),n.promise},race:function(e){var t=this,n=newPromiseCapability$1(t),r=n.reject,i=perform(function(){var i=aFunction$1(t.resolve);iterate_1(e,function(e){i.call(t,e).then(n.resolve,r)})});return i.error&&r(i.value),n.promise}});var getOwnPropertyDescriptor$4=objectGetOwnPropertyDescriptor.f,nativeStartsWith="".startsWith,min$4=Math.min,CORRECT_IS_REGEXP_LOGIC=correctIsRegexpLogic("startsWith"),MDN_POLYFILL_BUG=!(CORRECT_IS_REGEXP_LOGIC||(descriptor=getOwnPropertyDescriptor$4(String.prototype,"startsWith"),!descriptor||descriptor.writable)),descriptor;_export({target:"String",proto:!0,forced:!MDN_POLYFILL_BUG&&!CORRECT_IS_REGEXP_LOGIC},{startsWith:function(e){var t=String(requireObjectCoercible(this));notARegexp(e);var n=toLength(min$4(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return nativeStartsWith?nativeStartsWith.call(t,r,n):t.slice(n,n+r.length)===r}});var getConstructor$1=function(e){return null!=e?e.constructor:null},instanceOf$1=function(e,t){return Boolean(e&&t&&e instanceof t)},isNullOrUndefined$1=function(e){return null==e},isObject$2=function(e){return getConstructor$1(e)===Object},isNumber$1=function(e){return getConstructor$1(e)===Number&&!Number.isNaN(e)},isString$1=function(e){return getConstructor$1(e)===String},isBoolean$1=function(e){return getConstructor$1(e)===Boolean},isFunction$1=function(e){return getConstructor$1(e)===Function},isArray$2=function(e){return Array.isArray(e)},isWeakMap=function(e){return instanceOf$1(e,WeakMap)},isNodeList$1=function(e){return instanceOf$1(e,NodeList)},isElement$1=function(e){return instanceOf$1(e,Element)},isTextNode=function(e){return getConstructor$1(e)===Text},isEvent$1=function(e){return instanceOf$1(e,Event)},isKeyboardEvent=function(e){return instanceOf$1(e,KeyboardEvent)},isCue=function(e){return instanceOf$1(e,window.TextTrackCue)||instanceOf$1(e,window.VTTCue)},isTrack=function(e){return instanceOf$1(e,TextTrack)||!isNullOrUndefined$1(e)&&isString$1(e.kind)},isPromise=function(e){return instanceOf$1(e,Promise)&&isFunction$1(e.then)},isEmpty$1=function(e){return isNullOrUndefined$1(e)||(isString$1(e)||isArray$2(e)||isNodeList$1(e))&&!e.length||isObject$2(e)&&!Object.keys(e).length},isUrl=function(e){if(instanceOf$1(e,window.URL))return!0;if(!isString$1(e))return!1;var t=e;e.startsWith("http://")&&e.startsWith("https://")||(t="http://".concat(e));try{return!isEmpty$1(new URL(t).hostname)}catch(e){return!1}},is$1={nullOrUndefined:isNullOrUndefined$1,object:isObject$2,number:isNumber$1,string:isString$1,boolean:isBoolean$1,function:isFunction$1,array:isArray$2,weakMap:isWeakMap,nodeList:isNodeList$1,element:isElement$1,textNode:isTextNode,event:isEvent$1,keyboardEvent:isKeyboardEvent,cue:isCue,track:isTrack,promise:isPromise,url:isUrl,empty:isEmpty$1},transitionEndEvent=(element=document.createElement("span"),events={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},type=Object.keys(events).find(function(e){return void 0!==element.style[e]}),!!is$1.string(type)&&events[type]),element,events,type;function repaint(e,t){setTimeout(function(){try{e.hidden=!0,e.offsetHeight,e.hidden=!1}catch(e){}},t)}var browser={isIE:!!document.documentMode,isEdge:window.navigator.userAgent.includes("Edge"),isWebkit:"WebkitAppearance"in document.documentElement.style&&!/Edge/.test(navigator.userAgent),isIPhone:/(iPhone|iPod)/gi.test(navigator.platform),isIos:/(iPad|iPhone|iPod)/gi.test(navigator.platform)},createMethod$5=function(e){return function(t,n,r,i){aFunction$1(n);var a=toObject(t),o=indexedObject(a),s=toLength(a.length),l=e?s-1:0,c=e?-1:1;if(r<2)for(;;){if(l in o){i=o[l],l+=c;break}if(l+=c,e?l<0:s<=l)throw TypeError("Reduce of empty array with no initial value")}for(;e?l>=0:s>l;l+=c)l in o&&(i=n(i,o[l],l,a));return i}},arrayReduce={left:createMethod$5(!1),right:createMethod$5(!0)},$reduce=arrayReduce.left,STRICT_METHOD$5=arrayMethodIsStrict("reduce"),USES_TO_LENGTH$9=arrayMethodUsesToLength("reduce",{1:0});function cloneDeep(e){return JSON.parse(JSON.stringify(e))}function getDeep(e,t){return t.split(".").reduce(function(e,t){return e&&e[t]},e)}function extend(){for(var e=arguments,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=e[i];if(!r.length)return t;var a=r.shift();return is$1.object(a)?(Object.keys(a).forEach(function(e){is$1.object(a[e])?(Object.keys(t).includes(e)||Object.assign(t,_defineProperty({},e,{})),extend(t[e],a[e])):Object.assign(t,_defineProperty({},e,a[e]))}),extend.apply(void 0,[t].concat(r))):t}function wrap$1(e,t){var n=e.length?e:[e];Array.from(n).reverse().forEach(function(e,n){var r=n>0?t.cloneNode(!0):t,i=e.parentNode,a=e.nextSibling;r.appendChild(e),a?i.insertBefore(r,a):i.appendChild(r)})}function setAttributes(e,t){is$1.element(e)&&!is$1.empty(t)&&Object.entries(t).filter(function(e){var t=_slicedToArray(e,2)[1];return!is$1.nullOrUndefined(t)}).forEach(function(t){var n=_slicedToArray(t,2),r=n[0],i=n[1];return e.setAttribute(r,i)})}function createElement(e,t,n){var r=document.createElement(e);return is$1.object(t)&&setAttributes(r,t),is$1.string(n)&&(r.innerText=n),r}function insertAfter(e,t){is$1.element(e)&&is$1.element(t)&&t.parentNode.insertBefore(e,t.nextSibling)}function insertElement(e,t,n,r){is$1.element(t)&&t.appendChild(createElement(e,n,r))}function removeElement(e){is$1.nodeList(e)||is$1.array(e)?Array.from(e).forEach(removeElement):is$1.element(e)&&is$1.element(e.parentNode)&&e.parentNode.removeChild(e)}function emptyElement(e){if(is$1.element(e))for(var t=e.childNodes.length;t>0;)e.removeChild(e.lastChild),t-=1}function replaceElement(e,t){return is$1.element(t)&&is$1.element(t.parentNode)&&is$1.element(e)?(t.parentNode.replaceChild(e,t),e):null}function getAttributesFromSelector(e,t){if(!is$1.string(e)||is$1.empty(e))return{};var n={},r=extend({},t);return e.split(",").forEach(function(e){var t=e.trim(),i=t.replace(".",""),a=t.replace(/[[\]]/g,"").split("="),o=_slicedToArray(a,1)[0],s=a.length>1?a[1].replace(/["']/g,""):"";switch(t.charAt(0)){case".":is$1.string(r.class)?n.class="".concat(r.class," ").concat(i):n.class=i;break;case"#":n.id=t.replace("#","");break;case"[":n[o]=s}}),extend(r,n)}function toggleHidden(e,t){if(is$1.element(e)){var n=t;is$1.boolean(n)||(n=!e.hidden),e.hidden=n}}function toggleClass(e,t,n){if(is$1.nodeList(e))return Array.from(e).map(function(e){return toggleClass(e,t,n)});if(is$1.element(e)){var r="toggle";return void 0!==n&&(r=n?"add":"remove"),e.classList[r](t),e.classList.contains(t)}return!1}function hasClass(e,t){return is$1.element(e)&&e.classList.contains(t)}function matches$1(e,t){var n=Element.prototype;return(n.matches||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector||function(){return Array.from(document.querySelectorAll(t)).includes(this)}).call(e,t)}function closest(e,t){return(Element.prototype.closest||function(){var e=this;do{if(matches$1.matches(e,t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null}).call(e,t)}function getElements(e){return this.elements.container.querySelectorAll(e)}function getElement(e){return this.elements.container.querySelector(e)}function setFocus(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];is$1.element(e)&&(e.focus({preventScroll:!0}),t&&toggleClass(e,this.config.classNames.tabFocus))}_export({target:"Array",proto:!0,forced:!STRICT_METHOD$5||!USES_TO_LENGTH$9},{reduce:function(e){return $reduce(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}});var defaultCodecs={"audio/ogg":"vorbis","audio/wav":"1","video/webm":"vp8, vorbis","video/mp4":"avc1.42E01E, mp4a.40.2","video/ogg":"theora"},support={audio:"canPlayType"in document.createElement("audio"),video:"canPlayType"in document.createElement("video"),check:function(e,t,n){var r=browser.isIPhone&&n&&support.playsinline,i=support[e]||"html5"!==t;return{api:i,ui:i&&support.rangeInput&&("video"!==e||!browser.isIPhone||r)}},pip:!(browser.isIPhone||!is$1.function(createElement("video").webkitSetPresentationMode)&&(!document.pictureInPictureEnabled||createElement("video").disablePictureInPicture)),airplay:is$1.function(window.WebKitPlaybackTargetAvailabilityEvent),playsinline:"playsInline"in document.createElement("video"),mime:function(e){if(is$1.empty(e))return!1;var t=_slicedToArray(e.split("/"),1)[0],n=e;if(!this.isHTML5||t!==this.type)return!1;Object.keys(defaultCodecs).includes(n)&&(n+='; codecs="'.concat(defaultCodecs[e],'"'));try{return Boolean(n&&this.media.canPlayType(n).replace(/no/,""))}catch(e){return!1}},textTracks:"textTracks"in document.createElement("video"),rangeInput:(range=document.createElement("input"),range.type="range","range"===range.type),touch:"ontouchstart"in document.documentElement,transitions:!1!==transitionEndEvent,reducedMotion:"matchMedia"in window&&window.matchMedia("(prefers-reduced-motion)").matches},range,supportsPassiveListeners=function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){return e=!0,null}});window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(e){}return e}();function toggleListener(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(e&&"addEventListener"in e&&!is$1.empty(t)&&is$1.function(n)){var s=t.split(" "),l=o;supportsPassiveListeners&&(l={passive:a,capture:o}),s.forEach(function(t){r&&r.eventListeners&&i&&r.eventListeners.push({element:e,type:t,callback:n,options:l}),e[i?"addEventListener":"removeEventListener"](t,n,l)})}}function on(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];toggleListener.call(this,e,t,n,!0,r,i)}function off(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];toggleListener.call(this,e,t,n,!1,r,i)}function once(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];toggleListener.call(this,e,n,function o(){var s=arguments;off(e,n,o,i,a);for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=s[d];r.apply(t,c)},!0,i,a)}function triggerEvent(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(is$1.element(e)&&!is$1.empty(t)){var i=new CustomEvent(t,{bubbles:n,detail:_objectSpread2(_objectSpread2({},r),{},{plyr:this})});e.dispatchEvent(i)}}function unbindListeners(){this&&this.eventListeners&&(this.eventListeners.forEach(function(e){var t=e.element,n=e.type,r=e.callback,i=e.options;t.removeEventListener(n,r,i)}),this.eventListeners=[])}function ready(){var e=this;return new Promise(function(t){return e.ready?setTimeout(t,0):on.call(e,e.elements.container,"ready",t)}).then(function(){})}function silencePromise(e){is$1.promise(e)&&e.then(null,function(){})}function validateRatio(e){return!!(is$1.array(e)||is$1.string(e)&&e.includes(":"))&&(is$1.array(e)?e:e.split(":")).map(Number).every(is$1.number)}function reduceAspectRatio(e){if(!is$1.array(e)||!e.every(is$1.number))return null;var t=_slicedToArray(e,2),n=t[0],r=t[1],i=function e(t,n){return 0===n?t:e(n,t%n)}(n,r);return[n/i,r/i]}function getAspectRatio(e){var t=function(e){return validateRatio(e)?e.split(":").map(Number):null},n=t(e);if(null===n&&(n=t(this.config.ratio)),null===n&&!is$1.empty(this.embed)&&is$1.array(this.embed.ratio)&&(n=this.embed.ratio),null===n&&this.isHTML5){var r=this.media;n=reduceAspectRatio([r.videoWidth,r.videoHeight])}return n}function setAspectRatio(e){if(!this.isVideo)return{};var t=this.elements.wrapper,n=getAspectRatio.call(this,e),r=_slicedToArray(is$1.array(n)?n:[0,0],2),i=100/r[0]*r[1];if(t.style.paddingBottom="".concat(i,"%"),this.isVimeo&&!this.config.vimeo.premium&&this.supported.ui){var a=100/this.media.offsetWidth*parseInt(window.getComputedStyle(this.media).paddingBottom,10),o=(a-i)/(a/50);this.media.style.transform="translateY(-".concat(o,"%)")}else this.isHTML5&&t.classList.toggle(this.config.classNames.videoFixedRatio,null!==n);return{padding:i,ratio:n}}var html5={getSources:function(){var e=this;return this.isHTML5?Array.from(this.media.querySelectorAll("source")).filter(function(t){var n=t.getAttribute("type");return!!is$1.empty(n)||support.mime.call(e,n)}):[]},getQualityOptions:function(){return this.config.quality.forced?this.config.quality.options:html5.getSources.call(this).map(function(e){return Number(e.getAttribute("size"))}).filter(Boolean)},setup:function(){if(this.isHTML5){var e=this;e.options.speed=e.config.speed.options,is$1.empty(this.config.ratio)||setAspectRatio.call(e),Object.defineProperty(e.media,"quality",{get:function(){var t=html5.getSources.call(e).find(function(t){return t.getAttribute("src")===e.source});return t&&Number(t.getAttribute("size"))},set:function(t){if(e.quality!==t){if(e.config.quality.forced&&is$1.function(e.config.quality.onChange))e.config.quality.onChange(t);else{var n=html5.getSources.call(e).find(function(e){return Number(e.getAttribute("size"))===t});if(!n)return;var r=e.media,i=r.currentTime,a=r.paused,o=r.preload,s=r.readyState,l=r.playbackRate;e.media.src=n.getAttribute("src"),("none"!==o||s)&&(e.once("loadedmetadata",function(){e.speed=l,e.currentTime=i,a||silencePromise(e.play())}),e.media.load())}triggerEvent.call(e,e.media,"qualitychange",!1,{quality:t})}}})}},cancelRequests:function(){this.isHTML5&&(removeElement(html5.getSources.call(this)),this.media.setAttribute("src",this.config.blankVideo),this.media.load(),this.debug.log("Cancelled network requests"))}};function dedupe(e){return is$1.array(e)?e.filter(function(t,n){return e.indexOf(t)===n}):e}function closest$1(e,t){return is$1.array(e)&&e.length?e.reduce(function(e,n){return Math.abs(n-t)<Math.abs(e-t)?n:e}):null}var defineProperty$6=objectDefineProperty.f,getOwnPropertyNames$1=objectGetOwnPropertyNames.f,setInternalState$7=internalState.set,MATCH$2=wellKnownSymbol("match"),NativeRegExp=global_1.RegExp,RegExpPrototype$1=NativeRegExp.prototype,re1=/a/g,re2=/a/g,CORRECT_NEW=new NativeRegExp(re1)!==re1,UNSUPPORTED_Y$2=regexpStickyHelpers.UNSUPPORTED_Y,FORCED$4=descriptors&&isForced_1("RegExp",!CORRECT_NEW||UNSUPPORTED_Y$2||fails(function(){return re2[MATCH$2]=!1,NativeRegExp(re1)!=re1||NativeRegExp(re2)==re2||"/a/i"!=NativeRegExp(re1,"i")}));if(FORCED$4){for(var RegExpWrapper=function(e,t){var n,r=this instanceof RegExpWrapper,i=isRegexp(e),a=void 0===t;if(!r&&i&&e.constructor===RegExpWrapper&&a)return e;CORRECT_NEW?i&&!a&&(e=e.source):e instanceof RegExpWrapper&&(a&&(t=regexpFlags.call(e)),e=e.source),UNSUPPORTED_Y$2&&(n=!!t&&t.indexOf("y")>-1)&&(t=t.replace(/y/g,""));var o=inheritIfRequired(CORRECT_NEW?new NativeRegExp(e,t):NativeRegExp(e,t),r?this:RegExpPrototype$1,RegExpWrapper);return UNSUPPORTED_Y$2&&n&&setInternalState$7(o,{sticky:n}),o},proxy=function(e){e in RegExpWrapper||defineProperty$6(RegExpWrapper,e,{configurable:!0,get:function(){return NativeRegExp[e]},set:function(t){NativeRegExp[e]=t}})},keys$2=getOwnPropertyNames$1(NativeRegExp),index=0;keys$2.length>index;)proxy(keys$2[index++]);RegExpPrototype$1.constructor=RegExpWrapper,RegExpWrapper.prototype=RegExpPrototype$1,redefine(global_1,"RegExp",RegExpWrapper)}function generateId(e){return"".concat(e,"-").concat(Math.floor(1e4*Math.random()))}function format$1(e){for(var t=arguments,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=t[i];return is$1.empty(e)?e:e.toString().replace(/{(\d+)}/g,function(e,t){return r[t].toString()})}function getPercentage(e,t){return 0===e||0===t||Number.isNaN(e)||Number.isNaN(t)?0:(e/t*100).toFixed(2)}setSpecies("RegExp");var replaceAll=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return e.replace(new RegExp(t.toString().replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1"),"g"),n.toString())},toTitleCase=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toString().replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})};function toPascalCase(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toString();return e=replaceAll(e,"-"," "),e=replaceAll(e,"_"," "),e=toTitleCase(e),replaceAll(e," ","")}function toCamelCase(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toString();return(e=toPascalCase(e)).charAt(0).toLowerCase()+e.slice(1)}function stripHTML(e){var t=document.createDocumentFragment(),n=document.createElement("div");return t.appendChild(n),n.innerHTML=e,t.firstChild.innerText}function getHTML(e){var t=document.createElement("div");return t.appendChild(e),t.innerHTML}var resources={pip:"PIP",airplay:"AirPlay",html5:"HTML5",vimeo:"Vimeo",youtube:"YouTube"},i18n={get:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(is$1.empty(e)||is$1.empty(t))return"";var n=getDeep(t.i18n,e);if(is$1.empty(n))return Object.keys(resources).includes(e)?resources[e]:"";var r={"{seektime}":t.seekTime,"{title}":t.title};return Object.entries(r).forEach(function(e){var t=_slicedToArray(e,2),r=t[0],i=t[1];n=replaceAll(n,r,i)}),n}},Storage=function(){function e(t){_classCallCheck(this,e),this.enabled=t.config.storage.enabled,this.key=t.config.storage.key}return _createClass(e,[{key:"get",value:function(t){if(!e.supported||!this.enabled)return null;var n=window.localStorage.getItem(this.key);if(is$1.empty(n))return null;var r=JSON.parse(n);return is$1.string(t)&&t.length?r[t]:r}},{key:"set",value:function(t){if(e.supported&&this.enabled&&is$1.object(t)){var n=this.get();is$1.empty(n)&&(n={}),extend(n,t),window.localStorage.setItem(this.key,JSON.stringify(n))}}}],[{key:"supported",get:function(){try{if(!("localStorage"in window))return!1;return window.localStorage.setItem("___test","___test"),window.localStorage.removeItem("___test"),!0}catch(e){return!1}}}]),e}();function fetch$1(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";return new Promise(function(n,r){try{var i=new XMLHttpRequest;if(!("withCredentials"in i))return;i.addEventListener("load",function(){if("text"===t)try{n(JSON.parse(i.responseText))}catch(e){n(i.responseText)}else n(i.response)}),i.addEventListener("error",function(){throw new Error(i.status)}),i.open("GET",e,!0),i.responseType=t,i.send()}catch(e){r(e)}})}function loadSprite(e,t){if(is$1.string(e)){var n=is$1.string(t),r=function(){return null!==document.getElementById(t)},i=function(e,t){e.innerHTML=t,n&&r()||document.body.insertAdjacentElement("afterbegin",e)};if(!n||!r()){var a=Storage.supported,o=document.createElement("div");if(o.setAttribute("hidden",""),n&&o.setAttribute("id",t),a){var s=window.localStorage.getItem("".concat("cache","-").concat(t));if(null!==s){var l=JSON.parse(s);i(o,l.content)}}fetch$1(e).then(function(e){is$1.empty(e)||(a&&window.localStorage.setItem("".concat("cache","-").concat(t),JSON.stringify({content:e})),i(o,e))}).catch(function(){})}}}var ceil$1=Math.ceil,floor$5=Math.floor;_export({target:"Math",stat:!0},{trunc:function(e){return(e>0?floor$5:ceil$1)(e)}});var getHours=function(e){return Math.trunc(e/60/60%60,10)},getMinutes=function(e){return Math.trunc(e/60%60,10)},getSeconds=function(e){return Math.trunc(e%60,10)};function formatTime(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!is$1.number(e))return formatTime(void 0,t,n);var r=function(e){return"0".concat(e).slice(-2)},i=getHours(e),a=getMinutes(e),o=getSeconds(e);return i=t||i>0?"".concat(i,":"):"","".concat(n&&e>0?"-":"").concat(i).concat(r(a),":").concat(r(o))}var controls={getIconUrl:function(){var e=new URL(this.config.iconUrl,window.location).host!==window.location.host||browser.isIE&&!window.svg4everybody;return{url:this.config.iconUrl,cors:e}},findElements:function(){try{return this.elements.controls=getElement.call(this,this.config.selectors.controls.wrapper),this.elements.buttons={play:getElements.call(this,this.config.selectors.buttons.play),pause:getElement.call(this,this.config.selectors.buttons.pause),restart:getElement.call(this,this.config.selectors.buttons.restart),rewind:getElement.call(this,this.config.selectors.buttons.rewind),fastForward:getElement.call(this,this.config.selectors.buttons.fastForward),mute:getElement.call(this,this.config.selectors.buttons.mute),pip:getElement.call(this,this.config.selectors.buttons.pip),airplay:getElement.call(this,this.config.selectors.buttons.airplay),settings:getElement.call(this,this.config.selectors.buttons.settings),captions:getElement.call(this,this.config.selectors.buttons.captions),fullscreen:getElement.call(this,this.config.selectors.buttons.fullscreen)},this.elements.progress=getElement.call(this,this.config.selectors.progress),this.elements.inputs={seek:getElement.call(this,this.config.selectors.inputs.seek),volume:getElement.call(this,this.config.selectors.inputs.volume)},this.elements.display={buffer:getElement.call(this,this.config.selectors.display.buffer),currentTime:getElement.call(this,this.config.selectors.display.currentTime),duration:getElement.call(this,this.config.selectors.display.duration)},is$1.element(this.elements.progress)&&(this.elements.display.seekTooltip=this.elements.progress.querySelector(".".concat(this.config.classNames.tooltip))),!0}catch(e){return this.debug.warn("It looks like there is a problem with your custom controls HTML",e),this.toggleNativeControls(!0),!1}},createIcon:function(e,t){var n=controls.getIconUrl.call(this),r="".concat(n.cors?"":n.url,"#").concat(this.config.iconPrefix),i=document.createElementNS("http://www.w3.org/2000/svg","svg");setAttributes(i,extend(t,{"aria-hidden":"true",focusable:"false"}));var a=document.createElementNS("http://www.w3.org/2000/svg","use"),o="".concat(r,"-").concat(e);return"href"in a&&a.setAttributeNS("http://www.w3.org/1999/xlink","href",o),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o),i.appendChild(a),i},createLabel:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i18n.get(e,this.config);return createElement("span",_objectSpread2(_objectSpread2({},t),{},{class:[t.class,this.config.classNames.hidden].filter(Boolean).join(" ")}),n)},createBadge:function(e){if(is$1.empty(e))return null;var t=createElement("span",{class:this.config.classNames.menu.value});return t.appendChild(createElement("span",{class:this.config.classNames.menu.badge},e)),t},createButton:function(e,t){var n=this,r=extend({},t),i=toCamelCase(e),a={element:"button",toggle:!1,label:null,icon:null,labelPressed:null,iconPressed:null};switch(["element","icon","label"].forEach(function(e){Object.keys(r).includes(e)&&(a[e]=r[e],delete r[e])}),"button"!==a.element||Object.keys(r).includes("type")||(r.type="button"),Object.keys(r).includes("class")?r.class.split(" ").some(function(e){return e===n.config.classNames.control})||extend(r,{class:"".concat(r.class," ").concat(this.config.classNames.control)}):r.class=this.config.classNames.control,e){case"play":a.toggle=!0,a.label="play",a.labelPressed="pause",a.icon="play",a.iconPressed="pause";break;case"mute":a.toggle=!0,a.label="mute",a.labelPressed="unmute",a.icon="volume",a.iconPressed="muted";break;case"captions":a.toggle=!0,a.label="enableCaptions",a.labelPressed="disableCaptions",a.icon="captions-off",a.iconPressed="captions-on";break;case"fullscreen":a.toggle=!0,a.label="enterFullscreen",a.labelPressed="exitFullscreen",a.icon="enter-fullscreen",a.iconPressed="exit-fullscreen";break;case"play-large":r.class+=" ".concat(this.config.classNames.control,"--overlaid"),i="play",a.label="play",a.icon="play";break;default:is$1.empty(a.label)&&(a.label=i),is$1.empty(a.icon)&&(a.icon=e)}var o=createElement(a.element);return a.toggle?(o.appendChild(controls.createIcon.call(this,a.iconPressed,{class:"icon--pressed"})),o.appendChild(controls.createIcon.call(this,a.icon,{class:"icon--not-pressed"})),o.appendChild(controls.createLabel.call(this,a.labelPressed,{class:"label--pressed"})),o.appendChild(controls.createLabel.call(this,a.label,{class:"label--not-pressed"}))):(o.appendChild(controls.createIcon.call(this,a.icon)),o.appendChild(controls.createLabel.call(this,a.label))),extend(r,getAttributesFromSelector(this.config.selectors.buttons[i],r)),setAttributes(o,r),"play"===i?(is$1.array(this.elements.buttons[i])||(this.elements.buttons[i]=[]),this.elements.buttons[i].push(o)):this.elements.buttons[i]=o,o},createRange:function(e,t){var n=createElement("input",extend(getAttributesFromSelector(this.config.selectors.inputs[e]),{type:"range",min:0,max:100,step:.01,value:0,autocomplete:"off",role:"slider","aria-label":i18n.get(e,this.config),"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":0},t));return this.elements.inputs[e]=n,controls.updateRangeFill.call(this,n),RangeTouch.setup(n),n},createProgress:function(e,t){var n=createElement("progress",extend(getAttributesFromSelector(this.config.selectors.display[e]),{min:0,max:100,value:0,role:"progressbar","aria-hidden":!0},t));if("volume"!==e){n.appendChild(createElement("span",null,"0"));var r={played:"played",buffer:"buffered"}[e],i=r?i18n.get(r,this.config):"";n.innerText="% ".concat(i.toLowerCase())}return this.elements.display[e]=n,n},createTime:function(e,t){var n=getAttributesFromSelector(this.config.selectors.display[e],t),r=createElement("div",extend(n,{class:"".concat(n.class?n.class:""," ").concat(this.config.classNames.display.time," ").trim(),"aria-label":i18n.get(e,this.config)}),"00:00");return this.elements.display[e]=r,r},bindMenuItemShortcuts:function(e,t){var n=this;on.call(this,e,"keydown keyup",function(r){if([32,38,39,40].includes(r.which)&&(r.preventDefault(),r.stopPropagation(),"keydown"!==r.type)){var i,a=matches$1(e,'[role="menuitemradio"]');if(!a&&[32,39].includes(r.which))controls.showMenuPanel.call(n,t,!0);else 32!==r.which&&(40===r.which||a&&39===r.which?(i=e.nextElementSibling,is$1.element(i)||(i=e.parentNode.firstElementChild)):(i=e.previousElementSibling,is$1.element(i)||(i=e.parentNode.lastElementChild)),setFocus.call(n,i,!0))}},!1),on.call(this,e,"keyup",function(e){13===e.which&&controls.focusFirstMenuItem.call(n,null,!0)})},createMenuItem:function(e){var t=this,n=e.value,r=e.list,i=e.type,a=e.title,o=e.badge,s=void 0===o?null:o,l=e.checked,c=void 0!==l&&l,d=getAttributesFromSelector(this.config.selectors.inputs[i]),u=createElement("button",extend(d,{type:"button",role:"menuitemradio",class:"".concat(this.config.classNames.control," ").concat(d.class?d.class:"").trim(),"aria-checked":c,value:n})),p=createElement("span");p.innerHTML=a,is$1.element(s)&&p.appendChild(s),u.appendChild(p),Object.defineProperty(u,"checked",{enumerable:!0,get:function(){return"true"===u.getAttribute("aria-checked")},set:function(e){e&&Array.from(u.parentNode.children).filter(function(e){return matches$1(e,'[role="menuitemradio"]')}).forEach(function(e){return e.setAttribute("aria-checked","false")}),u.setAttribute("aria-checked",e?"true":"false")}}),this.listeners.bind(u,"click keyup",function(e){if(!is$1.keyboardEvent(e)||32===e.which){switch(e.preventDefault(),e.stopPropagation(),u.checked=!0,i){case"language":t.currentTrack=Number(n);break;case"quality":t.quality=n;break;case"speed":t.speed=parseFloat(n)}controls.showMenuPanel.call(t,"home",is$1.keyboardEvent(e))}},i,!1),controls.bindMenuItemShortcuts.call(this,u,i),r.appendChild(u)},formatTime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return is$1.number(e)?formatTime(e,getHours(this.duration)>0,t):e},updateTimeDisplay:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];is$1.element(e)&&is$1.number(t)&&(e.innerText=controls.formatTime(t,n))},updateVolume:function(){this.supported.ui&&(is$1.element(this.elements.inputs.volume)&&controls.setRange.call(this,this.elements.inputs.volume,this.muted?0:this.volume),is$1.element(this.elements.buttons.mute)&&(this.elements.buttons.mute.pressed=this.muted||0===this.volume))},setRange:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;is$1.element(e)&&(e.value=t,controls.updateRangeFill.call(this,e))},updateProgress:function(e){var t=this;if(this.supported.ui&&is$1.event(e)){var n=0;if(e)switch(e.type){case"timeupdate":case"seeking":case"seeked":n=getPercentage(this.currentTime,this.duration),"timeupdate"===e.type&&controls.setRange.call(this,this.elements.inputs.seek,n);break;case"playing":case"progress":!function(e,n){var r=is$1.number(n)?n:0,i=is$1.element(e)?e:t.elements.display.buffer;if(is$1.element(i)){i.value=r;var a=i.getElementsByTagName("span")[0];is$1.element(a)&&(a.childNodes[0].nodeValue=r)}}(this.elements.display.buffer,100*this.buffered)}}},updateRangeFill:function(e){var t=is$1.event(e)?e.target:e;if(is$1.element(t)&&"range"===t.getAttribute("type")){if(matches$1(t,this.config.selectors.inputs.seek)){t.setAttribute("aria-valuenow",this.currentTime);var n=controls.formatTime(this.currentTime),r=controls.formatTime(this.duration),i=i18n.get("seekLabel",this.config);t.setAttribute("aria-valuetext",i.replace("{currentTime}",n).replace("{duration}",r))}else if(matches$1(t,this.config.selectors.inputs.volume)){var a=100*t.value;t.setAttribute("aria-valuenow",a),t.setAttribute("aria-valuetext","".concat(a.toFixed(1),"%"))}else t.setAttribute("aria-valuenow",t.value);browser.isWebkit&&t.style.setProperty("--value","".concat(t.value/t.max*100,"%"))}},updateSeekTooltip:function(e){var t=this;if(this.config.tooltips.seek&&is$1.element(this.elements.inputs.seek)&&is$1.element(this.elements.display.seekTooltip)&&0!==this.duration){var n="".concat(this.config.classNames.tooltip,"--visible"),r=function(e){return toggleClass(t.elements.display.seekTooltip,n,e)};if(this.touch)r(!1);else{var i=0,a=this.elements.progress.getBoundingClientRect();if(is$1.event(e))i=100/a.width*(e.pageX-a.left);else{if(!hasClass(this.elements.display.seekTooltip,n))return;i=parseFloat(this.elements.display.seekTooltip.style.left,10)}i<0?i=0:i>100&&(i=100),controls.updateTimeDisplay.call(this,this.elements.display.seekTooltip,this.duration/100*i),this.elements.display.seekTooltip.style.left="".concat(i,"%"),is$1.event(e)&&["mouseenter","mouseleave"].includes(e.type)&&r("mouseenter"===e.type)}}},timeUpdate:function(e){var t=!is$1.element(this.elements.display.duration)&&this.config.invertTime;controls.updateTimeDisplay.call(this,this.elements.display.currentTime,t?this.duration-this.currentTime:this.currentTime,t),e&&"timeupdate"===e.type&&this.media.seeking||controls.updateProgress.call(this,e)},durationUpdate:function(){if(this.supported.ui&&(this.config.invertTime||!this.currentTime)){if(this.duration>=Math.pow(2,32))return toggleHidden(this.elements.display.currentTime,!0),void toggleHidden(this.elements.progress,!0);is$1.element(this.elements.inputs.seek)&&this.elements.inputs.seek.setAttribute("aria-valuemax",this.duration);var e=is$1.element(this.elements.display.duration);!e&&this.config.displayDuration&&this.paused&&controls.updateTimeDisplay.call(this,this.elements.display.currentTime,this.duration),e&&controls.updateTimeDisplay.call(this,this.elements.display.duration,this.duration),controls.updateSeekTooltip.call(this)}},toggleMenuButton:function(e,t){toggleHidden(this.elements.settings.buttons[e],!t)},updateSetting:function(e,t,n){var r=this.elements.settings.panels[e],i=null,a=t;if("captions"===e)i=this.currentTrack;else{if(i=is$1.empty(n)?this[e]:n,is$1.empty(i)&&(i=this.config[e].default),!is$1.empty(this.options[e])&&!this.options[e].includes(i))return void this.debug.warn("Unsupported value of '".concat(i,"' for ").concat(e));if(!this.config[e].options.includes(i))return void this.debug.warn("Disabled value of '".concat(i,"' for ").concat(e))}if(is$1.element(a)||(a=r&&r.querySelector('[role="menu"]')),is$1.element(a)){this.elements.settings.buttons[e].querySelector(".".concat(this.config.classNames.menu.value)).innerHTML=controls.getLabel.call(this,e,i);var o=a&&a.querySelector('[value="'.concat(i,'"]'));is$1.element(o)&&(o.checked=!0)}},getLabel:function(e,t){switch(e){case"speed":return 1===t?i18n.get("normal",this.config):"".concat(t,"&times;");case"quality":if(is$1.number(t)){var n=i18n.get("qualityLabel.".concat(t),this.config);return n.length?n:"".concat(t,"p")}return toTitleCase(t);case"captions":return captions.getLabel.call(this);default:return null}},setQualityMenu:function(e){var t=this;if(is$1.element(this.elements.settings.panels.quality)){var n=this.elements.settings.panels.quality.querySelector('[role="menu"]');is$1.array(e)&&(this.options.quality=dedupe(e).filter(function(e){return t.config.quality.options.includes(e)}));var r=!is$1.empty(this.options.quality)&&this.options.quality.length>1;if(controls.toggleMenuButton.call(this,"quality",r),emptyElement(n),controls.checkMenu.call(this),r){var i=function(e){var n=i18n.get("qualityBadge.".concat(e),t.config);return n.length?controls.createBadge.call(t,n):null};this.options.quality.sort(function(e,n){var r=t.config.quality.options;return r.indexOf(e)>r.indexOf(n)?1:-1}).forEach(function(e){controls.createMenuItem.call(t,{value:e,list:n,type:"quality",title:controls.getLabel.call(t,"quality",e),badge:i(e)})}),controls.updateSetting.call(this,"quality",n)}}},setCaptionsMenu:function(){var e=this;if(is$1.element(this.elements.settings.panels.captions)){var t=this.elements.settings.panels.captions.querySelector('[role="menu"]'),n=captions.getTracks.call(this),r=Boolean(n.length);if(controls.toggleMenuButton.call(this,"captions",r),emptyElement(t),controls.checkMenu.call(this),r){var i=n.map(function(n,r){return{value:r,checked:e.captions.toggled&&e.currentTrack===r,title:captions.getLabel.call(e,n),badge:n.language&&controls.createBadge.call(e,n.language.toUpperCase()),list:t,type:"language"}});i.unshift({value:-1,checked:!this.captions.toggled,title:i18n.get("disabled",this.config),list:t,type:"language"}),i.forEach(controls.createMenuItem.bind(this)),controls.updateSetting.call(this,"captions",t)}}},setSpeedMenu:function(){var e=this;if(is$1.element(this.elements.settings.panels.speed)){var t=this.elements.settings.panels.speed.querySelector('[role="menu"]');this.options.speed=this.options.speed.filter(function(t){return t>=e.minimumSpeed&&t<=e.maximumSpeed});var n=!is$1.empty(this.options.speed)&&this.options.speed.length>1;controls.toggleMenuButton.call(this,"speed",n),emptyElement(t),controls.checkMenu.call(this),n&&(this.options.speed.forEach(function(n){controls.createMenuItem.call(e,{value:n,list:t,type:"speed",title:controls.getLabel.call(e,"speed",n)})}),controls.updateSetting.call(this,"speed",t))}},checkMenu:function(){var e=this.elements.settings.buttons,t=!is$1.empty(e)&&Object.values(e).some(function(e){return!e.hidden});toggleHidden(this.elements.settings.menu,!t)},focusFirstMenuItem:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.elements.settings.popup.hidden){var n=e;is$1.element(n)||(n=Object.values(this.elements.settings.panels).find(function(e){return!e.hidden}));var r=n.querySelector('[role^="menuitem"]');setFocus.call(this,r,t)}},toggleMenu:function(e){var t=this.elements.settings.popup,n=this.elements.buttons.settings;if(is$1.element(t)&&is$1.element(n)){var r=t.hidden,i=r;if(is$1.boolean(e))i=e;else if(is$1.keyboardEvent(e)&&27===e.which)i=!1;else if(is$1.event(e)){var a=is$1.function(e.composedPath)?e.composedPath()[0]:e.target,o=t.contains(a);if(o||!o&&e.target!==n&&i)return}n.setAttribute("aria-expanded",i),toggleHidden(t,!i),toggleClass(this.elements.container,this.config.classNames.menu.open,i),i&&is$1.keyboardEvent(e)?controls.focusFirstMenuItem.call(this,null,!0):i||r||setFocus.call(this,n,is$1.keyboardEvent(e))}},getMenuSize:function(e){var t=e.cloneNode(!0);t.style.position="absolute",t.style.opacity=0,t.removeAttribute("hidden"),e.parentNode.appendChild(t);var n=t.scrollWidth,r=t.scrollHeight;return removeElement(t),{width:n,height:r}},showMenuPanel:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.elements.container.querySelector("#plyr-settings-".concat(this.id,"-").concat(t));if(is$1.element(r)){var i=r.parentNode,a=Array.from(i.children).find(function(e){return!e.hidden});if(support.transitions&&!support.reducedMotion){i.style.width="".concat(a.scrollWidth,"px"),i.style.height="".concat(a.scrollHeight,"px");var o=controls.getMenuSize.call(this,r);on.call(this,i,transitionEndEvent,function t(n){n.target===i&&["width","height"].includes(n.propertyName)&&(i.style.width="",i.style.height="",off.call(e,i,transitionEndEvent,t))}),i.style.width="".concat(o.width,"px"),i.style.height="".concat(o.height,"px")}toggleHidden(a,!0),toggleHidden(r,!1),controls.focusFirstMenuItem.call(this,r,n)}},setDownloadUrl:function(){var e=this.elements.buttons.download;is$1.element(e)&&e.setAttribute("href",this.download)},create:function(e){var t=this,n=controls.bindMenuItemShortcuts,r=controls.createButton,i=controls.createProgress,a=controls.createRange,o=controls.createTime,s=controls.setQualityMenu,l=controls.setSpeedMenu,c=controls.showMenuPanel;this.elements.controls=null,is$1.array(this.config.controls)&&this.config.controls.includes("play-large")&&this.elements.container.appendChild(r.call(this,"play-large"));var d=createElement("div",getAttributesFromSelector(this.config.selectors.controls.wrapper));this.elements.controls=d;var u={class:"plyr__controls__item"};return dedupe(is$1.array(this.config.controls)?this.config.controls:[]).forEach(function(s){if("restart"===s&&d.appendChild(r.call(t,"restart",u)),"rewind"===s&&d.appendChild(r.call(t,"rewind",u)),"play"===s&&d.appendChild(r.call(t,"play",u)),"fast-forward"===s&&d.appendChild(r.call(t,"fast-forward",u)),"progress"===s){var l=createElement("div",{class:"".concat(u.class," plyr__progress__container")}),p=createElement("div",getAttributesFromSelector(t.config.selectors.progress));if(p.appendChild(a.call(t,"seek",{id:"plyr-seek-".concat(e.id)})),p.appendChild(i.call(t,"buffer")),t.config.tooltips.seek){var f=createElement("span",{class:t.config.classNames.tooltip},"00:00");p.appendChild(f),t.elements.display.seekTooltip=f}t.elements.progress=p,l.appendChild(t.elements.progress),d.appendChild(l)}if("current-time"===s&&d.appendChild(o.call(t,"currentTime",u)),"duration"===s&&d.appendChild(o.call(t,"duration",u)),"mute"===s||"volume"===s){var h=t.elements.volume;if(is$1.element(h)&&d.contains(h)||(h=createElement("div",extend({},u,{class:"".concat(u.class," plyr__volume").trim()})),t.elements.volume=h,d.appendChild(h)),"mute"===s&&h.appendChild(r.call(t,"mute")),"volume"===s&&!browser.isIos){var _={max:1,step:.05,value:t.config.volume};h.appendChild(a.call(t,"volume",extend(_,{id:"plyr-volume-".concat(e.id)})))}}if("captions"===s&&d.appendChild(r.call(t,"captions",u)),"settings"===s&&!is$1.empty(t.config.settings)){var m=createElement("div",extend({},u,{class:"".concat(u.class," plyr__menu").trim(),hidden:""}));m.appendChild(r.call(t,"settings",{"aria-haspopup":!0,"aria-controls":"plyr-settings-".concat(e.id),"aria-expanded":!1}));var g=createElement("div",{class:"plyr__menu__container",id:"plyr-settings-".concat(e.id),hidden:""}),v=createElement("div"),b=createElement("div",{id:"plyr-settings-".concat(e.id,"-home")}),y=createElement("div",{role:"menu"});b.appendChild(y),v.appendChild(b),t.elements.settings.panels.home=b,t.config.settings.forEach(function(r){var i=createElement("button",extend(getAttributesFromSelector(t.config.selectors.buttons.settings),{type:"button",class:"".concat(t.config.classNames.control," ").concat(t.config.classNames.control,"--forward"),role:"menuitem","aria-haspopup":!0,hidden:""}));n.call(t,i,r),on.call(t,i,"click",function(){c.call(t,r,!1)});var a=createElement("span",null,i18n.get(r,t.config)),o=createElement("span",{class:t.config.classNames.menu.value});o.innerHTML=e[r],a.appendChild(o),i.appendChild(a),y.appendChild(i);var s=createElement("div",{id:"plyr-settings-".concat(e.id,"-").concat(r),hidden:""}),l=createElement("button",{type:"button",class:"".concat(t.config.classNames.control," ").concat(t.config.classNames.control,"--back")});l.appendChild(createElement("span",{"aria-hidden":!0},i18n.get(r,t.config))),l.appendChild(createElement("span",{class:t.config.classNames.hidden},i18n.get("menuBack",t.config))),on.call(t,s,"keydown",function(e){37===e.which&&(e.preventDefault(),e.stopPropagation(),c.call(t,"home",!0))},!1),on.call(t,l,"click",function(){c.call(t,"home",!1)}),s.appendChild(l),s.appendChild(createElement("div",{role:"menu"})),v.appendChild(s),t.elements.settings.buttons[r]=i,t.elements.settings.panels[r]=s}),g.appendChild(v),m.appendChild(g),d.appendChild(m),t.elements.settings.popup=g,t.elements.settings.menu=m}if("pip"===s&&support.pip&&d.appendChild(r.call(t,"pip",u)),"airplay"===s&&support.airplay&&d.appendChild(r.call(t,"airplay",u)),"download"===s){var w=extend({},u,{element:"a",href:t.download,target:"_blank"});t.isHTML5&&(w.download="");var k=t.config.urls.download;!is$1.url(k)&&t.isEmbed&&extend(w,{icon:"logo-".concat(t.provider),label:t.provider}),d.appendChild(r.call(t,"download",w))}"fullscreen"===s&&d.appendChild(r.call(t,"fullscreen",u))}),this.isHTML5&&s.call(this,html5.getQualityOptions.call(this)),l.call(this),d},inject:function(){var e=this;if(this.config.loadSprite){var t=controls.getIconUrl.call(this);t.cors&&loadSprite(t.url,"sprite-plyr")}this.id=Math.floor(1e4*Math.random());var n=null;this.elements.controls=null;var r={id:this.id,seektime:this.config.seekTime,title:this.config.title},i=!0;is$1.function(this.config.controls)&&(this.config.controls=this.config.controls.call(this,r)),this.config.controls||(this.config.controls=[]),is$1.element(this.config.controls)||is$1.string(this.config.controls)?n=this.config.controls:(n=controls.create.call(this,{id:this.id,seektime:this.config.seekTime,speed:this.speed,quality:this.quality,captions:captions.getLabel.call(this)}),i=!1);var a,o;if(i&&is$1.string(this.config.controls)&&(a=n,Object.entries(r).forEach(function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1];a=replaceAll(a,"{".concat(n,"}"),r)}),n=a),is$1.string(this.config.selectors.controls.container)&&(o=document.querySelector(this.config.selectors.controls.container)),is$1.element(o)||(o=this.elements.container),o[is$1.element(n)?"insertAdjacentElement":"insertAdjacentHTML"]("afterbegin",n),is$1.element(this.elements.controls)||controls.findElements.call(this),!is$1.empty(this.elements.buttons)){var s=function(t){var n=e.config.classNames.controlPressed;Object.defineProperty(t,"pressed",{enumerable:!0,get:function(){return hasClass(t,n)},set:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];toggleClass(t,n,e)}})};Object.values(this.elements.buttons).filter(Boolean).forEach(function(e){is$1.array(e)||is$1.nodeList(e)?Array.from(e).filter(Boolean).forEach(s):s(e)})}if(browser.isEdge&&repaint(o),this.config.tooltips.controls){var l=this.config,c=l.classNames,d=l.selectors,u="".concat(d.controls.wrapper," ").concat(d.labels," .").concat(c.hidden),p=getElements.call(this,u);Array.from(p).forEach(function(t){toggleClass(t,e.config.classNames.hidden,!1),toggleClass(t,e.config.classNames.tooltip,!0)})}}};function parseUrl(e){var t=e;if(!(arguments.length>1&&void 0!==arguments[1])||arguments[1]){var n=document.createElement("a");n.href=t,t=n.href}try{return new URL(t)}catch(e){return null}}function buildUrlParams(e){var t=new URLSearchParams;return is$1.object(e)&&Object.entries(e).forEach(function(e){var n=_slicedToArray(e,2),r=n[0],i=n[1];t.set(r,i)}),t}var captions={setup:function(){if(this.supported.ui)if(!this.isVideo||this.isYouTube||this.isHTML5&&!support.textTracks)is$1.array(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&controls.setCaptionsMenu.call(this);else{if(is$1.element(this.elements.captions)||(this.elements.captions=createElement("div",getAttributesFromSelector(this.config.selectors.captions)),insertAfter(this.elements.captions,this.elements.wrapper)),browser.isIE&&window.URL){var e=this.media.querySelectorAll("track");Array.from(e).forEach(function(e){var t=e.getAttribute("src"),n=parseUrl(t);null!==n&&n.hostname!==window.location.href.hostname&&["http:","https:"].includes(n.protocol)&&fetch$1(t,"blob").then(function(t){e.setAttribute("src",window.URL.createObjectURL(t))}).catch(function(){removeElement(e)})})}var t=dedupe((navigator.languages||[navigator.language||navigator.userLanguage||"en"]).map(function(e){return e.split("-")[0]})),n=(this.storage.get("language")||this.config.captions.language||"auto").toLowerCase();if("auto"===n)n=_slicedToArray(t,1)[0];var r=this.storage.get("captions");if(is$1.boolean(r)||(r=this.config.captions.active),Object.assign(this.captions,{toggled:!1,active:r,language:n,languages:t}),this.isHTML5){var i=this.config.captions.update?"addtrack removetrack":"removetrack";on.call(this,this.media.textTracks,i,captions.update.bind(this))}setTimeout(captions.update.bind(this),0)}},update:function(){var e=this,t=captions.getTracks.call(this,!0),n=this.captions,r=n.active,i=n.language,a=n.meta,o=n.currentTrackNode,s=Boolean(t.find(function(e){return e.language===i}));this.isHTML5&&this.isVideo&&t.filter(function(e){return!a.get(e)}).forEach(function(t){e.debug.log("Track added",t),a.set(t,{default:"showing"===t.mode}),"showing"===t.mode&&(t.mode="hidden"),on.call(e,t,"cuechange",function(){return captions.updateCues.call(e)})}),(s&&this.language!==i||!t.includes(o))&&(captions.setLanguage.call(this,i),captions.toggle.call(this,r&&s)),toggleClass(this.elements.container,this.config.classNames.captions.enabled,!is$1.empty(t)),is$1.array(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&controls.setCaptionsMenu.call(this)},toggle:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.supported.ui){var r=this.captions.toggled,i=this.config.classNames.captions.active,a=is$1.nullOrUndefined(e)?!r:e;if(a!==r){if(n||(this.captions.active=a,this.storage.set({captions:a})),!this.language&&a&&!n){var o=captions.getTracks.call(this),s=captions.findTrack.call(this,[this.captions.language].concat(_toConsumableArray(this.captions.languages)),!0);return this.captions.language=s.language,void captions.set.call(this,o.indexOf(s))}this.elements.buttons.captions&&(this.elements.buttons.captions.pressed=a),toggleClass(this.elements.container,i,a),this.captions.toggled=a,controls.updateSetting.call(this,"captions"),triggerEvent.call(this,this.media,a?"captionsenabled":"captionsdisabled")}setTimeout(function(){a&&t.captions.toggled&&(t.captions.currentTrackNode.mode="hidden")})}},set:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=captions.getTracks.call(this);if(-1!==e)if(is$1.number(e))if(e in n){if(this.captions.currentTrack!==e){this.captions.currentTrack=e;var r=n[e],i=(r||{}).language;this.captions.currentTrackNode=r,controls.updateSetting.call(this,"captions"),t||(this.captions.language=i,this.storage.set({language:i})),this.isVimeo&&this.embed.enableTextTrack(i),triggerEvent.call(this,this.media,"languagechange")}captions.toggle.call(this,!0,t),this.isHTML5&&this.isVideo&&captions.updateCues.call(this)}else this.debug.warn("Track not found",e);else this.debug.warn("Invalid caption argument",e);else captions.toggle.call(this,!1,t)},setLanguage:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(is$1.string(e)){var n=e.toLowerCase();this.captions.language=n;var r=captions.getTracks.call(this),i=captions.findTrack.call(this,[n]);captions.set.call(this,r.indexOf(i),t)}else this.debug.warn("Invalid language argument",e)},getTracks:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Array.from((this.media||{}).textTracks||[]).filter(function(n){return!e.isHTML5||t||e.captions.meta.has(n)}).filter(function(e){return["captions","subtitles"].includes(e.kind)})},findTrack:function(e){var t,n=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=captions.getTracks.call(this),a=function(e){return Number((n.captions.meta.get(e)||{}).default)},o=Array.from(i).sort(function(e,t){return a(t)-a(e)});return e.every(function(e){return!(t=o.find(function(t){return t.language===e}))}),t||(r?o[0]:void 0)},getCurrentTrack:function(){return captions.getTracks.call(this)[this.currentTrack]},getLabel:function(e){var t=e;return!is$1.track(t)&&support.textTracks&&this.captions.toggled&&(t=captions.getCurrentTrack.call(this)),is$1.track(t)?is$1.empty(t.label)?is$1.empty(t.language)?i18n.get("enabled",this.config):e.language.toUpperCase():t.label:i18n.get("disabled",this.config)},updateCues:function(e){if(this.supported.ui)if(is$1.element(this.elements.captions))if(is$1.nullOrUndefined(e)||Array.isArray(e)){var t=e;if(!t){var n=captions.getCurrentTrack.call(this);t=Array.from((n||{}).activeCues||[]).map(function(e){return e.getCueAsHTML()}).map(getHTML)}var r=t.map(function(e){return e.trim()}).join("\n");if(r!==this.elements.captions.innerHTML){emptyElement(this.elements.captions);var i=createElement("span",getAttributesFromSelector(this.config.selectors.caption));i.innerHTML=r,this.elements.captions.appendChild(i),triggerEvent.call(this,this.media,"cuechange")}}else this.debug.warn("updateCues: Invalid input",e);else this.debug.warn("No captions element to render to")}},defaults$1={enabled:!0,title:"",debug:!1,autoplay:!1,autopause:!0,playsinline:!0,seekTime:10,volume:1,muted:!1,duration:null,displayDuration:!0,invertTime:!0,toggleInvert:!0,ratio:null,clickToPlay:!0,hideControls:!0,resetOnEnd:!1,disableContextMenu:!0,loadSprite:!0,iconPrefix:"plyr",iconUrl:"https://cdn.plyr.io/3.6.2/plyr.svg",blankVideo:"https://cdn.plyr.io/static/blank.mp4",quality:{default:576,options:[4320,2880,2160,1440,1080,720,576,480,360,240],forced:!1,onChange:null},loop:{active:!1},speed:{selected:1,options:[.5,.75,1,1.25,1.5,1.75,2,4]},keyboard:{focused:!0,global:!1},tooltips:{controls:!1,seek:!0},captions:{active:!1,language:"auto",update:!1},fullscreen:{enabled:!0,fallback:!0,iosNative:!1},storage:{enabled:!0,key:"plyr"},controls:["play-large","play","progress","current-time","mute","volume","captions","settings","pip","airplay","fullscreen"],settings:["captions","quality","speed"],i18n:{restart:"Restart",rewind:"Rewind {seektime}s",play:"Play",pause:"Pause",fastForward:"Forward {seektime}s",seek:"Seek",seekLabel:"{currentTime} of {duration}",played:"Played",buffered:"Buffered",currentTime:"Current time",duration:"Duration",volume:"Volume",mute:"Mute",unmute:"Unmute",enableCaptions:"Enable captions",disableCaptions:"Disable captions",download:"Download",enterFullscreen:"Enter fullscreen",exitFullscreen:"Exit fullscreen",frameTitle:"Player for {title}",captions:"Captions",settings:"Settings",pip:"PIP",menuBack:"Go back to previous menu",speed:"Speed",normal:"Normal",quality:"Quality",loop:"Loop",start:"Start",end:"End",all:"All",reset:"Reset",disabled:"Disabled",enabled:"Enabled",advertisement:"Ad",qualityBadge:{2160:"4K",1440:"HD",1080:"HD",720:"HD",576:"SD",480:"SD"}},urls:{download:null,vimeo:{sdk:"https://player.vimeo.com/api/player.js",iframe:"https://player.vimeo.com/video/{0}?{1}",api:"https://vimeo.com/api/v2/video/{0}.json"},youtube:{sdk:"https://www.youtube.com/iframe_api",api:"https://noembed.com/embed?url=https://www.youtube.com/watch?v={0}"},googleIMA:{sdk:"https://imasdk.googleapis.com/js/sdkloader/ima3.js"}},listeners:{seek:null,play:null,pause:null,restart:null,rewind:null,fastForward:null,mute:null,volume:null,captions:null,download:null,fullscreen:null,pip:null,airplay:null,speed:null,quality:null,loop:null,language:null},events:["ended","progress","stalled","playing","waiting","canplay","canplaythrough","loadstart","loadeddata","loadedmetadata","timeupdate","volumechange","play","pause","error","seeking","seeked","emptied","ratechange","cuechange","download","enterfullscreen","exitfullscreen","captionsenabled","captionsdisabled","languagechange","controlshidden","controlsshown","ready","statechange","qualitychange","adsloaded","adscontentpause","adscontentresume","adstarted","adsmidpoint","adscomplete","adsallcomplete","adsimpression","adsclick"],selectors:{editable:"input, textarea, select, [contenteditable]",container:".plyr",controls:{container:null,wrapper:".plyr__controls"},labels:"[data-plyr]",buttons:{play:'[data-plyr="play"]',pause:'[data-plyr="pause"]',restart:'[data-plyr="restart"]',rewind:'[data-plyr="rewind"]',fastForward:'[data-plyr="fast-forward"]',mute:'[data-plyr="mute"]',captions:'[data-plyr="captions"]',download:'[data-plyr="download"]',fullscreen:'[data-plyr="fullscreen"]',pip:'[data-plyr="pip"]',airplay:'[data-plyr="airplay"]',settings:'[data-plyr="settings"]',loop:'[data-plyr="loop"]'},inputs:{seek:'[data-plyr="seek"]',volume:'[data-plyr="volume"]',speed:'[data-plyr="speed"]',language:'[data-plyr="language"]',quality:'[data-plyr="quality"]'},display:{currentTime:".plyr__time--current",duration:".plyr__time--duration",buffer:".plyr__progress__buffer",loop:".plyr__progress__loop",volume:".plyr__volume--display"},progress:".plyr__progress",captions:".plyr__captions",caption:".plyr__caption"},classNames:{type:"plyr--{0}",provider:"plyr--{0}",video:"plyr__video-wrapper",embed:"plyr__video-embed",videoFixedRatio:"plyr__video-wrapper--fixed-ratio",embedContainer:"plyr__video-embed__container",poster:"plyr__poster",posterEnabled:"plyr__poster-enabled",ads:"plyr__ads",control:"plyr__control",controlPressed:"plyr__control--pressed",playing:"plyr--playing",paused:"plyr--paused",stopped:"plyr--stopped",loading:"plyr--loading",hover:"plyr--hover",tooltip:"plyr__tooltip",cues:"plyr__cues",hidden:"plyr__sr-only",hideControls:"plyr--hide-controls",isIos:"plyr--is-ios",isTouch:"plyr--is-touch",uiSupported:"plyr--full-ui",noTransition:"plyr--no-transition",display:{time:"plyr__time"},menu:{value:"plyr__menu__value",badge:"plyr__badge",open:"plyr--menu-open"},captions:{enabled:"plyr--captions-enabled",active:"plyr--captions-active"},fullscreen:{enabled:"plyr--fullscreen-enabled",fallback:"plyr--fullscreen-fallback"},pip:{supported:"plyr--pip-supported",active:"plyr--pip-active"},airplay:{supported:"plyr--airplay-supported",active:"plyr--airplay-active"},tabFocus:"plyr__tab-focus",previewThumbnails:{thumbContainer:"plyr__preview-thumb",thumbContainerShown:"plyr__preview-thumb--is-shown",imageContainer:"plyr__preview-thumb__image-container",timeContainer:"plyr__preview-thumb__time-container",scrubbingContainer:"plyr__preview-scrubbing",scrubbingContainerShown:"plyr__preview-scrubbing--is-shown"}},attributes:{embed:{provider:"data-plyr-provider",id:"data-plyr-embed-id"}},ads:{enabled:!1,publisherId:"",tagUrl:""},previewThumbnails:{enabled:!1,src:""},vimeo:{byline:!1,portrait:!1,title:!1,speed:!0,transparent:!1,premium:!1,referrerPolicy:null},youtube:{noCookie:!0,rel:0,showinfo:0,iv_load_policy:3,modestbranding:1}},pip={active:"picture-in-picture",inactive:"inline"},providers={html5:"html5",youtube:"youtube",vimeo:"vimeo"},types={audio:"audio",video:"video"};function getProviderByUrl(e){return/^(https?:\/\/)?(www\.)?(youtube\.com|youtube-nocookie\.com|youtu\.?be)\/.+$/.test(e)?providers.youtube:/^https?:\/\/player.vimeo.com\/video\/\d{0,9}(?=\b|\/)/.test(e)?providers.vimeo:null}var noop=function(){},Console=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];_classCallCheck(this,e),this.enabled=window.console&&t,this.enabled&&this.log("Debugging enabled")}return _createClass(e,[{key:"log",get:function(){return this.enabled?Function.prototype.bind.call(console.log,console):noop}},{key:"warn",get:function(){return this.enabled?Function.prototype.bind.call(console.warn,console):noop}},{key:"error",get:function(){return this.enabled?Function.prototype.bind.call(console.error,console):noop}}]),e}(),Fullscreen=function(){function e(t){var n=this;_classCallCheck(this,e),this.player=t,this.prefix=e.prefix,this.property=e.property,this.scrollPosition={x:0,y:0},this.forceFallback="force"===t.config.fullscreen.fallback,this.player.elements.fullscreen=t.config.fullscreen.container&&closest(this.player.elements.container,t.config.fullscreen.container),on.call(this.player,document,"ms"===this.prefix?"MSFullscreenChange":"".concat(this.prefix,"fullscreenchange"),function(){n.onChange()}),on.call(this.player,this.player.elements.container,"dblclick",function(e){is$1.element(n.player.elements.controls)&&n.player.elements.controls.contains(e.target)||n.toggle()}),on.call(this,this.player.elements.container,"keydown",function(e){return n.trapFocus(e)}),this.update()}return _createClass(e,[{key:"onChange",value:function(){if(this.enabled){var e=this.player.elements.buttons.fullscreen;is$1.element(e)&&(e.pressed=this.active),triggerEvent.call(this.player,this.target,this.active?"enterfullscreen":"exitfullscreen",!0)}}},{key:"toggleFallback",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e?this.scrollPosition={x:window.scrollX||0,y:window.scrollY||0}:window.scrollTo(this.scrollPosition.x,this.scrollPosition.y),document.body.style.overflow=e?"hidden":"",toggleClass(this.target,this.player.config.classNames.fullscreen.fallback,e),browser.isIos){var t=document.head.querySelector('meta[name="viewport"]'),n="viewport-fit=cover";t||(t=document.createElement("meta")).setAttribute("name","viewport");var r=is$1.string(t.content)&&t.content.includes(n);e?(this.cleanupViewport=!r,r||(t.content+=",".concat(n))):this.cleanupViewport&&(t.content=t.content.split(",").filter(function(e){return e.trim()!==n}).join(","))}this.onChange()}},{key:"trapFocus",value:function(e){if(!browser.isIos&&this.active&&"Tab"===e.key&&9===e.keyCode){var t=document.activeElement,n=getElements.call(this.player,"a[href], button:not(:disabled), input:not(:disabled), [tabindex]"),r=_slicedToArray(n,1)[0],i=n[n.length-1];t!==i||e.shiftKey?t===r&&e.shiftKey&&(i.focus(),e.preventDefault()):(r.focus(),e.preventDefault())}}},{key:"update",value:function(){var t;this.enabled?(t=this.forceFallback?"Fallback (forced)":e.native?"Native":"Fallback",this.player.debug.log("".concat(t," fullscreen enabled"))):this.player.debug.log("Fullscreen not supported and fallback disabled");toggleClass(this.player.elements.container,this.player.config.classNames.fullscreen.enabled,this.enabled)}},{key:"enter",value:function(){this.enabled&&(browser.isIos&&this.player.config.fullscreen.iosNative?this.target.webkitEnterFullscreen():!e.native||this.forceFallback?this.toggleFallback(!0):this.prefix?is$1.empty(this.prefix)||this.target["".concat(this.prefix,"Request").concat(this.property)]():this.target.requestFullscreen({navigationUI:"hide"}))}},{key:"exit",value:function(){if(this.enabled)if(browser.isIos&&this.player.config.fullscreen.iosNative)this.target.webkitExitFullscreen(),silencePromise(this.player.play());else if(!e.native||this.forceFallback)this.toggleFallback(!1);else if(this.prefix){if(!is$1.empty(this.prefix)){var t="moz"===this.prefix?"Cancel":"Exit";document["".concat(this.prefix).concat(t).concat(this.property)]()}}else(document.cancelFullScreen||document.exitFullscreen).call(document)}},{key:"toggle",value:function(){this.active?this.exit():this.enter()}},{key:"usingNative",get:function(){return e.native&&!this.forceFallback}},{key:"enabled",get:function(){return(e.native||this.player.config.fullscreen.fallback)&&this.player.config.fullscreen.enabled&&this.player.supported.ui&&this.player.isVideo}},{key:"active",get:function(){if(!this.enabled)return!1;if(!e.native||this.forceFallback)return hasClass(this.target,this.player.config.classNames.fullscreen.fallback);var t=this.prefix?document["".concat(this.prefix).concat(this.property,"Element")]:document.fullscreenElement;return t&&t.shadowRoot?t===this.target.getRootNode().host:t===this.target}},{key:"target",get:function(){return browser.isIos&&this.player.config.fullscreen.iosNative?this.player.media:this.player.elements.fullscreen||this.player.elements.container}}],[{key:"native",get:function(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}},{key:"prefix",get:function(){if(is$1.function(document.exitFullscreen))return"";var e="";return["webkit","moz","ms"].some(function(t){return!(!is$1.function(document["".concat(t,"ExitFullscreen")])&&!is$1.function(document["".concat(t,"CancelFullScreen")]))&&(e=t,!0)}),e}},{key:"property",get:function(){return"moz"===this.prefix?"FullScreen":"Fullscreen"}}]),e}(),mathSign=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1};function loadImage(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new Promise(function(n,r){var i=new Image,a=function(){delete i.onload,delete i.onerror,(i.naturalWidth>=t?n:r)(i)};Object.assign(i,{onload:a,onerror:a,src:e})})}_export({target:"Math",stat:!0},{sign:mathSign});var ui={addStyleHook:function(){toggleClass(this.elements.container,this.config.selectors.container.replace(".",""),!0),toggleClass(this.elements.container,this.config.classNames.uiSupported,this.supported.ui)},toggleNativeControls:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&this.isHTML5?this.media.setAttribute("controls",""):this.media.removeAttribute("controls")},build:function(){var e=this;if(this.listeners.media(),!this.supported.ui)return this.debug.warn("Basic support only for ".concat(this.provider," ").concat(this.type)),void ui.toggleNativeControls.call(this,!0);is$1.element(this.elements.controls)||(controls.inject.call(this),this.listeners.controls()),ui.toggleNativeControls.call(this),this.isHTML5&&captions.setup.call(this),this.volume=null,this.muted=null,this.loop=null,this.quality=null,this.speed=null,controls.updateVolume.call(this),controls.timeUpdate.call(this),ui.checkPlaying.call(this),toggleClass(this.elements.container,this.config.classNames.pip.supported,support.pip&&this.isHTML5&&this.isVideo),toggleClass(this.elements.container,this.config.classNames.airplay.supported,support.airplay&&this.isHTML5),toggleClass(this.elements.container,this.config.classNames.isIos,browser.isIos),toggleClass(this.elements.container,this.config.classNames.isTouch,this.touch),this.ready=!0,setTimeout(function(){triggerEvent.call(e,e.media,"ready")},0),ui.setTitle.call(this),this.poster&&ui.setPoster.call(this,this.poster,!1).catch(function(){}),this.config.duration&&controls.durationUpdate.call(this)},setTitle:function(){var e=i18n.get("play",this.config);if(is$1.string(this.config.title)&&!is$1.empty(this.config.title)&&(e+=", ".concat(this.config.title)),Array.from(this.elements.buttons.play||[]).forEach(function(t){t.setAttribute("aria-label",e)}),this.isEmbed){var t=getElement.call(this,"iframe");if(!is$1.element(t))return;var n=is$1.empty(this.config.title)?"video":this.config.title,r=i18n.get("frameTitle",this.config);t.setAttribute("title",r.replace("{title}",n))}},togglePoster:function(e){toggleClass(this.elements.container,this.config.classNames.posterEnabled,e)},setPoster:function(e){var t=this;return arguments.length>1&&void 0!==arguments[1]&&!arguments[1]||!this.poster?(this.media.setAttribute("data-poster",e),ready.call(this).then(function(){return loadImage(e)}).catch(function(n){throw e===t.poster&&ui.togglePoster.call(t,!1),n}).then(function(){if(e!==t.poster)throw new Error("setPoster cancelled by later call to setPoster")}).then(function(){return Object.assign(t.elements.poster.style,{backgroundImage:"url('".concat(e,"')"),backgroundSize:""}),ui.togglePoster.call(t,!0),e})):Promise.reject(new Error("Poster already set"))},checkPlaying:function(e){var t=this;toggleClass(this.elements.container,this.config.classNames.playing,this.playing),toggleClass(this.elements.container,this.config.classNames.paused,this.paused),toggleClass(this.elements.container,this.config.classNames.stopped,this.stopped),Array.from(this.elements.buttons.play||[]).forEach(function(e){Object.assign(e,{pressed:t.playing}),e.setAttribute("aria-label",i18n.get(t.playing?"pause":"play",t.config))}),is$1.event(e)&&"timeupdate"===e.type||ui.toggleControls.call(this)},checkLoading:function(e){var t=this;this.loading=["stalled","waiting"].includes(e.type),clearTimeout(this.timers.loading),this.timers.loading=setTimeout(function(){toggleClass(t.elements.container,t.config.classNames.loading,t.loading),ui.toggleControls.call(t)},this.loading?250:0)},toggleControls:function(e){var t=this.elements.controls;if(t&&this.config.hideControls){var n=this.touch&&this.lastSeekTime+2e3>Date.now();this.toggleControls(Boolean(e||this.loading||this.paused||t.pressed||t.hover||n))}},migrateStyles:function(){var e=this;Object.values(_objectSpread2({},this.media.style)).filter(function(e){return!is$1.empty(e)&&e.startsWith("--plyr")}).forEach(function(t){e.elements.container.style.setProperty(t,e.media.style.getPropertyValue(t)),e.media.style.removeProperty(t)}),is$1.empty(this.media.style)&&this.media.removeAttribute("style")}},Listeners=function(){function e(t){_classCallCheck(this,e),this.player=t,this.lastKey=null,this.focusTimer=null,this.lastKeyDown=null,this.handleKey=this.handleKey.bind(this),this.toggleMenu=this.toggleMenu.bind(this),this.setTabFocus=this.setTabFocus.bind(this),this.firstTouch=this.firstTouch.bind(this)}return _createClass(e,[{key:"handleKey",value:function(e){var t=this.player,n=t.elements,r=e.keyCode?e.keyCode:e.which,i="keydown"===e.type,a=i&&r===this.lastKey;if(!(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)&&is$1.number(r)){if(i){var o=document.activeElement;if(is$1.element(o)){var s=t.config.selectors.editable;if(o!==n.inputs.seek&&matches$1(o,s))return;if(32===e.which&&matches$1(o,'button, [role^="menuitem"]'))return}switch([32,37,38,39,40,48,49,50,51,52,53,54,56,57,67,70,73,75,76,77,79].includes(r)&&(e.preventDefault(),e.stopPropagation()),r){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:a||(t.currentTime=t.duration/10*(r-48));break;case 32:case 75:a||silencePromise(t.togglePlay());break;case 38:t.increaseVolume(.1);break;case 40:t.decreaseVolume(.1);break;case 77:a||(t.muted=!t.muted);break;case 39:t.forward();break;case 37:t.rewind();break;case 70:t.fullscreen.toggle();break;case 67:a||t.toggleCaptions();break;case 76:t.loop=!t.loop}27===r&&!t.fullscreen.usingNative&&t.fullscreen.active&&t.fullscreen.toggle(),this.lastKey=r}else this.lastKey=null}}},{key:"toggleMenu",value:function(e){controls.toggleMenu.call(this.player,e)}},{key:"firstTouch",value:function(){var e=this.player,t=e.elements;e.touch=!0,toggleClass(t.container,e.config.classNames.isTouch,!0)}},{key:"setTabFocus",value:function(e){var t=this.player,n=t.elements;if(clearTimeout(this.focusTimer),"keydown"!==e.type||9===e.which){"keydown"===e.type&&(this.lastKeyDown=e.timeStamp);var r,i=e.timeStamp-this.lastKeyDown<=20;if("focus"!==e.type||i)r=t.config.classNames.tabFocus,toggleClass(getElements.call(t,".".concat(r)),r,!1),"focusout"!==e.type&&(this.focusTimer=setTimeout(function(){var e=document.activeElement;n.container.contains(e)&&toggleClass(document.activeElement,t.config.classNames.tabFocus,!0)},10))}}},{key:"global",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.player;t.config.keyboard.global&&toggleListener.call(t,window,"keydown keyup",this.handleKey,e,!1),toggleListener.call(t,document.body,"click",this.toggleMenu,e),once.call(t,document.body,"touchstart",this.firstTouch),toggleListener.call(t,document.body,"keydown focus blur focusout",this.setTabFocus,e,!1,!0)}},{key:"container",value:function(){var e=this.player,t=e.config,n=e.elements,r=e.timers;!t.keyboard.global&&t.keyboard.focused&&on.call(e,n.container,"keydown keyup",this.handleKey,!1),on.call(e,n.container,"mousemove mouseleave touchstart touchmove enterfullscreen exitfullscreen",function(t){var i=n.controls;i&&"enterfullscreen"===t.type&&(i.pressed=!1,i.hover=!1);var a=0;["touchstart","touchmove","mousemove"].includes(t.type)&&(ui.toggleControls.call(e,!0),a=e.touch?3e3:2e3),clearTimeout(r.controls),r.controls=setTimeout(function(){return ui.toggleControls.call(e,!1)},a)});var i=function(t){if(!t)return setAspectRatio.call(e);var r=n.container.getBoundingClientRect(),i=r.width,a=r.height;return setAspectRatio.call(e,"".concat(i,":").concat(a))},a=function(){clearTimeout(r.resized),r.resized=setTimeout(i,50)};on.call(e,n.container,"enterfullscreen exitfullscreen",function(t){var r=e.fullscreen,o=r.target,s=r.usingNative;if(o===n.container&&(e.isEmbed||!is$1.empty(e.config.ratio))){var l="enterfullscreen"===t.type,c=i(l);c.padding;!function(t,n,r){if(e.isVimeo&&!e.config.vimeo.premium){var i=e.elements.wrapper.firstChild,a=_slicedToArray(t,2)[1],o=_slicedToArray(getAspectRatio.call(e),2),s=o[0],l=o[1];i.style.maxWidth=r?"".concat(a/l*s,"px"):null,i.style.margin=r?"0 auto":null}}(c.ratio,0,l),s||(l?on.call(e,window,"resize",a):off.call(e,window,"resize",a))}})}},{key:"media",value:function(){var e=this,t=this.player,n=t.elements;if(on.call(t,t.media,"timeupdate seeking seeked",function(e){return controls.timeUpdate.call(t,e)}),on.call(t,t.media,"durationchange loadeddata loadedmetadata",function(e){return controls.durationUpdate.call(t,e)}),on.call(t,t.media,"ended",function(){t.isHTML5&&t.isVideo&&t.config.resetOnEnd&&(t.restart(),t.pause())}),on.call(t,t.media,"progress playing seeking seeked",function(e){return controls.updateProgress.call(t,e)}),on.call(t,t.media,"volumechange",function(e){return controls.updateVolume.call(t,e)}),on.call(t,t.media,"playing play pause ended emptied timeupdate",function(e){return ui.checkPlaying.call(t,e)}),on.call(t,t.media,"waiting canplay seeked playing",function(e){return ui.checkLoading.call(t,e)}),t.supported.ui&&t.config.clickToPlay&&!t.isAudio){var r=getElement.call(t,".".concat(t.config.classNames.video));if(!is$1.element(r))return;on.call(t,n.container,"click",function(i){([n.container,r].includes(i.target)||r.contains(i.target))&&(t.touch&&t.config.hideControls||(t.ended?(e.proxy(i,t.restart,"restart"),e.proxy(i,function(){silencePromise(t.play())},"play")):e.proxy(i,function(){silencePromise(t.togglePlay())},"play")))})}t.supported.ui&&t.config.disableContextMenu&&on.call(t,n.wrapper,"contextmenu",function(e){e.preventDefault()},!1),on.call(t,t.media,"volumechange",function(){t.storage.set({volume:t.volume,muted:t.muted})}),on.call(t,t.media,"ratechange",function(){controls.updateSetting.call(t,"speed"),t.storage.set({speed:t.speed})}),on.call(t,t.media,"qualitychange",function(e){controls.updateSetting.call(t,"quality",null,e.detail.quality)}),on.call(t,t.media,"ready qualitychange",function(){controls.setDownloadUrl.call(t)});var i=t.config.events.concat(["keyup","keydown"]).join(" ");on.call(t,t.media,i,function(e){var r=e.detail,i=void 0===r?{}:r;"error"===e.type&&(i=t.media.error),triggerEvent.call(t,n.container,e.type,!0,i)})}},{key:"proxy",value:function(e,t,n){var r=this.player,i=r.config.listeners[n],a=!0;is$1.function(i)&&(a=i.call(r,e)),!1!==a&&is$1.function(t)&&t.call(r,e)}},{key:"bind",value:function(e,t,n,r){var i=this,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=this.player,s=o.config.listeners[r],l=is$1.function(s);on.call(o,e,t,function(e){return i.proxy(e,n,r)},a&&!l)}},{key:"controls",value:function(){var e=this,t=this.player,n=t.elements,r=browser.isIE?"change":"input";if(n.buttons.play&&Array.from(n.buttons.play).forEach(function(n){e.bind(n,"click",function(){silencePromise(t.togglePlay())},"play")}),this.bind(n.buttons.restart,"click",t.restart,"restart"),this.bind(n.buttons.rewind,"click",t.rewind,"rewind"),this.bind(n.buttons.fastForward,"click",t.forward,"fastForward"),this.bind(n.buttons.mute,"click",function(){t.muted=!t.muted},"mute"),this.bind(n.buttons.captions,"click",function(){return t.toggleCaptions()}),this.bind(n.buttons.download,"click",function(){triggerEvent.call(t,t.media,"download")},"download"),this.bind(n.buttons.fullscreen,"click",function(){t.fullscreen.toggle()},"fullscreen"),this.bind(n.buttons.pip,"click",function(){t.pip="toggle"},"pip"),this.bind(n.buttons.airplay,"click",t.airplay,"airplay"),this.bind(n.buttons.settings,"click",function(e){e.stopPropagation(),e.preventDefault(),controls.toggleMenu.call(t,e)},null,!1),this.bind(n.buttons.settings,"keyup",function(e){var n=e.which;[13,32].includes(n)&&(13!==n?(e.preventDefault(),e.stopPropagation(),controls.toggleMenu.call(t,e)):controls.focusFirstMenuItem.call(t,null,!0))},null,!1),this.bind(n.settings.menu,"keydown",function(e){27===e.which&&controls.toggleMenu.call(t,e)}),this.bind(n.inputs.seek,"mousedown mousemove",function(e){var t=n.progress.getBoundingClientRect(),r=100/t.width*(e.pageX-t.left);e.currentTarget.setAttribute("seek-value",r)}),this.bind(n.inputs.seek,"mousedown mouseup keydown keyup touchstart touchend",function(e){var n=e.currentTarget,r=e.keyCode?e.keyCode:e.which;if(!is$1.keyboardEvent(e)||39===r||37===r){t.lastSeekTime=Date.now();var i=n.hasAttribute("play-on-seeked"),a=["mouseup","touchend","keyup"].includes(e.type);i&&a?(n.removeAttribute("play-on-seeked"),silencePromise(t.play())):!a&&t.playing&&(n.setAttribute("play-on-seeked",""),t.pause())}}),browser.isIos){var i=getElements.call(t,'input[type="range"]');Array.from(i).forEach(function(t){return e.bind(t,r,function(e){return repaint(e.target)})})}this.bind(n.inputs.seek,r,function(e){var n=e.currentTarget,r=n.getAttribute("seek-value");is$1.empty(r)&&(r=n.value),n.removeAttribute("seek-value"),t.currentTime=r/n.max*t.duration},"seek"),this.bind(n.progress,"mouseenter mouseleave mousemove",function(e){return controls.updateSeekTooltip.call(t,e)}),this.bind(n.progress,"mousemove touchmove",function(e){var n=t.previewThumbnails;n&&n.loaded&&n.startMove(e)}),this.bind(n.progress,"mouseleave touchend click",function(){var e=t.previewThumbnails;e&&e.loaded&&e.endMove(!1,!0)}),this.bind(n.progress,"mousedown touchstart",function(e){var n=t.previewThumbnails;n&&n.loaded&&n.startScrubbing(e)}),this.bind(n.progress,"mouseup touchend",function(e){var n=t.previewThumbnails;n&&n.loaded&&n.endScrubbing(e)}),browser.isWebkit&&Array.from(getElements.call(t,'input[type="range"]')).forEach(function(n){e.bind(n,"input",function(e){return controls.updateRangeFill.call(t,e.target)})}),t.config.toggleInvert&&!is$1.element(n.display.duration)&&this.bind(n.display.currentTime,"click",function(){0!==t.currentTime&&(t.config.invertTime=!t.config.invertTime,controls.timeUpdate.call(t))}),this.bind(n.inputs.volume,r,function(e){t.volume=e.target.value},"volume"),this.bind(n.controls,"mouseenter mouseleave",function(e){n.controls.hover=!t.touch&&"mouseenter"===e.type}),n.fullscreen&&Array.from(n.fullscreen.children).filter(function(e){return!e.contains(n.container)}).forEach(function(r){e.bind(r,"mouseenter mouseleave",function(e){n.controls.hover=!t.touch&&"mouseenter"===e.type})}),this.bind(n.controls,"mousedown mouseup touchstart touchend touchcancel",function(e){n.controls.pressed=["mousedown","touchstart"].includes(e.type)}),this.bind(n.controls,"focusin",function(){var r=t.config,i=t.timers;toggleClass(n.controls,r.classNames.noTransition,!0),ui.toggleControls.call(t,!0),setTimeout(function(){toggleClass(n.controls,r.classNames.noTransition,!1)},0);var a=e.touch?3e3:4e3;clearTimeout(i.controls),i.controls=setTimeout(function(){return ui.toggleControls.call(t,!1)},a)}),this.bind(n.inputs.volume,"wheel",function(e){var n=e.webkitDirectionInvertedFromDevice,r=_slicedToArray([e.deltaX,-e.deltaY].map(function(e){return n?-e:e}),2),i=r[0],a=r[1],o=Math.sign(Math.abs(i)>Math.abs(a)?i:a);t.increaseVolume(o/50);var s=t.media.volume;(1===o&&s<1||-1===o&&s>0)&&e.preventDefault()},"volume",!1)}}]),e}(),HAS_SPECIES_SUPPORT$3=arrayMethodHasSpeciesSupport("splice"),USES_TO_LENGTH$a=arrayMethodUsesToLength("splice",{ACCESSORS:!0,0:0,1:2}),max$3=Math.max,min$5=Math.min,MAX_SAFE_INTEGER$1=9007199254740991,MAXIMUM_ALLOWED_LENGTH_EXCEEDED="Maximum allowed length exceeded";_export({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT$3||!USES_TO_LENGTH$a},{splice:function(e,t){var n,r,i,a,o,s,l=arguments,c=toObject(this),d=toLength(c.length),u=toAbsoluteIndex(e,d),p=arguments.length;if(0===p?n=r=0:1===p?(n=0,r=d-u):(n=p-2,r=min$5(max$3(toInteger(t),0),d-u)),d+n-r>MAX_SAFE_INTEGER$1)throw TypeError(MAXIMUM_ALLOWED_LENGTH_EXCEEDED);for(i=arraySpeciesCreate(c,r),a=0;a<r;a++)(o=u+a)in c&&createProperty(i,a,c[o]);if(i.length=r,n<r){for(a=u;a<d-r;a++)s=a+n,(o=a+r)in c?c[s]=c[o]:delete c[s];for(a=d;a>d-r+n;a--)delete c[a-1]}else if(n>r)for(a=d-r;a>u;a--)s=a+n-1,(o=a+r-1)in c?c[s]=c[o]:delete c[s];for(a=0;a<n;a++)c[a+u]=l[a+2];return c.length=d-r+n,i}});var loadjs_umd=createCommonjsModule$1(function(e,t){e.exports=function(){var e=function(){},t={},n={},r={};function i(e,t){if(e){var i=r[e];if(n[e]=t,i)for(;i.length;)i[0](e,t),i.splice(0,1)}}function a(t,n){t.call&&(t={success:t}),n.length?(t.error||e)(n):(t.success||e)(t)}function o(t,n,r,i){var a,s,l=document,c=r.async,d=(r.numRetries||0)+1,u=r.before||e,p=t.replace(/[\?|#].*$/,""),f=t.replace(/^(css|img)!/,"");i=i||0,/(^css!|\.css$)/.test(p)?((s=l.createElement("link")).rel="stylesheet",s.href=f,(a="hideFocus"in s)&&s.relList&&(a=0,s.rel="preload",s.as="style")):/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(p)?(s=l.createElement("img")).src=f:((s=l.createElement("script")).src=t,s.async=void 0===c||c),s.onload=s.onerror=s.onbeforeload=function(e){var l=e.type[0];if(a)try{s.sheet.cssText.length||(l="e")}catch(e){18!=e.code&&(l="e")}if("e"==l){if((i+=1)<d)return o(t,n,r,i)}else if("preload"==s.rel&&"style"==s.as)return s.rel="stylesheet";n(t,l,e.defaultPrevented)},!1!==u(t,s)&&l.head.appendChild(s)}function s(e,n,r){var s,l;if(n&&n.trim&&(s=n),l=(s?r:n)||{},s){if(s in t)throw"LoadJS";t[s]=!0}function c(t,n){!function(e,t,n){var r,i,a=(e=e.push?e:[e]).length,s=a,l=[];for(r=function(e,n,r){if("e"==n&&l.push(e),"b"==n){if(!r)return;l.push(e)}--a||t(l)},i=0;i<s;i++)o(e[i],r,n)}(e,function(e){a(l,e),t&&a({success:t,error:n},e),i(s,e)},l)}if(l.returnPromise)return new Promise(c);c()}return s.ready=function(e,t){return function(e,t){e=e.push?e:[e];var i,a,o,s=[],l=e.length,c=l;for(i=function(e,n){n.length&&s.push(e),--c||t(s)};l--;)a=e[l],(o=n[a])?i(a,o):(r[a]=r[a]||[]).push(i)}(e,function(e){a(t,e)}),s},s.done=function(e){i(e,[])},s.reset=function(){t={},n={},r={}},s.isDefined=function(e){return e in t},s}()});function loadScript(e){return new Promise(function(t,n){loadjs_umd(e,{success:t,error:n})})}function parseId(e){if(is$1.empty(e))return null;if(is$1.number(Number(e)))return e;return e.match(/^.*(vimeo.com\/|video\/)(\d+).*/)?RegExp.$2:e}function assurePlaybackState(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,triggerEvent.call(this,this.media,e?"play":"pause"))}var vimeo={setup:function(){var e=this;toggleClass(e.elements.wrapper,e.config.classNames.embed,!0),e.options.speed=e.config.speed.options,setAspectRatio.call(e),is$1.object(window.Vimeo)?vimeo.ready.call(e):loadScript(e.config.urls.vimeo.sdk).then(function(){vimeo.ready.call(e)}).catch(function(t){e.debug.warn("Vimeo SDK (player.js) failed to load",t)})},ready:function(){var e=this,t=this,n=t.config.vimeo,r=n.premium,i=n.referrerPolicy,a=_objectWithoutProperties(n,["premium","referrerPolicy"]);r&&Object.assign(a,{controls:!1,sidedock:!1});var o=buildUrlParams(_objectSpread2({loop:t.config.loop.active,autoplay:t.autoplay,muted:t.muted,gesture:"media",playsinline:!this.config.fullscreen.iosNative},a)),s=t.media.getAttribute("src");is$1.empty(s)&&(s=t.media.getAttribute(t.config.attributes.embed.id));var l=parseId(s),c=createElement("iframe"),d=format$1(t.config.urls.vimeo.iframe,l,o);c.setAttribute("src",d),c.setAttribute("allowfullscreen",""),c.setAttribute("allow","autoplay,fullscreen,picture-in-picture"),is$1.empty(i)||c.setAttribute("referrerPolicy",i);var u=t.poster;if(r)c.setAttribute("data-poster",u),t.media=replaceElement(c,t.media);else{var p=createElement("div",{class:t.config.classNames.embedContainer,"data-poster":u});p.appendChild(c),t.media=replaceElement(p,t.media)}fetch$1(format$1(t.config.urls.vimeo.api,l),"json").then(function(e){if(!is$1.empty(e)){var n=new URL(e[0].thumbnail_large);n.pathname="".concat(n.pathname.split("_")[0],".jpg"),ui.setPoster.call(t,n.href).catch(function(){})}}),t.embed=new window.Vimeo.Player(c,{autopause:t.config.autopause,muted:t.muted}),t.media.paused=!0,t.media.currentTime=0,t.supported.ui&&t.embed.disableTextTrack(),t.media.play=function(){return assurePlaybackState.call(t,!0),t.embed.play()},t.media.pause=function(){return assurePlaybackState.call(t,!1),t.embed.pause()},t.media.stop=function(){t.pause(),t.currentTime=0};var f=t.media.currentTime;Object.defineProperty(t.media,"currentTime",{get:function(){return f},set:function(e){var n=t.embed,r=t.media,i=t.paused,a=t.volume,o=i&&!n.hasPlayed;r.seeking=!0,triggerEvent.call(t,r,"seeking"),Promise.resolve(o&&n.setVolume(0)).then(function(){return n.setCurrentTime(e)}).then(function(){return o&&n.pause()}).then(function(){return o&&n.setVolume(a)}).catch(function(){})}});var h=t.config.speed.selected;Object.defineProperty(t.media,"playbackRate",{get:function(){return h},set:function(e){t.embed.setPlaybackRate(e).then(function(){h=e,triggerEvent.call(t,t.media,"ratechange")}).catch(function(){t.options.speed=[1]})}});var _=t.config.volume;Object.defineProperty(t.media,"volume",{get:function(){return _},set:function(e){t.embed.setVolume(e).then(function(){_=e,triggerEvent.call(t,t.media,"volumechange")})}});var m=t.config.muted;Object.defineProperty(t.media,"muted",{get:function(){return m},set:function(e){var n=!!is$1.boolean(e)&&e;t.embed.setVolume(n?0:t.config.volume).then(function(){m=n,triggerEvent.call(t,t.media,"volumechange")})}});var g,v=t.config.loop;Object.defineProperty(t.media,"loop",{get:function(){return v},set:function(e){var n=is$1.boolean(e)?e:t.config.loop.active;t.embed.setLoop(n).then(function(){v=n})}}),t.embed.getVideoUrl().then(function(e){g=e,controls.setDownloadUrl.call(t)}).catch(function(t){e.debug.warn(t)}),Object.defineProperty(t.media,"currentSrc",{get:function(){return g}}),Object.defineProperty(t.media,"ended",{get:function(){return t.currentTime===t.duration}}),Promise.all([t.embed.getVideoWidth(),t.embed.getVideoHeight()]).then(function(n){var r=_slicedToArray(n,2),i=r[0],a=r[1];t.embed.ratio=[i,a],setAspectRatio.call(e)}),t.embed.setAutopause(t.config.autopause).then(function(e){t.config.autopause=e}),t.embed.getVideoTitle().then(function(n){t.config.title=n,ui.setTitle.call(e)}),t.embed.getCurrentTime().then(function(e){f=e,triggerEvent.call(t,t.media,"timeupdate")}),t.embed.getDuration().then(function(e){t.media.duration=e,triggerEvent.call(t,t.media,"durationchange")}),t.embed.getTextTracks().then(function(e){t.media.textTracks=e,captions.setup.call(t)}),t.embed.on("cuechange",function(e){var n=e.cues,r=(void 0===n?[]:n).map(function(e){return stripHTML(e.text)});captions.updateCues.call(t,r)}),t.embed.on("loaded",function(){(t.embed.getPaused().then(function(e){assurePlaybackState.call(t,!e),e||triggerEvent.call(t,t.media,"playing")}),is$1.element(t.embed.element)&&t.supported.ui)&&t.embed.element.setAttribute("tabindex",-1)}),t.embed.on("bufferstart",function(){triggerEvent.call(t,t.media,"waiting")}),t.embed.on("bufferend",function(){triggerEvent.call(t,t.media,"playing")}),t.embed.on("play",function(){assurePlaybackState.call(t,!0),triggerEvent.call(t,t.media,"playing")}),t.embed.on("pause",function(){assurePlaybackState.call(t,!1)}),t.embed.on("timeupdate",function(e){t.media.seeking=!1,f=e.seconds,triggerEvent.call(t,t.media,"timeupdate")}),t.embed.on("progress",function(e){t.media.buffered=e.percent,triggerEvent.call(t,t.media,"progress"),1===parseInt(e.percent,10)&&triggerEvent.call(t,t.media,"canplaythrough"),t.embed.getDuration().then(function(e){e!==t.media.duration&&(t.media.duration=e,triggerEvent.call(t,t.media,"durationchange"))})}),t.embed.on("seeked",function(){t.media.seeking=!1,triggerEvent.call(t,t.media,"seeked")}),t.embed.on("ended",function(){t.media.paused=!0,triggerEvent.call(t,t.media,"ended")}),t.embed.on("error",function(e){t.media.error=e,triggerEvent.call(t,t.media,"error")}),setTimeout(function(){return ui.build.call(t)},0)}};function parseId$1(e){if(is$1.empty(e))return null;return e.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/)?RegExp.$2:e}function assurePlaybackState$1(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,triggerEvent.call(this,this.media,e?"play":"pause"))}function getHost$1(e){return e.noCookie?"https://www.youtube-nocookie.com":"http:"===window.location.protocol?"http://www.youtube.com":void 0}var youtube={setup:function(){var e=this;if(toggleClass(this.elements.wrapper,this.config.classNames.embed,!0),is$1.object(window.YT)&&is$1.function(window.YT.Player))youtube.ready.call(this);else{var t=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=function(){is$1.function(t)&&t(),youtube.ready.call(e)},loadScript(this.config.urls.youtube.sdk).catch(function(t){e.debug.warn("YouTube API failed to load",t)})}},getTitle:function(e){var t=this;fetch$1(format$1(this.config.urls.youtube.api,e)).then(function(e){if(is$1.object(e)){var n=e.title,r=e.height,i=e.width;t.config.title=n,ui.setTitle.call(t),t.embed.ratio=[i,r]}setAspectRatio.call(t)}).catch(function(){setAspectRatio.call(t)})},ready:function(){var e=this,t=e.media&&e.media.getAttribute("id");if(is$1.empty(t)||!t.startsWith("youtube-")){var n=e.media.getAttribute("src");is$1.empty(n)&&(n=e.media.getAttribute(this.config.attributes.embed.id));var r=parseId$1(n),i=generateId(e.provider),a=createElement("div",{id:i,"data-poster":e.poster});e.media=replaceElement(a,e.media);var o=function(e){return"https://i.ytimg.com/vi/".concat(r,"/").concat(e,"default.jpg")};loadImage(o("maxres"),121).catch(function(){return loadImage(o("sd"),121)}).catch(function(){return loadImage(o("hq"))}).then(function(t){return ui.setPoster.call(e,t.src)}).then(function(t){t.includes("maxres")||(e.elements.poster.style.backgroundSize="cover")}).catch(function(){});var s=e.config.youtube;e.embed=new window.YT.Player(i,{videoId:r,host:getHost$1(s),playerVars:extend({},{autoplay:e.config.autoplay?1:0,hl:e.config.hl,controls:e.supported.ui?0:1,disablekb:1,playsinline:e.config.fullscreen.iosNative?0:1,cc_load_policy:e.captions.active?1:0,cc_lang_pref:e.config.captions.language,widget_referrer:window?window.location.href:null},s),events:{onError:function(t){if(!e.media.error){var n=t.data,r={2:"The request contains an invalid parameter value. For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.",5:"The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.",100:"The video requested was not found. This error occurs when a video has been removed (for any reason) or has been marked as private.",101:"The owner of the requested video does not allow it to be played in embedded players.",150:"The owner of the requested video does not allow it to be played in embedded players."}[n]||"An unknown error occured";e.media.error={code:n,message:r},triggerEvent.call(e,e.media,"error")}},onPlaybackRateChange:function(t){var n=t.target;e.media.playbackRate=n.getPlaybackRate(),triggerEvent.call(e,e.media,"ratechange")},onReady:function(t){if(!is$1.function(e.media.play)){var n=t.target;youtube.getTitle.call(e,r),e.media.play=function(){assurePlaybackState$1.call(e,!0),n.playVideo()},e.media.pause=function(){assurePlaybackState$1.call(e,!1),n.pauseVideo()},e.media.stop=function(){n.stopVideo()},e.media.duration=n.getDuration(),e.media.paused=!0,e.media.currentTime=0,Object.defineProperty(e.media,"currentTime",{get:function(){return Number(n.getCurrentTime())},set:function(t){e.paused&&!e.embed.hasPlayed&&e.embed.mute(),e.media.seeking=!0,triggerEvent.call(e,e.media,"seeking"),n.seekTo(t)}}),Object.defineProperty(e.media,"playbackRate",{get:function(){return n.getPlaybackRate()},set:function(e){n.setPlaybackRate(e)}});var i=e.config.volume;Object.defineProperty(e.media,"volume",{get:function(){return i},set:function(t){i=t,n.setVolume(100*i),triggerEvent.call(e,e.media,"volumechange")}});var a=e.config.muted;Object.defineProperty(e.media,"muted",{get:function(){return a},set:function(t){var r=is$1.boolean(t)?t:a;a=r,n[r?"mute":"unMute"](),triggerEvent.call(e,e.media,"volumechange")}}),Object.defineProperty(e.media,"currentSrc",{get:function(){return n.getVideoUrl()}}),Object.defineProperty(e.media,"ended",{get:function(){return e.currentTime===e.duration}});var o=n.getAvailablePlaybackRates();e.options.speed=o.filter(function(t){return e.config.speed.options.includes(t)}),e.supported.ui&&e.media.setAttribute("tabindex",-1),triggerEvent.call(e,e.media,"timeupdate"),triggerEvent.call(e,e.media,"durationchange"),clearInterval(e.timers.buffering),e.timers.buffering=setInterval(function(){e.media.buffered=n.getVideoLoadedFraction(),(null===e.media.lastBuffered||e.media.lastBuffered<e.media.buffered)&&triggerEvent.call(e,e.media,"progress"),e.media.lastBuffered=e.media.buffered,1===e.media.buffered&&(clearInterval(e.timers.buffering),triggerEvent.call(e,e.media,"canplaythrough"))},200),setTimeout(function(){return ui.build.call(e)},50)}},onStateChange:function(t){var n=t.target;switch(clearInterval(e.timers.playing),e.media.seeking&&[1,2].includes(t.data)&&(e.media.seeking=!1,triggerEvent.call(e,e.media,"seeked")),t.data){case-1:triggerEvent.call(e,e.media,"timeupdate"),e.media.buffered=n.getVideoLoadedFraction(),triggerEvent.call(e,e.media,"progress");break;case 0:assurePlaybackState$1.call(e,!1),e.media.loop?(n.stopVideo(),n.playVideo()):triggerEvent.call(e,e.media,"ended");break;case 1:e.config.autoplay||!e.media.paused||e.embed.hasPlayed?(assurePlaybackState$1.call(e,!0),triggerEvent.call(e,e.media,"playing"),e.timers.playing=setInterval(function(){triggerEvent.call(e,e.media,"timeupdate")},50),e.media.duration!==n.getDuration()&&(e.media.duration=n.getDuration(),triggerEvent.call(e,e.media,"durationchange"))):e.media.pause();break;case 2:e.muted||e.embed.unMute(),assurePlaybackState$1.call(e,!1);break;case 3:triggerEvent.call(e,e.media,"waiting")}triggerEvent.call(e,e.elements.container,"statechange",!1,{code:t.data})}}})}}},media={setup:function(){this.media?(toggleClass(this.elements.container,this.config.classNames.type.replace("{0}",this.type),!0),toggleClass(this.elements.container,this.config.classNames.provider.replace("{0}",this.provider),!0),this.isEmbed&&toggleClass(this.elements.container,this.config.classNames.type.replace("{0}","video"),!0),this.isVideo&&(this.elements.wrapper=createElement("div",{class:this.config.classNames.video}),wrap$1(this.media,this.elements.wrapper),this.elements.poster=createElement("div",{class:this.config.classNames.poster}),this.elements.wrapper.appendChild(this.elements.poster)),this.isHTML5?html5.setup.call(this):this.isYouTube?youtube.setup.call(this):this.isVimeo&&vimeo.setup.call(this)):this.debug.warn("No media element found!")}},destroy=function(e){e.manager&&e.manager.destroy(),e.elements.displayContainer&&e.elements.displayContainer.destroy(),e.elements.container.remove()},Ads=function(){function e(t){var n=this;_classCallCheck(this,e),this.player=t,this.config=t.config.ads,this.playing=!1,this.initialized=!1,this.elements={container:null,displayContainer:null},this.manager=null,this.loader=null,this.cuePoints=null,this.events={},this.safetyTimer=null,this.countdownTimer=null,this.managerPromise=new Promise(function(e,t){n.on("loaded",e),n.on("error",t)}),this.load()}return _createClass(e,[{key:"load",value:function(){var e=this;this.enabled&&(is$1.object(window.google)&&is$1.object(window.google.ima)?this.ready():loadScript(this.player.config.urls.googleIMA.sdk).then(function(){e.ready()}).catch(function(){e.trigger("error",new Error("Google IMA SDK failed to load"))}))}},{key:"ready",value:function(){var e=this;this.enabled||destroy(this),this.startSafetyTimer(12e3,"ready()"),this.managerPromise.then(function(){e.clearSafetyTimer("onAdsManagerLoaded()")}),this.listeners(),this.setupIMA()}},{key:"setupIMA",value:function(){var e=this;this.elements.container=createElement("div",{class:this.player.config.classNames.ads}),this.player.elements.container.appendChild(this.elements.container),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),google.ima.settings.setLocale(this.player.config.ads.language),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(this.player.config.playsinline),this.elements.displayContainer=new google.ima.AdDisplayContainer(this.elements.container,this.player.media),this.loader=new google.ima.AdsLoader(this.elements.displayContainer),this.loader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,function(t){return e.onAdsManagerLoaded(t)},!1),this.loader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,function(t){return e.onAdError(t)},!1),this.requestAds()}},{key:"requestAds",value:function(){var e=this.player.elements.container;try{var t=new google.ima.AdsRequest;t.adTagUrl=this.tagUrl,t.linearAdSlotWidth=e.offsetWidth,t.linearAdSlotHeight=e.offsetHeight,t.nonLinearAdSlotWidth=e.offsetWidth,t.nonLinearAdSlotHeight=e.offsetHeight,t.forceNonLinearFullSlot=!1,t.setAdWillPlayMuted(!this.player.muted),this.loader.requestAds(t)}catch(e){this.onAdError(e)}}},{key:"pollCountdown",value:function(){var e=this;if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0]))return clearInterval(this.countdownTimer),void this.elements.container.removeAttribute("data-badge-text");this.countdownTimer=setInterval(function(){var t=formatTime(Math.max(e.manager.getRemainingTime(),0)),n="".concat(i18n.get("advertisement",e.player.config)," - ").concat(t);e.elements.container.setAttribute("data-badge-text",n)},100)}},{key:"onAdsManagerLoaded",value:function(e){var t=this;if(this.enabled){var n=new google.ima.AdsRenderingSettings;n.restoreCustomPlaybackStateOnAdBreakComplete=!0,n.enablePreloading=!0,this.manager=e.getAdsManager(this.player,n),this.cuePoints=this.manager.getCuePoints(),this.manager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,function(e){return t.onAdError(e)}),Object.keys(google.ima.AdEvent.Type).forEach(function(e){t.manager.addEventListener(google.ima.AdEvent.Type[e],function(e){return t.onAdEvent(e)})}),this.trigger("loaded")}}},{key:"addCuePoints",value:function(){var e=this;is$1.empty(this.cuePoints)||this.cuePoints.forEach(function(t){if(0!==t&&-1!==t&&t<e.player.duration){var n=e.player.elements.progress;if(is$1.element(n)){var r=100/e.player.duration*t,i=createElement("span",{class:e.player.config.classNames.cues});i.style.left="".concat(r.toString(),"%"),n.appendChild(i)}}})}},{key:"onAdEvent",value:function(e){var t,n=this,r=this.player.elements.container,i=e.getAd(),a=e.getAdData();switch(t=e.type,triggerEvent.call(n.player,n.player.media,"ads".concat(t.replace(/_/g,"").toLowerCase())),e.type){case google.ima.AdEvent.Type.LOADED:this.trigger("loaded"),this.pollCountdown(!0),i.isLinear()||(i.width=r.offsetWidth,i.height=r.offsetHeight);break;case google.ima.AdEvent.Type.STARTED:this.manager.setVolume(this.player.volume);break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:this.player.ended?this.loadAds():this.loader.contentComplete();break;case google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:this.pauseContent();break;case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:this.pollCountdown(),this.resumeContent();break;case google.ima.AdEvent.Type.LOG:a.adError&&this.player.debug.warn("Non-fatal ad error: ".concat(a.adError.getMessage()))}}},{key:"onAdError",value:function(e){this.cancel(),this.player.debug.warn("Ads error",e)}},{key:"listeners",value:function(){var e,t=this,n=this.player.elements.container;this.player.on("canplay",function(){t.addCuePoints()}),this.player.on("ended",function(){t.loader.contentComplete()}),this.player.on("timeupdate",function(){e=t.player.currentTime}),this.player.on("seeked",function(){var n=t.player.currentTime;is$1.empty(t.cuePoints)||t.cuePoints.forEach(function(r,i){e<r&&r<n&&(t.manager.discardAdBreak(),t.cuePoints.splice(i,1))})}),window.addEventListener("resize",function(){t.manager&&t.manager.resize(n.offsetWidth,n.offsetHeight,google.ima.ViewMode.NORMAL)})}},{key:"play",value:function(){var e=this,t=this.player.elements.container;this.managerPromise||this.resumeContent(),this.managerPromise.then(function(){e.manager.setVolume(e.player.volume),e.elements.displayContainer.initialize();try{e.initialized||(e.manager.init(t.offsetWidth,t.offsetHeight,google.ima.ViewMode.NORMAL),e.manager.start()),e.initialized=!0}catch(t){e.onAdError(t)}}).catch(function(){})}},{key:"resumeContent",value:function(){this.elements.container.style.zIndex="",this.playing=!1,silencePromise(this.player.media.play())}},{key:"pauseContent",value:function(){this.elements.container.style.zIndex=3,this.playing=!0,this.player.media.pause()}},{key:"cancel",value:function(){this.initialized&&this.resumeContent(),this.trigger("error"),this.loadAds()}},{key:"loadAds",value:function(){var e=this;this.managerPromise.then(function(){e.manager&&e.manager.destroy(),e.managerPromise=new Promise(function(t){e.on("loaded",t),e.player.debug.log(e.manager)}),e.initialized=!1,e.requestAds()}).catch(function(){})}},{key:"trigger",value:function(e){for(var t=arguments,n=this,r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=t[a];var o=this.events[e];is$1.array(o)&&o.forEach(function(e){is$1.function(e)&&e.apply(n,i)})}},{key:"on",value:function(e,t){return is$1.array(this.events[e])||(this.events[e]=[]),this.events[e].push(t),this}},{key:"startSafetyTimer",value:function(e,t){var n=this;this.player.debug.log("Safety timer invoked from: ".concat(t)),this.safetyTimer=setTimeout(function(){n.cancel(),n.clearSafetyTimer("startSafetyTimer()")},e)}},{key:"clearSafetyTimer",value:function(e){is$1.nullOrUndefined(this.safetyTimer)||(this.player.debug.log("Safety timer cleared from: ".concat(e)),clearTimeout(this.safetyTimer),this.safetyTimer=null)}},{key:"enabled",get:function(){var e=this.config;return this.player.isHTML5&&this.player.isVideo&&e.enabled&&(!is$1.empty(e.publisherId)||is$1.url(e.tagUrl))}},{key:"tagUrl",get:function(){var e=this.config;if(is$1.url(e.tagUrl))return e.tagUrl;var t={AV_PUBLISHERID:"58c25bb0073ef448b1087ad6",AV_CHANNELID:"5a0458dc28a06145e4519d21",AV_URL:window.location.hostname,cb:Date.now(),AV_WIDTH:640,AV_HEIGHT:480,AV_CDIM2:e.publisherId};return"".concat("https://go.aniview.com/api/adserver6/vast/","?").concat(buildUrlParams(t))}}]),e}(),$findIndex=arrayIteration.findIndex,FIND_INDEX="findIndex",SKIPS_HOLES$1=!0,USES_TO_LENGTH$b=arrayMethodUsesToLength(FIND_INDEX);FIND_INDEX in[]&&Array(1)[FIND_INDEX](function(){SKIPS_HOLES$1=!1}),_export({target:"Array",proto:!0,forced:SKIPS_HOLES$1||!USES_TO_LENGTH$b},{findIndex:function(e){return $findIndex(this,e,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables(FIND_INDEX);var min$6=Math.min,nativeLastIndexOf=[].lastIndexOf,NEGATIVE_ZERO$1=!!nativeLastIndexOf&&1/[1].lastIndexOf(1,-0)<0,STRICT_METHOD$6=arrayMethodIsStrict("lastIndexOf"),USES_TO_LENGTH$c=arrayMethodUsesToLength("indexOf",{ACCESSORS:!0,1:0}),FORCED$5=NEGATIVE_ZERO$1||!STRICT_METHOD$6||!USES_TO_LENGTH$c,arrayLastIndexOf=FORCED$5?function(e){if(NEGATIVE_ZERO$1)return nativeLastIndexOf.apply(this,arguments)||0;var t=toIndexedObject(this),n=toLength(t.length),r=n-1;for(arguments.length>1&&(r=min$6(r,toInteger(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}:nativeLastIndexOf;_export({target:"Array",proto:!0,forced:arrayLastIndexOf!==[].lastIndexOf},{lastIndexOf:arrayLastIndexOf});var parseVtt=function(e){var t=[];return e.split(/\r\n\r\n|\n\n|\r\r/).forEach(function(e){var n={};e.split(/\r\n|\n|\r/).forEach(function(e){if(is$1.number(n.startTime)){if(!is$1.empty(e.trim())&&is$1.empty(n.text)){var t=e.trim().split("#xywh="),r=_slicedToArray(t,1);if(n.text=r[0],t[1]){var i=_slicedToArray(t[1].split(","),4);n.x=i[0],n.y=i[1],n.w=i[2],n.h=i[3]}}}else{var a=e.match(/([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})( ?--> ?)([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})/);a&&(n.startTime=60*Number(a[1]||0)*60+60*Number(a[2])+Number(a[3])+Number("0.".concat(a[4])),n.endTime=60*Number(a[6]||0)*60+60*Number(a[7])+Number(a[8])+Number("0.".concat(a[9])))}}),n.text&&t.push(n)}),t},fitRatio=function(e,t){var n={};return e>t.width/t.height?(n.width=t.width,n.height=1/e*t.width):(n.height=t.height,n.width=e*t.height),n},PreviewThumbnails=function(){function e(t){_classCallCheck(this,e),this.player=t,this.thumbnails=[],this.loaded=!1,this.lastMouseMoveTime=Date.now(),this.mouseDown=!1,this.loadedImages=[],this.elements={thumb:{},scrubbing:{}},this.load()}return _createClass(e,[{key:"load",value:function(){var e=this;this.player.elements.display.seekTooltip&&(this.player.elements.display.seekTooltip.hidden=this.enabled),this.enabled&&this.getThumbnails().then(function(){e.enabled&&(e.render(),e.determineContainerAutoSizing(),e.loaded=!0)})}},{key:"getThumbnails",value:function(){var e=this;return new Promise(function(t){var n=e.player.config.previewThumbnails.src;if(is$1.empty(n))throw new Error("Missing previewThumbnails.src config attribute");var r=function(){e.thumbnails.sort(function(e,t){return e.height-t.height}),e.player.debug.log("Preview thumbnails",e.thumbnails),t()};if(is$1.function(n))n(function(t){e.thumbnails=t,r()});else{var i=(is$1.string(n)?[n]:n).map(function(t){return e.getThumbnail(t)});Promise.all(i).then(r)}})}},{key:"getThumbnail",value:function(e){var t=this;return new Promise(function(n){fetch$1(e).then(function(r){var i={frames:parseVtt(r),height:null,urlPrefix:""};i.frames[0].text.startsWith("/")||i.frames[0].text.startsWith("http://")||i.frames[0].text.startsWith("https://")||(i.urlPrefix=e.substring(0,e.lastIndexOf("/")+1));var a=new Image;a.onload=function(){i.height=a.naturalHeight,i.width=a.naturalWidth,t.thumbnails.push(i),n()},a.src=i.urlPrefix+i.frames[0].text})})}},{key:"startMove",value:function(e){if(this.loaded&&is$1.event(e)&&["touchmove","mousemove"].includes(e.type)&&this.player.media.duration){if("touchmove"===e.type)this.seekTime=this.player.media.duration*(this.player.elements.inputs.seek.value/100);else{var t=this.player.elements.progress.getBoundingClientRect(),n=100/t.width*(e.pageX-t.left);this.seekTime=this.player.media.duration*(n/100),this.seekTime<0&&(this.seekTime=0),this.seekTime>this.player.media.duration-1&&(this.seekTime=this.player.media.duration-1),this.mousePosX=e.pageX,this.elements.thumb.time.innerText=formatTime(this.seekTime)}this.showImageAtCurrentTime()}}},{key:"endMove",value:function(){this.toggleThumbContainer(!1,!0)}},{key:"startScrubbing",value:function(e){(is$1.nullOrUndefined(e.button)||!1===e.button||0===e.button)&&(this.mouseDown=!0,this.player.media.duration&&(this.toggleScrubbingContainer(!0),this.toggleThumbContainer(!1,!0),this.showImageAtCurrentTime()))}},{key:"endScrubbing",value:function(){var e=this;this.mouseDown=!1,Math.ceil(this.lastTime)===Math.ceil(this.player.media.currentTime)?this.toggleScrubbingContainer(!1):once.call(this.player,this.player.media,"timeupdate",function(){e.mouseDown||e.toggleScrubbingContainer(!1)})}},{key:"listeners",value:function(){var e=this;this.player.on("play",function(){e.toggleThumbContainer(!1,!0)}),this.player.on("seeked",function(){e.toggleThumbContainer(!1)}),this.player.on("timeupdate",function(){e.lastTime=e.player.media.currentTime})}},{key:"render",value:function(){this.elements.thumb.container=createElement("div",{class:this.player.config.classNames.previewThumbnails.thumbContainer}),this.elements.thumb.imageContainer=createElement("div",{class:this.player.config.classNames.previewThumbnails.imageContainer}),this.elements.thumb.container.appendChild(this.elements.thumb.imageContainer);var e=createElement("div",{class:this.player.config.classNames.previewThumbnails.timeContainer});this.elements.thumb.time=createElement("span",{},"00:00"),e.appendChild(this.elements.thumb.time),this.elements.thumb.container.appendChild(e),is$1.element(this.player.elements.progress)&&this.player.elements.progress.appendChild(this.elements.thumb.container),this.elements.scrubbing.container=createElement("div",{class:this.player.config.classNames.previewThumbnails.scrubbingContainer}),this.player.elements.wrapper.appendChild(this.elements.scrubbing.container)}},{key:"destroy",value:function(){this.elements.thumb.container&&this.elements.thumb.container.remove(),this.elements.scrubbing.container&&this.elements.scrubbing.container.remove()}},{key:"showImageAtCurrentTime",value:function(){var e=this;this.mouseDown?this.setScrubbingContainerSize():this.setThumbContainerSizeAndPos();var t=this.thumbnails[0].frames.findIndex(function(t){return e.seekTime>=t.startTime&&e.seekTime<=t.endTime}),n=t>=0,r=0;this.mouseDown||this.toggleThumbContainer(n),n&&(this.thumbnails.forEach(function(n,i){e.loadedImages.includes(n.frames[t].text)&&(r=i)}),t!==this.showingThumb&&(this.showingThumb=t,this.loadImage(r)))}},{key:"loadImage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.showingThumb,r=this.thumbnails[t],i=r.urlPrefix,a=r.frames[n],o=r.frames[n].text,s=i+o;if(this.currentImageElement&&this.currentImageElement.dataset.filename===o)this.showImage(this.currentImageElement,a,t,n,o,!1),this.currentImageElement.dataset.index=n,this.removeOldImages(this.currentImageElement);else{this.loadingImage&&this.usingSprites&&(this.loadingImage.onload=null);var l=new Image;l.src=s,l.dataset.index=n,l.dataset.filename=o,this.showingThumbFilename=o,this.player.debug.log("Loading image: ".concat(s)),l.onload=function(){return e.showImage(l,a,t,n,o,!0)},this.loadingImage=l,this.removeOldImages(l)}}},{key:"showImage",value:function(e,t,n,r,i){var a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];this.player.debug.log("Showing thumb: ".concat(i,". num: ").concat(r,". qual: ").concat(n,". newimg: ").concat(a)),this.setImageSizeAndOffset(e,t),a&&(this.currentImageContainer.appendChild(e),this.currentImageElement=e,this.loadedImages.includes(i)||this.loadedImages.push(i)),this.preloadNearby(r,!0).then(this.preloadNearby(r,!1)).then(this.getHigherQuality(n,e,t,i))}},{key:"removeOldImages",value:function(e){var t=this;Array.from(this.currentImageContainer.children).forEach(function(n){if("img"===n.tagName.toLowerCase()){var r=t.usingSprites?500:1e3;if(n.dataset.index!==e.dataset.index&&!n.dataset.deleting){n.dataset.deleting=!0;var i=t.currentImageContainer;setTimeout(function(){i.removeChild(n),t.player.debug.log("Removing thumb: ".concat(n.dataset.filename))},r)}}})}},{key:"preloadNearby",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise(function(r){setTimeout(function(){var i=t.thumbnails[0].frames[e].text;if(t.showingThumbFilename===i){var a;a=n?t.thumbnails[0].frames.slice(e):t.thumbnails[0].frames.slice(0,e).reverse();var o=!1;a.forEach(function(e){var n=e.text;if(n!==i&&!t.loadedImages.includes(n)){o=!0,t.player.debug.log("Preloading thumb filename: ".concat(n));var a=t.thumbnails[0].urlPrefix+n,s=new Image;s.src=a,s.onload=function(){t.player.debug.log("Preloaded thumb filename: ".concat(n)),t.loadedImages.includes(n)||t.loadedImages.push(n),r()}}}),o||r()}},300)})}},{key:"getHigherQuality",value:function(e,t,n,r){var i=this;if(e<this.thumbnails.length-1){var a=t.naturalHeight;this.usingSprites&&(a=n.h),a<this.thumbContainerHeight&&setTimeout(function(){i.showingThumbFilename===r&&(i.player.debug.log("Showing higher quality thumb for: ".concat(r)),i.loadImage(e+1))},300)}}},{key:"toggleThumbContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.player.config.classNames.previewThumbnails.thumbContainerShown;this.elements.thumb.container.classList.toggle(n,e),!e&&t&&(this.showingThumb=null,this.showingThumbFilename=null)}},{key:"toggleScrubbingContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.player.config.classNames.previewThumbnails.scrubbingContainerShown;this.elements.scrubbing.container.classList.toggle(t,e),e||(this.showingThumb=null,this.showingThumbFilename=null)}},{key:"determineContainerAutoSizing",value:function(){(this.elements.thumb.imageContainer.clientHeight>20||this.elements.thumb.imageContainer.clientWidth>20)&&(this.sizeSpecifiedInCSS=!0)}},{key:"setThumbContainerSizeAndPos",value:function(){if(this.sizeSpecifiedInCSS){if(this.elements.thumb.imageContainer.clientHeight>20&&this.elements.thumb.imageContainer.clientWidth<20){var e=Math.floor(this.elements.thumb.imageContainer.clientHeight*this.thumbAspectRatio);this.elements.thumb.imageContainer.style.width="".concat(e,"px")}else if(this.elements.thumb.imageContainer.clientHeight<20&&this.elements.thumb.imageContainer.clientWidth>20){var t=Math.floor(this.elements.thumb.imageContainer.clientWidth/this.thumbAspectRatio);this.elements.thumb.imageContainer.style.height="".concat(t,"px")}}else{var n=Math.floor(this.thumbContainerHeight*this.thumbAspectRatio);this.elements.thumb.imageContainer.style.height="".concat(this.thumbContainerHeight,"px"),this.elements.thumb.imageContainer.style.width="".concat(n,"px")}this.setThumbContainerPos()}},{key:"setThumbContainerPos",value:function(){var e=this.player.elements.progress.getBoundingClientRect(),t=this.player.elements.container.getBoundingClientRect(),n=this.elements.thumb.container,r=t.left-e.left+10,i=t.right-e.left-n.clientWidth-10,a=this.mousePosX-e.left-n.clientWidth/2;a<r&&(a=r),a>i&&(a=i),n.style.left="".concat(a,"px")}},{key:"setScrubbingContainerSize",value:function(){var e=fitRatio(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight}),t=e.width,n=e.height;this.elements.scrubbing.container.style.width="".concat(t,"px"),this.elements.scrubbing.container.style.height="".concat(n,"px")}},{key:"setImageSizeAndOffset",value:function(e,t){if(this.usingSprites){var n=this.thumbContainerHeight/t.h;e.style.height="".concat(e.naturalHeight*n,"px"),e.style.width="".concat(e.naturalWidth*n,"px"),e.style.left="-".concat(t.x*n,"px"),e.style.top="-".concat(t.y*n,"px")}}},{key:"enabled",get:function(){return this.player.isHTML5&&this.player.isVideo&&this.player.config.previewThumbnails.enabled}},{key:"currentImageContainer",get:function(){return this.mouseDown?this.elements.scrubbing.container:this.elements.thumb.imageContainer}},{key:"usingSprites",get:function(){return Object.keys(this.thumbnails[0].frames[0]).includes("w")}},{key:"thumbAspectRatio",get:function(){return this.usingSprites?this.thumbnails[0].frames[0].w/this.thumbnails[0].frames[0].h:this.thumbnails[0].width/this.thumbnails[0].height}},{key:"thumbContainerHeight",get:function(){return this.mouseDown?fitRatio(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight}).height:this.sizeSpecifiedInCSS?this.elements.thumb.imageContainer.clientHeight:Math.floor(this.player.media.clientWidth/this.thumbAspectRatio/4)}},{key:"currentImageElement",get:function(){return this.mouseDown?this.currentScrubbingImageElement:this.currentThumbnailImageElement},set:function(e){this.mouseDown?this.currentScrubbingImageElement=e:this.currentThumbnailImageElement=e}}]),e}(),source={insertElements:function(e,t){var n=this;is$1.string(t)?insertElement(e,this.media,{src:t}):is$1.array(t)&&t.forEach(function(t){insertElement(e,n.media,t)})},change:function(e){var t=this;getDeep(e,"sources.length")?(html5.cancelRequests.call(this),this.destroy.call(this,function(){t.options.quality=[],removeElement(t.media),t.media=null,is$1.element(t.elements.container)&&t.elements.container.removeAttribute("class");var n=e.sources,r=e.type,i=_slicedToArray(n,1)[0],a=i.provider,o=void 0===a?providers.html5:a,s=i.src,l="html5"===o?r:"div",c="html5"===o?{}:{src:s};Object.assign(t,{provider:o,type:r,supported:support.check(r,o,t.config.playsinline),media:createElement(l,c)}),t.elements.container.appendChild(t.media),is$1.boolean(e.autoplay)&&(t.config.autoplay=e.autoplay),t.isHTML5&&(t.config.crossorigin&&t.media.setAttribute("crossorigin",""),t.config.autoplay&&t.media.setAttribute("autoplay",""),is$1.empty(e.poster)||(t.poster=e.poster),t.config.loop.active&&t.media.setAttribute("loop",""),t.config.muted&&t.media.setAttribute("muted",""),t.config.playsinline&&t.media.setAttribute("playsinline","")),ui.addStyleHook.call(t),t.isHTML5&&source.insertElements.call(t,"source",n),t.config.title=e.title,media.setup.call(t),t.isHTML5&&Object.keys(e).includes("tracks")&&source.insertElements.call(t,"track",e.tracks),(t.isHTML5||t.isEmbed&&!t.supported.ui)&&ui.build.call(t),t.isHTML5&&t.media.load(),is$1.empty(e.previewThumbnails)||(Object.assign(t.config.previewThumbnails,e.previewThumbnails),t.previewThumbnails&&t.previewThumbnails.loaded&&(t.previewThumbnails.destroy(),t.previewThumbnails=null),t.config.previewThumbnails.enabled&&(t.previewThumbnails=new PreviewThumbnails(t))),t.fullscreen.update()},!0)):this.debug.warn("Invalid source format")}};function clamp(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:255;return Math.min(Math.max(e,t),n)}var Plyr=function(){function e(t,n){var r=this;if(_classCallCheck(this,e),this.timers={},this.ready=!1,this.loading=!1,this.failed=!1,this.touch=support.touch,this.media=t,is$1.string(this.media)&&(this.media=document.querySelectorAll(this.media)),(window.jQuery&&this.media instanceof jQuery||is$1.nodeList(this.media)||is$1.array(this.media))&&(this.media=this.media[0]),this.config=extend({},defaults$1,e.defaults,n||{},function(){try{return JSON.parse(r.media.getAttribute("data-plyr-config"))}catch(e){return{}}}()),this.elements={container:null,fullscreen:null,captions:null,buttons:{},display:{},progress:{},inputs:{},settings:{popup:null,menu:null,panels:{},buttons:{}}},this.captions={active:null,currentTrack:-1,meta:new WeakMap},this.fullscreen={active:!1},this.options={speed:[],quality:[]},this.debug=new Console(this.config.debug),this.debug.log("Config",this.config),this.debug.log("Support",support),!is$1.nullOrUndefined(this.media)&&is$1.element(this.media))if(this.media.plyr)this.debug.warn("Target already setup");else if(this.config.enabled)if(support.check().api){var i=this.media.cloneNode(!0);i.autoplay=!1,this.elements.original=i;var a=this.media.tagName.toLowerCase(),o=null,s=null;switch(a){case"div":if(o=this.media.querySelector("iframe"),is$1.element(o)){if(s=parseUrl(o.getAttribute("src")),this.provider=getProviderByUrl(s.toString()),this.elements.container=this.media,this.media=o,this.elements.container.className="",s.search.length){var l=["1","true"];l.includes(s.searchParams.get("autoplay"))&&(this.config.autoplay=!0),l.includes(s.searchParams.get("loop"))&&(this.config.loop.active=!0),this.isYouTube?(this.config.playsinline=l.includes(s.searchParams.get("playsinline")),this.config.youtube.hl=s.searchParams.get("hl")):this.config.playsinline=!0}}else this.provider=this.media.getAttribute(this.config.attributes.embed.provider),this.media.removeAttribute(this.config.attributes.embed.provider);if(is$1.empty(this.provider)||!Object.keys(providers).includes(this.provider))return void this.debug.error("Setup failed: Invalid provider");this.type=types.video;break;case"video":case"audio":this.type=a,this.provider=providers.html5,this.media.hasAttribute("crossorigin")&&(this.config.crossorigin=!0),this.media.hasAttribute("autoplay")&&(this.config.autoplay=!0),(this.media.hasAttribute("playsinline")||this.media.hasAttribute("webkit-playsinline"))&&(this.config.playsinline=!0),this.media.hasAttribute("muted")&&(this.config.muted=!0),this.media.hasAttribute("loop")&&(this.config.loop.active=!0);break;default:return void this.debug.error("Setup failed: unsupported type")}this.supported=support.check(this.type,this.provider,this.config.playsinline),this.supported.api?(this.eventListeners=[],this.listeners=new Listeners(this),this.storage=new Storage(this),this.media.plyr=this,is$1.element(this.elements.container)||(this.elements.container=createElement("div",{tabindex:0}),wrap$1(this.media,this.elements.container)),ui.migrateStyles.call(this),ui.addStyleHook.call(this),media.setup.call(this),this.config.debug&&on.call(this,this.elements.container,this.config.events.join(" "),function(e){r.debug.log("event: ".concat(e.type))}),this.fullscreen=new Fullscreen(this),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&ui.build.call(this),this.listeners.container(),this.listeners.global(),this.config.ads.enabled&&(this.ads=new Ads(this)),this.isHTML5&&this.config.autoplay&&setTimeout(function(){return silencePromise(r.play())},10),this.lastSeekTime=0,this.config.previewThumbnails.enabled&&(this.previewThumbnails=new PreviewThumbnails(this))):this.debug.error("Setup failed: no support")}else this.debug.error("Setup failed: no support");else this.debug.error("Setup failed: disabled by config");else this.debug.error("Setup failed: no suitable element passed")}return _createClass(e,[{key:"play",value:function(){var e=this;return is$1.function(this.media.play)?(this.ads&&this.ads.enabled&&this.ads.managerPromise.then(function(){return e.ads.play()}).catch(function(){return silencePromise(e.media.play())}),this.media.play()):null}},{key:"pause",value:function(){return this.playing&&is$1.function(this.media.pause)?this.media.pause():null}},{key:"togglePlay",value:function(e){return(is$1.boolean(e)?e:!this.playing)?this.play():this.pause()}},{key:"stop",value:function(){this.isHTML5?(this.pause(),this.restart()):is$1.function(this.media.stop)&&this.media.stop()}},{key:"restart",value:function(){this.currentTime=0}},{key:"rewind",value:function(e){this.currentTime-=is$1.number(e)?e:this.config.seekTime}},{key:"forward",value:function(e){this.currentTime+=is$1.number(e)?e:this.config.seekTime}},{key:"increaseVolume",value:function(e){var t=this.media.muted?0:this.volume;this.volume=t+(is$1.number(e)?e:0)}},{key:"decreaseVolume",value:function(e){this.increaseVolume(-e)}},{key:"toggleCaptions",value:function(e){captions.toggle.call(this,e,!1)}},{key:"airplay",value:function(){support.airplay&&this.media.webkitShowPlaybackTargetPicker()}},{key:"toggleControls",value:function(e){if(this.supported.ui&&!this.isAudio){var t=hasClass(this.elements.container,this.config.classNames.hideControls),n=void 0===e?void 0:!e,r=toggleClass(this.elements.container,this.config.classNames.hideControls,n);if(r&&is$1.array(this.config.controls)&&this.config.controls.includes("settings")&&!is$1.empty(this.config.settings)&&controls.toggleMenu.call(this,!1),r!==t){var i=r?"controlshidden":"controlsshown";triggerEvent.call(this,this.media,i)}return!r}return!1}},{key:"on",value:function(e,t){on.call(this,this.elements.container,e,t)}},{key:"once",value:function(e,t){once.call(this,this.elements.container,e,t)}},{key:"off",value:function(e,t){off(this.elements.container,e,t)}},{key:"destroy",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.ready){var r=function(){document.body.style.overflow="",t.embed=null,n?(Object.keys(t.elements).length&&(removeElement(t.elements.buttons.play),removeElement(t.elements.captions),removeElement(t.elements.controls),removeElement(t.elements.wrapper),t.elements.buttons.play=null,t.elements.captions=null,t.elements.controls=null,t.elements.wrapper=null),is$1.function(e)&&e()):(unbindListeners.call(t),replaceElement(t.elements.original,t.elements.container),triggerEvent.call(t,t.elements.original,"destroyed",!0),is$1.function(e)&&e.call(t.elements.original),t.ready=!1,setTimeout(function(){t.elements=null,t.media=null},200))};this.stop(),clearTimeout(this.timers.loading),clearTimeout(this.timers.controls),clearTimeout(this.timers.resized),this.isHTML5?(ui.toggleNativeControls.call(this,!0),r()):this.isYouTube?(clearInterval(this.timers.buffering),clearInterval(this.timers.playing),null!==this.embed&&is$1.function(this.embed.destroy)&&this.embed.destroy(),r()):this.isVimeo&&(null!==this.embed&&this.embed.unload().then(r),setTimeout(r,200))}}},{key:"supports",value:function(e){return support.mime.call(this,e)}},{key:"isHTML5",get:function(){return this.provider===providers.html5}},{key:"isEmbed",get:function(){return this.isYouTube||this.isVimeo}},{key:"isYouTube",get:function(){return this.provider===providers.youtube}},{key:"isVimeo",get:function(){return this.provider===providers.vimeo}},{key:"isVideo",get:function(){return this.type===types.video}},{key:"isAudio",get:function(){return this.type===types.audio}},{key:"playing",get:function(){return Boolean(this.ready&&!this.paused&&!this.ended)}},{key:"paused",get:function(){return Boolean(this.media.paused)}},{key:"stopped",get:function(){return Boolean(this.paused&&0===this.currentTime)}},{key:"ended",get:function(){return Boolean(this.media.ended)}},{key:"currentTime",set:function(e){if(this.duration){var t=is$1.number(e)&&e>0;this.media.currentTime=t?Math.min(e,this.duration):0,this.debug.log("Seeking to ".concat(this.currentTime," seconds"))}},get:function(){return Number(this.media.currentTime)}},{key:"buffered",get:function(){var e=this.media.buffered;return is$1.number(e)?e:e&&e.length&&this.duration>0?e.end(0)/this.duration:0}},{key:"seeking",get:function(){return Boolean(this.media.seeking)}},{key:"duration",get:function(){var e=parseFloat(this.config.duration),t=(this.media||{}).duration,n=is$1.number(t)&&t!==1/0?t:0;return e||n}},{key:"volume",set:function(e){var t=e;is$1.string(t)&&(t=Number(t)),is$1.number(t)||(t=this.storage.get("volume")),is$1.number(t)||(t=this.config.volume),t>1&&(t=1),t<0&&(t=0),this.config.volume=t,this.media.volume=t,!is$1.empty(e)&&this.muted&&t>0&&(this.muted=!1)},get:function(){return Number(this.media.volume)}},{key:"muted",set:function(e){var t=e;is$1.boolean(t)||(t=this.storage.get("muted")),is$1.boolean(t)||(t=this.config.muted),this.config.muted=t,this.media.muted=t},get:function(){return Boolean(this.media.muted)}},{key:"hasAudio",get:function(){return!this.isHTML5||(!!this.isAudio||(Boolean(this.media.mozHasAudio)||Boolean(this.media.webkitAudioDecodedByteCount)||Boolean(this.media.audioTracks&&this.media.audioTracks.length)))}},{key:"speed",set:function(e){var t=this,n=null;is$1.number(e)&&(n=e),is$1.number(n)||(n=this.storage.get("speed")),is$1.number(n)||(n=this.config.speed.selected);var r=this.minimumSpeed,i=this.maximumSpeed;n=clamp(n,r,i),this.config.speed.selected=n,setTimeout(function(){t.media.playbackRate=n},0)},get:function(){return Number(this.media.playbackRate)}},{key:"minimumSpeed",get:function(){return this.isYouTube?Math.min.apply(Math,_toConsumableArray(this.options.speed)):this.isVimeo?.5:.0625}},{key:"maximumSpeed",get:function(){return this.isYouTube?Math.max.apply(Math,_toConsumableArray(this.options.speed)):this.isVimeo?2:16}},{key:"quality",set:function(e){var t=this.config.quality,n=this.options.quality;if(n.length){var r=[!is$1.empty(e)&&Number(e),this.storage.get("quality"),t.selected,t.default].find(is$1.number),i=!0;if(!n.includes(r)){var a=closest$1(n,r);this.debug.warn("Unsupported quality option: ".concat(r,", using ").concat(a," instead")),r=a,i=!1}t.selected=r,this.media.quality=r,i&&this.storage.set({quality:r})}},get:function(){return this.media.quality}},{key:"loop",set:function(e){var t=is$1.boolean(e)?e:this.config.loop.active;this.config.loop.active=t,this.media.loop=t},get:function(){return Boolean(this.media.loop)}},{key:"source",set:function(e){source.change.call(this,e)},get:function(){return this.media.currentSrc}},{key:"download",get:function(){var e=this.config.urls.download;return is$1.url(e)?e:this.source},set:function(e){is$1.url(e)&&(this.config.urls.download=e,controls.setDownloadUrl.call(this))}},{key:"poster",set:function(e){this.isVideo?ui.setPoster.call(this,e,!1).catch(function(){}):this.debug.warn("Poster can only be set for video")},get:function(){return this.isVideo?this.media.getAttribute("poster")||this.media.getAttribute("data-poster"):null}},{key:"ratio",get:function(){if(!this.isVideo)return null;var e=reduceAspectRatio(getAspectRatio.call(this));return is$1.array(e)?e.join(":"):e},set:function(e){this.isVideo?is$1.string(e)&&validateRatio(e)?(this.config.ratio=e,setAspectRatio.call(this)):this.debug.error("Invalid aspect ratio specified (".concat(e,")")):this.debug.warn("Aspect ratio can only be set for video")}},{key:"autoplay",set:function(e){var t=is$1.boolean(e)?e:this.config.autoplay;this.config.autoplay=t},get:function(){return Boolean(this.config.autoplay)}},{key:"currentTrack",set:function(e){captions.set.call(this,e,!1)},get:function(){var e=this.captions,t=e.toggled,n=e.currentTrack;return t?n:-1}},{key:"language",set:function(e){captions.setLanguage.call(this,e,!1)},get:function(){return(captions.getCurrentTrack.call(this)||{}).language}},{key:"pip",set:function(e){if(support.pip){var t=is$1.boolean(e)?e:!this.pip;is$1.function(this.media.webkitSetPresentationMode)&&this.media.webkitSetPresentationMode(t?pip.active:pip.inactive),is$1.function(this.media.requestPictureInPicture)&&(!this.pip&&t?this.media.requestPictureInPicture():this.pip&&!t&&document.exitPictureInPicture())}},get:function(){return support.pip?is$1.empty(this.media.webkitPresentationMode)?this.media===document.pictureInPictureElement:this.media.webkitPresentationMode===pip.active:null}}],[{key:"supported",value:function(e,t,n){return support.check(e,t,n)}},{key:"loadSprite",value:function(e,t){return loadSprite(e,t)}},{key:"setup",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null;return is$1.string(t)?r=Array.from(document.querySelectorAll(t)):is$1.nodeList(t)?r=Array.from(t):is$1.array(t)&&(r=t.filter(is$1.element)),is$1.empty(r)?null:r.map(function(t){return new e(t,n)})}}]),e}();return Plyr.defaults=cloneDeep(defaults$1),frappe.Plyr=Plyr,frappe.provide("frappe.barcode"),frappe.barcode.scan_barcode=function(){return new Promise(function(e,t){window.cordova&&window.cordova.plugins&&window.cordova.plugins.barcodeScanner?window.cordova.plugins.barcodeScanner.scan(function(t){t.cancelled||e(t.text)},t):frappe.require("/assets/js/barcode_scanner.min.js",function(){frappe.barcode.get_barcode().then(function(t){e(t)})})})},frappe.provide("frappe.ui"),frappe.ui.Scanner=class{constructor(e){this.dialog=null,this.handler=null,this.options=e,this.is_alive=!1,"multiple"in this.options||(this.options.multiple=!1),e.container&&(this.$scan_area=$(e.container),this.scan_area_id=frappe.dom.set_unique_id(this.$scan_area)),e.dialog&&(this.dialog=this.make_dialog(),this.dialog.show())}scan(){var e=this;this.load_lib().then(function(){return e.start_scan()})}start_scan(){var e=this;this.handler||(this.handler=new Html5Qrcode(this.scan_area_id)),this.handler.start({facingMode:"environment"},{fps:10,qrbox:250},function(t,n){if(e.options.on_scan)try{e.options.on_scan(n)}catch(e){console.error(e)}e.options.multiple||(e.stop_scan(),e.hide_dialog())},function(e){}).catch(function(t){e.is_alive=!1,e.hide_dialog(),console.error(t)}),this.is_alive=!0}stop_scan(){var e=this;this.handler&&this.is_alive&&this.handler.stop().then(function(){e.is_alive=!1,e.$scan_area.empty(),e.hide_dialog()})}make_dialog(){var e=this,t=new frappe.ui.Dialog({title:__("Scan QRCode"),fields:[{fieldtype:"HTML",fieldname:"scan_area"}],on_page_show:function(){e.$scan_area=t.get_field("scan_area").$wrapper,e.$scan_area.addClass("barcode-scanner"),e.scan_area_id=frappe.dom.set_unique_id(e.$scan_area),e.scan()},on_hide:function(){e.stop_scan()}});return t}hide_dialog(){this.dialog&&this.dialog.hide()}load_lib(){return frappe.require("/assets/frappe/node_modules/html5-qrcode/dist/html5-qrcode.min.js")}},exports.__moduleExports=_class,exports}({});
//# sourceMappingURL=desk.min.js.map
